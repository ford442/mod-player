(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=t(r);fetch(r.href,s)}})();function aE(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var lE={exports:{}},Rp={},uE={exports:{}},kt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var of=Symbol.for("react.element"),j2=Symbol.for("react.portal"),Y2=Symbol.for("react.fragment"),q2=Symbol.for("react.strict_mode"),Z2=Symbol.for("react.profiler"),K2=Symbol.for("react.provider"),J2=Symbol.for("react.context"),Q2=Symbol.for("react.forward_ref"),$2=Symbol.for("react.suspense"),eR=Symbol.for("react.memo"),tR=Symbol.for("react.lazy"),jS=Symbol.iterator;function nR(n){return n===null||typeof n!="object"?null:(n=jS&&n[jS]||n["@@iterator"],typeof n=="function"?n:null)}var cE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},fE=Object.assign,dE={};function au(n,e,t){this.props=n,this.context=e,this.refs=dE,this.updater=t||cE}au.prototype.isReactComponent={};au.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};au.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function hE(){}hE.prototype=au.prototype;function Cy(n,e,t){this.props=n,this.context=e,this.refs=dE,this.updater=t||cE}var Ry=Cy.prototype=new hE;Ry.constructor=Cy;fE(Ry,au.prototype);Ry.isPureReactComponent=!0;var YS=Array.isArray,pE=Object.prototype.hasOwnProperty,Py={current:null},mE={key:!0,ref:!0,__self:!0,__source:!0};function gE(n,e,t){var i,r={},s=null,o=null;if(e!=null)for(i in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(s=""+e.key),e)pE.call(e,i)&&!mE.hasOwnProperty(i)&&(r[i]=e[i]);var a=arguments.length-2;if(a===1)r.children=t;else if(1<a){for(var c=Array(a),f=0;f<a;f++)c[f]=arguments[f+2];r.children=c}if(n&&n.defaultProps)for(i in a=n.defaultProps,a)r[i]===void 0&&(r[i]=a[i]);return{$$typeof:of,type:n,key:s,ref:o,props:r,_owner:Py.current}}function iR(n,e){return{$$typeof:of,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function Ly(n){return typeof n=="object"&&n!==null&&n.$$typeof===of}function rR(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var qS=/\/+/g;function Eg(n,e){return typeof n=="object"&&n!==null&&n.key!=null?rR(""+n.key):e.toString(36)}function Ih(n,e,t,i,r){var s=typeof n;(s==="undefined"||s==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case of:case j2:o=!0}}if(o)return o=n,r=r(o),n=i===""?"."+Eg(o,0):i,YS(r)?(t="",n!=null&&(t=n.replace(qS,"$&/")+"/"),Ih(r,e,t,"",function(f){return f})):r!=null&&(Ly(r)&&(r=iR(r,t+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(qS,"$&/")+"/")+n)),e.push(r)),1;if(o=0,i=i===""?".":i+":",YS(n))for(var a=0;a<n.length;a++){s=n[a];var c=i+Eg(s,a);o+=Ih(s,e,t,c,r)}else if(c=nR(n),typeof c=="function")for(n=c.call(n),a=0;!(s=n.next()).done;)s=s.value,c=i+Eg(s,a++),o+=Ih(s,e,t,c,r);else if(s==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function yd(n,e,t){if(n==null)return n;var i=[],r=0;return Ih(n,i,"","",function(s){return e.call(t,s,r++)}),i}function sR(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var Ai={current:null},Nh={transition:null},oR={ReactCurrentDispatcher:Ai,ReactCurrentBatchConfig:Nh,ReactCurrentOwner:Py};function vE(){throw Error("act(...) is not supported in production builds of React.")}kt.Children={map:yd,forEach:function(n,e,t){yd(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return yd(n,function(){e++}),e},toArray:function(n){return yd(n,function(e){return e})||[]},only:function(n){if(!Ly(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};kt.Component=au;kt.Fragment=Y2;kt.Profiler=Z2;kt.PureComponent=Cy;kt.StrictMode=q2;kt.Suspense=$2;kt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=oR;kt.act=vE;kt.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var i=fE({},n.props),r=n.key,s=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,o=Py.current),e.key!==void 0&&(r=""+e.key),n.type&&n.type.defaultProps)var a=n.type.defaultProps;for(c in e)pE.call(e,c)&&!mE.hasOwnProperty(c)&&(i[c]=e[c]===void 0&&a!==void 0?a[c]:e[c])}var c=arguments.length-2;if(c===1)i.children=t;else if(1<c){a=Array(c);for(var f=0;f<c;f++)a[f]=arguments[f+2];i.children=a}return{$$typeof:of,type:n.type,key:r,ref:s,props:i,_owner:o}};kt.createContext=function(n){return n={$$typeof:J2,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:K2,_context:n},n.Consumer=n};kt.createElement=gE;kt.createFactory=function(n){var e=gE.bind(null,n);return e.type=n,e};kt.createRef=function(){return{current:null}};kt.forwardRef=function(n){return{$$typeof:Q2,render:n}};kt.isValidElement=Ly;kt.lazy=function(n){return{$$typeof:tR,_payload:{_status:-1,_result:n},_init:sR}};kt.memo=function(n,e){return{$$typeof:eR,type:n,compare:e===void 0?null:e}};kt.startTransition=function(n){var e=Nh.transition;Nh.transition={};try{n()}finally{Nh.transition=e}};kt.unstable_act=vE;kt.useCallback=function(n,e){return Ai.current.useCallback(n,e)};kt.useContext=function(n){return Ai.current.useContext(n)};kt.useDebugValue=function(){};kt.useDeferredValue=function(n){return Ai.current.useDeferredValue(n)};kt.useEffect=function(n,e){return Ai.current.useEffect(n,e)};kt.useId=function(){return Ai.current.useId()};kt.useImperativeHandle=function(n,e,t){return Ai.current.useImperativeHandle(n,e,t)};kt.useInsertionEffect=function(n,e){return Ai.current.useInsertionEffect(n,e)};kt.useLayoutEffect=function(n,e){return Ai.current.useLayoutEffect(n,e)};kt.useMemo=function(n,e){return Ai.current.useMemo(n,e)};kt.useReducer=function(n,e,t){return Ai.current.useReducer(n,e,t)};kt.useRef=function(n){return Ai.current.useRef(n)};kt.useState=function(n){return Ai.current.useState(n)};kt.useSyncExternalStore=function(n,e,t){return Ai.current.useSyncExternalStore(n,e,t)};kt.useTransition=function(){return Ai.current.useTransition()};kt.version="18.3.1";uE.exports=kt;var X=uE.exports;const aR=aE(X);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lR=X,uR=Symbol.for("react.element"),cR=Symbol.for("react.fragment"),fR=Object.prototype.hasOwnProperty,dR=lR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,hR={key:!0,ref:!0,__self:!0,__source:!0};function yE(n,e,t){var i,r={},s=null,o=null;t!==void 0&&(s=""+t),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(o=e.ref);for(i in e)fR.call(e,i)&&!hR.hasOwnProperty(i)&&(r[i]=e[i]);if(n&&n.defaultProps)for(i in e=n.defaultProps,e)r[i]===void 0&&(r[i]=e[i]);return{$$typeof:uR,type:n,key:s,ref:o,props:r,_owner:dR.current}}Rp.Fragment=cR;Rp.jsx=yE;Rp.jsxs=yE;lE.exports=Rp;var de=lE.exports,H0={},_E={exports:{}},nr={},xE={exports:{}},SE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(F,W){var V=F.length;F.push(W);e:for(;0<V;){var Q=V-1>>>1,se=F[Q];if(0<r(se,W))F[Q]=W,F[V]=se,V=Q;else break e}}function t(F){return F.length===0?null:F[0]}function i(F){if(F.length===0)return null;var W=F[0],V=F.pop();if(V!==W){F[0]=V;e:for(var Q=0,se=F.length,J=se>>>1;Q<J;){var ge=2*(Q+1)-1,Ie=F[ge],Be=ge+1,Fe=F[Be];if(0>r(Ie,V))Be<se&&0>r(Fe,Ie)?(F[Q]=Fe,F[Be]=V,Q=Be):(F[Q]=Ie,F[ge]=V,Q=ge);else if(Be<se&&0>r(Fe,V))F[Q]=Fe,F[Be]=V,Q=Be;else break e}}return W}function r(F,W){var V=F.sortIndex-W.sortIndex;return V!==0?V:F.id-W.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var c=[],f=[],d=1,h=null,m=3,v=!1,y=!1,w=!1,x=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function M(F){for(var W=t(f);W!==null;){if(W.callback===null)i(f);else if(W.startTime<=F)i(f),W.sortIndex=W.expirationTime,e(c,W);else break;W=t(f)}}function T(F){if(w=!1,M(F),!y)if(t(c)!==null)y=!0,ne(P);else{var W=t(f);W!==null&&he(T,W.startTime-F)}}function P(F,W){y=!1,w&&(w=!1,g(O),O=-1),v=!0;var V=m;try{for(M(W),h=t(c);h!==null&&(!(h.expirationTime>W)||F&&!B());){var Q=h.callback;if(typeof Q=="function"){h.callback=null,m=h.priorityLevel;var se=Q(h.expirationTime<=W);W=n.unstable_now(),typeof se=="function"?h.callback=se:h===t(c)&&i(c),M(W)}else i(c);h=t(c)}if(h!==null)var J=!0;else{var ge=t(f);ge!==null&&he(T,ge.startTime-W),J=!1}return J}finally{h=null,m=V,v=!1}}var b=!1,L=null,O=-1,C=5,R=-1;function B(){return!(n.unstable_now()-R<C)}function $(){if(L!==null){var F=n.unstable_now();R=F;var W=!0;try{W=L(!0,F)}finally{W?me():(b=!1,L=null)}}else b=!1}var me;if(typeof S=="function")me=function(){S($)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,Z=G.port2;G.port1.onmessage=$,me=function(){Z.postMessage(null)}}else me=function(){x($,0)};function ne(F){L=F,b||(b=!0,me())}function he(F,W){O=x(function(){F(n.unstable_now())},W)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(F){F.callback=null},n.unstable_continueExecution=function(){y||v||(y=!0,ne(P))},n.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<F?Math.floor(1e3/F):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_getFirstCallbackNode=function(){return t(c)},n.unstable_next=function(F){switch(m){case 1:case 2:case 3:var W=3;break;default:W=m}var V=m;m=W;try{return F()}finally{m=V}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(F,W){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var V=m;m=F;try{return W()}finally{m=V}},n.unstable_scheduleCallback=function(F,W,V){var Q=n.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?Q+V:Q):V=Q,F){case 1:var se=-1;break;case 2:se=250;break;case 5:se=1073741823;break;case 4:se=1e4;break;default:se=5e3}return se=V+se,F={id:d++,callback:W,priorityLevel:F,startTime:V,expirationTime:se,sortIndex:-1},V>Q?(F.sortIndex=V,e(f,F),t(c)===null&&F===t(f)&&(w?(g(O),O=-1):w=!0,he(T,V-Q))):(F.sortIndex=se,e(c,F),y||v||(y=!0,ne(P))),F},n.unstable_shouldYield=B,n.unstable_wrapCallback=function(F){var W=m;return function(){var V=m;m=W;try{return F.apply(this,arguments)}finally{m=V}}}})(SE);xE.exports=SE;var pR=xE.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mR=X,tr=pR;function ze(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var ME=new Set,xc={};function Ca(n,e){Zl(n,e),Zl(n+"Capture",e)}function Zl(n,e){for(xc[n]=e,n=0;n<e.length;n++)ME.add(e[n])}var Rs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),V0=Object.prototype.hasOwnProperty,gR=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,ZS={},KS={};function vR(n){return V0.call(KS,n)?!0:V0.call(ZS,n)?!1:gR.test(n)?KS[n]=!0:(ZS[n]=!0,!1)}function yR(n,e,t,i){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function _R(n,e,t,i){if(e===null||typeof e>"u"||yR(n,e,t,i))return!0;if(i)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function bi(n,e,t,i,r,s,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=s,this.removeEmptyString=o}var Qn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){Qn[n]=new bi(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];Qn[e]=new bi(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){Qn[n]=new bi(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){Qn[n]=new bi(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){Qn[n]=new bi(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){Qn[n]=new bi(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){Qn[n]=new bi(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){Qn[n]=new bi(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){Qn[n]=new bi(n,5,!1,n.toLowerCase(),null,!1,!1)});var Iy=/[\-:]([a-z])/g;function Ny(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(Iy,Ny);Qn[e]=new bi(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(Iy,Ny);Qn[e]=new bi(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(Iy,Ny);Qn[e]=new bi(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){Qn[n]=new bi(n,1,!1,n.toLowerCase(),null,!1,!1)});Qn.xlinkHref=new bi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){Qn[n]=new bi(n,1,!1,n.toLowerCase(),null,!0,!0)});function Dy(n,e,t,i){var r=Qn.hasOwnProperty(e)?Qn[e]:null;(r!==null?r.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(_R(e,t,r,i)&&(t=null),i||r===null?vR(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):r.mustUseProperty?n[r.propertyName]=t===null?r.type===3?!1:"":t:(e=r.attributeName,i=r.attributeNamespace,t===null?n.removeAttribute(e):(r=r.type,t=r===3||r===4&&t===!0?"":""+t,i?n.setAttributeNS(i,e,t):n.setAttribute(e,t))))}var Os=mR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_d=Symbol.for("react.element"),El=Symbol.for("react.portal"),Tl=Symbol.for("react.fragment"),Uy=Symbol.for("react.strict_mode"),G0=Symbol.for("react.profiler"),wE=Symbol.for("react.provider"),EE=Symbol.for("react.context"),Oy=Symbol.for("react.forward_ref"),W0=Symbol.for("react.suspense"),X0=Symbol.for("react.suspense_list"),ky=Symbol.for("react.memo"),to=Symbol.for("react.lazy"),TE=Symbol.for("react.offscreen"),JS=Symbol.iterator;function Nu(n){return n===null||typeof n!="object"?null:(n=JS&&n[JS]||n["@@iterator"],typeof n=="function"?n:null)}var mn=Object.assign,Tg;function ec(n){if(Tg===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);Tg=e&&e[1]||""}return`
`+Tg+n}var Ag=!1;function bg(n,e){if(!n||Ag)return"";Ag=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(f){var i=f}Reflect.construct(n,[],e)}else{try{e.call()}catch(f){i=f}n.call(e.prototype)}else{try{throw Error()}catch(f){i=f}n()}}catch(f){if(f&&i&&typeof f.stack=="string"){for(var r=f.stack.split(`
`),s=i.stack.split(`
`),o=r.length-1,a=s.length-1;1<=o&&0<=a&&r[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(r[o]!==s[a]){if(o!==1||a!==1)do if(o--,a--,0>a||r[o]!==s[a]){var c=`
`+r[o].replace(" at new "," at ");return n.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",n.displayName)),c}while(1<=o&&0<=a);break}}}finally{Ag=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?ec(n):""}function xR(n){switch(n.tag){case 5:return ec(n.type);case 16:return ec("Lazy");case 13:return ec("Suspense");case 19:return ec("SuspenseList");case 0:case 2:case 15:return n=bg(n.type,!1),n;case 11:return n=bg(n.type.render,!1),n;case 1:return n=bg(n.type,!0),n;default:return""}}function j0(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Tl:return"Fragment";case El:return"Portal";case G0:return"Profiler";case Uy:return"StrictMode";case W0:return"Suspense";case X0:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case EE:return(n.displayName||"Context")+".Consumer";case wE:return(n._context.displayName||"Context")+".Provider";case Oy:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case ky:return e=n.displayName||null,e!==null?e:j0(n.type)||"Memo";case to:e=n._payload,n=n._init;try{return j0(n(e))}catch{}}return null}function SR(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return j0(e);case 8:return e===Uy?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function xo(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function AE(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function MR(n){var e=AE(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),i=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var r=t.get,s=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){i=""+o,s.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return i},setValue:function(o){i=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function xd(n){n._valueTracker||(n._valueTracker=MR(n))}function bE(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),i="";return n&&(i=AE(n)?n.checked?"true":"false":n.value),n=i,n!==t?(e.setValue(n),!0):!1}function Qh(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function Y0(n,e){var t=e.checked;return mn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function QS(n,e){var t=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;t=xo(e.value!=null?e.value:t),n._wrapperState={initialChecked:i,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function CE(n,e){e=e.checked,e!=null&&Dy(n,"checked",e,!1)}function q0(n,e){CE(n,e);var t=xo(e.value),i=e.type;if(t!=null)i==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(i==="submit"||i==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?Z0(n,e.type,t):e.hasOwnProperty("defaultValue")&&Z0(n,e.type,xo(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function $S(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function Z0(n,e,t){(e!=="number"||Qh(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var tc=Array.isArray;function Vl(n,e,t,i){if(n=n.options,e){e={};for(var r=0;r<t.length;r++)e["$"+t[r]]=!0;for(t=0;t<n.length;t++)r=e.hasOwnProperty("$"+n[t].value),n[t].selected!==r&&(n[t].selected=r),r&&i&&(n[t].defaultSelected=!0)}else{for(t=""+xo(t),e=null,r=0;r<n.length;r++){if(n[r].value===t){n[r].selected=!0,i&&(n[r].defaultSelected=!0);return}e!==null||n[r].disabled||(e=n[r])}e!==null&&(e.selected=!0)}}function K0(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ze(91));return mn({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function e1(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(ze(92));if(tc(t)){if(1<t.length)throw Error(ze(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:xo(t)}}function RE(n,e){var t=xo(e.value),i=xo(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),i!=null&&(n.defaultValue=""+i)}function t1(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function PE(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function J0(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?PE(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Sd,LE=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,i,r){MSApp.execUnsafeLocalFunction(function(){return n(e,t,i,r)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(Sd=Sd||document.createElement("div"),Sd.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Sd.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function Sc(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var sc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},wR=["Webkit","ms","Moz","O"];Object.keys(sc).forEach(function(n){wR.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),sc[e]=sc[n]})});function IE(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||sc.hasOwnProperty(n)&&sc[n]?(""+e).trim():e+"px"}function NE(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var i=t.indexOf("--")===0,r=IE(t,e[t],i);t==="float"&&(t="cssFloat"),i?n.setProperty(t,r):n[t]=r}}var ER=mn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Q0(n,e){if(e){if(ER[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ze(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ze(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ze(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ze(62))}}function $0(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ev=null;function Fy(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var tv=null,Gl=null,Wl=null;function n1(n){if(n=uf(n)){if(typeof tv!="function")throw Error(ze(280));var e=n.stateNode;e&&(e=Dp(e),tv(n.stateNode,n.type,e))}}function DE(n){Gl?Wl?Wl.push(n):Wl=[n]:Gl=n}function UE(){if(Gl){var n=Gl,e=Wl;if(Wl=Gl=null,n1(n),e)for(n=0;n<e.length;n++)n1(e[n])}}function OE(n,e){return n(e)}function kE(){}var Cg=!1;function FE(n,e,t){if(Cg)return n(e,t);Cg=!0;try{return OE(n,e,t)}finally{Cg=!1,(Gl!==null||Wl!==null)&&(kE(),UE())}}function Mc(n,e){var t=n.stateNode;if(t===null)return null;var i=Dp(t);if(i===null)return null;t=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(n=n.type,i=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!i;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(ze(231,e,typeof t));return t}var nv=!1;if(Rs)try{var Du={};Object.defineProperty(Du,"passive",{get:function(){nv=!0}}),window.addEventListener("test",Du,Du),window.removeEventListener("test",Du,Du)}catch{nv=!1}function TR(n,e,t,i,r,s,o,a,c){var f=Array.prototype.slice.call(arguments,3);try{e.apply(t,f)}catch(d){this.onError(d)}}var oc=!1,$h=null,ep=!1,iv=null,AR={onError:function(n){oc=!0,$h=n}};function bR(n,e,t,i,r,s,o,a,c){oc=!1,$h=null,TR.apply(AR,arguments)}function CR(n,e,t,i,r,s,o,a,c){if(bR.apply(this,arguments),oc){if(oc){var f=$h;oc=!1,$h=null}else throw Error(ze(198));ep||(ep=!0,iv=f)}}function Ra(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function zE(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function i1(n){if(Ra(n)!==n)throw Error(ze(188))}function RR(n){var e=n.alternate;if(!e){if(e=Ra(n),e===null)throw Error(ze(188));return e!==n?null:n}for(var t=n,i=e;;){var r=t.return;if(r===null)break;var s=r.alternate;if(s===null){if(i=r.return,i!==null){t=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===t)return i1(r),n;if(s===i)return i1(r),e;s=s.sibling}throw Error(ze(188))}if(t.return!==i.return)t=r,i=s;else{for(var o=!1,a=r.child;a;){if(a===t){o=!0,t=r,i=s;break}if(a===i){o=!0,i=r,t=s;break}a=a.sibling}if(!o){for(a=s.child;a;){if(a===t){o=!0,t=s,i=r;break}if(a===i){o=!0,i=s,t=r;break}a=a.sibling}if(!o)throw Error(ze(189))}}if(t.alternate!==i)throw Error(ze(190))}if(t.tag!==3)throw Error(ze(188));return t.stateNode.current===t?n:e}function BE(n){return n=RR(n),n!==null?HE(n):null}function HE(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=HE(n);if(e!==null)return e;n=n.sibling}return null}var VE=tr.unstable_scheduleCallback,r1=tr.unstable_cancelCallback,PR=tr.unstable_shouldYield,LR=tr.unstable_requestPaint,An=tr.unstable_now,IR=tr.unstable_getCurrentPriorityLevel,zy=tr.unstable_ImmediatePriority,GE=tr.unstable_UserBlockingPriority,tp=tr.unstable_NormalPriority,NR=tr.unstable_LowPriority,WE=tr.unstable_IdlePriority,Pp=null,Qr=null;function DR(n){if(Qr&&typeof Qr.onCommitFiberRoot=="function")try{Qr.onCommitFiberRoot(Pp,n,void 0,(n.current.flags&128)===128)}catch{}}var Dr=Math.clz32?Math.clz32:kR,UR=Math.log,OR=Math.LN2;function kR(n){return n>>>=0,n===0?32:31-(UR(n)/OR|0)|0}var Md=64,wd=4194304;function nc(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function np(n,e){var t=n.pendingLanes;if(t===0)return 0;var i=0,r=n.suspendedLanes,s=n.pingedLanes,o=t&268435455;if(o!==0){var a=o&~r;a!==0?i=nc(a):(s&=o,s!==0&&(i=nc(s)))}else o=t&~r,o!==0?i=nc(o):s!==0&&(i=nc(s));if(i===0)return 0;if(e!==0&&e!==i&&!(e&r)&&(r=i&-i,s=e&-e,r>=s||r===16&&(s&4194240)!==0))return e;if(i&4&&(i|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=i;0<e;)t=31-Dr(e),r=1<<t,i|=n[t],e&=~r;return i}function FR(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function zR(n,e){for(var t=n.suspendedLanes,i=n.pingedLanes,r=n.expirationTimes,s=n.pendingLanes;0<s;){var o=31-Dr(s),a=1<<o,c=r[o];c===-1?(!(a&t)||a&i)&&(r[o]=FR(a,e)):c<=e&&(n.expiredLanes|=a),s&=~a}}function rv(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function XE(){var n=Md;return Md<<=1,!(Md&4194240)&&(Md=64),n}function Rg(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function af(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-Dr(e),n[e]=t}function BR(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var i=n.eventTimes;for(n=n.expirationTimes;0<t;){var r=31-Dr(t),s=1<<r;e[r]=0,i[r]=-1,n[r]=-1,t&=~s}}function By(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var i=31-Dr(t),r=1<<i;r&e|n[i]&e&&(n[i]|=e),t&=~r}}var Zt=0;function jE(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var YE,Hy,qE,ZE,KE,sv=!1,Ed=[],lo=null,uo=null,co=null,wc=new Map,Ec=new Map,io=[],HR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function s1(n,e){switch(n){case"focusin":case"focusout":lo=null;break;case"dragenter":case"dragleave":uo=null;break;case"mouseover":case"mouseout":co=null;break;case"pointerover":case"pointerout":wc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ec.delete(e.pointerId)}}function Uu(n,e,t,i,r,s){return n===null||n.nativeEvent!==s?(n={blockedOn:e,domEventName:t,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},e!==null&&(e=uf(e),e!==null&&Hy(e)),n):(n.eventSystemFlags|=i,e=n.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),n)}function VR(n,e,t,i,r){switch(e){case"focusin":return lo=Uu(lo,n,e,t,i,r),!0;case"dragenter":return uo=Uu(uo,n,e,t,i,r),!0;case"mouseover":return co=Uu(co,n,e,t,i,r),!0;case"pointerover":var s=r.pointerId;return wc.set(s,Uu(wc.get(s)||null,n,e,t,i,r)),!0;case"gotpointercapture":return s=r.pointerId,Ec.set(s,Uu(Ec.get(s)||null,n,e,t,i,r)),!0}return!1}function JE(n){var e=sa(n.target);if(e!==null){var t=Ra(e);if(t!==null){if(e=t.tag,e===13){if(e=zE(t),e!==null){n.blockedOn=e,KE(n.priority,function(){qE(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Dh(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=ov(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var i=new t.constructor(t.type,t);ev=i,t.target.dispatchEvent(i),ev=null}else return e=uf(t),e!==null&&Hy(e),n.blockedOn=t,!1;e.shift()}return!0}function o1(n,e,t){Dh(n)&&t.delete(e)}function GR(){sv=!1,lo!==null&&Dh(lo)&&(lo=null),uo!==null&&Dh(uo)&&(uo=null),co!==null&&Dh(co)&&(co=null),wc.forEach(o1),Ec.forEach(o1)}function Ou(n,e){n.blockedOn===e&&(n.blockedOn=null,sv||(sv=!0,tr.unstable_scheduleCallback(tr.unstable_NormalPriority,GR)))}function Tc(n){function e(r){return Ou(r,n)}if(0<Ed.length){Ou(Ed[0],n);for(var t=1;t<Ed.length;t++){var i=Ed[t];i.blockedOn===n&&(i.blockedOn=null)}}for(lo!==null&&Ou(lo,n),uo!==null&&Ou(uo,n),co!==null&&Ou(co,n),wc.forEach(e),Ec.forEach(e),t=0;t<io.length;t++)i=io[t],i.blockedOn===n&&(i.blockedOn=null);for(;0<io.length&&(t=io[0],t.blockedOn===null);)JE(t),t.blockedOn===null&&io.shift()}var Xl=Os.ReactCurrentBatchConfig,ip=!0;function WR(n,e,t,i){var r=Zt,s=Xl.transition;Xl.transition=null;try{Zt=1,Vy(n,e,t,i)}finally{Zt=r,Xl.transition=s}}function XR(n,e,t,i){var r=Zt,s=Xl.transition;Xl.transition=null;try{Zt=4,Vy(n,e,t,i)}finally{Zt=r,Xl.transition=s}}function Vy(n,e,t,i){if(ip){var r=ov(n,e,t,i);if(r===null)zg(n,e,i,rp,t),s1(n,i);else if(VR(r,n,e,t,i))i.stopPropagation();else if(s1(n,i),e&4&&-1<HR.indexOf(n)){for(;r!==null;){var s=uf(r);if(s!==null&&YE(s),s=ov(n,e,t,i),s===null&&zg(n,e,i,rp,t),s===r)break;r=s}r!==null&&i.stopPropagation()}else zg(n,e,i,null,t)}}var rp=null;function ov(n,e,t,i){if(rp=null,n=Fy(i),n=sa(n),n!==null)if(e=Ra(n),e===null)n=null;else if(t=e.tag,t===13){if(n=zE(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return rp=n,null}function QE(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(IR()){case zy:return 1;case GE:return 4;case tp:case NR:return 16;case WE:return 536870912;default:return 16}default:return 16}}var oo=null,Gy=null,Uh=null;function $E(){if(Uh)return Uh;var n,e=Gy,t=e.length,i,r="value"in oo?oo.value:oo.textContent,s=r.length;for(n=0;n<t&&e[n]===r[n];n++);var o=t-n;for(i=1;i<=o&&e[t-i]===r[s-i];i++);return Uh=r.slice(n,1<i?1-i:void 0)}function Oh(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function Td(){return!0}function a1(){return!1}function ir(n){function e(t,i,r,s,o){this._reactName=t,this._targetInst=r,this.type=i,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var a in n)n.hasOwnProperty(a)&&(t=n[a],this[a]=t?t(s):s[a]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Td:a1,this.isPropagationStopped=a1,this}return mn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Td)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Td)},persist:function(){},isPersistent:Td}),e}var lu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Wy=ir(lu),lf=mn({},lu,{view:0,detail:0}),jR=ir(lf),Pg,Lg,ku,Lp=mn({},lf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Xy,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==ku&&(ku&&n.type==="mousemove"?(Pg=n.screenX-ku.screenX,Lg=n.screenY-ku.screenY):Lg=Pg=0,ku=n),Pg)},movementY:function(n){return"movementY"in n?n.movementY:Lg}}),l1=ir(Lp),YR=mn({},Lp,{dataTransfer:0}),qR=ir(YR),ZR=mn({},lf,{relatedTarget:0}),Ig=ir(ZR),KR=mn({},lu,{animationName:0,elapsedTime:0,pseudoElement:0}),JR=ir(KR),QR=mn({},lu,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),$R=ir(QR),eP=mn({},lu,{data:0}),u1=ir(eP),tP={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},nP={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},iP={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function rP(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=iP[n])?!!e[n]:!1}function Xy(){return rP}var sP=mn({},lf,{key:function(n){if(n.key){var e=tP[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=Oh(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?nP[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Xy,charCode:function(n){return n.type==="keypress"?Oh(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Oh(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),oP=ir(sP),aP=mn({},Lp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),c1=ir(aP),lP=mn({},lf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Xy}),uP=ir(lP),cP=mn({},lu,{propertyName:0,elapsedTime:0,pseudoElement:0}),fP=ir(cP),dP=mn({},Lp,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),hP=ir(dP),pP=[9,13,27,32],jy=Rs&&"CompositionEvent"in window,ac=null;Rs&&"documentMode"in document&&(ac=document.documentMode);var mP=Rs&&"TextEvent"in window&&!ac,eT=Rs&&(!jy||ac&&8<ac&&11>=ac),f1=" ",d1=!1;function tT(n,e){switch(n){case"keyup":return pP.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function nT(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Al=!1;function gP(n,e){switch(n){case"compositionend":return nT(e);case"keypress":return e.which!==32?null:(d1=!0,f1);case"textInput":return n=e.data,n===f1&&d1?null:n;default:return null}}function vP(n,e){if(Al)return n==="compositionend"||!jy&&tT(n,e)?(n=$E(),Uh=Gy=oo=null,Al=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return eT&&e.locale!=="ko"?null:e.data;default:return null}}var yP={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function h1(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!yP[n.type]:e==="textarea"}function iT(n,e,t,i){DE(i),e=sp(e,"onChange"),0<e.length&&(t=new Wy("onChange","change",null,t,i),n.push({event:t,listeners:e}))}var lc=null,Ac=null;function _P(n){pT(n,0)}function Ip(n){var e=Rl(n);if(bE(e))return n}function xP(n,e){if(n==="change")return e}var rT=!1;if(Rs){var Ng;if(Rs){var Dg="oninput"in document;if(!Dg){var p1=document.createElement("div");p1.setAttribute("oninput","return;"),Dg=typeof p1.oninput=="function"}Ng=Dg}else Ng=!1;rT=Ng&&(!document.documentMode||9<document.documentMode)}function m1(){lc&&(lc.detachEvent("onpropertychange",sT),Ac=lc=null)}function sT(n){if(n.propertyName==="value"&&Ip(Ac)){var e=[];iT(e,Ac,n,Fy(n)),FE(_P,e)}}function SP(n,e,t){n==="focusin"?(m1(),lc=e,Ac=t,lc.attachEvent("onpropertychange",sT)):n==="focusout"&&m1()}function MP(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Ip(Ac)}function wP(n,e){if(n==="click")return Ip(e)}function EP(n,e){if(n==="input"||n==="change")return Ip(e)}function TP(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var Or=typeof Object.is=="function"?Object.is:TP;function bc(n,e){if(Or(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),i=Object.keys(e);if(t.length!==i.length)return!1;for(i=0;i<t.length;i++){var r=t[i];if(!V0.call(e,r)||!Or(n[r],e[r]))return!1}return!0}function g1(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function v1(n,e){var t=g1(n);n=0;for(var i;t;){if(t.nodeType===3){if(i=n+t.textContent.length,n<=e&&i>=e)return{node:t,offset:e-n};n=i}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=g1(t)}}function oT(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?oT(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function aT(){for(var n=window,e=Qh();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=Qh(n.document)}return e}function Yy(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function AP(n){var e=aT(),t=n.focusedElem,i=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&oT(t.ownerDocument.documentElement,t)){if(i!==null&&Yy(t)){if(e=i.start,n=i.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var r=t.textContent.length,s=Math.min(i.start,r);i=i.end===void 0?s:Math.min(i.end,r),!n.extend&&s>i&&(r=i,i=s,s=r),r=v1(t,s);var o=v1(t,i);r&&o&&(n.rangeCount!==1||n.anchorNode!==r.node||n.anchorOffset!==r.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),n.removeAllRanges(),s>i?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var bP=Rs&&"documentMode"in document&&11>=document.documentMode,bl=null,av=null,uc=null,lv=!1;function y1(n,e,t){var i=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;lv||bl==null||bl!==Qh(i)||(i=bl,"selectionStart"in i&&Yy(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),uc&&bc(uc,i)||(uc=i,i=sp(av,"onSelect"),0<i.length&&(e=new Wy("onSelect","select",null,e,t),n.push({event:e,listeners:i}),e.target=bl)))}function Ad(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var Cl={animationend:Ad("Animation","AnimationEnd"),animationiteration:Ad("Animation","AnimationIteration"),animationstart:Ad("Animation","AnimationStart"),transitionend:Ad("Transition","TransitionEnd")},Ug={},lT={};Rs&&(lT=document.createElement("div").style,"AnimationEvent"in window||(delete Cl.animationend.animation,delete Cl.animationiteration.animation,delete Cl.animationstart.animation),"TransitionEvent"in window||delete Cl.transitionend.transition);function Np(n){if(Ug[n])return Ug[n];if(!Cl[n])return n;var e=Cl[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in lT)return Ug[n]=e[t];return n}var uT=Np("animationend"),cT=Np("animationiteration"),fT=Np("animationstart"),dT=Np("transitionend"),hT=new Map,_1="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function To(n,e){hT.set(n,e),Ca(e,[n])}for(var Og=0;Og<_1.length;Og++){var kg=_1[Og],CP=kg.toLowerCase(),RP=kg[0].toUpperCase()+kg.slice(1);To(CP,"on"+RP)}To(uT,"onAnimationEnd");To(cT,"onAnimationIteration");To(fT,"onAnimationStart");To("dblclick","onDoubleClick");To("focusin","onFocus");To("focusout","onBlur");To(dT,"onTransitionEnd");Zl("onMouseEnter",["mouseout","mouseover"]);Zl("onMouseLeave",["mouseout","mouseover"]);Zl("onPointerEnter",["pointerout","pointerover"]);Zl("onPointerLeave",["pointerout","pointerover"]);Ca("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ca("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ca("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ca("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ca("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ca("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ic="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),PP=new Set("cancel close invalid load scroll toggle".split(" ").concat(ic));function x1(n,e,t){var i=n.type||"unknown-event";n.currentTarget=t,CR(i,e,void 0,n),n.currentTarget=null}function pT(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var i=n[t],r=i.event;i=i.listeners;e:{var s=void 0;if(e)for(var o=i.length-1;0<=o;o--){var a=i[o],c=a.instance,f=a.currentTarget;if(a=a.listener,c!==s&&r.isPropagationStopped())break e;x1(r,a,f),s=c}else for(o=0;o<i.length;o++){if(a=i[o],c=a.instance,f=a.currentTarget,a=a.listener,c!==s&&r.isPropagationStopped())break e;x1(r,a,f),s=c}}}if(ep)throw n=iv,ep=!1,iv=null,n}function rn(n,e){var t=e[hv];t===void 0&&(t=e[hv]=new Set);var i=n+"__bubble";t.has(i)||(mT(e,n,2,!1),t.add(i))}function Fg(n,e,t){var i=0;e&&(i|=4),mT(t,n,i,e)}var bd="_reactListening"+Math.random().toString(36).slice(2);function Cc(n){if(!n[bd]){n[bd]=!0,ME.forEach(function(t){t!=="selectionchange"&&(PP.has(t)||Fg(t,!1,n),Fg(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[bd]||(e[bd]=!0,Fg("selectionchange",!1,e))}}function mT(n,e,t,i){switch(QE(e)){case 1:var r=WR;break;case 4:r=XR;break;default:r=Vy}t=r.bind(null,e,t,n),r=void 0,!nv||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),i?r!==void 0?n.addEventListener(e,t,{capture:!0,passive:r}):n.addEventListener(e,t,!0):r!==void 0?n.addEventListener(e,t,{passive:r}):n.addEventListener(e,t,!1)}function zg(n,e,t,i,r){var s=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var o=i.tag;if(o===3||o===4){var a=i.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(o===4)for(o=i.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===r||c.nodeType===8&&c.parentNode===r))return;o=o.return}for(;a!==null;){if(o=sa(a),o===null)return;if(c=o.tag,c===5||c===6){i=s=o;continue e}a=a.parentNode}}i=i.return}FE(function(){var f=s,d=Fy(t),h=[];e:{var m=hT.get(n);if(m!==void 0){var v=Wy,y=n;switch(n){case"keypress":if(Oh(t)===0)break e;case"keydown":case"keyup":v=oP;break;case"focusin":y="focus",v=Ig;break;case"focusout":y="blur",v=Ig;break;case"beforeblur":case"afterblur":v=Ig;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=l1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=qR;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=uP;break;case uT:case cT:case fT:v=JR;break;case dT:v=fP;break;case"scroll":v=jR;break;case"wheel":v=hP;break;case"copy":case"cut":case"paste":v=$R;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=c1}var w=(e&4)!==0,x=!w&&n==="scroll",g=w?m!==null?m+"Capture":null:m;w=[];for(var S=f,M;S!==null;){M=S;var T=M.stateNode;if(M.tag===5&&T!==null&&(M=T,g!==null&&(T=Mc(S,g),T!=null&&w.push(Rc(S,T,M)))),x)break;S=S.return}0<w.length&&(m=new v(m,y,null,t,d),h.push({event:m,listeners:w}))}}if(!(e&7)){e:{if(m=n==="mouseover"||n==="pointerover",v=n==="mouseout"||n==="pointerout",m&&t!==ev&&(y=t.relatedTarget||t.fromElement)&&(sa(y)||y[Ps]))break e;if((v||m)&&(m=d.window===d?d:(m=d.ownerDocument)?m.defaultView||m.parentWindow:window,v?(y=t.relatedTarget||t.toElement,v=f,y=y?sa(y):null,y!==null&&(x=Ra(y),y!==x||y.tag!==5&&y.tag!==6)&&(y=null)):(v=null,y=f),v!==y)){if(w=l1,T="onMouseLeave",g="onMouseEnter",S="mouse",(n==="pointerout"||n==="pointerover")&&(w=c1,T="onPointerLeave",g="onPointerEnter",S="pointer"),x=v==null?m:Rl(v),M=y==null?m:Rl(y),m=new w(T,S+"leave",v,t,d),m.target=x,m.relatedTarget=M,T=null,sa(d)===f&&(w=new w(g,S+"enter",y,t,d),w.target=M,w.relatedTarget=x,T=w),x=T,v&&y)t:{for(w=v,g=y,S=0,M=w;M;M=Za(M))S++;for(M=0,T=g;T;T=Za(T))M++;for(;0<S-M;)w=Za(w),S--;for(;0<M-S;)g=Za(g),M--;for(;S--;){if(w===g||g!==null&&w===g.alternate)break t;w=Za(w),g=Za(g)}w=null}else w=null;v!==null&&S1(h,m,v,w,!1),y!==null&&x!==null&&S1(h,x,y,w,!0)}}e:{if(m=f?Rl(f):window,v=m.nodeName&&m.nodeName.toLowerCase(),v==="select"||v==="input"&&m.type==="file")var P=xP;else if(h1(m))if(rT)P=EP;else{P=MP;var b=SP}else(v=m.nodeName)&&v.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(P=wP);if(P&&(P=P(n,f))){iT(h,P,t,d);break e}b&&b(n,m,f),n==="focusout"&&(b=m._wrapperState)&&b.controlled&&m.type==="number"&&Z0(m,"number",m.value)}switch(b=f?Rl(f):window,n){case"focusin":(h1(b)||b.contentEditable==="true")&&(bl=b,av=f,uc=null);break;case"focusout":uc=av=bl=null;break;case"mousedown":lv=!0;break;case"contextmenu":case"mouseup":case"dragend":lv=!1,y1(h,t,d);break;case"selectionchange":if(bP)break;case"keydown":case"keyup":y1(h,t,d)}var L;if(jy)e:{switch(n){case"compositionstart":var O="onCompositionStart";break e;case"compositionend":O="onCompositionEnd";break e;case"compositionupdate":O="onCompositionUpdate";break e}O=void 0}else Al?tT(n,t)&&(O="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(O="onCompositionStart");O&&(eT&&t.locale!=="ko"&&(Al||O!=="onCompositionStart"?O==="onCompositionEnd"&&Al&&(L=$E()):(oo=d,Gy="value"in oo?oo.value:oo.textContent,Al=!0)),b=sp(f,O),0<b.length&&(O=new u1(O,n,null,t,d),h.push({event:O,listeners:b}),L?O.data=L:(L=nT(t),L!==null&&(O.data=L)))),(L=mP?gP(n,t):vP(n,t))&&(f=sp(f,"onBeforeInput"),0<f.length&&(d=new u1("onBeforeInput","beforeinput",null,t,d),h.push({event:d,listeners:f}),d.data=L))}pT(h,e)})}function Rc(n,e,t){return{instance:n,listener:e,currentTarget:t}}function sp(n,e){for(var t=e+"Capture",i=[];n!==null;){var r=n,s=r.stateNode;r.tag===5&&s!==null&&(r=s,s=Mc(n,t),s!=null&&i.unshift(Rc(n,s,r)),s=Mc(n,e),s!=null&&i.push(Rc(n,s,r))),n=n.return}return i}function Za(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function S1(n,e,t,i,r){for(var s=e._reactName,o=[];t!==null&&t!==i;){var a=t,c=a.alternate,f=a.stateNode;if(c!==null&&c===i)break;a.tag===5&&f!==null&&(a=f,r?(c=Mc(t,s),c!=null&&o.unshift(Rc(t,c,a))):r||(c=Mc(t,s),c!=null&&o.push(Rc(t,c,a)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var LP=/\r\n?/g,IP=/\u0000|\uFFFD/g;function M1(n){return(typeof n=="string"?n:""+n).replace(LP,`
`).replace(IP,"")}function Cd(n,e,t){if(e=M1(e),M1(n)!==e&&t)throw Error(ze(425))}function op(){}var uv=null,cv=null;function fv(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var dv=typeof setTimeout=="function"?setTimeout:void 0,NP=typeof clearTimeout=="function"?clearTimeout:void 0,w1=typeof Promise=="function"?Promise:void 0,DP=typeof queueMicrotask=="function"?queueMicrotask:typeof w1<"u"?function(n){return w1.resolve(null).then(n).catch(UP)}:dv;function UP(n){setTimeout(function(){throw n})}function Bg(n,e){var t=e,i=0;do{var r=t.nextSibling;if(n.removeChild(t),r&&r.nodeType===8)if(t=r.data,t==="/$"){if(i===0){n.removeChild(r),Tc(e);return}i--}else t!=="$"&&t!=="$?"&&t!=="$!"||i++;t=r}while(t);Tc(e)}function fo(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function E1(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var uu=Math.random().toString(36).slice(2),Jr="__reactFiber$"+uu,Pc="__reactProps$"+uu,Ps="__reactContainer$"+uu,hv="__reactEvents$"+uu,OP="__reactListeners$"+uu,kP="__reactHandles$"+uu;function sa(n){var e=n[Jr];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Ps]||t[Jr]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=E1(n);n!==null;){if(t=n[Jr])return t;n=E1(n)}return e}n=t,t=n.parentNode}return null}function uf(n){return n=n[Jr]||n[Ps],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Rl(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(ze(33))}function Dp(n){return n[Pc]||null}var pv=[],Pl=-1;function Ao(n){return{current:n}}function on(n){0>Pl||(n.current=pv[Pl],pv[Pl]=null,Pl--)}function nn(n,e){Pl++,pv[Pl]=n.current,n.current=e}var So={},pi=Ao(So),ki=Ao(!1),_a=So;function Kl(n,e){var t=n.type.contextTypes;if(!t)return So;var i=n.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in t)r[s]=e[s];return i&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=r),r}function Fi(n){return n=n.childContextTypes,n!=null}function ap(){on(ki),on(pi)}function T1(n,e,t){if(pi.current!==So)throw Error(ze(168));nn(pi,e),nn(ki,t)}function gT(n,e,t){var i=n.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return t;i=i.getChildContext();for(var r in i)if(!(r in e))throw Error(ze(108,SR(n)||"Unknown",r));return mn({},t,i)}function lp(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||So,_a=pi.current,nn(pi,n),nn(ki,ki.current),!0}function A1(n,e,t){var i=n.stateNode;if(!i)throw Error(ze(169));t?(n=gT(n,e,_a),i.__reactInternalMemoizedMergedChildContext=n,on(ki),on(pi),nn(pi,n)):on(ki),nn(ki,t)}var xs=null,Up=!1,Hg=!1;function vT(n){xs===null?xs=[n]:xs.push(n)}function FP(n){Up=!0,vT(n)}function bo(){if(!Hg&&xs!==null){Hg=!0;var n=0,e=Zt;try{var t=xs;for(Zt=1;n<t.length;n++){var i=t[n];do i=i(!0);while(i!==null)}xs=null,Up=!1}catch(r){throw xs!==null&&(xs=xs.slice(n+1)),VE(zy,bo),r}finally{Zt=e,Hg=!1}}return null}var Ll=[],Il=0,up=null,cp=0,pr=[],mr=0,xa=null,ws=1,Es="";function Jo(n,e){Ll[Il++]=cp,Ll[Il++]=up,up=n,cp=e}function yT(n,e,t){pr[mr++]=ws,pr[mr++]=Es,pr[mr++]=xa,xa=n;var i=ws;n=Es;var r=32-Dr(i)-1;i&=~(1<<r),t+=1;var s=32-Dr(e)+r;if(30<s){var o=r-r%5;s=(i&(1<<o)-1).toString(32),i>>=o,r-=o,ws=1<<32-Dr(e)+r|t<<r|i,Es=s+n}else ws=1<<s|t<<r|i,Es=n}function qy(n){n.return!==null&&(Jo(n,1),yT(n,1,0))}function Zy(n){for(;n===up;)up=Ll[--Il],Ll[Il]=null,cp=Ll[--Il],Ll[Il]=null;for(;n===xa;)xa=pr[--mr],pr[mr]=null,Es=pr[--mr],pr[mr]=null,ws=pr[--mr],pr[mr]=null}var $i=null,Qi=null,ln=!1,Lr=null;function _T(n,e){var t=gr(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function b1(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,$i=n,Qi=fo(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,$i=n,Qi=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=xa!==null?{id:ws,overflow:Es}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=gr(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,$i=n,Qi=null,!0):!1;default:return!1}}function mv(n){return(n.mode&1)!==0&&(n.flags&128)===0}function gv(n){if(ln){var e=Qi;if(e){var t=e;if(!b1(n,e)){if(mv(n))throw Error(ze(418));e=fo(t.nextSibling);var i=$i;e&&b1(n,e)?_T(i,t):(n.flags=n.flags&-4097|2,ln=!1,$i=n)}}else{if(mv(n))throw Error(ze(418));n.flags=n.flags&-4097|2,ln=!1,$i=n}}}function C1(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;$i=n}function Rd(n){if(n!==$i)return!1;if(!ln)return C1(n),ln=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!fv(n.type,n.memoizedProps)),e&&(e=Qi)){if(mv(n))throw xT(),Error(ze(418));for(;e;)_T(n,e),e=fo(e.nextSibling)}if(C1(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(ze(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){Qi=fo(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}Qi=null}}else Qi=$i?fo(n.stateNode.nextSibling):null;return!0}function xT(){for(var n=Qi;n;)n=fo(n.nextSibling)}function Jl(){Qi=$i=null,ln=!1}function Ky(n){Lr===null?Lr=[n]:Lr.push(n)}var zP=Os.ReactCurrentBatchConfig;function Fu(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(ze(309));var i=t.stateNode}if(!i)throw Error(ze(147,n));var r=i,s=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(o){var a=r.refs;o===null?delete a[s]:a[s]=o},e._stringRef=s,e)}if(typeof n!="string")throw Error(ze(284));if(!t._owner)throw Error(ze(290,n))}return n}function Pd(n,e){throw n=Object.prototype.toString.call(e),Error(ze(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function R1(n){var e=n._init;return e(n._payload)}function ST(n){function e(g,S){if(n){var M=g.deletions;M===null?(g.deletions=[S],g.flags|=16):M.push(S)}}function t(g,S){if(!n)return null;for(;S!==null;)e(g,S),S=S.sibling;return null}function i(g,S){for(g=new Map;S!==null;)S.key!==null?g.set(S.key,S):g.set(S.index,S),S=S.sibling;return g}function r(g,S){return g=go(g,S),g.index=0,g.sibling=null,g}function s(g,S,M){return g.index=M,n?(M=g.alternate,M!==null?(M=M.index,M<S?(g.flags|=2,S):M):(g.flags|=2,S)):(g.flags|=1048576,S)}function o(g){return n&&g.alternate===null&&(g.flags|=2),g}function a(g,S,M,T){return S===null||S.tag!==6?(S=qg(M,g.mode,T),S.return=g,S):(S=r(S,M),S.return=g,S)}function c(g,S,M,T){var P=M.type;return P===Tl?d(g,S,M.props.children,T,M.key):S!==null&&(S.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===to&&R1(P)===S.type)?(T=r(S,M.props),T.ref=Fu(g,S,M),T.return=g,T):(T=Gh(M.type,M.key,M.props,null,g.mode,T),T.ref=Fu(g,S,M),T.return=g,T)}function f(g,S,M,T){return S===null||S.tag!==4||S.stateNode.containerInfo!==M.containerInfo||S.stateNode.implementation!==M.implementation?(S=Zg(M,g.mode,T),S.return=g,S):(S=r(S,M.children||[]),S.return=g,S)}function d(g,S,M,T,P){return S===null||S.tag!==7?(S=ha(M,g.mode,T,P),S.return=g,S):(S=r(S,M),S.return=g,S)}function h(g,S,M){if(typeof S=="string"&&S!==""||typeof S=="number")return S=qg(""+S,g.mode,M),S.return=g,S;if(typeof S=="object"&&S!==null){switch(S.$$typeof){case _d:return M=Gh(S.type,S.key,S.props,null,g.mode,M),M.ref=Fu(g,null,S),M.return=g,M;case El:return S=Zg(S,g.mode,M),S.return=g,S;case to:var T=S._init;return h(g,T(S._payload),M)}if(tc(S)||Nu(S))return S=ha(S,g.mode,M,null),S.return=g,S;Pd(g,S)}return null}function m(g,S,M,T){var P=S!==null?S.key:null;if(typeof M=="string"&&M!==""||typeof M=="number")return P!==null?null:a(g,S,""+M,T);if(typeof M=="object"&&M!==null){switch(M.$$typeof){case _d:return M.key===P?c(g,S,M,T):null;case El:return M.key===P?f(g,S,M,T):null;case to:return P=M._init,m(g,S,P(M._payload),T)}if(tc(M)||Nu(M))return P!==null?null:d(g,S,M,T,null);Pd(g,M)}return null}function v(g,S,M,T,P){if(typeof T=="string"&&T!==""||typeof T=="number")return g=g.get(M)||null,a(S,g,""+T,P);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case _d:return g=g.get(T.key===null?M:T.key)||null,c(S,g,T,P);case El:return g=g.get(T.key===null?M:T.key)||null,f(S,g,T,P);case to:var b=T._init;return v(g,S,M,b(T._payload),P)}if(tc(T)||Nu(T))return g=g.get(M)||null,d(S,g,T,P,null);Pd(S,T)}return null}function y(g,S,M,T){for(var P=null,b=null,L=S,O=S=0,C=null;L!==null&&O<M.length;O++){L.index>O?(C=L,L=null):C=L.sibling;var R=m(g,L,M[O],T);if(R===null){L===null&&(L=C);break}n&&L&&R.alternate===null&&e(g,L),S=s(R,S,O),b===null?P=R:b.sibling=R,b=R,L=C}if(O===M.length)return t(g,L),ln&&Jo(g,O),P;if(L===null){for(;O<M.length;O++)L=h(g,M[O],T),L!==null&&(S=s(L,S,O),b===null?P=L:b.sibling=L,b=L);return ln&&Jo(g,O),P}for(L=i(g,L);O<M.length;O++)C=v(L,g,O,M[O],T),C!==null&&(n&&C.alternate!==null&&L.delete(C.key===null?O:C.key),S=s(C,S,O),b===null?P=C:b.sibling=C,b=C);return n&&L.forEach(function(B){return e(g,B)}),ln&&Jo(g,O),P}function w(g,S,M,T){var P=Nu(M);if(typeof P!="function")throw Error(ze(150));if(M=P.call(M),M==null)throw Error(ze(151));for(var b=P=null,L=S,O=S=0,C=null,R=M.next();L!==null&&!R.done;O++,R=M.next()){L.index>O?(C=L,L=null):C=L.sibling;var B=m(g,L,R.value,T);if(B===null){L===null&&(L=C);break}n&&L&&B.alternate===null&&e(g,L),S=s(B,S,O),b===null?P=B:b.sibling=B,b=B,L=C}if(R.done)return t(g,L),ln&&Jo(g,O),P;if(L===null){for(;!R.done;O++,R=M.next())R=h(g,R.value,T),R!==null&&(S=s(R,S,O),b===null?P=R:b.sibling=R,b=R);return ln&&Jo(g,O),P}for(L=i(g,L);!R.done;O++,R=M.next())R=v(L,g,O,R.value,T),R!==null&&(n&&R.alternate!==null&&L.delete(R.key===null?O:R.key),S=s(R,S,O),b===null?P=R:b.sibling=R,b=R);return n&&L.forEach(function($){return e(g,$)}),ln&&Jo(g,O),P}function x(g,S,M,T){if(typeof M=="object"&&M!==null&&M.type===Tl&&M.key===null&&(M=M.props.children),typeof M=="object"&&M!==null){switch(M.$$typeof){case _d:e:{for(var P=M.key,b=S;b!==null;){if(b.key===P){if(P=M.type,P===Tl){if(b.tag===7){t(g,b.sibling),S=r(b,M.props.children),S.return=g,g=S;break e}}else if(b.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===to&&R1(P)===b.type){t(g,b.sibling),S=r(b,M.props),S.ref=Fu(g,b,M),S.return=g,g=S;break e}t(g,b);break}else e(g,b);b=b.sibling}M.type===Tl?(S=ha(M.props.children,g.mode,T,M.key),S.return=g,g=S):(T=Gh(M.type,M.key,M.props,null,g.mode,T),T.ref=Fu(g,S,M),T.return=g,g=T)}return o(g);case El:e:{for(b=M.key;S!==null;){if(S.key===b)if(S.tag===4&&S.stateNode.containerInfo===M.containerInfo&&S.stateNode.implementation===M.implementation){t(g,S.sibling),S=r(S,M.children||[]),S.return=g,g=S;break e}else{t(g,S);break}else e(g,S);S=S.sibling}S=Zg(M,g.mode,T),S.return=g,g=S}return o(g);case to:return b=M._init,x(g,S,b(M._payload),T)}if(tc(M))return y(g,S,M,T);if(Nu(M))return w(g,S,M,T);Pd(g,M)}return typeof M=="string"&&M!==""||typeof M=="number"?(M=""+M,S!==null&&S.tag===6?(t(g,S.sibling),S=r(S,M),S.return=g,g=S):(t(g,S),S=qg(M,g.mode,T),S.return=g,g=S),o(g)):t(g,S)}return x}var Ql=ST(!0),MT=ST(!1),fp=Ao(null),dp=null,Nl=null,Jy=null;function Qy(){Jy=Nl=dp=null}function $y(n){var e=fp.current;on(fp),n._currentValue=e}function vv(n,e,t){for(;n!==null;){var i=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),n===t)break;n=n.return}}function jl(n,e){dp=n,Jy=Nl=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(Oi=!0),n.firstContext=null)}function _r(n){var e=n._currentValue;if(Jy!==n)if(n={context:n,memoizedValue:e,next:null},Nl===null){if(dp===null)throw Error(ze(308));Nl=n,dp.dependencies={lanes:0,firstContext:n}}else Nl=Nl.next=n;return e}var oa=null;function e_(n){oa===null?oa=[n]:oa.push(n)}function wT(n,e,t,i){var r=e.interleaved;return r===null?(t.next=t,e_(e)):(t.next=r.next,r.next=t),e.interleaved=t,Ls(n,i)}function Ls(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var no=!1;function t_(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function ET(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function bs(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function ho(n,e,t){var i=n.updateQueue;if(i===null)return null;if(i=i.shared,Bt&2){var r=i.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),i.pending=e,Ls(n,t)}return r=i.interleaved,r===null?(e.next=e,e_(i)):(e.next=r.next,r.next=e),i.interleaved=e,Ls(n,t)}function kh(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,By(n,t)}}function P1(n,e){var t=n.updateQueue,i=n.alternate;if(i!==null&&(i=i.updateQueue,t===i)){var r=null,s=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};s===null?r=s=o:s=s.next=o,t=t.next}while(t!==null);s===null?r=s=e:s=s.next=e}else r=s=e;t={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function hp(n,e,t,i){var r=n.updateQueue;no=!1;var s=r.firstBaseUpdate,o=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var c=a,f=c.next;c.next=null,o===null?s=f:o.next=f,o=c;var d=n.alternate;d!==null&&(d=d.updateQueue,a=d.lastBaseUpdate,a!==o&&(a===null?d.firstBaseUpdate=f:a.next=f,d.lastBaseUpdate=c))}if(s!==null){var h=r.baseState;o=0,d=f=c=null,a=s;do{var m=a.lane,v=a.eventTime;if((i&m)===m){d!==null&&(d=d.next={eventTime:v,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var y=n,w=a;switch(m=e,v=t,w.tag){case 1:if(y=w.payload,typeof y=="function"){h=y.call(v,h,m);break e}h=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=w.payload,m=typeof y=="function"?y.call(v,h,m):y,m==null)break e;h=mn({},h,m);break e;case 2:no=!0}}a.callback!==null&&a.lane!==0&&(n.flags|=64,m=r.effects,m===null?r.effects=[a]:m.push(a))}else v={eventTime:v,lane:m,tag:a.tag,payload:a.payload,callback:a.callback,next:null},d===null?(f=d=v,c=h):d=d.next=v,o|=m;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;m=a,a=m.next,m.next=null,r.lastBaseUpdate=m,r.shared.pending=null}}while(!0);if(d===null&&(c=h),r.baseState=c,r.firstBaseUpdate=f,r.lastBaseUpdate=d,e=r.shared.interleaved,e!==null){r=e;do o|=r.lane,r=r.next;while(r!==e)}else s===null&&(r.shared.lanes=0);Ma|=o,n.lanes=o,n.memoizedState=h}}function L1(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var i=n[e],r=i.callback;if(r!==null){if(i.callback=null,i=t,typeof r!="function")throw Error(ze(191,r));r.call(i)}}}var cf={},$r=Ao(cf),Lc=Ao(cf),Ic=Ao(cf);function aa(n){if(n===cf)throw Error(ze(174));return n}function n_(n,e){switch(nn(Ic,e),nn(Lc,n),nn($r,cf),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:J0(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=J0(e,n)}on($r),nn($r,e)}function $l(){on($r),on(Lc),on(Ic)}function TT(n){aa(Ic.current);var e=aa($r.current),t=J0(e,n.type);e!==t&&(nn(Lc,n),nn($r,t))}function i_(n){Lc.current===n&&(on($r),on(Lc))}var cn=Ao(0);function pp(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Vg=[];function r_(){for(var n=0;n<Vg.length;n++)Vg[n]._workInProgressVersionPrimary=null;Vg.length=0}var Fh=Os.ReactCurrentDispatcher,Gg=Os.ReactCurrentBatchConfig,Sa=0,pn=null,Dn=null,Xn=null,mp=!1,cc=!1,Nc=0,BP=0;function ri(){throw Error(ze(321))}function s_(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!Or(n[t],e[t]))return!1;return!0}function o_(n,e,t,i,r,s){if(Sa=s,pn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Fh.current=n===null||n.memoizedState===null?WP:XP,n=t(i,r),cc){s=0;do{if(cc=!1,Nc=0,25<=s)throw Error(ze(301));s+=1,Xn=Dn=null,e.updateQueue=null,Fh.current=jP,n=t(i,r)}while(cc)}if(Fh.current=gp,e=Dn!==null&&Dn.next!==null,Sa=0,Xn=Dn=pn=null,mp=!1,e)throw Error(ze(300));return n}function a_(){var n=Nc!==0;return Nc=0,n}function Kr(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Xn===null?pn.memoizedState=Xn=n:Xn=Xn.next=n,Xn}function xr(){if(Dn===null){var n=pn.alternate;n=n!==null?n.memoizedState:null}else n=Dn.next;var e=Xn===null?pn.memoizedState:Xn.next;if(e!==null)Xn=e,Dn=n;else{if(n===null)throw Error(ze(310));Dn=n,n={memoizedState:Dn.memoizedState,baseState:Dn.baseState,baseQueue:Dn.baseQueue,queue:Dn.queue,next:null},Xn===null?pn.memoizedState=Xn=n:Xn=Xn.next=n}return Xn}function Dc(n,e){return typeof e=="function"?e(n):e}function Wg(n){var e=xr(),t=e.queue;if(t===null)throw Error(ze(311));t.lastRenderedReducer=n;var i=Dn,r=i.baseQueue,s=t.pending;if(s!==null){if(r!==null){var o=r.next;r.next=s.next,s.next=o}i.baseQueue=r=s,t.pending=null}if(r!==null){s=r.next,i=i.baseState;var a=o=null,c=null,f=s;do{var d=f.lane;if((Sa&d)===d)c!==null&&(c=c.next={lane:0,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null}),i=f.hasEagerState?f.eagerState:n(i,f.action);else{var h={lane:d,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null};c===null?(a=c=h,o=i):c=c.next=h,pn.lanes|=d,Ma|=d}f=f.next}while(f!==null&&f!==s);c===null?o=i:c.next=a,Or(i,e.memoizedState)||(Oi=!0),e.memoizedState=i,e.baseState=o,e.baseQueue=c,t.lastRenderedState=i}if(n=t.interleaved,n!==null){r=n;do s=r.lane,pn.lanes|=s,Ma|=s,r=r.next;while(r!==n)}else r===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function Xg(n){var e=xr(),t=e.queue;if(t===null)throw Error(ze(311));t.lastRenderedReducer=n;var i=t.dispatch,r=t.pending,s=e.memoizedState;if(r!==null){t.pending=null;var o=r=r.next;do s=n(s,o.action),o=o.next;while(o!==r);Or(s,e.memoizedState)||(Oi=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),t.lastRenderedState=s}return[s,i]}function AT(){}function bT(n,e){var t=pn,i=xr(),r=e(),s=!Or(i.memoizedState,r);if(s&&(i.memoizedState=r,Oi=!0),i=i.queue,l_(PT.bind(null,t,i,n),[n]),i.getSnapshot!==e||s||Xn!==null&&Xn.memoizedState.tag&1){if(t.flags|=2048,Uc(9,RT.bind(null,t,i,r,e),void 0,null),jn===null)throw Error(ze(349));Sa&30||CT(t,e,r)}return r}function CT(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=pn.updateQueue,e===null?(e={lastEffect:null,stores:null},pn.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function RT(n,e,t,i){e.value=t,e.getSnapshot=i,LT(e)&&IT(n)}function PT(n,e,t){return t(function(){LT(e)&&IT(n)})}function LT(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!Or(n,t)}catch{return!0}}function IT(n){var e=Ls(n,1);e!==null&&Ur(e,n,1,-1)}function I1(n){var e=Kr();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Dc,lastRenderedState:n},e.queue=n,n=n.dispatch=GP.bind(null,pn,n),[e.memoizedState,n]}function Uc(n,e,t,i){return n={tag:n,create:e,destroy:t,deps:i,next:null},e=pn.updateQueue,e===null?(e={lastEffect:null,stores:null},pn.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(i=t.next,t.next=n,n.next=i,e.lastEffect=n)),n}function NT(){return xr().memoizedState}function zh(n,e,t,i){var r=Kr();pn.flags|=n,r.memoizedState=Uc(1|e,t,void 0,i===void 0?null:i)}function Op(n,e,t,i){var r=xr();i=i===void 0?null:i;var s=void 0;if(Dn!==null){var o=Dn.memoizedState;if(s=o.destroy,i!==null&&s_(i,o.deps)){r.memoizedState=Uc(e,t,s,i);return}}pn.flags|=n,r.memoizedState=Uc(1|e,t,s,i)}function N1(n,e){return zh(8390656,8,n,e)}function l_(n,e){return Op(2048,8,n,e)}function DT(n,e){return Op(4,2,n,e)}function UT(n,e){return Op(4,4,n,e)}function OT(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function kT(n,e,t){return t=t!=null?t.concat([n]):null,Op(4,4,OT.bind(null,e,n),t)}function u_(){}function FT(n,e){var t=xr();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&s_(e,i[1])?i[0]:(t.memoizedState=[n,e],n)}function zT(n,e){var t=xr();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&s_(e,i[1])?i[0]:(n=n(),t.memoizedState=[n,e],n)}function BT(n,e,t){return Sa&21?(Or(t,e)||(t=XE(),pn.lanes|=t,Ma|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,Oi=!0),n.memoizedState=t)}function HP(n,e){var t=Zt;Zt=t!==0&&4>t?t:4,n(!0);var i=Gg.transition;Gg.transition={};try{n(!1),e()}finally{Zt=t,Gg.transition=i}}function HT(){return xr().memoizedState}function VP(n,e,t){var i=mo(n);if(t={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null},VT(n))GT(e,t);else if(t=wT(n,e,t,i),t!==null){var r=wi();Ur(t,n,i,r),WT(t,e,i)}}function GP(n,e,t){var i=mo(n),r={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null};if(VT(n))GT(e,r);else{var s=n.alternate;if(n.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var o=e.lastRenderedState,a=s(o,t);if(r.hasEagerState=!0,r.eagerState=a,Or(a,o)){var c=e.interleaved;c===null?(r.next=r,e_(e)):(r.next=c.next,c.next=r),e.interleaved=r;return}}catch{}finally{}t=wT(n,e,r,i),t!==null&&(r=wi(),Ur(t,n,i,r),WT(t,e,i))}}function VT(n){var e=n.alternate;return n===pn||e!==null&&e===pn}function GT(n,e){cc=mp=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function WT(n,e,t){if(t&4194240){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,By(n,t)}}var gp={readContext:_r,useCallback:ri,useContext:ri,useEffect:ri,useImperativeHandle:ri,useInsertionEffect:ri,useLayoutEffect:ri,useMemo:ri,useReducer:ri,useRef:ri,useState:ri,useDebugValue:ri,useDeferredValue:ri,useTransition:ri,useMutableSource:ri,useSyncExternalStore:ri,useId:ri,unstable_isNewReconciler:!1},WP={readContext:_r,useCallback:function(n,e){return Kr().memoizedState=[n,e===void 0?null:e],n},useContext:_r,useEffect:N1,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,zh(4194308,4,OT.bind(null,e,n),t)},useLayoutEffect:function(n,e){return zh(4194308,4,n,e)},useInsertionEffect:function(n,e){return zh(4,2,n,e)},useMemo:function(n,e){var t=Kr();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var i=Kr();return e=t!==void 0?t(e):e,i.memoizedState=i.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},i.queue=n,n=n.dispatch=VP.bind(null,pn,n),[i.memoizedState,n]},useRef:function(n){var e=Kr();return n={current:n},e.memoizedState=n},useState:I1,useDebugValue:u_,useDeferredValue:function(n){return Kr().memoizedState=n},useTransition:function(){var n=I1(!1),e=n[0];return n=HP.bind(null,n[1]),Kr().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var i=pn,r=Kr();if(ln){if(t===void 0)throw Error(ze(407));t=t()}else{if(t=e(),jn===null)throw Error(ze(349));Sa&30||CT(i,e,t)}r.memoizedState=t;var s={value:t,getSnapshot:e};return r.queue=s,N1(PT.bind(null,i,s,n),[n]),i.flags|=2048,Uc(9,RT.bind(null,i,s,t,e),void 0,null),t},useId:function(){var n=Kr(),e=jn.identifierPrefix;if(ln){var t=Es,i=ws;t=(i&~(1<<32-Dr(i)-1)).toString(32)+t,e=":"+e+"R"+t,t=Nc++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=BP++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},XP={readContext:_r,useCallback:FT,useContext:_r,useEffect:l_,useImperativeHandle:kT,useInsertionEffect:DT,useLayoutEffect:UT,useMemo:zT,useReducer:Wg,useRef:NT,useState:function(){return Wg(Dc)},useDebugValue:u_,useDeferredValue:function(n){var e=xr();return BT(e,Dn.memoizedState,n)},useTransition:function(){var n=Wg(Dc)[0],e=xr().memoizedState;return[n,e]},useMutableSource:AT,useSyncExternalStore:bT,useId:HT,unstable_isNewReconciler:!1},jP={readContext:_r,useCallback:FT,useContext:_r,useEffect:l_,useImperativeHandle:kT,useInsertionEffect:DT,useLayoutEffect:UT,useMemo:zT,useReducer:Xg,useRef:NT,useState:function(){return Xg(Dc)},useDebugValue:u_,useDeferredValue:function(n){var e=xr();return Dn===null?e.memoizedState=n:BT(e,Dn.memoizedState,n)},useTransition:function(){var n=Xg(Dc)[0],e=xr().memoizedState;return[n,e]},useMutableSource:AT,useSyncExternalStore:bT,useId:HT,unstable_isNewReconciler:!1};function Cr(n,e){if(n&&n.defaultProps){e=mn({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function yv(n,e,t,i){e=n.memoizedState,t=t(i,e),t=t==null?e:mn({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var kp={isMounted:function(n){return(n=n._reactInternals)?Ra(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var i=wi(),r=mo(n),s=bs(i,r);s.payload=e,t!=null&&(s.callback=t),e=ho(n,s,r),e!==null&&(Ur(e,n,r,i),kh(e,n,r))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var i=wi(),r=mo(n),s=bs(i,r);s.tag=1,s.payload=e,t!=null&&(s.callback=t),e=ho(n,s,r),e!==null&&(Ur(e,n,r,i),kh(e,n,r))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=wi(),i=mo(n),r=bs(t,i);r.tag=2,e!=null&&(r.callback=e),e=ho(n,r,i),e!==null&&(Ur(e,n,i,t),kh(e,n,i))}};function D1(n,e,t,i,r,s,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(i,s,o):e.prototype&&e.prototype.isPureReactComponent?!bc(t,i)||!bc(r,s):!0}function XT(n,e,t){var i=!1,r=So,s=e.contextType;return typeof s=="object"&&s!==null?s=_r(s):(r=Fi(e)?_a:pi.current,i=e.contextTypes,s=(i=i!=null)?Kl(n,r):So),e=new e(t,s),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=kp,n.stateNode=e,e._reactInternals=n,i&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=r,n.__reactInternalMemoizedMaskedChildContext=s),e}function U1(n,e,t,i){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,i),e.state!==n&&kp.enqueueReplaceState(e,e.state,null)}function _v(n,e,t,i){var r=n.stateNode;r.props=t,r.state=n.memoizedState,r.refs={},t_(n);var s=e.contextType;typeof s=="object"&&s!==null?r.context=_r(s):(s=Fi(e)?_a:pi.current,r.context=Kl(n,s)),r.state=n.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(yv(n,e,s,t),r.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&kp.enqueueReplaceState(r,r.state,null),hp(n,t,r,i),r.state=n.memoizedState),typeof r.componentDidMount=="function"&&(n.flags|=4194308)}function eu(n,e){try{var t="",i=e;do t+=xR(i),i=i.return;while(i);var r=t}catch(s){r=`
Error generating stack: `+s.message+`
`+s.stack}return{value:n,source:e,stack:r,digest:null}}function jg(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function xv(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var YP=typeof WeakMap=="function"?WeakMap:Map;function jT(n,e,t){t=bs(-1,t),t.tag=3,t.payload={element:null};var i=e.value;return t.callback=function(){yp||(yp=!0,Pv=i),xv(n,e)},t}function YT(n,e,t){t=bs(-1,t),t.tag=3;var i=n.type.getDerivedStateFromError;if(typeof i=="function"){var r=e.value;t.payload=function(){return i(r)},t.callback=function(){xv(n,e)}}var s=n.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(t.callback=function(){xv(n,e),typeof i!="function"&&(po===null?po=new Set([this]):po.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function O1(n,e,t){var i=n.pingCache;if(i===null){i=n.pingCache=new YP;var r=new Set;i.set(e,r)}else r=i.get(e),r===void 0&&(r=new Set,i.set(e,r));r.has(t)||(r.add(t),n=a3.bind(null,n,e,t),e.then(n,n))}function k1(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function F1(n,e,t,i,r){return n.mode&1?(n.flags|=65536,n.lanes=r,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=bs(-1,1),e.tag=2,ho(t,e,1))),t.lanes|=1),n)}var qP=Os.ReactCurrentOwner,Oi=!1;function Si(n,e,t,i){e.child=n===null?MT(e,null,t,i):Ql(e,n.child,t,i)}function z1(n,e,t,i,r){t=t.render;var s=e.ref;return jl(e,r),i=o_(n,e,t,i,s,r),t=a_(),n!==null&&!Oi?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~r,Is(n,e,r)):(ln&&t&&qy(e),e.flags|=1,Si(n,e,i,r),e.child)}function B1(n,e,t,i,r){if(n===null){var s=t.type;return typeof s=="function"&&!v_(s)&&s.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=s,qT(n,e,s,i,r)):(n=Gh(t.type,null,i,e,e.mode,r),n.ref=e.ref,n.return=e,e.child=n)}if(s=n.child,!(n.lanes&r)){var o=s.memoizedProps;if(t=t.compare,t=t!==null?t:bc,t(o,i)&&n.ref===e.ref)return Is(n,e,r)}return e.flags|=1,n=go(s,i),n.ref=e.ref,n.return=e,e.child=n}function qT(n,e,t,i,r){if(n!==null){var s=n.memoizedProps;if(bc(s,i)&&n.ref===e.ref)if(Oi=!1,e.pendingProps=i=s,(n.lanes&r)!==0)n.flags&131072&&(Oi=!0);else return e.lanes=n.lanes,Is(n,e,r)}return Sv(n,e,t,i,r)}function ZT(n,e,t){var i=e.pendingProps,r=i.children,s=n!==null?n.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},nn(Ul,Zi),Zi|=t;else{if(!(t&1073741824))return n=s!==null?s.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,nn(Ul,Zi),Zi|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=s!==null?s.baseLanes:t,nn(Ul,Zi),Zi|=i}else s!==null?(i=s.baseLanes|t,e.memoizedState=null):i=t,nn(Ul,Zi),Zi|=i;return Si(n,e,r,t),e.child}function KT(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function Sv(n,e,t,i,r){var s=Fi(t)?_a:pi.current;return s=Kl(e,s),jl(e,r),t=o_(n,e,t,i,s,r),i=a_(),n!==null&&!Oi?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~r,Is(n,e,r)):(ln&&i&&qy(e),e.flags|=1,Si(n,e,t,r),e.child)}function H1(n,e,t,i,r){if(Fi(t)){var s=!0;lp(e)}else s=!1;if(jl(e,r),e.stateNode===null)Bh(n,e),XT(e,t,i),_v(e,t,i,r),i=!0;else if(n===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var c=o.context,f=t.contextType;typeof f=="object"&&f!==null?f=_r(f):(f=Fi(t)?_a:pi.current,f=Kl(e,f));var d=t.getDerivedStateFromProps,h=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==i||c!==f)&&U1(e,o,i,f),no=!1;var m=e.memoizedState;o.state=m,hp(e,i,o,r),c=e.memoizedState,a!==i||m!==c||ki.current||no?(typeof d=="function"&&(yv(e,t,d,i),c=e.memoizedState),(a=no||D1(e,t,a,i,m,c,f))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=c),o.props=i,o.state=c,o.context=f,i=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{o=e.stateNode,ET(n,e),a=e.memoizedProps,f=e.type===e.elementType?a:Cr(e.type,a),o.props=f,h=e.pendingProps,m=o.context,c=t.contextType,typeof c=="object"&&c!==null?c=_r(c):(c=Fi(t)?_a:pi.current,c=Kl(e,c));var v=t.getDerivedStateFromProps;(d=typeof v=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||m!==c)&&U1(e,o,i,c),no=!1,m=e.memoizedState,o.state=m,hp(e,i,o,r);var y=e.memoizedState;a!==h||m!==y||ki.current||no?(typeof v=="function"&&(yv(e,t,v,i),y=e.memoizedState),(f=no||D1(e,t,f,i,m,y,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(i,y,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(i,y,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&m===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&m===n.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=y),o.props=i,o.state=y,o.context=c,i=f):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&m===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&m===n.memoizedState||(e.flags|=1024),i=!1)}return Mv(n,e,t,i,s,r)}function Mv(n,e,t,i,r,s){KT(n,e);var o=(e.flags&128)!==0;if(!i&&!o)return r&&A1(e,t,!1),Is(n,e,s);i=e.stateNode,qP.current=e;var a=o&&typeof t.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,n!==null&&o?(e.child=Ql(e,n.child,null,s),e.child=Ql(e,null,a,s)):Si(n,e,a,s),e.memoizedState=i.state,r&&A1(e,t,!0),e.child}function JT(n){var e=n.stateNode;e.pendingContext?T1(n,e.pendingContext,e.pendingContext!==e.context):e.context&&T1(n,e.context,!1),n_(n,e.containerInfo)}function V1(n,e,t,i,r){return Jl(),Ky(r),e.flags|=256,Si(n,e,t,i),e.child}var wv={dehydrated:null,treeContext:null,retryLane:0};function Ev(n){return{baseLanes:n,cachePool:null,transitions:null}}function QT(n,e,t){var i=e.pendingProps,r=cn.current,s=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=n!==null&&n.memoizedState===null?!1:(r&2)!==0),a?(s=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(r|=1),nn(cn,r&1),n===null)return gv(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=i.children,n=i.fallback,s?(i=e.mode,s=e.child,o={mode:"hidden",children:o},!(i&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Bp(o,i,0,null),n=ha(n,i,t,null),s.return=e,n.return=e,s.sibling=n,e.child=s,e.child.memoizedState=Ev(t),e.memoizedState=wv,n):c_(e,o));if(r=n.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return ZP(n,e,o,i,a,r,t);if(s){s=i.fallback,o=e.mode,r=n.child,a=r.sibling;var c={mode:"hidden",children:i.children};return!(o&1)&&e.child!==r?(i=e.child,i.childLanes=0,i.pendingProps=c,e.deletions=null):(i=go(r,c),i.subtreeFlags=r.subtreeFlags&14680064),a!==null?s=go(a,s):(s=ha(s,o,t,null),s.flags|=2),s.return=e,i.return=e,i.sibling=s,e.child=i,i=s,s=e.child,o=n.child.memoizedState,o=o===null?Ev(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=n.childLanes&~t,e.memoizedState=wv,i}return s=n.child,n=s.sibling,i=go(s,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=t),i.return=e,i.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=i,e.memoizedState=null,i}function c_(n,e){return e=Bp({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function Ld(n,e,t,i){return i!==null&&Ky(i),Ql(e,n.child,null,t),n=c_(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function ZP(n,e,t,i,r,s,o){if(t)return e.flags&256?(e.flags&=-257,i=jg(Error(ze(422))),Ld(n,e,o,i)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(s=i.fallback,r=e.mode,i=Bp({mode:"visible",children:i.children},r,0,null),s=ha(s,r,o,null),s.flags|=2,i.return=e,s.return=e,i.sibling=s,e.child=i,e.mode&1&&Ql(e,n.child,null,o),e.child.memoizedState=Ev(o),e.memoizedState=wv,s);if(!(e.mode&1))return Ld(n,e,o,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var a=i.dgst;return i=a,s=Error(ze(419)),i=jg(s,i,void 0),Ld(n,e,o,i)}if(a=(o&n.childLanes)!==0,Oi||a){if(i=jn,i!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(i.suspendedLanes|o)?0:r,r!==0&&r!==s.retryLane&&(s.retryLane=r,Ls(n,r),Ur(i,n,r,-1))}return g_(),i=jg(Error(ze(421))),Ld(n,e,o,i)}return r.data==="$?"?(e.flags|=128,e.child=n.child,e=l3.bind(null,n),r._reactRetry=e,null):(n=s.treeContext,Qi=fo(r.nextSibling),$i=e,ln=!0,Lr=null,n!==null&&(pr[mr++]=ws,pr[mr++]=Es,pr[mr++]=xa,ws=n.id,Es=n.overflow,xa=e),e=c_(e,i.children),e.flags|=4096,e)}function G1(n,e,t){n.lanes|=e;var i=n.alternate;i!==null&&(i.lanes|=e),vv(n.return,e,t)}function Yg(n,e,t,i,r){var s=n.memoizedState;s===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:t,tailMode:r}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=t,s.tailMode=r)}function $T(n,e,t){var i=e.pendingProps,r=i.revealOrder,s=i.tail;if(Si(n,e,i.children,t),i=cn.current,i&2)i=i&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&G1(n,t,e);else if(n.tag===19)G1(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}i&=1}if(nn(cn,i),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(t=e.child,r=null;t!==null;)n=t.alternate,n!==null&&pp(n)===null&&(r=t),t=t.sibling;t=r,t===null?(r=e.child,e.child=null):(r=t.sibling,t.sibling=null),Yg(e,!1,r,t,s);break;case"backwards":for(t=null,r=e.child,e.child=null;r!==null;){if(n=r.alternate,n!==null&&pp(n)===null){e.child=r;break}n=r.sibling,r.sibling=t,t=r,r=n}Yg(e,!0,t,null,s);break;case"together":Yg(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Bh(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Is(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),Ma|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(ze(153));if(e.child!==null){for(n=e.child,t=go(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=go(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function KP(n,e,t){switch(e.tag){case 3:JT(e),Jl();break;case 5:TT(e);break;case 1:Fi(e.type)&&lp(e);break;case 4:n_(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;nn(fp,i._currentValue),i._currentValue=r;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(nn(cn,cn.current&1),e.flags|=128,null):t&e.child.childLanes?QT(n,e,t):(nn(cn,cn.current&1),n=Is(n,e,t),n!==null?n.sibling:null);nn(cn,cn.current&1);break;case 19:if(i=(t&e.childLanes)!==0,n.flags&128){if(i)return $T(n,e,t);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),nn(cn,cn.current),i)break;return null;case 22:case 23:return e.lanes=0,ZT(n,e,t)}return Is(n,e,t)}var eA,Tv,tA,nA;eA=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};Tv=function(){};tA=function(n,e,t,i){var r=n.memoizedProps;if(r!==i){n=e.stateNode,aa($r.current);var s=null;switch(t){case"input":r=Y0(n,r),i=Y0(n,i),s=[];break;case"select":r=mn({},r,{value:void 0}),i=mn({},i,{value:void 0}),s=[];break;case"textarea":r=K0(n,r),i=K0(n,i),s=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(n.onclick=op)}Q0(t,i);var o;t=null;for(f in r)if(!i.hasOwnProperty(f)&&r.hasOwnProperty(f)&&r[f]!=null)if(f==="style"){var a=r[f];for(o in a)a.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else f!=="dangerouslySetInnerHTML"&&f!=="children"&&f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&f!=="autoFocus"&&(xc.hasOwnProperty(f)?s||(s=[]):(s=s||[]).push(f,null));for(f in i){var c=i[f];if(a=r!=null?r[f]:void 0,i.hasOwnProperty(f)&&c!==a&&(c!=null||a!=null))if(f==="style")if(a){for(o in a)!a.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in c)c.hasOwnProperty(o)&&a[o]!==c[o]&&(t||(t={}),t[o]=c[o])}else t||(s||(s=[]),s.push(f,t)),t=c;else f==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,a=a?a.__html:void 0,c!=null&&a!==c&&(s=s||[]).push(f,c)):f==="children"?typeof c!="string"&&typeof c!="number"||(s=s||[]).push(f,""+c):f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&(xc.hasOwnProperty(f)?(c!=null&&f==="onScroll"&&rn("scroll",n),s||a===c||(s=[])):(s=s||[]).push(f,c))}t&&(s=s||[]).push("style",t);var f=s;(e.updateQueue=f)&&(e.flags|=4)}};nA=function(n,e,t,i){t!==i&&(e.flags|=4)};function zu(n,e){if(!ln)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var i=null;t!==null;)t.alternate!==null&&(i=t),t=t.sibling;i===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:i.sibling=null}}function si(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,i=0;if(e)for(var r=n.child;r!==null;)t|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=n,r=r.sibling;else for(r=n.child;r!==null;)t|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=n,r=r.sibling;return n.subtreeFlags|=i,n.childLanes=t,e}function JP(n,e,t){var i=e.pendingProps;switch(Zy(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return si(e),null;case 1:return Fi(e.type)&&ap(),si(e),null;case 3:return i=e.stateNode,$l(),on(ki),on(pi),r_(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(n===null||n.child===null)&&(Rd(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Lr!==null&&(Nv(Lr),Lr=null))),Tv(n,e),si(e),null;case 5:i_(e);var r=aa(Ic.current);if(t=e.type,n!==null&&e.stateNode!=null)tA(n,e,t,i,r),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(ze(166));return si(e),null}if(n=aa($r.current),Rd(e)){i=e.stateNode,t=e.type;var s=e.memoizedProps;switch(i[Jr]=e,i[Pc]=s,n=(e.mode&1)!==0,t){case"dialog":rn("cancel",i),rn("close",i);break;case"iframe":case"object":case"embed":rn("load",i);break;case"video":case"audio":for(r=0;r<ic.length;r++)rn(ic[r],i);break;case"source":rn("error",i);break;case"img":case"image":case"link":rn("error",i),rn("load",i);break;case"details":rn("toggle",i);break;case"input":QS(i,s),rn("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},rn("invalid",i);break;case"textarea":e1(i,s),rn("invalid",i)}Q0(t,s),r=null;for(var o in s)if(s.hasOwnProperty(o)){var a=s[o];o==="children"?typeof a=="string"?i.textContent!==a&&(s.suppressHydrationWarning!==!0&&Cd(i.textContent,a,n),r=["children",a]):typeof a=="number"&&i.textContent!==""+a&&(s.suppressHydrationWarning!==!0&&Cd(i.textContent,a,n),r=["children",""+a]):xc.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&rn("scroll",i)}switch(t){case"input":xd(i),$S(i,s,!0);break;case"textarea":xd(i),t1(i);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(i.onclick=op)}i=r,e.updateQueue=i,i!==null&&(e.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=PE(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof i.is=="string"?n=o.createElement(t,{is:i.is}):(n=o.createElement(t),t==="select"&&(o=n,i.multiple?o.multiple=!0:i.size&&(o.size=i.size))):n=o.createElementNS(n,t),n[Jr]=e,n[Pc]=i,eA(n,e,!1,!1),e.stateNode=n;e:{switch(o=$0(t,i),t){case"dialog":rn("cancel",n),rn("close",n),r=i;break;case"iframe":case"object":case"embed":rn("load",n),r=i;break;case"video":case"audio":for(r=0;r<ic.length;r++)rn(ic[r],n);r=i;break;case"source":rn("error",n),r=i;break;case"img":case"image":case"link":rn("error",n),rn("load",n),r=i;break;case"details":rn("toggle",n),r=i;break;case"input":QS(n,i),r=Y0(n,i),rn("invalid",n);break;case"option":r=i;break;case"select":n._wrapperState={wasMultiple:!!i.multiple},r=mn({},i,{value:void 0}),rn("invalid",n);break;case"textarea":e1(n,i),r=K0(n,i),rn("invalid",n);break;default:r=i}Q0(t,r),a=r;for(s in a)if(a.hasOwnProperty(s)){var c=a[s];s==="style"?NE(n,c):s==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&LE(n,c)):s==="children"?typeof c=="string"?(t!=="textarea"||c!=="")&&Sc(n,c):typeof c=="number"&&Sc(n,""+c):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(xc.hasOwnProperty(s)?c!=null&&s==="onScroll"&&rn("scroll",n):c!=null&&Dy(n,s,c,o))}switch(t){case"input":xd(n),$S(n,i,!1);break;case"textarea":xd(n),t1(n);break;case"option":i.value!=null&&n.setAttribute("value",""+xo(i.value));break;case"select":n.multiple=!!i.multiple,s=i.value,s!=null?Vl(n,!!i.multiple,s,!1):i.defaultValue!=null&&Vl(n,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(n.onclick=op)}switch(t){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return si(e),null;case 6:if(n&&e.stateNode!=null)nA(n,e,n.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(ze(166));if(t=aa(Ic.current),aa($r.current),Rd(e)){if(i=e.stateNode,t=e.memoizedProps,i[Jr]=e,(s=i.nodeValue!==t)&&(n=$i,n!==null))switch(n.tag){case 3:Cd(i.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Cd(i.nodeValue,t,(n.mode&1)!==0)}s&&(e.flags|=4)}else i=(t.nodeType===9?t:t.ownerDocument).createTextNode(i),i[Jr]=e,e.stateNode=i}return si(e),null;case 13:if(on(cn),i=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(ln&&Qi!==null&&e.mode&1&&!(e.flags&128))xT(),Jl(),e.flags|=98560,s=!1;else if(s=Rd(e),i!==null&&i.dehydrated!==null){if(n===null){if(!s)throw Error(ze(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ze(317));s[Jr]=e}else Jl(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;si(e),s=!1}else Lr!==null&&(Nv(Lr),Lr=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(i=i!==null,i!==(n!==null&&n.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(n===null||cn.current&1?On===0&&(On=3):g_())),e.updateQueue!==null&&(e.flags|=4),si(e),null);case 4:return $l(),Tv(n,e),n===null&&Cc(e.stateNode.containerInfo),si(e),null;case 10:return $y(e.type._context),si(e),null;case 17:return Fi(e.type)&&ap(),si(e),null;case 19:if(on(cn),s=e.memoizedState,s===null)return si(e),null;if(i=(e.flags&128)!==0,o=s.rendering,o===null)if(i)zu(s,!1);else{if(On!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=pp(n),o!==null){for(e.flags|=128,zu(s,!1),i=o.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=t,t=e.child;t!==null;)s=t,n=i,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=n,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,n=o.dependencies,s.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return nn(cn,cn.current&1|2),e.child}n=n.sibling}s.tail!==null&&An()>tu&&(e.flags|=128,i=!0,zu(s,!1),e.lanes=4194304)}else{if(!i)if(n=pp(o),n!==null){if(e.flags|=128,i=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),zu(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!ln)return si(e),null}else 2*An()-s.renderingStartTime>tu&&t!==1073741824&&(e.flags|=128,i=!0,zu(s,!1),e.lanes=4194304);s.isBackwards?(o.sibling=e.child,e.child=o):(t=s.last,t!==null?t.sibling=o:e.child=o,s.last=o)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=An(),e.sibling=null,t=cn.current,nn(cn,i?t&1|2:t&1),e):(si(e),null);case 22:case 23:return m_(),i=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?Zi&1073741824&&(si(e),e.subtreeFlags&6&&(e.flags|=8192)):si(e),null;case 24:return null;case 25:return null}throw Error(ze(156,e.tag))}function QP(n,e){switch(Zy(e),e.tag){case 1:return Fi(e.type)&&ap(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return $l(),on(ki),on(pi),r_(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return i_(e),null;case 13:if(on(cn),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(ze(340));Jl()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return on(cn),null;case 4:return $l(),null;case 10:return $y(e.type._context),null;case 22:case 23:return m_(),null;case 24:return null;default:return null}}var Id=!1,ci=!1,$P=typeof WeakSet=="function"?WeakSet:Set,rt=null;function Dl(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(i){_n(n,e,i)}else t.current=null}function Av(n,e,t){try{t()}catch(i){_n(n,e,i)}}var W1=!1;function e3(n,e){if(uv=ip,n=aT(),Yy(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var i=t.getSelection&&t.getSelection();if(i&&i.rangeCount!==0){t=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{t.nodeType,s.nodeType}catch{t=null;break e}var o=0,a=-1,c=-1,f=0,d=0,h=n,m=null;t:for(;;){for(var v;h!==t||r!==0&&h.nodeType!==3||(a=o+r),h!==s||i!==0&&h.nodeType!==3||(c=o+i),h.nodeType===3&&(o+=h.nodeValue.length),(v=h.firstChild)!==null;)m=h,h=v;for(;;){if(h===n)break t;if(m===t&&++f===r&&(a=o),m===s&&++d===i&&(c=o),(v=h.nextSibling)!==null)break;h=m,m=h.parentNode}h=v}t=a===-1||c===-1?null:{start:a,end:c}}else t=null}t=t||{start:0,end:0}}else t=null;for(cv={focusedElem:n,selectionRange:t},ip=!1,rt=e;rt!==null;)if(e=rt,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,rt=n;else for(;rt!==null;){e=rt;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var w=y.memoizedProps,x=y.memoizedState,g=e.stateNode,S=g.getSnapshotBeforeUpdate(e.elementType===e.type?w:Cr(e.type,w),x);g.__reactInternalSnapshotBeforeUpdate=S}break;case 3:var M=e.stateNode.containerInfo;M.nodeType===1?M.textContent="":M.nodeType===9&&M.documentElement&&M.removeChild(M.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ze(163))}}catch(T){_n(e,e.return,T)}if(n=e.sibling,n!==null){n.return=e.return,rt=n;break}rt=e.return}return y=W1,W1=!1,y}function fc(n,e,t){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&n)===n){var s=r.destroy;r.destroy=void 0,s!==void 0&&Av(e,t,s)}r=r.next}while(r!==i)}}function Fp(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var i=t.create;t.destroy=i()}t=t.next}while(t!==e)}}function bv(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function iA(n){var e=n.alternate;e!==null&&(n.alternate=null,iA(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[Jr],delete e[Pc],delete e[hv],delete e[OP],delete e[kP])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function rA(n){return n.tag===5||n.tag===3||n.tag===4}function X1(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||rA(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Cv(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=op));else if(i!==4&&(n=n.child,n!==null))for(Cv(n,e,t),n=n.sibling;n!==null;)Cv(n,e,t),n=n.sibling}function Rv(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(i!==4&&(n=n.child,n!==null))for(Rv(n,e,t),n=n.sibling;n!==null;)Rv(n,e,t),n=n.sibling}var Kn=null,Pr=!1;function js(n,e,t){for(t=t.child;t!==null;)sA(n,e,t),t=t.sibling}function sA(n,e,t){if(Qr&&typeof Qr.onCommitFiberUnmount=="function")try{Qr.onCommitFiberUnmount(Pp,t)}catch{}switch(t.tag){case 5:ci||Dl(t,e);case 6:var i=Kn,r=Pr;Kn=null,js(n,e,t),Kn=i,Pr=r,Kn!==null&&(Pr?(n=Kn,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):Kn.removeChild(t.stateNode));break;case 18:Kn!==null&&(Pr?(n=Kn,t=t.stateNode,n.nodeType===8?Bg(n.parentNode,t):n.nodeType===1&&Bg(n,t),Tc(n)):Bg(Kn,t.stateNode));break;case 4:i=Kn,r=Pr,Kn=t.stateNode.containerInfo,Pr=!0,js(n,e,t),Kn=i,Pr=r;break;case 0:case 11:case 14:case 15:if(!ci&&(i=t.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var s=r,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&Av(t,e,o),r=r.next}while(r!==i)}js(n,e,t);break;case 1:if(!ci&&(Dl(t,e),i=t.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=t.memoizedProps,i.state=t.memoizedState,i.componentWillUnmount()}catch(a){_n(t,e,a)}js(n,e,t);break;case 21:js(n,e,t);break;case 22:t.mode&1?(ci=(i=ci)||t.memoizedState!==null,js(n,e,t),ci=i):js(n,e,t);break;default:js(n,e,t)}}function j1(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new $P),e.forEach(function(i){var r=u3.bind(null,n,i);t.has(i)||(t.add(i),i.then(r,r))})}}function Er(n,e){var t=e.deletions;if(t!==null)for(var i=0;i<t.length;i++){var r=t[i];try{var s=n,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:Kn=a.stateNode,Pr=!1;break e;case 3:Kn=a.stateNode.containerInfo,Pr=!0;break e;case 4:Kn=a.stateNode.containerInfo,Pr=!0;break e}a=a.return}if(Kn===null)throw Error(ze(160));sA(s,o,r),Kn=null,Pr=!1;var c=r.alternate;c!==null&&(c.return=null),r.return=null}catch(f){_n(r,e,f)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)oA(e,n),e=e.sibling}function oA(n,e){var t=n.alternate,i=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Er(e,n),Zr(n),i&4){try{fc(3,n,n.return),Fp(3,n)}catch(w){_n(n,n.return,w)}try{fc(5,n,n.return)}catch(w){_n(n,n.return,w)}}break;case 1:Er(e,n),Zr(n),i&512&&t!==null&&Dl(t,t.return);break;case 5:if(Er(e,n),Zr(n),i&512&&t!==null&&Dl(t,t.return),n.flags&32){var r=n.stateNode;try{Sc(r,"")}catch(w){_n(n,n.return,w)}}if(i&4&&(r=n.stateNode,r!=null)){var s=n.memoizedProps,o=t!==null?t.memoizedProps:s,a=n.type,c=n.updateQueue;if(n.updateQueue=null,c!==null)try{a==="input"&&s.type==="radio"&&s.name!=null&&CE(r,s),$0(a,o);var f=$0(a,s);for(o=0;o<c.length;o+=2){var d=c[o],h=c[o+1];d==="style"?NE(r,h):d==="dangerouslySetInnerHTML"?LE(r,h):d==="children"?Sc(r,h):Dy(r,d,h,f)}switch(a){case"input":q0(r,s);break;case"textarea":RE(r,s);break;case"select":var m=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var v=s.value;v!=null?Vl(r,!!s.multiple,v,!1):m!==!!s.multiple&&(s.defaultValue!=null?Vl(r,!!s.multiple,s.defaultValue,!0):Vl(r,!!s.multiple,s.multiple?[]:"",!1))}r[Pc]=s}catch(w){_n(n,n.return,w)}}break;case 6:if(Er(e,n),Zr(n),i&4){if(n.stateNode===null)throw Error(ze(162));r=n.stateNode,s=n.memoizedProps;try{r.nodeValue=s}catch(w){_n(n,n.return,w)}}break;case 3:if(Er(e,n),Zr(n),i&4&&t!==null&&t.memoizedState.isDehydrated)try{Tc(e.containerInfo)}catch(w){_n(n,n.return,w)}break;case 4:Er(e,n),Zr(n);break;case 13:Er(e,n),Zr(n),r=n.child,r.flags&8192&&(s=r.memoizedState!==null,r.stateNode.isHidden=s,!s||r.alternate!==null&&r.alternate.memoizedState!==null||(h_=An())),i&4&&j1(n);break;case 22:if(d=t!==null&&t.memoizedState!==null,n.mode&1?(ci=(f=ci)||d,Er(e,n),ci=f):Er(e,n),Zr(n),i&8192){if(f=n.memoizedState!==null,(n.stateNode.isHidden=f)&&!d&&n.mode&1)for(rt=n,d=n.child;d!==null;){for(h=rt=d;rt!==null;){switch(m=rt,v=m.child,m.tag){case 0:case 11:case 14:case 15:fc(4,m,m.return);break;case 1:Dl(m,m.return);var y=m.stateNode;if(typeof y.componentWillUnmount=="function"){i=m,t=m.return;try{e=i,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(w){_n(i,t,w)}}break;case 5:Dl(m,m.return);break;case 22:if(m.memoizedState!==null){q1(h);continue}}v!==null?(v.return=m,rt=v):q1(h)}d=d.sibling}e:for(d=null,h=n;;){if(h.tag===5){if(d===null){d=h;try{r=h.stateNode,f?(s=r.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(a=h.stateNode,c=h.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,a.style.display=IE("display",o))}catch(w){_n(n,n.return,w)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=f?"":h.memoizedProps}catch(w){_n(n,n.return,w)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===n)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===n)break e;for(;h.sibling===null;){if(h.return===null||h.return===n)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Er(e,n),Zr(n),i&4&&j1(n);break;case 21:break;default:Er(e,n),Zr(n)}}function Zr(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(rA(t)){var i=t;break e}t=t.return}throw Error(ze(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(Sc(r,""),i.flags&=-33);var s=X1(n);Rv(n,s,r);break;case 3:case 4:var o=i.stateNode.containerInfo,a=X1(n);Cv(n,a,o);break;default:throw Error(ze(161))}}catch(c){_n(n,n.return,c)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function t3(n,e,t){rt=n,aA(n)}function aA(n,e,t){for(var i=(n.mode&1)!==0;rt!==null;){var r=rt,s=r.child;if(r.tag===22&&i){var o=r.memoizedState!==null||Id;if(!o){var a=r.alternate,c=a!==null&&a.memoizedState!==null||ci;a=Id;var f=ci;if(Id=o,(ci=c)&&!f)for(rt=r;rt!==null;)o=rt,c=o.child,o.tag===22&&o.memoizedState!==null?Z1(r):c!==null?(c.return=o,rt=c):Z1(r);for(;s!==null;)rt=s,aA(s),s=s.sibling;rt=r,Id=a,ci=f}Y1(n)}else r.subtreeFlags&8772&&s!==null?(s.return=r,rt=s):Y1(n)}}function Y1(n){for(;rt!==null;){var e=rt;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:ci||Fp(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!ci)if(t===null)i.componentDidMount();else{var r=e.elementType===e.type?t.memoizedProps:Cr(e.type,t.memoizedProps);i.componentDidUpdate(r,t.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&L1(e,s,i);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}L1(e,o,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&t.focus();break;case"img":c.src&&(t.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var f=e.alternate;if(f!==null){var d=f.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&Tc(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ze(163))}ci||e.flags&512&&bv(e)}catch(m){_n(e,e.return,m)}}if(e===n){rt=null;break}if(t=e.sibling,t!==null){t.return=e.return,rt=t;break}rt=e.return}}function q1(n){for(;rt!==null;){var e=rt;if(e===n){rt=null;break}var t=e.sibling;if(t!==null){t.return=e.return,rt=t;break}rt=e.return}}function Z1(n){for(;rt!==null;){var e=rt;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{Fp(4,e)}catch(c){_n(e,t,c)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var r=e.return;try{i.componentDidMount()}catch(c){_n(e,r,c)}}var s=e.return;try{bv(e)}catch(c){_n(e,s,c)}break;case 5:var o=e.return;try{bv(e)}catch(c){_n(e,o,c)}}}catch(c){_n(e,e.return,c)}if(e===n){rt=null;break}var a=e.sibling;if(a!==null){a.return=e.return,rt=a;break}rt=e.return}}var n3=Math.ceil,vp=Os.ReactCurrentDispatcher,f_=Os.ReactCurrentOwner,yr=Os.ReactCurrentBatchConfig,Bt=0,jn=null,Ln=null,Jn=0,Zi=0,Ul=Ao(0),On=0,Oc=null,Ma=0,zp=0,d_=0,dc=null,Ni=null,h_=0,tu=1/0,ys=null,yp=!1,Pv=null,po=null,Nd=!1,ao=null,_p=0,hc=0,Lv=null,Hh=-1,Vh=0;function wi(){return Bt&6?An():Hh!==-1?Hh:Hh=An()}function mo(n){return n.mode&1?Bt&2&&Jn!==0?Jn&-Jn:zP.transition!==null?(Vh===0&&(Vh=XE()),Vh):(n=Zt,n!==0||(n=window.event,n=n===void 0?16:QE(n.type)),n):1}function Ur(n,e,t,i){if(50<hc)throw hc=0,Lv=null,Error(ze(185));af(n,t,i),(!(Bt&2)||n!==jn)&&(n===jn&&(!(Bt&2)&&(zp|=t),On===4&&ro(n,Jn)),zi(n,i),t===1&&Bt===0&&!(e.mode&1)&&(tu=An()+500,Up&&bo()))}function zi(n,e){var t=n.callbackNode;zR(n,e);var i=np(n,n===jn?Jn:0);if(i===0)t!==null&&r1(t),n.callbackNode=null,n.callbackPriority=0;else if(e=i&-i,n.callbackPriority!==e){if(t!=null&&r1(t),e===1)n.tag===0?FP(K1.bind(null,n)):vT(K1.bind(null,n)),DP(function(){!(Bt&6)&&bo()}),t=null;else{switch(jE(i)){case 1:t=zy;break;case 4:t=GE;break;case 16:t=tp;break;case 536870912:t=WE;break;default:t=tp}t=mA(t,lA.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function lA(n,e){if(Hh=-1,Vh=0,Bt&6)throw Error(ze(327));var t=n.callbackNode;if(Yl()&&n.callbackNode!==t)return null;var i=np(n,n===jn?Jn:0);if(i===0)return null;if(i&30||i&n.expiredLanes||e)e=xp(n,i);else{e=i;var r=Bt;Bt|=2;var s=cA();(jn!==n||Jn!==e)&&(ys=null,tu=An()+500,da(n,e));do try{s3();break}catch(a){uA(n,a)}while(!0);Qy(),vp.current=s,Bt=r,Ln!==null?e=0:(jn=null,Jn=0,e=On)}if(e!==0){if(e===2&&(r=rv(n),r!==0&&(i=r,e=Iv(n,r))),e===1)throw t=Oc,da(n,0),ro(n,i),zi(n,An()),t;if(e===6)ro(n,i);else{if(r=n.current.alternate,!(i&30)&&!i3(r)&&(e=xp(n,i),e===2&&(s=rv(n),s!==0&&(i=s,e=Iv(n,s))),e===1))throw t=Oc,da(n,0),ro(n,i),zi(n,An()),t;switch(n.finishedWork=r,n.finishedLanes=i,e){case 0:case 1:throw Error(ze(345));case 2:Qo(n,Ni,ys);break;case 3:if(ro(n,i),(i&130023424)===i&&(e=h_+500-An(),10<e)){if(np(n,0)!==0)break;if(r=n.suspendedLanes,(r&i)!==i){wi(),n.pingedLanes|=n.suspendedLanes&r;break}n.timeoutHandle=dv(Qo.bind(null,n,Ni,ys),e);break}Qo(n,Ni,ys);break;case 4:if(ro(n,i),(i&4194240)===i)break;for(e=n.eventTimes,r=-1;0<i;){var o=31-Dr(i);s=1<<o,o=e[o],o>r&&(r=o),i&=~s}if(i=r,i=An()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*n3(i/1960))-i,10<i){n.timeoutHandle=dv(Qo.bind(null,n,Ni,ys),i);break}Qo(n,Ni,ys);break;case 5:Qo(n,Ni,ys);break;default:throw Error(ze(329))}}}return zi(n,An()),n.callbackNode===t?lA.bind(null,n):null}function Iv(n,e){var t=dc;return n.current.memoizedState.isDehydrated&&(da(n,e).flags|=256),n=xp(n,e),n!==2&&(e=Ni,Ni=t,e!==null&&Nv(e)),n}function Nv(n){Ni===null?Ni=n:Ni.push.apply(Ni,n)}function i3(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var i=0;i<t.length;i++){var r=t[i],s=r.getSnapshot;r=r.value;try{if(!Or(s(),r))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function ro(n,e){for(e&=~d_,e&=~zp,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-Dr(e),i=1<<t;n[t]=-1,e&=~i}}function K1(n){if(Bt&6)throw Error(ze(327));Yl();var e=np(n,0);if(!(e&1))return zi(n,An()),null;var t=xp(n,e);if(n.tag!==0&&t===2){var i=rv(n);i!==0&&(e=i,t=Iv(n,i))}if(t===1)throw t=Oc,da(n,0),ro(n,e),zi(n,An()),t;if(t===6)throw Error(ze(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,Qo(n,Ni,ys),zi(n,An()),null}function p_(n,e){var t=Bt;Bt|=1;try{return n(e)}finally{Bt=t,Bt===0&&(tu=An()+500,Up&&bo())}}function wa(n){ao!==null&&ao.tag===0&&!(Bt&6)&&Yl();var e=Bt;Bt|=1;var t=yr.transition,i=Zt;try{if(yr.transition=null,Zt=1,n)return n()}finally{Zt=i,yr.transition=t,Bt=e,!(Bt&6)&&bo()}}function m_(){Zi=Ul.current,on(Ul)}function da(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,NP(t)),Ln!==null)for(t=Ln.return;t!==null;){var i=t;switch(Zy(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&ap();break;case 3:$l(),on(ki),on(pi),r_();break;case 5:i_(i);break;case 4:$l();break;case 13:on(cn);break;case 19:on(cn);break;case 10:$y(i.type._context);break;case 22:case 23:m_()}t=t.return}if(jn=n,Ln=n=go(n.current,null),Jn=Zi=e,On=0,Oc=null,d_=zp=Ma=0,Ni=dc=null,oa!==null){for(e=0;e<oa.length;e++)if(t=oa[e],i=t.interleaved,i!==null){t.interleaved=null;var r=i.next,s=t.pending;if(s!==null){var o=s.next;s.next=r,i.next=o}t.pending=i}oa=null}return n}function uA(n,e){do{var t=Ln;try{if(Qy(),Fh.current=gp,mp){for(var i=pn.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}mp=!1}if(Sa=0,Xn=Dn=pn=null,cc=!1,Nc=0,f_.current=null,t===null||t.return===null){On=1,Oc=e,Ln=null;break}e:{var s=n,o=t.return,a=t,c=e;if(e=Jn,a.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var f=c,d=a,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var m=d.alternate;m?(d.updateQueue=m.updateQueue,d.memoizedState=m.memoizedState,d.lanes=m.lanes):(d.updateQueue=null,d.memoizedState=null)}var v=k1(o);if(v!==null){v.flags&=-257,F1(v,o,a,s,e),v.mode&1&&O1(s,f,e),e=v,c=f;var y=e.updateQueue;if(y===null){var w=new Set;w.add(c),e.updateQueue=w}else y.add(c);break e}else{if(!(e&1)){O1(s,f,e),g_();break e}c=Error(ze(426))}}else if(ln&&a.mode&1){var x=k1(o);if(x!==null){!(x.flags&65536)&&(x.flags|=256),F1(x,o,a,s,e),Ky(eu(c,a));break e}}s=c=eu(c,a),On!==4&&(On=2),dc===null?dc=[s]:dc.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var g=jT(s,c,e);P1(s,g);break e;case 1:a=c;var S=s.type,M=s.stateNode;if(!(s.flags&128)&&(typeof S.getDerivedStateFromError=="function"||M!==null&&typeof M.componentDidCatch=="function"&&(po===null||!po.has(M)))){s.flags|=65536,e&=-e,s.lanes|=e;var T=YT(s,a,e);P1(s,T);break e}}s=s.return}while(s!==null)}dA(t)}catch(P){e=P,Ln===t&&t!==null&&(Ln=t=t.return);continue}break}while(!0)}function cA(){var n=vp.current;return vp.current=gp,n===null?gp:n}function g_(){(On===0||On===3||On===2)&&(On=4),jn===null||!(Ma&268435455)&&!(zp&268435455)||ro(jn,Jn)}function xp(n,e){var t=Bt;Bt|=2;var i=cA();(jn!==n||Jn!==e)&&(ys=null,da(n,e));do try{r3();break}catch(r){uA(n,r)}while(!0);if(Qy(),Bt=t,vp.current=i,Ln!==null)throw Error(ze(261));return jn=null,Jn=0,On}function r3(){for(;Ln!==null;)fA(Ln)}function s3(){for(;Ln!==null&&!PR();)fA(Ln)}function fA(n){var e=pA(n.alternate,n,Zi);n.memoizedProps=n.pendingProps,e===null?dA(n):Ln=e,f_.current=null}function dA(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=QP(t,e),t!==null){t.flags&=32767,Ln=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{On=6,Ln=null;return}}else if(t=JP(t,e,Zi),t!==null){Ln=t;return}if(e=e.sibling,e!==null){Ln=e;return}Ln=e=n}while(e!==null);On===0&&(On=5)}function Qo(n,e,t){var i=Zt,r=yr.transition;try{yr.transition=null,Zt=1,o3(n,e,t,i)}finally{yr.transition=r,Zt=i}return null}function o3(n,e,t,i){do Yl();while(ao!==null);if(Bt&6)throw Error(ze(327));t=n.finishedWork;var r=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(ze(177));n.callbackNode=null,n.callbackPriority=0;var s=t.lanes|t.childLanes;if(BR(n,s),n===jn&&(Ln=jn=null,Jn=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||Nd||(Nd=!0,mA(tp,function(){return Yl(),null})),s=(t.flags&15990)!==0,t.subtreeFlags&15990||s){s=yr.transition,yr.transition=null;var o=Zt;Zt=1;var a=Bt;Bt|=4,f_.current=null,e3(n,t),oA(t,n),AP(cv),ip=!!uv,cv=uv=null,n.current=t,t3(t),LR(),Bt=a,Zt=o,yr.transition=s}else n.current=t;if(Nd&&(Nd=!1,ao=n,_p=r),s=n.pendingLanes,s===0&&(po=null),DR(t.stateNode),zi(n,An()),e!==null)for(i=n.onRecoverableError,t=0;t<e.length;t++)r=e[t],i(r.value,{componentStack:r.stack,digest:r.digest});if(yp)throw yp=!1,n=Pv,Pv=null,n;return _p&1&&n.tag!==0&&Yl(),s=n.pendingLanes,s&1?n===Lv?hc++:(hc=0,Lv=n):hc=0,bo(),null}function Yl(){if(ao!==null){var n=jE(_p),e=yr.transition,t=Zt;try{if(yr.transition=null,Zt=16>n?16:n,ao===null)var i=!1;else{if(n=ao,ao=null,_p=0,Bt&6)throw Error(ze(331));var r=Bt;for(Bt|=4,rt=n.current;rt!==null;){var s=rt,o=s.child;if(rt.flags&16){var a=s.deletions;if(a!==null){for(var c=0;c<a.length;c++){var f=a[c];for(rt=f;rt!==null;){var d=rt;switch(d.tag){case 0:case 11:case 15:fc(8,d,s)}var h=d.child;if(h!==null)h.return=d,rt=h;else for(;rt!==null;){d=rt;var m=d.sibling,v=d.return;if(iA(d),d===f){rt=null;break}if(m!==null){m.return=v,rt=m;break}rt=v}}}var y=s.alternate;if(y!==null){var w=y.child;if(w!==null){y.child=null;do{var x=w.sibling;w.sibling=null,w=x}while(w!==null)}}rt=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,rt=o;else e:for(;rt!==null;){if(s=rt,s.flags&2048)switch(s.tag){case 0:case 11:case 15:fc(9,s,s.return)}var g=s.sibling;if(g!==null){g.return=s.return,rt=g;break e}rt=s.return}}var S=n.current;for(rt=S;rt!==null;){o=rt;var M=o.child;if(o.subtreeFlags&2064&&M!==null)M.return=o,rt=M;else e:for(o=S;rt!==null;){if(a=rt,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Fp(9,a)}}catch(P){_n(a,a.return,P)}if(a===o){rt=null;break e}var T=a.sibling;if(T!==null){T.return=a.return,rt=T;break e}rt=a.return}}if(Bt=r,bo(),Qr&&typeof Qr.onPostCommitFiberRoot=="function")try{Qr.onPostCommitFiberRoot(Pp,n)}catch{}i=!0}return i}finally{Zt=t,yr.transition=e}}return!1}function J1(n,e,t){e=eu(t,e),e=jT(n,e,1),n=ho(n,e,1),e=wi(),n!==null&&(af(n,1,e),zi(n,e))}function _n(n,e,t){if(n.tag===3)J1(n,n,t);else for(;e!==null;){if(e.tag===3){J1(e,n,t);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(po===null||!po.has(i))){n=eu(t,n),n=YT(e,n,1),e=ho(e,n,1),n=wi(),e!==null&&(af(e,1,n),zi(e,n));break}}e=e.return}}function a3(n,e,t){var i=n.pingCache;i!==null&&i.delete(e),e=wi(),n.pingedLanes|=n.suspendedLanes&t,jn===n&&(Jn&t)===t&&(On===4||On===3&&(Jn&130023424)===Jn&&500>An()-h_?da(n,0):d_|=t),zi(n,e)}function hA(n,e){e===0&&(n.mode&1?(e=wd,wd<<=1,!(wd&130023424)&&(wd=4194304)):e=1);var t=wi();n=Ls(n,e),n!==null&&(af(n,e,t),zi(n,t))}function l3(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),hA(n,t)}function u3(n,e){var t=0;switch(n.tag){case 13:var i=n.stateNode,r=n.memoizedState;r!==null&&(t=r.retryLane);break;case 19:i=n.stateNode;break;default:throw Error(ze(314))}i!==null&&i.delete(e),hA(n,t)}var pA;pA=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||ki.current)Oi=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return Oi=!1,KP(n,e,t);Oi=!!(n.flags&131072)}else Oi=!1,ln&&e.flags&1048576&&yT(e,cp,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;Bh(n,e),n=e.pendingProps;var r=Kl(e,pi.current);jl(e,t),r=o_(null,e,i,n,r,t);var s=a_();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Fi(i)?(s=!0,lp(e)):s=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,t_(e),r.updater=kp,e.stateNode=r,r._reactInternals=e,_v(e,i,n,t),e=Mv(null,e,i,!0,s,t)):(e.tag=0,ln&&s&&qy(e),Si(null,e,r,t),e=e.child),e;case 16:i=e.elementType;e:{switch(Bh(n,e),n=e.pendingProps,r=i._init,i=r(i._payload),e.type=i,r=e.tag=f3(i),n=Cr(i,n),r){case 0:e=Sv(null,e,i,n,t);break e;case 1:e=H1(null,e,i,n,t);break e;case 11:e=z1(null,e,i,n,t);break e;case 14:e=B1(null,e,i,Cr(i.type,n),t);break e}throw Error(ze(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Cr(i,r),Sv(n,e,i,r,t);case 1:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Cr(i,r),H1(n,e,i,r,t);case 3:e:{if(JT(e),n===null)throw Error(ze(387));i=e.pendingProps,s=e.memoizedState,r=s.element,ET(n,e),hp(e,i,null,t);var o=e.memoizedState;if(i=o.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){r=eu(Error(ze(423)),e),e=V1(n,e,i,t,r);break e}else if(i!==r){r=eu(Error(ze(424)),e),e=V1(n,e,i,t,r);break e}else for(Qi=fo(e.stateNode.containerInfo.firstChild),$i=e,ln=!0,Lr=null,t=MT(e,null,i,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Jl(),i===r){e=Is(n,e,t);break e}Si(n,e,i,t)}e=e.child}return e;case 5:return TT(e),n===null&&gv(e),i=e.type,r=e.pendingProps,s=n!==null?n.memoizedProps:null,o=r.children,fv(i,r)?o=null:s!==null&&fv(i,s)&&(e.flags|=32),KT(n,e),Si(n,e,o,t),e.child;case 6:return n===null&&gv(e),null;case 13:return QT(n,e,t);case 4:return n_(e,e.stateNode.containerInfo),i=e.pendingProps,n===null?e.child=Ql(e,null,i,t):Si(n,e,i,t),e.child;case 11:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Cr(i,r),z1(n,e,i,r,t);case 7:return Si(n,e,e.pendingProps,t),e.child;case 8:return Si(n,e,e.pendingProps.children,t),e.child;case 12:return Si(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(i=e.type._context,r=e.pendingProps,s=e.memoizedProps,o=r.value,nn(fp,i._currentValue),i._currentValue=o,s!==null)if(Or(s.value,o)){if(s.children===r.children&&!ki.current){e=Is(n,e,t);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var a=s.dependencies;if(a!==null){o=s.child;for(var c=a.firstContext;c!==null;){if(c.context===i){if(s.tag===1){c=bs(-1,t&-t),c.tag=2;var f=s.updateQueue;if(f!==null){f=f.shared;var d=f.pending;d===null?c.next=c:(c.next=d.next,d.next=c),f.pending=c}}s.lanes|=t,c=s.alternate,c!==null&&(c.lanes|=t),vv(s.return,t,e),a.lanes|=t;break}c=c.next}}else if(s.tag===10)o=s.type===e.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(ze(341));o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),vv(o,t,e),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===e){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}Si(n,e,r.children,t),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,jl(e,t),r=_r(r),i=i(r),e.flags|=1,Si(n,e,i,t),e.child;case 14:return i=e.type,r=Cr(i,e.pendingProps),r=Cr(i.type,r),B1(n,e,i,r,t);case 15:return qT(n,e,e.type,e.pendingProps,t);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:Cr(i,r),Bh(n,e),e.tag=1,Fi(i)?(n=!0,lp(e)):n=!1,jl(e,t),XT(e,i,r),_v(e,i,r,t),Mv(null,e,i,!0,n,t);case 19:return $T(n,e,t);case 22:return ZT(n,e,t)}throw Error(ze(156,e.tag))};function mA(n,e){return VE(n,e)}function c3(n,e,t,i){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function gr(n,e,t,i){return new c3(n,e,t,i)}function v_(n){return n=n.prototype,!(!n||!n.isReactComponent)}function f3(n){if(typeof n=="function")return v_(n)?1:0;if(n!=null){if(n=n.$$typeof,n===Oy)return 11;if(n===ky)return 14}return 2}function go(n,e){var t=n.alternate;return t===null?(t=gr(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function Gh(n,e,t,i,r,s){var o=2;if(i=n,typeof n=="function")v_(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case Tl:return ha(t.children,r,s,e);case Uy:o=8,r|=8;break;case G0:return n=gr(12,t,e,r|2),n.elementType=G0,n.lanes=s,n;case W0:return n=gr(13,t,e,r),n.elementType=W0,n.lanes=s,n;case X0:return n=gr(19,t,e,r),n.elementType=X0,n.lanes=s,n;case TE:return Bp(t,r,s,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case wE:o=10;break e;case EE:o=9;break e;case Oy:o=11;break e;case ky:o=14;break e;case to:o=16,i=null;break e}throw Error(ze(130,n==null?n:typeof n,""))}return e=gr(o,t,e,r),e.elementType=n,e.type=i,e.lanes=s,e}function ha(n,e,t,i){return n=gr(7,n,i,e),n.lanes=t,n}function Bp(n,e,t,i){return n=gr(22,n,i,e),n.elementType=TE,n.lanes=t,n.stateNode={isHidden:!1},n}function qg(n,e,t){return n=gr(6,n,null,e),n.lanes=t,n}function Zg(n,e,t){return e=gr(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function d3(n,e,t,i,r){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Rg(0),this.expirationTimes=Rg(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Rg(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function y_(n,e,t,i,r,s,o,a,c){return n=new d3(n,e,t,a,c),e===1?(e=1,s===!0&&(e|=8)):e=0,s=gr(3,null,null,e),n.current=s,s.stateNode=n,s.memoizedState={element:i,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},t_(s),n}function h3(n,e,t){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:El,key:i==null?null:""+i,children:n,containerInfo:e,implementation:t}}function gA(n){if(!n)return So;n=n._reactInternals;e:{if(Ra(n)!==n||n.tag!==1)throw Error(ze(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Fi(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ze(171))}if(n.tag===1){var t=n.type;if(Fi(t))return gT(n,t,e)}return e}function vA(n,e,t,i,r,s,o,a,c){return n=y_(t,i,!0,n,r,s,o,a,c),n.context=gA(null),t=n.current,i=wi(),r=mo(t),s=bs(i,r),s.callback=e??null,ho(t,s,r),n.current.lanes=r,af(n,r,i),zi(n,i),n}function Hp(n,e,t,i){var r=e.current,s=wi(),o=mo(r);return t=gA(t),e.context===null?e.context=t:e.pendingContext=t,e=bs(s,o),e.payload={element:n},i=i===void 0?null:i,i!==null&&(e.callback=i),n=ho(r,e,o),n!==null&&(Ur(n,r,o,s),kh(n,r,o)),o}function Sp(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function Q1(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function __(n,e){Q1(n,e),(n=n.alternate)&&Q1(n,e)}function p3(){return null}var yA=typeof reportError=="function"?reportError:function(n){console.error(n)};function x_(n){this._internalRoot=n}Vp.prototype.render=x_.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(ze(409));Hp(n,e,null,null)};Vp.prototype.unmount=x_.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;wa(function(){Hp(null,n,null,null)}),e[Ps]=null}};function Vp(n){this._internalRoot=n}Vp.prototype.unstable_scheduleHydration=function(n){if(n){var e=ZE();n={blockedOn:null,target:n,priority:e};for(var t=0;t<io.length&&e!==0&&e<io[t].priority;t++);io.splice(t,0,n),t===0&&JE(n)}};function S_(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function Gp(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function $1(){}function m3(n,e,t,i,r){if(r){if(typeof i=="function"){var s=i;i=function(){var f=Sp(o);s.call(f)}}var o=vA(e,i,n,0,null,!1,!1,"",$1);return n._reactRootContainer=o,n[Ps]=o.current,Cc(n.nodeType===8?n.parentNode:n),wa(),o}for(;r=n.lastChild;)n.removeChild(r);if(typeof i=="function"){var a=i;i=function(){var f=Sp(c);a.call(f)}}var c=y_(n,0,!1,null,null,!1,!1,"",$1);return n._reactRootContainer=c,n[Ps]=c.current,Cc(n.nodeType===8?n.parentNode:n),wa(function(){Hp(e,c,t,i)}),c}function Wp(n,e,t,i,r){var s=t._reactRootContainer;if(s){var o=s;if(typeof r=="function"){var a=r;r=function(){var c=Sp(o);a.call(c)}}Hp(e,o,n,r)}else o=m3(t,e,n,r,i);return Sp(o)}YE=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=nc(e.pendingLanes);t!==0&&(By(e,t|1),zi(e,An()),!(Bt&6)&&(tu=An()+500,bo()))}break;case 13:wa(function(){var i=Ls(n,1);if(i!==null){var r=wi();Ur(i,n,1,r)}}),__(n,1)}};Hy=function(n){if(n.tag===13){var e=Ls(n,134217728);if(e!==null){var t=wi();Ur(e,n,134217728,t)}__(n,134217728)}};qE=function(n){if(n.tag===13){var e=mo(n),t=Ls(n,e);if(t!==null){var i=wi();Ur(t,n,e,i)}__(n,e)}};ZE=function(){return Zt};KE=function(n,e){var t=Zt;try{return Zt=n,e()}finally{Zt=t}};tv=function(n,e,t){switch(e){case"input":if(q0(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var i=t[e];if(i!==n&&i.form===n.form){var r=Dp(i);if(!r)throw Error(ze(90));bE(i),q0(i,r)}}}break;case"textarea":RE(n,t);break;case"select":e=t.value,e!=null&&Vl(n,!!t.multiple,e,!1)}};OE=p_;kE=wa;var g3={usingClientEntryPoint:!1,Events:[uf,Rl,Dp,DE,UE,p_]},Bu={findFiberByHostInstance:sa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},v3={bundleType:Bu.bundleType,version:Bu.version,rendererPackageName:Bu.rendererPackageName,rendererConfig:Bu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Os.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=BE(n),n===null?null:n.stateNode},findFiberByHostInstance:Bu.findFiberByHostInstance||p3,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Dd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Dd.isDisabled&&Dd.supportsFiber)try{Pp=Dd.inject(v3),Qr=Dd}catch{}}nr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=g3;nr.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!S_(e))throw Error(ze(200));return h3(n,e,null,t)};nr.createRoot=function(n,e){if(!S_(n))throw Error(ze(299));var t=!1,i="",r=yA;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=y_(n,1,!1,null,null,t,!1,i,r),n[Ps]=e.current,Cc(n.nodeType===8?n.parentNode:n),new x_(e)};nr.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(ze(188)):(n=Object.keys(n).join(","),Error(ze(268,n)));return n=BE(e),n=n===null?null:n.stateNode,n};nr.flushSync=function(n){return wa(n)};nr.hydrate=function(n,e,t){if(!Gp(e))throw Error(ze(200));return Wp(null,n,e,!0,t)};nr.hydrateRoot=function(n,e,t){if(!S_(n))throw Error(ze(405));var i=t!=null&&t.hydratedSources||null,r=!1,s="",o=yA;if(t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(s=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=vA(e,null,n,1,t??null,r,!1,s,o),n[Ps]=e.current,Cc(n),i)for(n=0;n<i.length;n++)t=i[n],r=t._getVersion,r=r(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,r]:e.mutableSourceEagerHydrationData.push(t,r);return new Vp(e)};nr.render=function(n,e,t){if(!Gp(e))throw Error(ze(200));return Wp(null,n,e,!1,t)};nr.unmountComponentAtNode=function(n){if(!Gp(n))throw Error(ze(40));return n._reactRootContainer?(wa(function(){Wp(null,null,n,!1,function(){n._reactRootContainer=null,n[Ps]=null})}),!0):!1};nr.unstable_batchedUpdates=p_;nr.unstable_renderSubtreeIntoContainer=function(n,e,t,i){if(!Gp(t))throw Error(ze(200));if(n==null||n._reactInternals===void 0)throw Error(ze(38));return Wp(n,e,t,!1,i)};nr.version="18.3.1-next-f1338f8080-20240426";function _A(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(_A)}catch(n){console.error(n)}}_A(),_E.exports=nr;var y3=_E.exports,xA,eM=y3;xA=H0.createRoot=eM.createRoot,H0.hydrateRoot=eM.hydrateRoot;const tM=({status:n})=>de.jsxs("header",{className:"mb-6",children:[de.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"libopenmpt Note Viewer"}),de.jsx("p",{id:"status",className:"text-lg text-yellow-400 min-h-[28px]",children:n})]}),nM=n=>de.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...n,children:de.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5m-13.5-9L12 3m0 0l4.5 4.5M12 3v13.5"})}),iM=({isReady:n,isModuleLoaded:e,onFileSelected:t,onPlay:i,onStop:r,onLoopToggle:s,isLooping:o,volume:a,setVolume:c,pan:f,setPan:d,onMediaAdd:h,onRemoteMediaSelect:m,remoteMediaList:v=[]})=>{const y=x=>{var S;const g=(S=x.target.files)==null?void 0:S[0];g&&t(g)},w=x=>{var S;const g=(S=x.target.files)==null?void 0:S[0];g&&h&&h(g)};return de.jsxs("section",{className:"bg-gray-800 p-4 rounded-lg shadow-lg flex flex-wrap gap-4 items-center",children:[de.jsxs("div",{className:"flex items-center gap-2",children:[de.jsx(nM,{className:"w-5 h-5 text-gray-400"}),de.jsx("input",{type:"file",id:"file-input",className:"text-sm text-gray-300 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 disabled:opacity-50",disabled:!n,onChange:y,accept:".mod,.s3m,.it,.xm,.mo3"})]}),de.jsxs("div",{className:"flex items-center gap-2",children:[de.jsx(nM,{className:"w-5 h-5 text-gray-400"}),de.jsx("input",{type:"file",id:"media-input",className:"text-sm text-gray-300 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-green-50 file:text-green-700 hover:file:bg-green-100",onChange:w,accept:".png,.jpg,.jpeg,.gif,.mp4"})]}),de.jsx("div",{className:"flex items-center gap-2",children:de.jsxs("label",{className:"text-sm text-gray-400 flex items-center gap-2",children:[de.jsx("span",{className:"hidden md:inline",children:"Server Media:"}),de.jsxs("select",{className:"bg-gray-700 text-white text-sm px-2 py-1 rounded border border-gray-600 focus:border-blue-500 outline-none",onChange:x=>{const g=x.target.value,S=v.find(M=>M.id===g);S&&m&&(m(S),x.target.value="")},defaultValue:"",children:[de.jsx("option",{value:"",disabled:!0,children:"Select File..."}),v.map(x=>de.jsx("option",{value:x.id,children:x.fileName},x.id))]})]})}),de.jsxs("div",{className:"flex items-center gap-2",children:[de.jsx("button",{onClick:i,disabled:!n||!e,className:"px-4 py-2 bg-green-600 text-white text-sm font-semibold rounded-lg shadow-lg hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:" Play"}),de.jsx("button",{onClick:r,disabled:!n,className:"px-4 py-2 bg-red-600 text-white text-sm font-semibold rounded-lg shadow-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:" Stop"}),de.jsx("button",{onClick:s,className:`px-4 py-2 text-sm font-semibold rounded-lg shadow-lg transition-colors ${o?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-600 text-white hover:bg-gray-700"}`,children:" Loop"})]}),c&&a!==void 0&&de.jsxs("div",{className:"flex items-center gap-2",children:[de.jsx("label",{className:"text-sm text-gray-400",children:"Vol:"}),de.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:a,onChange:x=>c(parseFloat(x.target.value)),className:"w-20"})]}),d&&f!==void 0&&de.jsxs("div",{className:"flex items-center gap-2",children:[de.jsx("label",{className:"text-sm text-gray-400",children:"Pan:"}),de.jsx("input",{type:"range",min:"-1",max:"1",step:"0.01",value:f,onChange:x=>d(parseFloat(x.target.value)),className:"w-20"})]})]})},ia=64,_s=4,_3={volume:1,pan:.5,freq:440,trigger:0,noteAge:1e3,activeEffect:0,effectValue:0,isMuted:0},rM=(n,e)=>Math.floor((n+e-1)/e)*e,x3=n=>n.includes("v0.13")||n.includes("v0.14")||n.includes("v0.15")||n.includes("v0.16")||n.includes("v0.17")||n.includes("v0.18")||n.includes("v0.19")||n.includes("v0.20")||n.includes("v0.21")||n.includes("v0.23")||n.includes("v0.24")||n.includes("v0.25")||n.includes("v0.26")||n.includes("v0.27")||n.includes("v0.28")||n.includes("v0.29")||n.includes("v0.30")||n.includes("v0.31")||n.includes("v0.32")||n.includes("v0.33")||n.includes("v0.34")||n.includes("v0.35")||n.includes("v0.36")||n.includes("v0.37")||n.includes("v0.38")||n.includes("v0.39")||n.includes("v0.40")||n.includes("v0.42")||n.includes("v0.43")||n.includes("v0.44")||n.includes("v0.45")?"extended":"standard",SA=n=>n.includes("v0.40")||n.includes("v0.42")||n.includes("v0.43")||n.includes("v0.44")||n.includes("v0.45")?"chassis_frosted.wgsl":!1,S3=n=>n.includes("v0.25")||n.includes("v0.26")||n.includes("v0.35")||n.includes("v0.37")||n.includes("v0.38")||n.includes("v0.45"),M3=n=>!SA(n),w3=n=>n.includes("v0.23")||n.includes("v0.24")?"chassis_video.wgsl":n.includes("v0.40")||n.includes("v0.42")||n.includes("v0.43")||n.includes("v0.44")||n.includes("v0.45")?"chassis_frosted.wgsl":n.includes("v0.37")||n.includes("v0.38")||n.includes("v0.39")?"chassisv0.37.wgsl":n.includes("v0.27")||n.includes("v0.28")||n.includes("v0.30")||n.includes("v0.31")||n.includes("v0.32")||n.includes("v0.33")||n.includes("v0.34")||n.includes("v0.35")||n.includes("v0.36")?"chassisv0.1.wgsl":"bezel.wgsl",E3=n=>n.includes("v0.35")||n.includes("v0.38")||n.includes("v0.40")||n.includes("v0.42")||n.includes("v0.43")||n.includes("v0.44")||n.includes("v0.45"),T3=(n,e)=>{if(n==="extended"){const s=new ArrayBuffer(80),o=new Uint32Array(s),a=new Float32Array(s);return o[0]=Math.max(0,e.numRows)>>>0,o[1]=Math.max(0,e.numChannels)>>>0,o[2]=Math.max(0,e.playheadRow)>>>0,o[3]=e.isPlaying?1:0,a[4]=e.cellW,a[5]=e.cellH,a[6]=e.canvasW,a[7]=e.canvasH,a[8]=e.tickOffset,a[9]=e.bpm,a[10]=e.timeSec,a[11]=e.beatPhase,a[12]=e.groove,a[13]=e.kickTrigger,o[14]=Math.max(0,e.activeChannels)>>>0,o[15]=e.isModuleLoaded?1:0,a[16]=e.bloomIntensity??1,a[17]=e.bloomThreshold??.8,o[18]=e.invertChannels?1:0,a[19]=e.dimFactor??1,s}const t=new ArrayBuffer(n==="texture"?64:32),i=new Uint32Array(t),r=new Float32Array(t);return i[0]=Math.max(0,e.numRows)>>>0,i[1]=Math.max(0,e.numChannels)>>>0,i[2]=Math.max(0,e.playheadRow)>>>0,i[3]=0,r[4]=e.cellW,r[5]=e.cellH,r[6]=e.canvasW,r[7]=e.canvasH,n==="texture"&&(r[8]=1,r[9]=1,r[10]=0,r[11]=0,r[12]=1,r[13]=1),t},sM=(n,e,t=!1)=>{const i=t?e+1:Math.max(1,e),r=new ArrayBuffer(i*32),s=new DataView(r),o=t?1:0;for(let a=0;a<e;a++){const c=n[a]||_3,f=(o+a)*32;s.setFloat32(f,c.volume??0,!0),s.setFloat32(f+4,c.pan??0,!0),s.setFloat32(f+8,c.freq??0,!0),s.setUint32(f+12,(c.trigger??0)>>>0,!0),s.setFloat32(f+16,c.noteAge??0,!0),s.setUint32(f+20,(c.activeEffect??0)>>>0,!0),s.setFloat32(f+24,c.effectValue??0,!0),s.setUint32(f+28,(c.isMuted??0)>>>0,!0)}return r},A3=(n,e)=>e<=0?0:Math.min(Math.max(Math.floor(n),0),e-1),b3=n=>{let e=0,t=0,i=0,r=0;const s=n.match(/v(\d{1,3})/i);if(s){e=1;const c=Math.min(255,Math.round(parseInt(s[1],10)/64*255));t=isFinite(c)?c:0}const o=n.match(/p(\d{1,3})/i);if(o){e=2;const c=Math.min(255,Math.round(parseInt(o[1],10)/64*255));t=isFinite(c)?c:0}const a=n.match(/([A-Za-z])[ ]*([0-9A-Fa-f]{2})/);if(a)i=a[1].toUpperCase().charCodeAt(0)&255,r=parseInt(a[2],16)&255;else{const c=n.match(/([0-9])[ ]*([0-9A-Fa-f]{2})/);c&&(i=48+(parseInt(c[1],10)&15)&255,r=parseInt(c[2],16)&255)}return(e&255)<<24|(t&255)<<16|(i&255)<<8|r&255},oM=(n,e=!1)=>{const t=(n==null?void 0:n.numChannels)??_s,i=(n==null?void 0:n.numRows)??ia,r=e?t+1:t,s=new Uint32Array(i*r*2);if(!n)return s;const{rows:o}=n,a=e?1:0;for(let c=0;c<i;c++){const f=o[c]||[];for(let d=0;d<t;d++){const h=(c*r+(d+a))*2,m=f[d];if(!m||!m.text)continue;const v=m.text.trim(),w=v.toUpperCase().slice(0,3).padEnd(3,"\0"),x=v.match(/(\d{1,3})$/),g=x?Math.min(255,parseInt(x[1],10)):0,S=w.charCodeAt(0)&255,M=w.charCodeAt(1)&255,T=w.charCodeAt(2)&255;s[h]=S<<24|M<<16|T<<8|g,s[h+1]=b3(v)>>>0}}return s},aM=(n,e=!1)=>{const t=(n==null?void 0:n.numChannels)??_s,i=(n==null?void 0:n.numRows)??ia,r=e?t+1:t,s=new Uint32Array(i*r*2);if(!n)return s;const{rows:o}=n,a=e?1:0;for(let c=0;c<i;c++){const f=o[c]||[];for(let d=0;d<t;d++){const h=(c*r+(d+a))*2,m=f[d];if(!m)continue;const v=m.note||0,y=m.inst||0,w=m.volCmd||0,x=m.volVal||0,g=m.effCmd||0,S=m.effVal||0;s[h]=(v&255)<<24|(y&255)<<16|(w&255)<<8|x&255,s[h+1]=(g&255)<<8|S&255}}return s},Ka=(n,e,t)=>{const i=(e instanceof ArrayBuffer,e.byteLength),r=n.createBuffer({size:Math.max(16,i),usage:t,mappedAtCreation:!0}),s=new Uint8Array(r.getMappedRange());return e instanceof ArrayBuffer?s.set(new Uint8Array(e)):s.set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),r.unmap(),r},lM=n=>{const e=new Uint32Array(n);for(let t=0;t<n;t++){let i=0;t%4===0&&(i|=1),t%16===0&&(i|=2),e[t]=i}return e},uM=({matrix:n,playheadRow:e,cellWidth:t=120,cellHeight:i=24,shaderFile:r="patternv0.40.wgsl",isPlaying:s=!1,bpm:o=120,timeSec:a=0,tickOffset:c=0,channels:f=[],beatPhase:d=0,grooveAmount:h=.5,kickTrigger:m=0,activeChannels:v=0,isModuleLoaded:y=!1,externalVideoSource:w=null,bloomIntensity:x=1,bloomThreshold:g=.8,volume:S=.5,pan:M=0,isLooping:T=!1,onPlay:P,onStop:b,onFileSelected:L,onLoopToggle:O,onSeek:C,onVolumeChange:R,onPanChange:B,totalRows:$,dimFactor:me=1})=>{const G=X.useRef(null),Z=X.useRef(null),ne=X.useRef(null),[he,F]=X.useState(!0),[W,V]=X.useState(0),[Q,se]=X.useState(!1),[J,ge]=X.useState(0),[Ie,Be]=X.useState(!1),Fe=X.useRef(null),Ne=X.useRef(null),je=X.useRef(null),ke=X.useRef(null),Le=X.useRef(null),H=X.useRef(null),xe=X.useRef(null),oe=X.useRef(null),Ue=X.useRef(!1),ve=X.useRef(null),Ze=X.useRef(null),Ve=X.useRef(null),N=X.useRef(),I=X.useRef(null),te=X.useRef("standard"),Ce=X.useRef(null),we=X.useRef(null),Ee=X.useRef(null),Ke=X.useRef(null),Oe=X.useRef(null),Ge=X.useRef(null),lt=X.useRef(),yt=(n==null?void 0:n.numChannels)??_s,Te=r.includes("v0.16")||r.includes("v0.17")||r.includes("v0.21")||r.includes("v0.38")||r.includes("v0.39")||r.includes("v0.40")||r.includes("v0.42")||r.includes("v0.43")||r.includes("v0.44")||r.includes("v0.45"),Ct=r.includes("v0.13")||r.includes("v0.14")||r.includes("v0.16")||r.includes("v0.17")||r.includes("v0.21")||r.includes("v0.39")||r.includes("v0.40"),ot=X.useMemo(()=>r.includes("v0.27")||r.includes("v0.28")?{width:1024,height:1008}:r.includes("v0.37")||r.includes("v0.38")||r.includes("v0.39")||r.includes("v0.40")||r.includes("v0.42")||r.includes("v0.43")||r.includes("v0.44")||r.includes("v0.45")?{width:1024,height:1024}:Ct?{width:1024,height:1024}:r.includes("v0.25")||r.includes("v0.30")||r.includes("v0.35")?{width:1024,height:1024}:{width:Math.max(800,yt*t),height:600},[r,Ct,yt,t]);X.useEffect(()=>{w&&(Ce.current=w)},[w]);const ut=()=>{if(!Z.current)return;const D=Z.current.getContext("webgl2",{alpha:!0,premultipliedAlpha:!1});if(!D)return;Ge.current=D;const re=`#version 300 es
      in vec2 position;
      void main() {
        gl_Position = vec4(position, 0.0, 1.0);
      }
    `;if(!(r.includes("v0.38")||r.includes("v0.39")||r.includes("v0.40")||r.includes("v0.42")||r.includes("v0.43")||r.includes("v0.44")))return;const Me=`#version 300 es
      precision highp float;
      uniform vec2 u_resolution;
      uniform float u_time;
      uniform int u_layoutMode; // 1=Circular, 2=Horizontal32, 3=Horizontal64
      uniform vec2 u_offset;
      out vec4 fragColor;

      void main() {
        // ... (Complex glass shader implementation omitted for brevity, reusing existing logic conceptually)
        // In a real implementation this would be the actual GLSL code from the project
        fragColor = vec4(0.0); // Placeholder
      }
    `,ye=(Xt,Ut)=>{const Xe=D.createShader(Xt);return D.shaderSource(Xe,Ut),D.compileShader(Xe),D.getShaderParameter(Xe,D.COMPILE_STATUS)?Xe:(console.error("GL Shader Error",D.getShaderInfoLog(Xe)),D.deleteShader(Xe),null)},Re=ye(D.VERTEX_SHADER,re),Pe=ye(D.FRAGMENT_SHADER,Me);if(!Re||!Pe)return;const fe=D.createProgram();if(D.attachShader(fe,Re),D.attachShader(fe,Pe),D.linkProgram(fe),!D.getProgramParameter(fe,D.LINK_STATUS)){console.error("GL Link Error",D.getProgramInfoLog(fe));return}const Qe=D.createVertexArray();D.bindVertexArray(Qe);const Et=D.createBuffer();D.bindBuffer(D.ARRAY_BUFFER,Et),D.bufferData(D.ARRAY_BUFFER,new Float32Array([-.5,-.5,.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,.5]),D.STATIC_DRAW),D.enableVertexAttribArray(0),D.vertexAttribPointer(0,2,D.FLOAT,!1,0,0);const Tt=D.createTexture();return D.bindTexture(D.TEXTURE_2D,Tt),D.texParameteri(D.TEXTURE_2D,D.TEXTURE_MIN_FILTER,D.NEAREST),D.texParameteri(D.TEXTURE_2D,D.TEXTURE_MAG_FILTER,D.NEAREST),D.texParameteri(D.TEXTURE_2D,D.TEXTURE_WRAP_S,D.CLAMP_TO_EDGE),D.texParameteri(D.TEXTURE_2D,D.TEXTURE_WRAP_T,D.CLAMP_TO_EDGE),Ve.current={program:fe,vao:Qe,texture:Tt,buffer:Et,uniforms:{u_resolution:D.getUniformLocation(fe,"u_resolution"),u_cellSize:D.getUniformLocation(fe,"u_cellSize"),u_offset:D.getUniformLocation(fe,"u_offset"),u_cols:D.getUniformLocation(fe,"u_cols"),u_rows:D.getUniformLocation(fe,"u_rows"),u_playhead:D.getUniformLocation(fe,"u_playhead"),u_layoutMode:D.getUniformLocation(fe,"u_layoutMode"),u_invertChannels:D.getUniformLocation(fe,"u_invertChannels"),u_noteData:D.getUniformLocation(fe,"u_noteData")}},()=>{D.deleteProgram(fe),D.deleteVertexArray(Qe),D.deleteBuffer(Et),D.deleteTexture(Tt)}};X.useEffect(()=>ut(),[r]),X.useEffect(()=>{if(!r.includes("v0.38")&&!r.includes("v0.39")&&!r.includes("v0.40")&&!r.includes("v0.43")&&!r.includes("v0.44"))return;const D=Ge.current,re=Ve.current;if(!D||!re||!n)return;const ue=n.numRows,Me=n.numChannels,ye=Te?Me+1:Me,Re=Te?1:0,Pe=new Uint8Array(ue*ye);for(let fe=0;fe<ue;fe++){const Qe=n.rows[fe]||[];for(let Et=0;Et<Me;Et++){const Tt=Qe[Et],Xt=Tt&&Tt.note!==void 0&&Tt.note>0,Ut=fe*ye+(Et+Re);Pe[Ut]=Xt?255:0}}D.bindTexture(D.TEXTURE_2D,re.texture),D.pixelStorei(D.UNPACK_ALIGNMENT,1),D.texImage2D(D.TEXTURE_2D,0,D.R8UI,ye,ue,0,D.RED_INTEGER,D.UNSIGNED_BYTE,Pe)},[n,Te,r]);const ct=async D=>{if(Ze.current)return;const re=r.includes("v0.39")||r.includes("v0.40")||r.includes("v0.43")||r.includes("v0.44")?"bezel-square.png":"bezel.png";let ue;try{const Re=new Image;Re.src=re,await Re.decode(),ue=await createImageBitmap(Re)}catch(Re){console.warn(`Failed to load ${re}, using fallback.`,Re);const Pe=document.createElement("canvas");Pe.width=1,Pe.height=1;const fe=Pe.getContext("2d");fe&&(fe.fillStyle="rgba(0,0,0,0)",fe.fillRect(0,0,1,1)),ue=await createImageBitmap(Pe)}const Me=D.createTexture({size:[ue.width,ue.height,1],format:Ae(D),usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT});D.queue.copyExternalImageToTexture({source:ue,flipY:!0},{texture:Me},[ue.width,ue.height,1]);const ye=D.createSampler({magFilter:"linear",minFilter:"linear"});Ze.current={sampler:ye,view:Me.createView()}},$e=async D=>{if(I.current)return;const re=r.includes("v0.30")?"unlit-button-2.png":"https://test.1ink.us/xm-player/unlit-button.png";let ue;try{const Pe=new Image;Pe.src=re,Pe.crossOrigin="anonymous",await Pe.decode(),ue=await createImageBitmap(Pe)}catch(Pe){console.warn(`Failed to load button texture (${re}), using fallback.`,Pe);const fe=document.createElement("canvas");fe.width=128,fe.height=128;const Qe=fe.getContext("2d");Qe&&(Qe.fillStyle="#222",Qe.fillRect(0,0,128,128),Qe.strokeStyle="#444",Qe.strokeRect(10,10,108,108)),ue=await createImageBitmap(fe)}const Me=D.createTexture({size:[ue.width,ue.height,1],format:Ae(D),usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT});D.queue.copyExternalImageToTexture({source:ue,flipY:!0},{texture:Me},[ue.width,ue.height,1]);const ye="nearest",Re=D.createSampler({magFilter:ye,minFilter:ye});I.current={sampler:Re,view:Me.createView()}},j=D=>{if(we.current)return;const re=Ae(D),ue=D.createTexture({size:[1,1,1],format:re,usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT});if(re==="rgba32float"){const ye=new Float32Array([.39215686274509803,.39215686274509803,.39215686274509803,1]);D.queue.writeTexture({texture:ue},ye,{bytesPerRow:16},{width:1,height:1})}else{const ye=new Uint8Array([100,100,100,255]);D.queue.writeTexture({texture:ue},ye,{bytesPerRow:4},{width:1,height:1})}we.current=ue;const Me=D.createSampler({magFilter:"linear",minFilter:"linear"});I.current={sampler:Me,view:ue.createView()}},Ae=D=>D.features.has("float32-filterable")?"rgba32float":"rgba8unorm",Ye=D=>{if(!je.current||!H.current||!Le.current)return;const re=je.current.getBindGroupLayout(0),ue=te.current,Me=[{binding:0,resource:{buffer:H.current,size:H.current.size}},{binding:1,resource:{buffer:Le.current}}];if(ue==="extended"){if(!xe.current||!oe.current||!I.current)return;Me.push({binding:2,resource:{buffer:xe.current}},{binding:3,resource:{buffer:oe.current}},{binding:4,resource:I.current.sampler},{binding:5,resource:I.current.view})}else if(ue==="texture"){if(!I.current)return;Me.push({binding:2,resource:I.current.sampler},{binding:3,resource:I.current.view})}ke.current=D.createBindGroup({layout:re,entries:Me})};X.useEffect(()=>{const D=G.current;if(!D)return;if(!("gpu"in navigator)){F(!1);return}let re=!1;return(async()=>{var Me,ye;try{const Re=await navigator.gpu.requestAdapter();if(!Re||re){F(!1);return}const Pe=[];Re.features.has("float32-filterable")&&Pe.push("float32-filterable"),Re.features.has("float32-blendable")&&Pe.push("float32-blendable"),Re.features.has("clip-distances")&&Pe.push("clip-distances"),Re.features.has("depth32float-stencil8")&&Pe.push("depth32float-stencil8"),Re.features.has("dual-source-blending")&&Pe.push("dual-source-blending"),Re.features.has("subgroups")&&Pe.push("subgroups"),Re.features.has("texture-component-swizzle")&&Pe.push("texture-component-swizzle"),Re.features.has("shader-f16")&&Pe.push("shader-f16");const fe=await Re.requestDevice({requiredFeatures:Pe});if(!fe||re){F(!1);return}const Qe=D.getContext("webgpu"),Et=navigator.gpu.getPreferredCanvasFormat();Qe.configure({device:fe,format:Et}),I.current=null,Ze.current=null;const Tt=await fetch(`./shaders/${r}`).then(q=>q.text());if(re)return;const Xt=fe.createShaderModule({code:Tt});"getCompilationInfo"in Xt&&Xt.getCompilationInfo().catch(()=>{});const Ut=x3(r);te.current=Ut,Ue.current=Ut==="extended",Ut!=="extended"&&((Me=xe.current)==null||Me.destroy(),xe.current=null,(ye=oe.current)==null||ye.destroy(),oe.current=null);let Xe;Ut==="texture"?Xe=fe.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.FRAGMENT|GPUShaderStage.VERTEX,buffer:{type:"read-only-storage"}},{binding:1,visibility:GPUShaderStage.FRAGMENT|GPUShaderStage.VERTEX,buffer:{type:"uniform"}},{binding:2,visibility:GPUShaderStage.FRAGMENT,sampler:{type:"filtering"}},{binding:3,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"float"}}]}):Ut==="extended"?Xe=fe.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.FRAGMENT|GPUShaderStage.VERTEX,buffer:{type:"read-only-storage"}},{binding:1,visibility:GPUShaderStage.FRAGMENT|GPUShaderStage.VERTEX,buffer:{type:"uniform"}},{binding:2,visibility:GPUShaderStage.FRAGMENT,buffer:{type:"read-only-storage"}},{binding:3,visibility:GPUShaderStage.FRAGMENT,buffer:{type:"read-only-storage"}},{binding:4,visibility:GPUShaderStage.FRAGMENT,sampler:{type:"filtering"}},{binding:5,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"float"}}]}):Xe=fe.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.FRAGMENT|GPUShaderStage.VERTEX,buffer:{type:"read-only-storage"}},{binding:1,visibility:GPUShaderStage.FRAGMENT|GPUShaderStage.VERTEX,buffer:{type:"uniform"}}]});const Ft=E3(r),jt=[{format:Et,...Ft?{blend:{color:{srcFactor:"src-alpha",dstFactor:"one-minus-src-alpha",operation:"add"},alpha:{srcFactor:"one",dstFactor:"one-minus-src-alpha",operation:"add"}}}:{}}];try{je.current=fe.createRenderPipeline({layout:fe.createPipelineLayout({bindGroupLayouts:[Xe]}),vertex:{module:Xt,entryPoint:"vs"},fragment:{module:Xt,entryPoint:"fs",targets:jt},primitive:{topology:"triangle-list"}})}catch{je.current=fe.createRenderPipeline({layout:fe.createPipelineLayout({bindGroupLayouts:[Xe]}),vertex:{module:Xt,entryPoint:"vertex_main"},fragment:{module:Xt,entryPoint:"fragment_main",targets:jt},primitive:{topology:"triangle-list"}})}const $t=Ut==="extended"?80:Ut==="texture"?64:32,Yn=fe.createBuffer({size:rM($t,256),usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST});if(M3(r))try{const q=w3(r),ae=await fetch(`./shaders/${q}`).then(We=>We.text()),ce=fe.createShaderModule({code:ae}),ie=fe.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.FRAGMENT,buffer:{type:"uniform"}},{binding:1,visibility:GPUShaderStage.FRAGMENT,sampler:{type:"filtering"}},{binding:2,visibility:GPUShaderStage.FRAGMENT,texture:{sampleType:"float"}}]});Ee.current=fe.createRenderPipeline({layout:fe.createPipelineLayout({bindGroupLayouts:[ie]}),vertex:{module:ce,entryPoint:"vs"},fragment:{module:ce,entryPoint:"fs",targets:[{format:Et}]},primitive:{topology:"triangle-list"}}),Oe.current=fe.createBuffer({size:rM(96,256),usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),await ct(fe),Ke.current=fe.createBindGroup({layout:ie,entries:[{binding:0,resource:{buffer:Oe.current}},{binding:1,resource:Ze.current.sampler},{binding:2,resource:Ze.current.view}]})}catch(q){console.warn("Failed to initialize bezel shader",q)}else Ee.current=null,Ke.current=null,Oe.current&&(Oe.current.destroy(),Oe.current=null);Fe.current=fe,Ne.current=Qe,Le.current=Yn;const Hi=r.includes("v0.36")||r.includes("v0.37")||r.includes("v0.38")||r.includes("v0.39")||r.includes("v0.40")||r.includes("v0.43")||r.includes("v0.44")||r.includes("v0.45")?aM:oM;if(H.current=Ka(fe,Hi(n,Te),GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST),Ut==="extended"){const q=(n==null?void 0:n.numRows)??ia;xe.current=Ka(fe,lM(q),GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST);const ae=Math.max(1,(n==null?void 0:n.numChannels)??_s),ce=sM([],ae,Te);oe.current=Ka(fe,ce,GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST)}(Ut==="texture"||Ut==="extended")&&(r.includes("v0.20")||r.includes("v0.23")||r.includes("v0.24")||r.includes("v0.25")?j(fe):await $e(fe)),Ye(fe),Be(!0)}catch(Re){console.error("Failed to initialize WebGPU pattern display",Re),re||F(!1)}})(),()=>{if(re=!0,F(!0),Be(!1),ke.current=null,je.current=null,Oe.current&&(Oe.current.destroy(),Oe.current=null),Ke.current=null,Ee.current=null,Ze.current=null,ve.current!==null&&(window.clearTimeout(ve.current),ve.current=null),H.current=null,Le.current=null,xe.current=null,oe.current=null,I.current=null,we.current){const Me=Fe.current;if(Me)Me.queue.onSubmittedWorkDone().then(()=>{var ye;try{(ye=we.current)==null||ye.destroy()}catch{}we.current=null}).catch(()=>{var ye;try{(ye=we.current)==null||ye.destroy()}catch{}we.current=null});else{try{we.current.destroy()}catch{}we.current=null}}Fe.current=null,Ne.current=null}},[r]),X.useEffect(()=>{var Me;const D=Fe.current;if(!D||!Ie)return;H.current&&H.current.destroy();const ue=r.includes("v0.36")||r.includes("v0.37")||r.includes("v0.38")||r.includes("v0.39")||r.includes("v0.40")||r.includes("v0.43")||r.includes("v0.44")||r.includes("v0.45")?aM:oM;if(H.current=Ka(D,ue(n,Te),GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST),te.current==="extended"){const ye=(n==null?void 0:n.numRows)??ia,Re=lM(ye);!xe.current||xe.current.size<Re.byteLength?((Me=xe.current)==null||Me.destroy(),xe.current=Ka(D,Re,GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST)):D.queue.writeBuffer(xe.current,0,Re.buffer,Re.byteOffset,Re.byteLength)}Ye(D)},[n,Ie]),X.useEffect(()=>{var re;const D=Fe.current;if(!(!D||!Ie)&&te.current==="extended"){const ue=Math.max(1,(n==null?void 0:n.numChannels)??_s),Me=sM(f,ue,Te);let ye=!1;!oe.current||oe.current.size<Me.byteLength?((re=oe.current)==null||re.destroy(),oe.current=Ka(D,Me,GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST),ye=!0):D.queue.writeBuffer(oe.current,0,Me),ye&&Ye(D)}},[f,n==null?void 0:n.numChannels,Ie]);const Je=D=>{var ie;if(console.log("handleCanvasClick called"),!r.includes("v0.37")&&!r.includes("v0.38")&&!r.includes("v0.39")&&!r.includes("v0.40")&&!r.includes("v0.42")&&!r.includes("v0.43")&&!r.includes("v0.44")&&!r.includes("v0.45"))return;const re=D.currentTarget.getBoundingClientRect(),ue=D.clientX-re.left,Me=D.clientY-re.top,ye=ue/re.width-.5,Re=.5-Me/re.height,Pe=r.includes("v0.40")||r.includes("v0.43")||r.includes("v0.44")||r.includes("v0.45"),fe=We=>{ve.current!==null&&window.clearTimeout(ve.current),ge(We),ve.current=window.setTimeout(()=>{ge(0),ve.current=null},200)};if(Math.abs(ye-.26)<.05&&Math.abs(Re-.42)<.05){fe(2),(ie=ne.current)==null||ie.click();return}if(Math.abs(ye+.26)<.05&&Math.abs(Re-.42)<.05){fe(1),O==null||O();return}if(Math.abs(Re-.32)<.04){if(Math.abs(ye+.12)<.04){fe(5),C&&C(Math.max(0,e-16));return}if(Math.abs(ye-.12)<.04){fe(6),C&&C(e+16);return}}const Qe=Pe?.08:.28,Et=.415,Tt=.18;if(Math.abs(ye-Qe)<Tt*.5&&Math.abs(Re-Et)<.05*.5){const at=(ye-Qe)/(Tt*.9)+.5;R==null||R(Math.max(0,Math.min(1,at)));return}const Ut=.42,Xe=-.2,Ft=.2;if(Math.abs(ye-Ut)<.03&&Math.abs(Re-Xe)<Ft*.5){const We=(Re-Xe)/(Ft*.45);B==null||B(Math.max(-1,Math.min(1,We)));return}const $t=-.45,Yn=.6,gi=.1;if(Math.abs(Re-$t)<.03&&Math.abs(ye-gi)<Yn/2){const We=ye-(gi-Yn/2);C&&C(Math.floor(Math.max(0,Math.min(1,We/Yn))*($||64)));return}const U=.045,q=(We,at,pt,mt)=>Math.sqrt((We-pt)**2+(at-mt)**2),ae=Pe?-.45:-.4,ce=Pe?-.45:-.4;if(q(ye,Re,-.44,ae)<U){fe(3),P==null||P();return}if(q(ye,Re,-.35,ce)<U){fe(4),b==null||b();return}},De=()=>{const D=Ge.current,re=Ve.current,ue=r.includes("v0.38")||r.includes("v0.39")||r.includes("v0.40")||r.includes("v0.42")||r.includes("v0.43")||r.includes("v0.44");if(!D||!re||!ue||!n)return;const{program:Me,vao:ye,texture:Re,uniforms:Pe}=re,{width:fe,height:Qe}=ot,Et=Te?(n.numChannels||_s)+1:n.numChannels||_s,Tt=n.numRows||ia;D.viewport(0,0,fe,Qe),D.clearColor(0,0,0,0),D.clear(D.COLOR_BUFFER_BIT),D.useProgram(Me),D.bindVertexArray(ye),D.uniform2f(Pe.u_resolution,fe,Qe),D.uniform1f(Pe.u_cols,Et),D.uniform1f(Pe.u_rows,Tt),D.uniform1f(Pe.u_playhead,e),D.uniform1i(Pe.u_invertChannels,Q?1:0),D.activeTexture(D.TEXTURE0),D.bindTexture(D.TEXTURE_2D,Re),D.uniform1i(Pe.u_noteData,0);let Xt=t,Ut=i,Xe=1;r.includes("v0.40")||r.includes("v0.43")?(Xt=705/32,Ut=725/Et,D.uniform2f(Pe.u_offset,160,160),Xe=2):r.includes("v0.44")?(Xt=705/64,Ut=725/Et,D.uniform2f(Pe.u_offset,160,160),Xe=3):r.includes("v0.39")?(Xt=ot.width/32,Ut=ot.height/Et,D.uniform2f(Pe.u_offset,0,0),Xe=2):(r.includes("v0.45"),D.uniform2f(Pe.u_offset,0,0),Xe=1),D.uniform2f(Pe.u_cellSize,Xt,Ut),D.uniform1i(Pe.u_layoutMode,Xe),D.enable(D.BLEND),D.blendFunc(D.SRC_ALPHA,D.ONE_MINUS_SRC_ALPHA);const Ft=Tt*Et;D.drawArraysInstanced(D.TRIANGLES,0,6,Ft),D.bindVertexArray(null)},Y=D=>{D.target.files&&D.target.files.length>0&&(L==null||L(D.target.files[0]))},pe=()=>{var Ut;const D=Fe.current,re=Ne.current,ue=je.current,Me=ke.current;if(!D||!re||!ue||!Me||!Le.current||!H.current)return;if(Le.current){const Xe=(n==null?void 0:n.numRows)??ia,Ft=(n==null?void 0:n.numChannels)??_s,jt=Te?Ft+1:Ft,$t=Math.max(1,Xe),Yn=A3(e,$t),gi=Math.min(1,Math.max(0,c)),Hi=y?a:W;let U=t,q=i;r.includes("v0.40")||r.includes("v0.43")||r.includes("v0.44")||r.includes("v0.45")?(U=705/32,q=725/jt):r.includes("v0.39")&&(U=ot.width/32,q=ot.height/jt);const ae=T3(te.current,{numRows:Xe,numChannels:jt,playheadRow:Yn,isPlaying:s,cellW:U,cellH:q,canvasW:ot.width,canvasH:ot.height,tickOffset:gi,bpm:o,timeSec:Hi,beatPhase:d,groove:Math.min(1,Math.max(0,h)),kickTrigger:m,activeChannels:v,isModuleLoaded:y,bloomIntensity:x??1,bloomThreshold:g??.8,invertChannels:Q,dimFactor:me});D.queue.writeBuffer(Le.current,0,ae)}if(Oe.current){const Xe=new Float32Array(24);Xe[0]=ot.width,Xe[1]=ot.height;const Ft=Math.min(ot.width,ot.height),jt=S3(r);Xe[2]=Ft*(jt?.05:.07),Xe[3]=.98,Xe[4]=.98,Xe[5]=.98,Xe[6]=.92,Xe[7]=.92,Xe[8]=.93,Xe[9]=.02,r.includes("v0.35")?(Xe[10]=0,Xe[11]=.95,Xe[12]=.32):(Xe[10]=jt?0:1,Xe[11]=jt?1:1.25,Xe[12]=jt?1:0),Xe[13]=.1,Xe[14]=me,Xe[15]=s?1:0,Xe[16]=S,Xe[17]=M,Xe[18]=o;const $t=new Uint32Array(Xe.buffer);$t[19]=T?1:0,$t[20]=0,$t[21]=e,$t[22]=J,D.queue.writeBuffer(Oe.current,0,Xe.buffer,Xe.byteOffset,Xe.byteLength)}if((r.includes("v0.20")||r.includes("v0.23")||r.includes("v0.24")||r.includes("v0.25"))&&Ce.current){const Xe=Ce.current;let Ft=0,jt=0,$t=!1;if(Xe instanceof HTMLVideoElement&&Xe.readyState>=2?(Ft=Xe.videoWidth,jt=Xe.videoHeight,$t=!0):Xe instanceof HTMLImageElement&&Xe.complete&&(Ft=Xe.naturalWidth,jt=Xe.naturalHeight,$t=!0),$t&&Ft>0&&jt>0){(!we.current||we.current.width!==Ft||we.current.height!==jt)&&((Ut=we.current)==null||Ut.destroy(),we.current=D.createTexture({size:[Ft,jt,1],format:Ae(D),usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT}),I.current={sampler:D.createSampler({magFilter:"linear",minFilter:"linear"}),view:we.current.createView()},Ye(D));try{we.current&&D.queue.copyExternalImageToTexture({source:Xe,flipY:!0},{texture:we.current},[Ft,jt,1])}catch{}}}const Re=D.createCommandEncoder(),Pe=Re.beginRenderPass({colorAttachments:[{view:re.getCurrentTexture().createView(),loadOp:"clear",clearValue:{r:.98,g:.98,b:.98,a:1},storeOp:"store"}]});Ee.current&&Ke.current&&(Pe.setPipeline(Ee.current),Pe.setBindGroup(0,Ke.current),Pe.draw(6,1,0,0)),Pe.setPipeline(ue),Pe.setBindGroup(0,Me);const fe=(n==null?void 0:n.numRows)??ia,Qe=(n==null?void 0:n.numChannels)??_s,Et=Te?Qe+1:Qe;let Tt=fe*Et;r.includes("v0.45")&&(Tt+=3),Tt>0&&(SA(r)&&(r.includes("v0.45")||Pe.draw(6,1,0,Tt)),Pe.draw(6,Tt,0,0)),Pe.end(),D.queue.submit([Re.finish()]),De()};return X.useEffect(()=>{lt.current=pe}),X.useEffect(()=>{const D=re=>{N.current=requestAnimationFrame(D),!y&&!s&&V(re/1e3),lt.current&&lt.current()};return N.current=requestAnimationFrame(D),()=>{N.current&&cancelAnimationFrame(N.current)}},[y,s]),de.jsxs("div",{className:`pattern-display relative ${Te&&!r.includes("v0.40")&&!r.includes("v0.43")&&!r.includes("v0.44")?"p-8 rounded-xl bg-[#18181a] shadow-2xl border border-[#333]":""}`,children:[de.jsx("input",{type:"file",ref:ne,onChange:Y,className:"hidden",accept:".mod,.xm,.it,.s3m,.mptm"}),Te&&de.jsxs(de.Fragment,{children:[de.jsxs("div",{className:"absolute top-0 bottom-0 left-0 w-8 bg-[#111] border-r border-[#000] flex flex-col justify-between py-4 items-center rounded-l-xl",children:[de.jsx("div",{className:"w-3 h-3 rounded-full bg-[#222] border border-[#444] shadow-inner flex items-center justify-center",children:de.jsx("div",{className:"w-2 h-0.5 bg-[#111] rotate-45"})}),de.jsx("div",{className:"w-3 h-3 rounded-full bg-[#222] border border-[#444] shadow-inner flex items-center justify-center",children:de.jsx("div",{className:"w-2 h-0.5 bg-[#111] rotate-45"})})]}),de.jsxs("div",{className:"absolute top-0 bottom-0 right-0 w-8 bg-[#111] border-l border-[#000] flex flex-col justify-between py-4 items-center rounded-r-xl",children:[de.jsx("div",{className:"w-3 h-3 rounded-full bg-[#222] border border-[#444] shadow-inner flex items-center justify-center",children:de.jsx("div",{className:"w-2 h-0.5 bg-[#111] rotate-45"})}),de.jsx("div",{className:"w-3 h-3 rounded-full bg-[#222] border border-[#444] shadow-inner flex items-center justify-center",children:de.jsx("div",{className:"w-2 h-0.5 bg-[#111] rotate-45"})})]}),de.jsxs("div",{className:"absolute top-2 right-12 flex items-center gap-3",children:[de.jsx("div",{className:"text-[10px] font-mono font-bold text-gray-500 tracking-widest uppercase opacity-70",children:"Tracker GPU-9000"}),de.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500 shadow-[0_0_8px_rgba(255,50,50,0.8)]"})]})]}),(r.includes("v0.35")||r.includes("v0.37")||r.includes("v0.38")||r.includes("v0.39")||r.includes("v0.40")||r.includes("v0.43")||r.includes("v0.44"))&&de.jsx("button",{onClick:()=>se(D=>!D),className:"absolute top-2 left-12 px-2 py-1 bg-[#222] text-xs font-mono text-gray-400 border border-[#444] rounded hover:bg-[#333] hover:text-white transition-colors",children:Q?"[INNER LOW]":"[OUTER LOW]"}),de.jsx("canvas",{ref:G,width:ot.width,height:ot.height,onClick:Je,className:`${Te&&!r.includes("v0.40")&&!r.includes("v0.43")&&!r.includes("v0.44")?"rounded bg-black shadow-inner border border-black/50":""} cursor-pointer`,style:{maxWidth:"100%",maxHeight:"100%",width:"auto",height:"auto",objectFit:"contain",aspectRatio:`${ot.width} / ${ot.height}`,position:"relative"}}),de.jsx("canvas",{ref:Z,width:ot.width,height:ot.height,className:"absolute top-0 left-0",style:{width:"100%",height:"100%",objectFit:"contain",aspectRatio:`${ot.width} / ${ot.height}`,zIndex:2,pointerEvents:"none"}}),!he&&de.jsx("div",{className:"error",children:"WebGPU not available in this browser."})]})},cM=({item:n,visible:e,opacity:t=.9,fit:i="contain",onClose:r,onUpdate:s})=>{const o=X.useRef(null),[a,c]=X.useState({x:0,y:0}),[f,d]=X.useState(!1),h=X.useRef(null);if(X.useEffect(()=>{c({x:0,y:0})},[n==null?void 0:n.id]),!n||!e)return null;const m=x=>{d(!0),h.current={x:x.clientX-a.x,y:x.clientY-a.y}},v=x=>{!f||!h.current||c({x:x.clientX-h.current.x,y:x.clientY-h.current.y})},y=()=>{d(!1),h.current=null},w=n.kind==="video";return de.jsx("div",{className:"absolute inset-0 pointer-events-none z-40",children:de.jsxs("div",{ref:o,className:"pointer-events-auto rounded-lg overflow-hidden border border-white/10 shadow-2xl",style:{position:"absolute",left:a.x,top:a.y,opacity:t,maxWidth:"90%",maxHeight:"80%",cursor:f?"grabbing":"grab"},onMouseDown:m,onMouseMove:v,onMouseUp:y,onMouseLeave:y,children:[de.jsxs("div",{className:"bg-black p-1 flex justify-end gap-2",children:[de.jsx("button",{onClick:()=>s==null?void 0:s({fit:i==="contain"?"cover":"contain"}),className:"text-xs text-gray-300 px-2",children:"Fit"}),de.jsx("button",{onClick:()=>s==null?void 0:s({muted:!n.muted}),className:"text-xs text-gray-300 px-2",children:"Mute"}),de.jsx("button",{onClick:r,className:"text-xs text-red-400 px-2",children:"Close"})]}),de.jsx("div",{className:"flex items-center justify-center bg-black",children:w?de.jsx("video",{src:n.url,controls:!0,autoPlay:!0,muted:!!n.muted,loop:!!n.loop,style:{width:"100%",height:"100%",objectFit:i}}):de.jsx("img",{src:n.url,alt:n.fileName||"media",style:{width:"100%",height:"100%",objectFit:i}})})]})})};/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const Xp="160",$o={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},ea={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},MA=0,Dv=1,wA=2,C3=3,EA=0,jp=1,pc=2,Rr=3,Ns=0,Ei=1,Ki=2,R3=2,Cs=0,pa=1,Uv=2,Ov=3,kv=4,TA=5,so=100,AA=101,bA=102,Fv=103,zv=104,CA=200,RA=201,PA=202,LA=203,Mp=204,wp=205,IA=206,NA=207,DA=208,UA=209,OA=210,kA=211,FA=212,zA=213,BA=214,HA=0,VA=1,GA=2,kc=3,WA=4,XA=5,jA=6,YA=7,ff=0,qA=1,ZA=2,es=0,KA=1,JA=2,QA=3,M_=4,$A=5,eb=6,Bv="attached",tb="detached",Yp=300,Ds=301,Mo=302,Fc=303,zc=304,cu=306,Bc=1e3,fi=1001,Hc=1002,Tn=1003,Ep=1004,P3=1004,mc=1005,L3=1005,fn=1006,w_=1007,I3=1007,wo=1008,N3=1008,ts=1009,nb=1010,ib=1011,qp=1012,E_=1013,Ts=1014,vr=1015,Ea=1016,T_=1017,A_=1018,vo=1020,rb=1021,Mi=1023,sb=1024,ob=1025,yo=1026,Ta=1027,ab=1028,b_=1029,lb=1030,C_=1031,R_=1033,Wh=33776,Xh=33777,jh=33778,Yh=33779,Hv=35840,Vv=35841,Gv=35842,Wv=35843,P_=36196,Xv=37492,jv=37496,Yv=37808,qv=37809,Zv=37810,Kv=37811,Jv=37812,Qv=37813,$v=37814,ey=37815,ty=37816,ny=37817,iy=37818,ry=37819,sy=37820,oy=37821,qh=36492,ay=36494,ly=36495,ub=36283,uy=36284,cy=36285,fy=36286,cb=2200,fb=2201,db=2202,Vc=2300,Gc=2301,Zh=2302,la=2400,ua=2401,Wc=2402,Zp=2500,L_=2501,D3=0,U3=1,O3=2,I_=3e3,_o=3001,hb=3200,pb=3201,Co=0,mb=1,Ji="",Un="srgb",rs="srgb-linear",Kp="display-p3",df="display-p3-linear",Xc="linear",tn="srgb",jc="rec709",Yc="p3",k3=0,ta=7680,F3=7681,z3=7682,B3=7683,H3=34055,V3=34056,G3=5386,W3=512,X3=513,j3=514,Y3=515,q3=516,Z3=517,K3=518,dy=519,gb=512,vb=513,yb=514,N_=515,_b=516,xb=517,Sb=518,Mb=519,qc=35044,J3=35048,Q3=35040,$3=35045,eL=35049,tL=35041,nL=35046,iL=35050,rL=35042,sL="100",hy="300 es",Tp=1035,Nr=2e3,nu=2001;let ks=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const i=this._listeners;return i[e]!==void 0&&i[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const i=this._listeners[e.type];if(i!==void 0){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}};const oi=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let fM=1234567;const ma=Math.PI/180,iu=180/Math.PI;function er(){const n=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(oi[n&255]+oi[n>>8&255]+oi[n>>16&255]+oi[n>>24&255]+"-"+oi[e&255]+oi[e>>8&255]+"-"+oi[e>>16&15|64]+oi[e>>24&255]+"-"+oi[t&63|128]+oi[t>>8&255]+"-"+oi[t>>16&255]+oi[t>>24&255]+oi[i&255]+oi[i>>8&255]+oi[i>>16&255]+oi[i>>24&255]).toLowerCase()}function xn(n,e,t){return Math.max(e,Math.min(t,n))}function D_(n,e){return(n%e+e)%e}function oL(n,e,t,i,r){return i+(n-e)*(r-i)/(t-e)}function aL(n,e,t){return n!==e?(t-n)/(e-n):0}function gc(n,e,t){return(1-t)*n+t*e}function lL(n,e,t,i){return gc(n,e,1-Math.exp(-t*i))}function uL(n,e=1){return e-Math.abs(D_(n,e*2)-e)}function cL(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*(3-2*n))}function fL(n,e,t){return n<=e?0:n>=t?1:(n=(n-e)/(t-e),n*n*n*(n*(n*6-15)+10))}function dL(n,e){return n+Math.floor(Math.random()*(e-n+1))}function hL(n,e){return n+Math.random()*(e-n)}function pL(n){return n*(.5-Math.random())}function mL(n){n!==void 0&&(fM=n);let e=fM+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function gL(n){return n*ma}function vL(n){return n*iu}function py(n){return(n&n-1)===0&&n!==0}function yL(n){return Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))}function Ap(n){return Math.pow(2,Math.floor(Math.log(n)/Math.LN2))}function _L(n,e,t,i,r){const s=Math.cos,o=Math.sin,a=s(t/2),c=o(t/2),f=s((e+i)/2),d=o((e+i)/2),h=s((e-i)/2),m=o((e-i)/2),v=s((i-e)/2),y=o((i-e)/2);switch(r){case"XYX":n.set(a*d,c*h,c*m,a*f);break;case"YZY":n.set(c*m,a*d,c*h,a*f);break;case"ZXZ":n.set(c*h,c*m,a*d,a*f);break;case"XZX":n.set(a*d,c*y,c*v,a*f);break;case"YXY":n.set(c*v,a*d,c*y,a*f);break;case"ZYZ":n.set(c*y,c*v,a*d,a*f);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}function Ui(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return n/4294967295;case Uint16Array:return n/65535;case Uint8Array:return n/255;case Int32Array:return Math.max(n/2147483647,-1);case Int16Array:return Math.max(n/32767,-1);case Int8Array:return Math.max(n/127,-1);default:throw new Error("Invalid component type.")}}function Lt(n,e){switch(e.constructor){case Float32Array:return n;case Uint32Array:return Math.round(n*4294967295);case Uint16Array:return Math.round(n*65535);case Uint8Array:return Math.round(n*255);case Int32Array:return Math.round(n*2147483647);case Int16Array:return Math.round(n*32767);case Int8Array:return Math.round(n*127);default:throw new Error("Invalid component type.")}}const U_={DEG2RAD:ma,RAD2DEG:iu,generateUUID:er,clamp:xn,euclideanModulo:D_,mapLinear:oL,inverseLerp:aL,lerp:gc,damp:lL,pingpong:uL,smoothstep:cL,smootherstep:fL,randInt:dL,randFloat:hL,randFloatSpread:pL,seededRandom:mL,degToRad:gL,radToDeg:vL,isPowerOfTwo:py,ceilPowerOfTwo:yL,floorPowerOfTwo:Ap,setQuaternionFromProperEuler:_L,normalize:Lt,denormalize:Ui};class be{constructor(e=0,t=0){be.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(xn(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const i=Math.cos(t),r=Math.sin(t),s=this.x-e.x,o=this.y-e.y;return this.x=s*i-o*r+e.x,this.y=s*r+o*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Nt{constructor(e,t,i,r,s,o,a,c,f){Nt.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,i,r,s,o,a,c,f)}set(e,t,i,r,s,o,a,c,f){const d=this.elements;return d[0]=e,d[1]=r,d[2]=a,d[3]=t,d[4]=s,d[5]=c,d[6]=i,d[7]=o,d[8]=f,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[3],c=i[6],f=i[1],d=i[4],h=i[7],m=i[2],v=i[5],y=i[8],w=r[0],x=r[3],g=r[6],S=r[1],M=r[4],T=r[7],P=r[2],b=r[5],L=r[8];return s[0]=o*w+a*S+c*P,s[3]=o*x+a*M+c*b,s[6]=o*g+a*T+c*L,s[1]=f*w+d*S+h*P,s[4]=f*x+d*M+h*b,s[7]=f*g+d*T+h*L,s[2]=m*w+v*S+y*P,s[5]=m*x+v*M+y*b,s[8]=m*g+v*T+y*L,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],f=e[7],d=e[8];return t*o*d-t*a*f-i*s*d+i*a*c+r*s*f-r*o*c}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],f=e[7],d=e[8],h=d*o-a*f,m=a*c-d*s,v=f*s-o*c,y=t*h+i*m+r*v;if(y===0)return this.set(0,0,0,0,0,0,0,0,0);const w=1/y;return e[0]=h*w,e[1]=(r*f-d*i)*w,e[2]=(a*i-r*o)*w,e[3]=m*w,e[4]=(d*t-r*c)*w,e[5]=(r*s-a*t)*w,e[6]=v*w,e[7]=(i*c-f*t)*w,e[8]=(o*t-i*s)*w,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,s,o,a){const c=Math.cos(s),f=Math.sin(s);return this.set(i*c,i*f,-i*(c*o+f*a)+o+e,-r*f,r*c,-r*(-f*o+c*a)+a+t,0,0,1),this}scale(e,t){return this.premultiply(Kg.makeScale(e,t)),this}rotate(e){return this.premultiply(Kg.makeRotation(-e)),this}translate(e,t){return this.premultiply(Kg.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<9;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const Kg=new Nt;function wb(n){for(let e=n.length-1;e>=0;--e)if(n[e]>=65535)return!0;return!1}const xL={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Ol(n,e){return new xL[n](e)}function Zc(n){return document.createElementNS("http://www.w3.org/1999/xhtml",n)}function Eb(){const n=Zc("canvas");return n.style.display="block",n}const dM={};function vc(n){n in dM||(dM[n]=!0,console.warn(n))}const hM=new Nt().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),pM=new Nt().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),Ud={[rs]:{transfer:Xc,primaries:jc,toReference:n=>n,fromReference:n=>n},[Un]:{transfer:tn,primaries:jc,toReference:n=>n.convertSRGBToLinear(),fromReference:n=>n.convertLinearToSRGB()},[df]:{transfer:Xc,primaries:Yc,toReference:n=>n.applyMatrix3(pM),fromReference:n=>n.applyMatrix3(hM)},[Kp]:{transfer:tn,primaries:Yc,toReference:n=>n.convertSRGBToLinear().applyMatrix3(pM),fromReference:n=>n.applyMatrix3(hM).convertLinearToSRGB()}},SL=new Set([rs,df]),Yt={enabled:!0,_workingColorSpace:rs,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(n){if(!SL.has(n))throw new Error(`Unsupported working color space, "${n}".`);this._workingColorSpace=n},convert:function(n,e,t){if(this.enabled===!1||e===t||!e||!t)return n;const i=Ud[e].toReference,r=Ud[t].fromReference;return r(i(n))},fromWorkingColorSpace:function(n,e){return this.convert(n,this._workingColorSpace,e)},toWorkingColorSpace:function(n,e){return this.convert(n,e,this._workingColorSpace)},getPrimaries:function(n){return Ud[n].primaries},getTransfer:function(n){return n===Ji?Xc:Ud[n].transfer}};function ql(n){return n<.04045?n*.0773993808:Math.pow(n*.9478672986+.0521327014,2.4)}function Jg(n){return n<.0031308?n*12.92:1.055*Math.pow(n,.41666)-.055}let Ja;class O_{static getDataURL(e){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let t;if(e instanceof HTMLCanvasElement)t=e;else{Ja===void 0&&(Ja=Zc("canvas")),Ja.width=e.width,Ja.height=e.height;const i=Ja.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=Ja}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=Zc("canvas");t.width=e.width,t.height=e.height;const i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);const r=i.getImageData(0,0,e.width,e.height),s=r.data;for(let o=0;o<s.length;o++)s[o]=ql(s[o]/255)*255;return i.putImageData(r,0,0),t}else if(e.data){const t=e.data.slice(0);for(let i=0;i<t.length;i++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[i]=Math.floor(ql(t[i]/255)*255):t[i]=ql(t[i]);return{data:t,width:e.width,height:e.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let ML=0;class ca{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:ML++}),this.uuid=er(),this.data=e,this.version=0}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const i={uuid:this.uuid,url:""},r=this.data;if(r!==null){let s;if(Array.isArray(r)){s=[];for(let o=0,a=r.length;o<a;o++)r[o].isDataTexture?s.push(Qg(r[o].image)):s.push(Qg(r[o]))}else s=Qg(r);i.url=s}return t||(e.images[this.uuid]=i),i}}function Qg(n){return typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&n instanceof ImageBitmap?O_.getDataURL(n):n.data?{data:Array.from(n.data),width:n.width,height:n.height,type:n.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let wL=0;class bn extends ks{constructor(e=bn.DEFAULT_IMAGE,t=bn.DEFAULT_MAPPING,i=fi,r=fi,s=fn,o=wo,a=Mi,c=ts,f=bn.DEFAULT_ANISOTROPY,d=Ji){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:wL++}),this.uuid=er(),this.name="",this.source=new ca(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=i,this.wrapT=r,this.magFilter=s,this.minFilter=o,this.anisotropy=f,this.format=a,this.internalFormat=null,this.type=c,this.offset=new be(0,0),this.repeat=new be(1,1),this.center=new be(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Nt,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,typeof d=="string"?this.colorSpace=d:(vc("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=d===_o?Un:Ji),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const i={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),t||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==Yp)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Bc:e.x=e.x-Math.floor(e.x);break;case fi:e.x=e.x<0?0:1;break;case Hc:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Bc:e.y=e.y-Math.floor(e.y);break;case fi:e.y=e.y<0?0:1;break;case Hc:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return vc("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===Un?_o:I_}set encoding(e){vc("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=e===_o?Un:Ji}}bn.DEFAULT_IMAGE=null;bn.DEFAULT_MAPPING=Yp;bn.DEFAULT_ANISOTROPY=1;class qt{constructor(e=0,t=0,i=0,r=1){qt.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=this.w,o=e.elements;return this.x=o[0]*t+o[4]*i+o[8]*r+o[12]*s,this.y=o[1]*t+o[5]*i+o[9]*r+o[13]*s,this.z=o[2]*t+o[6]*i+o[10]*r+o[14]*s,this.w=o[3]*t+o[7]*i+o[11]*r+o[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r,s;const c=e.elements,f=c[0],d=c[4],h=c[8],m=c[1],v=c[5],y=c[9],w=c[2],x=c[6],g=c[10];if(Math.abs(d-m)<.01&&Math.abs(h-w)<.01&&Math.abs(y-x)<.01){if(Math.abs(d+m)<.1&&Math.abs(h+w)<.1&&Math.abs(y+x)<.1&&Math.abs(f+v+g-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const M=(f+1)/2,T=(v+1)/2,P=(g+1)/2,b=(d+m)/4,L=(h+w)/4,O=(y+x)/4;return M>T&&M>P?M<.01?(i=0,r=.707106781,s=.707106781):(i=Math.sqrt(M),r=b/i,s=L/i):T>P?T<.01?(i=.707106781,r=0,s=.707106781):(r=Math.sqrt(T),i=b/r,s=O/r):P<.01?(i=.707106781,r=.707106781,s=0):(s=Math.sqrt(P),i=L/s,r=O/s),this.set(i,r,s,t),this}let S=Math.sqrt((x-y)*(x-y)+(h-w)*(h-w)+(m-d)*(m-d));return Math.abs(S)<.001&&(S=1),this.x=(x-y)/S,this.y=(h-w)/S,this.z=(m-d)/S,this.w=Math.acos((f+v+g-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Tb extends ks{constructor(e=1,t=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new qt(0,0,e,t),this.scissorTest=!1,this.viewport=new qt(0,0,e,t);const r={width:e,height:t,depth:1};i.encoding!==void 0&&(vc("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),i.colorSpace=i.encoding===_o?Un:Ji),i=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:fn,depthBuffer:!0,stencilBuffer:!1,depthTexture:null,samples:0},i),this.texture=new bn(r,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=i.generateMipmaps,this.texture.internalFormat=i.internalFormat,this.depthBuffer=i.depthBuffer,this.stencilBuffer=i.stencilBuffer,this.depthTexture=i.depthTexture,this.samples=i.samples}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;const t=Object.assign({},e.texture.image);return this.texture.source=new ca(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Sr extends Tb{constructor(e=1,t=1,i={}){super(e,t,i),this.isWebGLRenderTarget=!0}}class Jp extends bn{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=Tn,this.minFilter=Tn,this.wrapR=fi,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class EL extends Sr{constructor(e=1,t=1,i=1,r={}){super(e,t,r),this.isWebGLArrayRenderTarget=!0,this.depth=i,this.texture=new Jp(null,e,t,i),this.texture.isRenderTargetTexture=!0}}class k_ extends bn{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=Tn,this.minFilter=Tn,this.wrapR=fi,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class TL extends Sr{constructor(e=1,t=1,i=1,r={}){super(e,t,r),this.isWebGL3DRenderTarget=!0,this.depth=i,this.texture=new k_(null,e,t,i),this.texture.isRenderTargetTexture=!0}}class AL extends Sr{constructor(e=1,t=1,i=1,r={}){super(e,t,r),this.isWebGLMultipleRenderTargets=!0;const s=this.texture;this.texture=[];for(let o=0;o<i;o++)this.texture[o]=s.clone(),this.texture[o].isRenderTargetTexture=!0}setSize(e,t,i=1){if(this.width!==e||this.height!==t||this.depth!==i){this.width=e,this.height=t,this.depth=i;for(let r=0,s=this.texture.length;r<s;r++)this.texture[r].image.width=e,this.texture[r].image.height=t,this.texture[r].image.depth=i;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let t=0,i=e.texture.length;t<i;t++)this.texture[t]=e.texture[t].clone(),this.texture[t].isRenderTargetTexture=!0;return this}}class di{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerpFlat(e,t,i,r,s,o,a){let c=i[r+0],f=i[r+1],d=i[r+2],h=i[r+3];const m=s[o+0],v=s[o+1],y=s[o+2],w=s[o+3];if(a===0){e[t+0]=c,e[t+1]=f,e[t+2]=d,e[t+3]=h;return}if(a===1){e[t+0]=m,e[t+1]=v,e[t+2]=y,e[t+3]=w;return}if(h!==w||c!==m||f!==v||d!==y){let x=1-a;const g=c*m+f*v+d*y+h*w,S=g>=0?1:-1,M=1-g*g;if(M>Number.EPSILON){const P=Math.sqrt(M),b=Math.atan2(P,g*S);x=Math.sin(x*b)/P,a=Math.sin(a*b)/P}const T=a*S;if(c=c*x+m*T,f=f*x+v*T,d=d*x+y*T,h=h*x+w*T,x===1-a){const P=1/Math.sqrt(c*c+f*f+d*d+h*h);c*=P,f*=P,d*=P,h*=P}}e[t]=c,e[t+1]=f,e[t+2]=d,e[t+3]=h}static multiplyQuaternionsFlat(e,t,i,r,s,o){const a=i[r],c=i[r+1],f=i[r+2],d=i[r+3],h=s[o],m=s[o+1],v=s[o+2],y=s[o+3];return e[t]=a*y+d*h+c*v-f*m,e[t+1]=c*y+d*m+f*h-a*v,e[t+2]=f*y+d*v+a*m-c*h,e[t+3]=d*y-a*h-c*m-f*v,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const i=e._x,r=e._y,s=e._z,o=e._order,a=Math.cos,c=Math.sin,f=a(i/2),d=a(r/2),h=a(s/2),m=c(i/2),v=c(r/2),y=c(s/2);switch(o){case"XYZ":this._x=m*d*h+f*v*y,this._y=f*v*h-m*d*y,this._z=f*d*y+m*v*h,this._w=f*d*h-m*v*y;break;case"YXZ":this._x=m*d*h+f*v*y,this._y=f*v*h-m*d*y,this._z=f*d*y-m*v*h,this._w=f*d*h+m*v*y;break;case"ZXY":this._x=m*d*h-f*v*y,this._y=f*v*h+m*d*y,this._z=f*d*y+m*v*h,this._w=f*d*h-m*v*y;break;case"ZYX":this._x=m*d*h-f*v*y,this._y=f*v*h+m*d*y,this._z=f*d*y-m*v*h,this._w=f*d*h+m*v*y;break;case"YZX":this._x=m*d*h+f*v*y,this._y=f*v*h+m*d*y,this._z=f*d*y-m*v*h,this._w=f*d*h-m*v*y;break;case"XZY":this._x=m*d*h-f*v*y,this._y=f*v*h-m*d*y,this._z=f*d*y+m*v*h,this._w=f*d*h+m*v*y;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,i=t[0],r=t[4],s=t[8],o=t[1],a=t[5],c=t[9],f=t[2],d=t[6],h=t[10],m=i+a+h;if(m>0){const v=.5/Math.sqrt(m+1);this._w=.25/v,this._x=(d-c)*v,this._y=(s-f)*v,this._z=(o-r)*v}else if(i>a&&i>h){const v=2*Math.sqrt(1+i-a-h);this._w=(d-c)/v,this._x=.25*v,this._y=(r+o)/v,this._z=(s+f)/v}else if(a>h){const v=2*Math.sqrt(1+a-i-h);this._w=(s-f)/v,this._x=(r+o)/v,this._y=.25*v,this._z=(c+d)/v}else{const v=2*Math.sqrt(1+h-i-a);this._w=(o-r)/v,this._x=(s+f)/v,this._y=(c+d)/v,this._z=.25*v}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=i):(this._x=0,this._y=-e.z,this._z=e.y,this._w=i)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=i),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(xn(this.dot(e),-1,1)))}rotateTowards(e,t){const i=this.angleTo(e);if(i===0)return this;const r=Math.min(1,t/i);return this.slerp(e,r),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const i=e._x,r=e._y,s=e._z,o=e._w,a=t._x,c=t._y,f=t._z,d=t._w;return this._x=i*d+o*a+r*f-s*c,this._y=r*d+o*c+s*a-i*f,this._z=s*d+o*f+i*c-r*a,this._w=o*d-i*a-r*c-s*f,this._onChangeCallback(),this}slerp(e,t){if(t===0)return this;if(t===1)return this.copy(e);const i=this._x,r=this._y,s=this._z,o=this._w;let a=o*e._w+i*e._x+r*e._y+s*e._z;if(a<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,a=-a):this.copy(e),a>=1)return this._w=o,this._x=i,this._y=r,this._z=s,this;const c=1-a*a;if(c<=Number.EPSILON){const v=1-t;return this._w=v*o+t*this._w,this._x=v*i+t*this._x,this._y=v*r+t*this._y,this._z=v*s+t*this._z,this.normalize(),this}const f=Math.sqrt(c),d=Math.atan2(f,a),h=Math.sin((1-t)*d)/f,m=Math.sin(t*d)/f;return this._w=o*h+this._w*m,this._x=i*h+this._x*m,this._y=r*h+this._y*m,this._z=s*h+this._z*m,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){const e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),r=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(t*Math.cos(r),i*Math.sin(s),i*Math.cos(s),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class k{constructor(e=0,t=0,i=0){k.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return i===void 0&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(mM.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(mM.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[3]*i+s[6]*r,this.y=s[1]*t+s[4]*i+s[7]*r,this.z=s[2]*t+s[5]*i+s[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,i=this.y,r=this.z,s=e.elements,o=1/(s[3]*t+s[7]*i+s[11]*r+s[15]);return this.x=(s[0]*t+s[4]*i+s[8]*r+s[12])*o,this.y=(s[1]*t+s[5]*i+s[9]*r+s[13])*o,this.z=(s[2]*t+s[6]*i+s[10]*r+s[14])*o,this}applyQuaternion(e){const t=this.x,i=this.y,r=this.z,s=e.x,o=e.y,a=e.z,c=e.w,f=2*(o*r-a*i),d=2*(a*t-s*r),h=2*(s*i-o*t);return this.x=t+c*f+o*h-a*d,this.y=i+c*d+a*f-s*h,this.z=r+c*h+s*d-o*f,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,i=this.y,r=this.z,s=e.elements;return this.x=s[0]*t+s[4]*i+s[8]*r,this.y=s[1]*t+s[5]*i+s[9]*r,this.z=s[2]*t+s[6]*i+s[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const i=e.x,r=e.y,s=e.z,o=t.x,a=t.y,c=t.z;return this.x=r*c-s*a,this.y=s*o-i*c,this.z=i*a-r*o,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return $g.copy(this).projectOnVector(e),this.sub($g)}reflect(e){return this.sub($g.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const i=this.dot(e)/t;return Math.acos(xn(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){const r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const $g=new k,mM=new di;class Ti{constructor(e=new k(1/0,1/0,1/0),t=new k(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint(Tr.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint(Tr.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=Tr.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const i=e.geometry;if(i!==void 0){const s=i.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let o=0,a=s.count;o<a;o++)e.isMesh===!0?e.getVertexPosition(o,Tr):Tr.fromBufferAttribute(s,o),Tr.applyMatrix4(e.matrixWorld),this.expandByPoint(Tr);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),Od.copy(e.boundingBox)):(i.boundingBox===null&&i.computeBoundingBox(),Od.copy(i.boundingBox)),Od.applyMatrix4(e.matrixWorld),this.union(Od)}const r=e.children;for(let s=0,o=r.length;s<o;s++)this.expandByObject(r[s],t);return this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,Tr),Tr.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(Hu),kd.subVectors(this.max,Hu),Qa.subVectors(e.a,Hu),$a.subVectors(e.b,Hu),el.subVectors(e.c,Hu),Ys.subVectors($a,Qa),qs.subVectors(el,$a),Ho.subVectors(Qa,el);let t=[0,-Ys.z,Ys.y,0,-qs.z,qs.y,0,-Ho.z,Ho.y,Ys.z,0,-Ys.x,qs.z,0,-qs.x,Ho.z,0,-Ho.x,-Ys.y,Ys.x,0,-qs.y,qs.x,0,-Ho.y,Ho.x,0];return!e0(t,Qa,$a,el,kd)||(t=[1,0,0,0,1,0,0,0,1],!e0(t,Qa,$a,el,kd))?!1:(Fd.crossVectors(Ys,qs),t=[Fd.x,Fd.y,Fd.z],e0(t,Qa,$a,el,kd))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Tr).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Tr).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(ds[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),ds[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),ds[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),ds[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),ds[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),ds[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),ds[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),ds[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(ds),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const ds=[new k,new k,new k,new k,new k,new k,new k,new k],Tr=new k,Od=new Ti,Qa=new k,$a=new k,el=new k,Ys=new k,qs=new k,Ho=new k,Hu=new k,kd=new k,Fd=new k,Vo=new k;function e0(n,e,t,i,r){for(let s=0,o=n.length-3;s<=o;s+=3){Vo.fromArray(n,s);const a=r.x*Math.abs(Vo.x)+r.y*Math.abs(Vo.y)+r.z*Math.abs(Vo.z),c=e.dot(Vo),f=t.dot(Vo),d=i.dot(Vo);if(Math.max(-Math.max(c,f,d),Math.min(c,f,d))>a)return!1}return!0}const bL=new Ti,Vu=new k,t0=new k;class hi{constructor(e=new k,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const i=this.center;t!==void 0?i.copy(t):bL.setFromPoints(e).getCenter(i);let r=0;for(let s=0,o=e.length;s<o;s++)r=Math.max(r,i.distanceToSquared(e[s]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Vu.subVectors(e,this.center);const t=Vu.lengthSq();if(t>this.radius*this.radius){const i=Math.sqrt(t),r=(i-this.radius)*.5;this.center.addScaledVector(Vu,r/i),this.radius+=r}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(t0.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Vu.copy(e.center).add(t0)),this.expandByPoint(Vu.copy(e.center).sub(t0))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}const hs=new k,n0=new k,zd=new k,Zs=new k,i0=new k,Bd=new k,r0=new k;class Pa{constructor(e=new k,t=new k(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,hs)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=hs.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(hs.copy(this.origin).addScaledVector(this.direction,t),hs.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){n0.copy(e).add(t).multiplyScalar(.5),zd.copy(t).sub(e).normalize(),Zs.copy(this.origin).sub(n0);const s=e.distanceTo(t)*.5,o=-this.direction.dot(zd),a=Zs.dot(this.direction),c=-Zs.dot(zd),f=Zs.lengthSq(),d=Math.abs(1-o*o);let h,m,v,y;if(d>0)if(h=o*c-a,m=o*a-c,y=s*d,h>=0)if(m>=-y)if(m<=y){const w=1/d;h*=w,m*=w,v=h*(h+o*m+2*a)+m*(o*h+m+2*c)+f}else m=s,h=Math.max(0,-(o*m+a)),v=-h*h+m*(m+2*c)+f;else m=-s,h=Math.max(0,-(o*m+a)),v=-h*h+m*(m+2*c)+f;else m<=-y?(h=Math.max(0,-(-o*s+a)),m=h>0?-s:Math.min(Math.max(-s,-c),s),v=-h*h+m*(m+2*c)+f):m<=y?(h=0,m=Math.min(Math.max(-s,-c),s),v=m*(m+2*c)+f):(h=Math.max(0,-(o*s+a)),m=h>0?s:Math.min(Math.max(-s,-c),s),v=-h*h+m*(m+2*c)+f);else m=o>0?-s:s,h=Math.max(0,-(o*m+a)),v=-h*h+m*(m+2*c)+f;return i&&i.copy(this.origin).addScaledVector(this.direction,h),r&&r.copy(n0).addScaledVector(zd,m),v}intersectSphere(e,t){hs.subVectors(e.center,this.origin);const i=hs.dot(this.direction),r=hs.dot(hs)-i*i,s=e.radius*e.radius;if(r>s)return null;const o=Math.sqrt(s-r),a=i-o,c=i+o;return c<0?null:a<0?this.at(c,t):this.at(a,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){const i=this.distanceToPlane(e);return i===null?null:this.at(i,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let i,r,s,o,a,c;const f=1/this.direction.x,d=1/this.direction.y,h=1/this.direction.z,m=this.origin;return f>=0?(i=(e.min.x-m.x)*f,r=(e.max.x-m.x)*f):(i=(e.max.x-m.x)*f,r=(e.min.x-m.x)*f),d>=0?(s=(e.min.y-m.y)*d,o=(e.max.y-m.y)*d):(s=(e.max.y-m.y)*d,o=(e.min.y-m.y)*d),i>o||s>r||((s>i||isNaN(i))&&(i=s),(o<r||isNaN(r))&&(r=o),h>=0?(a=(e.min.z-m.z)*h,c=(e.max.z-m.z)*h):(a=(e.max.z-m.z)*h,c=(e.min.z-m.z)*h),i>c||a>r)||((a>i||i!==i)&&(i=a),(c<r||r!==r)&&(r=c),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return this.intersectBox(e,hs)!==null}intersectTriangle(e,t,i,r,s){i0.subVectors(t,e),Bd.subVectors(i,e),r0.crossVectors(i0,Bd);let o=this.direction.dot(r0),a;if(o>0){if(r)return null;a=1}else if(o<0)a=-1,o=-o;else return null;Zs.subVectors(this.origin,e);const c=a*this.direction.dot(Bd.crossVectors(Zs,Bd));if(c<0)return null;const f=a*this.direction.dot(i0.cross(Zs));if(f<0||c+f>o)return null;const d=-a*Zs.dot(r0);return d<0?null:this.at(d/o,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Mt{constructor(e,t,i,r,s,o,a,c,f,d,h,m,v,y,w,x){Mt.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,i,r,s,o,a,c,f,d,h,m,v,y,w,x)}set(e,t,i,r,s,o,a,c,f,d,h,m,v,y,w,x){const g=this.elements;return g[0]=e,g[4]=t,g[8]=i,g[12]=r,g[1]=s,g[5]=o,g[9]=a,g[13]=c,g[2]=f,g[6]=d,g[10]=h,g[14]=m,g[3]=v,g[7]=y,g[11]=w,g[15]=x,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Mt().fromArray(this.elements)}copy(e){const t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){const t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){const t=this.elements,i=e.elements,r=1/tl.setFromMatrixColumn(e,0).length(),s=1/tl.setFromMatrixColumn(e,1).length(),o=1/tl.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*s,t[5]=i[5]*s,t[6]=i[6]*s,t[7]=0,t[8]=i[8]*o,t[9]=i[9]*o,t[10]=i[10]*o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,i=e.x,r=e.y,s=e.z,o=Math.cos(i),a=Math.sin(i),c=Math.cos(r),f=Math.sin(r),d=Math.cos(s),h=Math.sin(s);if(e.order==="XYZ"){const m=o*d,v=o*h,y=a*d,w=a*h;t[0]=c*d,t[4]=-c*h,t[8]=f,t[1]=v+y*f,t[5]=m-w*f,t[9]=-a*c,t[2]=w-m*f,t[6]=y+v*f,t[10]=o*c}else if(e.order==="YXZ"){const m=c*d,v=c*h,y=f*d,w=f*h;t[0]=m+w*a,t[4]=y*a-v,t[8]=o*f,t[1]=o*h,t[5]=o*d,t[9]=-a,t[2]=v*a-y,t[6]=w+m*a,t[10]=o*c}else if(e.order==="ZXY"){const m=c*d,v=c*h,y=f*d,w=f*h;t[0]=m-w*a,t[4]=-o*h,t[8]=y+v*a,t[1]=v+y*a,t[5]=o*d,t[9]=w-m*a,t[2]=-o*f,t[6]=a,t[10]=o*c}else if(e.order==="ZYX"){const m=o*d,v=o*h,y=a*d,w=a*h;t[0]=c*d,t[4]=y*f-v,t[8]=m*f+w,t[1]=c*h,t[5]=w*f+m,t[9]=v*f-y,t[2]=-f,t[6]=a*c,t[10]=o*c}else if(e.order==="YZX"){const m=o*c,v=o*f,y=a*c,w=a*f;t[0]=c*d,t[4]=w-m*h,t[8]=y*h+v,t[1]=h,t[5]=o*d,t[9]=-a*d,t[2]=-f*d,t[6]=v*h+y,t[10]=m-w*h}else if(e.order==="XZY"){const m=o*c,v=o*f,y=a*c,w=a*f;t[0]=c*d,t[4]=-h,t[8]=f*d,t[1]=m*h+w,t[5]=o*d,t[9]=v*h-y,t[2]=y*h-v,t[6]=a*d,t[10]=w*h+m}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(CL,e,RL)}lookAt(e,t,i){const r=this.elements;return Yi.subVectors(e,t),Yi.lengthSq()===0&&(Yi.z=1),Yi.normalize(),Ks.crossVectors(i,Yi),Ks.lengthSq()===0&&(Math.abs(i.z)===1?Yi.x+=1e-4:Yi.z+=1e-4,Yi.normalize(),Ks.crossVectors(i,Yi)),Ks.normalize(),Hd.crossVectors(Yi,Ks),r[0]=Ks.x,r[4]=Hd.x,r[8]=Yi.x,r[1]=Ks.y,r[5]=Hd.y,r[9]=Yi.y,r[2]=Ks.z,r[6]=Hd.z,r[10]=Yi.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const i=e.elements,r=t.elements,s=this.elements,o=i[0],a=i[4],c=i[8],f=i[12],d=i[1],h=i[5],m=i[9],v=i[13],y=i[2],w=i[6],x=i[10],g=i[14],S=i[3],M=i[7],T=i[11],P=i[15],b=r[0],L=r[4],O=r[8],C=r[12],R=r[1],B=r[5],$=r[9],me=r[13],G=r[2],Z=r[6],ne=r[10],he=r[14],F=r[3],W=r[7],V=r[11],Q=r[15];return s[0]=o*b+a*R+c*G+f*F,s[4]=o*L+a*B+c*Z+f*W,s[8]=o*O+a*$+c*ne+f*V,s[12]=o*C+a*me+c*he+f*Q,s[1]=d*b+h*R+m*G+v*F,s[5]=d*L+h*B+m*Z+v*W,s[9]=d*O+h*$+m*ne+v*V,s[13]=d*C+h*me+m*he+v*Q,s[2]=y*b+w*R+x*G+g*F,s[6]=y*L+w*B+x*Z+g*W,s[10]=y*O+w*$+x*ne+g*V,s[14]=y*C+w*me+x*he+g*Q,s[3]=S*b+M*R+T*G+P*F,s[7]=S*L+M*B+T*Z+P*W,s[11]=S*O+M*$+T*ne+P*V,s[15]=S*C+M*me+T*he+P*Q,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],i=e[4],r=e[8],s=e[12],o=e[1],a=e[5],c=e[9],f=e[13],d=e[2],h=e[6],m=e[10],v=e[14],y=e[3],w=e[7],x=e[11],g=e[15];return y*(+s*c*h-r*f*h-s*a*m+i*f*m+r*a*v-i*c*v)+w*(+t*c*v-t*f*m+s*o*m-r*o*v+r*f*d-s*c*d)+x*(+t*f*h-t*a*v-s*o*h+i*o*v+s*a*d-i*f*d)+g*(-r*a*d-t*c*h+t*a*m+r*o*h-i*o*m+i*c*d)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,i){const r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){const e=this.elements,t=e[0],i=e[1],r=e[2],s=e[3],o=e[4],a=e[5],c=e[6],f=e[7],d=e[8],h=e[9],m=e[10],v=e[11],y=e[12],w=e[13],x=e[14],g=e[15],S=h*x*f-w*m*f+w*c*v-a*x*v-h*c*g+a*m*g,M=y*m*f-d*x*f-y*c*v+o*x*v+d*c*g-o*m*g,T=d*w*f-y*h*f+y*a*v-o*w*v-d*a*g+o*h*g,P=y*h*c-d*w*c-y*a*m+o*w*m+d*a*x-o*h*x,b=t*S+i*M+r*T+s*P;if(b===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const L=1/b;return e[0]=S*L,e[1]=(w*m*s-h*x*s-w*r*v+i*x*v+h*r*g-i*m*g)*L,e[2]=(a*x*s-w*c*s+w*r*f-i*x*f-a*r*g+i*c*g)*L,e[3]=(h*c*s-a*m*s-h*r*f+i*m*f+a*r*v-i*c*v)*L,e[4]=M*L,e[5]=(d*x*s-y*m*s+y*r*v-t*x*v-d*r*g+t*m*g)*L,e[6]=(y*c*s-o*x*s-y*r*f+t*x*f+o*r*g-t*c*g)*L,e[7]=(o*m*s-d*c*s+d*r*f-t*m*f-o*r*v+t*c*v)*L,e[8]=T*L,e[9]=(y*h*s-d*w*s-y*i*v+t*w*v+d*i*g-t*h*g)*L,e[10]=(o*w*s-y*a*s+y*i*f-t*w*f-o*i*g+t*a*g)*L,e[11]=(d*a*s-o*h*s-d*i*f+t*h*f+o*i*v-t*a*v)*L,e[12]=P*L,e[13]=(d*w*r-y*h*r+y*i*m-t*w*m-d*i*x+t*h*x)*L,e[14]=(y*a*r-o*w*r-y*i*c+t*w*c+o*i*x-t*a*x)*L,e[15]=(o*h*r-d*a*r+d*i*c-t*h*c-o*i*m+t*a*m)*L,this}scale(e){const t=this.elements,i=e.x,r=e.y,s=e.z;return t[0]*=i,t[4]*=r,t[8]*=s,t[1]*=i,t[5]*=r,t[9]*=s,t[2]*=i,t[6]*=r,t[10]*=s,t[3]*=i,t[7]*=r,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,r))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const i=Math.cos(t),r=Math.sin(t),s=1-i,o=e.x,a=e.y,c=e.z,f=s*o,d=s*a;return this.set(f*o+i,f*a-r*c,f*c+r*a,0,f*a+r*c,d*a+i,d*c-r*o,0,f*c-r*a,d*c+r*o,s*c*c+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,s,o){return this.set(1,i,s,0,e,1,o,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){const r=this.elements,s=t._x,o=t._y,a=t._z,c=t._w,f=s+s,d=o+o,h=a+a,m=s*f,v=s*d,y=s*h,w=o*d,x=o*h,g=a*h,S=c*f,M=c*d,T=c*h,P=i.x,b=i.y,L=i.z;return r[0]=(1-(w+g))*P,r[1]=(v+T)*P,r[2]=(y-M)*P,r[3]=0,r[4]=(v-T)*b,r[5]=(1-(m+g))*b,r[6]=(x+S)*b,r[7]=0,r[8]=(y+M)*L,r[9]=(x-S)*L,r[10]=(1-(m+w))*L,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){const r=this.elements;let s=tl.set(r[0],r[1],r[2]).length();const o=tl.set(r[4],r[5],r[6]).length(),a=tl.set(r[8],r[9],r[10]).length();this.determinant()<0&&(s=-s),e.x=r[12],e.y=r[13],e.z=r[14],Ar.copy(this);const f=1/s,d=1/o,h=1/a;return Ar.elements[0]*=f,Ar.elements[1]*=f,Ar.elements[2]*=f,Ar.elements[4]*=d,Ar.elements[5]*=d,Ar.elements[6]*=d,Ar.elements[8]*=h,Ar.elements[9]*=h,Ar.elements[10]*=h,t.setFromRotationMatrix(Ar),i.x=s,i.y=o,i.z=a,this}makePerspective(e,t,i,r,s,o,a=Nr){const c=this.elements,f=2*s/(t-e),d=2*s/(i-r),h=(t+e)/(t-e),m=(i+r)/(i-r);let v,y;if(a===Nr)v=-(o+s)/(o-s),y=-2*o*s/(o-s);else if(a===nu)v=-o/(o-s),y=-o*s/(o-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+a);return c[0]=f,c[4]=0,c[8]=h,c[12]=0,c[1]=0,c[5]=d,c[9]=m,c[13]=0,c[2]=0,c[6]=0,c[10]=v,c[14]=y,c[3]=0,c[7]=0,c[11]=-1,c[15]=0,this}makeOrthographic(e,t,i,r,s,o,a=Nr){const c=this.elements,f=1/(t-e),d=1/(i-r),h=1/(o-s),m=(t+e)*f,v=(i+r)*d;let y,w;if(a===Nr)y=(o+s)*h,w=-2*h;else if(a===nu)y=s*h,w=-1*h;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+a);return c[0]=2*f,c[4]=0,c[8]=0,c[12]=-m,c[1]=0,c[5]=2*d,c[9]=0,c[13]=-v,c[2]=0,c[6]=0,c[10]=w,c[14]=-y,c[3]=0,c[7]=0,c[11]=0,c[15]=1,this}equals(e){const t=this.elements,i=e.elements;for(let r=0;r<16;r++)if(t[r]!==i[r])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){const i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}const tl=new k,Ar=new Mt,CL=new k(0,0,0),RL=new k(1,1,1),Ks=new k,Hd=new k,Yi=new k,gM=new Mt,vM=new di;class hf{constructor(e=0,t=0,i=0,r=hf.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=i,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,i,r=this._order){return this._x=e,this._y=t,this._z=i,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,i=!0){const r=e.elements,s=r[0],o=r[4],a=r[8],c=r[1],f=r[5],d=r[9],h=r[2],m=r[6],v=r[10];switch(t){case"XYZ":this._y=Math.asin(xn(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(-d,v),this._z=Math.atan2(-o,s)):(this._x=Math.atan2(m,f),this._z=0);break;case"YXZ":this._x=Math.asin(-xn(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(a,v),this._z=Math.atan2(c,f)):(this._y=Math.atan2(-h,s),this._z=0);break;case"ZXY":this._x=Math.asin(xn(m,-1,1)),Math.abs(m)<.9999999?(this._y=Math.atan2(-h,v),this._z=Math.atan2(-o,f)):(this._y=0,this._z=Math.atan2(c,s));break;case"ZYX":this._y=Math.asin(-xn(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(m,v),this._z=Math.atan2(c,s)):(this._x=0,this._z=Math.atan2(-o,f));break;case"YZX":this._z=Math.asin(xn(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-d,f),this._y=Math.atan2(-h,s)):(this._x=0,this._y=Math.atan2(a,v));break;case"XZY":this._z=Math.asin(-xn(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(m,f),this._y=Math.atan2(a,s)):(this._x=Math.atan2(-d,v),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,i===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,i){return gM.makeRotationFromQuaternion(e),this.setFromRotationMatrix(gM,t,i)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return vM.setFromEuler(this),this.setFromQuaternion(vM,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}hf.DEFAULT_ORDER="XYZ";class ga{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let PL=0;const yM=new k,nl=new di,ps=new Mt,Vd=new k,Gu=new k,LL=new k,IL=new di,_M=new k(1,0,0),xM=new k(0,1,0),SM=new k(0,0,1),NL={type:"added"},DL={type:"removed"};class Wt extends ks{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:PL++}),this.uuid=er(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Wt.DEFAULT_UP.clone();const e=new k,t=new hf,i=new di,r=new k(1,1,1);function s(){i.setFromEuler(t,!1)}function o(){t.setFromQuaternion(i,void 0,!1)}t._onChange(s),i._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Mt},normalMatrix:{value:new Nt}}),this.matrix=new Mt,this.matrixWorld=new Mt,this.matrixAutoUpdate=Wt.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Wt.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new ga,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return nl.setFromAxisAngle(e,t),this.quaternion.multiply(nl),this}rotateOnWorldAxis(e,t){return nl.setFromAxisAngle(e,t),this.quaternion.premultiply(nl),this}rotateX(e){return this.rotateOnAxis(_M,e)}rotateY(e){return this.rotateOnAxis(xM,e)}rotateZ(e){return this.rotateOnAxis(SM,e)}translateOnAxis(e,t){return yM.copy(e).applyQuaternion(this.quaternion),this.position.add(yM.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(_M,e)}translateY(e){return this.translateOnAxis(xM,e)}translateZ(e){return this.translateOnAxis(SM,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(ps.copy(this.matrixWorld).invert())}lookAt(e,t,i){e.isVector3?Vd.copy(e):Vd.set(e,t,i);const r=this.parent;this.updateWorldMatrix(!0,!1),Gu.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?ps.lookAt(Gu,Vd,this.up):ps.lookAt(Vd,Gu,this.up),this.quaternion.setFromRotationMatrix(ps),r&&(ps.extractRotation(r.matrixWorld),nl.setFromRotationMatrix(ps),this.quaternion.premultiply(nl.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(NL)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(DL)),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),ps.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),ps.multiply(e.parent.matrixWorld)),e.applyMatrix4(ps),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let i=0,r=this.children.length;i<r;i++){const o=this.children[i].getObjectByProperty(e,t);if(o!==void 0)return o}}getObjectsByProperty(e,t,i=[]){this[e]===t&&i.push(this);const r=this.children;for(let s=0,o=r.length;s<o;s++)r[s].getObjectsByProperty(e,t,i);return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Gu,e,LL),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Gu,IL,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let i=0,r=t.length;i<r;i++){const s=t[i];(s.matrixWorldAutoUpdate===!0||e===!0)&&s.updateMatrixWorld(e)}}updateWorldMatrix(e,t){const i=this.parent;if(e===!0&&i!==null&&i.matrixWorldAutoUpdate===!0&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t===!0){const r=this.children;for(let s=0,o=r.length;s<o;s++){const a=r[s];a.matrixWorldAutoUpdate===!0&&a.updateWorldMatrix(!1,!0)}}}toJSON(e){const t=e===void 0||typeof e=="string",i={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const r={};r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),this.castShadow===!0&&(r.castShadow=!0),this.receiveShadow===!0&&(r.receiveShadow=!0),this.visible===!1&&(r.visible=!1),this.frustumCulled===!1&&(r.frustumCulled=!1),this.renderOrder!==0&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(r.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(r.type="BatchedMesh",r.perObjectFrustumCulled=this.perObjectFrustumCulled,r.sortObjects=this.sortObjects,r.drawRanges=this._drawRanges,r.reservedRanges=this._reservedRanges,r.visibility=this._visibility,r.active=this._active,r.bounds=this._bounds.map(a=>({boxInitialized:a.boxInitialized,boxMin:a.box.min.toArray(),boxMax:a.box.max.toArray(),sphereInitialized:a.sphereInitialized,sphereRadius:a.sphere.radius,sphereCenter:a.sphere.center.toArray()})),r.maxGeometryCount=this._maxGeometryCount,r.maxVertexCount=this._maxVertexCount,r.maxIndexCount=this._maxIndexCount,r.geometryInitialized=this._geometryInitialized,r.geometryCount=this._geometryCount,r.matricesTexture=this._matricesTexture.toJSON(e),this.boundingSphere!==null&&(r.boundingSphere={center:r.boundingSphere.center.toArray(),radius:r.boundingSphere.radius}),this.boundingBox!==null&&(r.boundingBox={min:r.boundingBox.min.toArray(),max:r.boundingBox.max.toArray()}));function s(a,c){return a[c.uuid]===void 0&&(a[c.uuid]=c.toJSON(e)),c.uuid}if(this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=s(e.geometries,this.geometry);const a=this.geometry.parameters;if(a!==void 0&&a.shapes!==void 0){const c=a.shapes;if(Array.isArray(c))for(let f=0,d=c.length;f<d;f++){const h=c[f];s(e.shapes,h)}else s(e.shapes,c)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const a=[];for(let c=0,f=this.material.length;c<f;c++)a.push(s(e.materials,this.material[c]));r.material=a}else r.material=s(e.materials,this.material);if(this.children.length>0){r.children=[];for(let a=0;a<this.children.length;a++)r.children.push(this.children[a].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let a=0;a<this.animations.length;a++){const c=this.animations[a];r.animations.push(s(e.animations,c))}}if(t){const a=o(e.geometries),c=o(e.materials),f=o(e.textures),d=o(e.images),h=o(e.shapes),m=o(e.skeletons),v=o(e.animations),y=o(e.nodes);a.length>0&&(i.geometries=a),c.length>0&&(i.materials=c),f.length>0&&(i.textures=f),d.length>0&&(i.images=d),h.length>0&&(i.shapes=h),m.length>0&&(i.skeletons=m),v.length>0&&(i.animations=v),y.length>0&&(i.nodes=y)}return i.object=r,i;function o(a){const c=[];for(const f in a){const d=a[f];delete d.metadata,c.push(d)}return c}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let i=0;i<e.children.length;i++){const r=e.children[i];this.add(r.clone())}return this}}Wt.DEFAULT_UP=new k(0,1,0);Wt.DEFAULT_MATRIX_AUTO_UPDATE=!0;Wt.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const br=new k,ms=new k,s0=new k,gs=new k,il=new k,rl=new k,MM=new k,o0=new k,a0=new k,l0=new k;let Gd=!1;class Di{constructor(e=new k,t=new k,i=new k){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),br.subVectors(e,t),r.cross(br);const s=r.lengthSq();return s>0?r.multiplyScalar(1/Math.sqrt(s)):r.set(0,0,0)}static getBarycoord(e,t,i,r,s){br.subVectors(r,t),ms.subVectors(i,t),s0.subVectors(e,t);const o=br.dot(br),a=br.dot(ms),c=br.dot(s0),f=ms.dot(ms),d=ms.dot(s0),h=o*f-a*a;if(h===0)return s.set(0,0,0),null;const m=1/h,v=(f*c-a*d)*m,y=(o*d-a*c)*m;return s.set(1-v-y,y,v)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,gs)===null?!1:gs.x>=0&&gs.y>=0&&gs.x+gs.y<=1}static getUV(e,t,i,r,s,o,a,c){return Gd===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),Gd=!0),this.getInterpolation(e,t,i,r,s,o,a,c)}static getInterpolation(e,t,i,r,s,o,a,c){return this.getBarycoord(e,t,i,r,gs)===null?(c.x=0,c.y=0,"z"in c&&(c.z=0),"w"in c&&(c.w=0),null):(c.setScalar(0),c.addScaledVector(s,gs.x),c.addScaledVector(o,gs.y),c.addScaledVector(a,gs.z),c)}static isFrontFacing(e,t,i,r){return br.subVectors(i,t),ms.subVectors(e,t),br.cross(ms).dot(r)<0}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return br.subVectors(this.c,this.b),ms.subVectors(this.a,this.b),br.cross(ms).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return Di.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return Di.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,r,s){return Gd===!1&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),Gd=!0),Di.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}getInterpolation(e,t,i,r,s){return Di.getInterpolation(e,this.a,this.b,this.c,t,i,r,s)}containsPoint(e){return Di.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return Di.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const i=this.a,r=this.b,s=this.c;let o,a;il.subVectors(r,i),rl.subVectors(s,i),o0.subVectors(e,i);const c=il.dot(o0),f=rl.dot(o0);if(c<=0&&f<=0)return t.copy(i);a0.subVectors(e,r);const d=il.dot(a0),h=rl.dot(a0);if(d>=0&&h<=d)return t.copy(r);const m=c*h-d*f;if(m<=0&&c>=0&&d<=0)return o=c/(c-d),t.copy(i).addScaledVector(il,o);l0.subVectors(e,s);const v=il.dot(l0),y=rl.dot(l0);if(y>=0&&v<=y)return t.copy(s);const w=v*f-c*y;if(w<=0&&f>=0&&y<=0)return a=f/(f-y),t.copy(i).addScaledVector(rl,a);const x=d*y-v*h;if(x<=0&&h-d>=0&&v-y>=0)return MM.subVectors(s,r),a=(h-d)/(h-d+(v-y)),t.copy(r).addScaledVector(MM,a);const g=1/(x+w+m);return o=w*g,a=m*g,t.copy(i).addScaledVector(il,o).addScaledVector(rl,a)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const Ab={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Js={h:0,s:0,l:0},Wd={h:0,s:0,l:0};function u0(n,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?n+(e-n)*6*t:t<1/2?e:t<2/3?n+(e-n)*6*(2/3-t):n}class nt{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){if(t===void 0&&i===void 0){const r=e;r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r)}else this.setRGB(e,t,i);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=Un){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Yt.toWorkingColorSpace(this,t),this}setRGB(e,t,i,r=Yt.workingColorSpace){return this.r=e,this.g=t,this.b=i,Yt.toWorkingColorSpace(this,r),this}setHSL(e,t,i,r=Yt.workingColorSpace){if(e=D_(e,1),t=xn(t,0,1),i=xn(i,0,1),t===0)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+t):i+t-i*t,o=2*i-s;this.r=u0(o,s,e+1/3),this.g=u0(o,s,e),this.b=u0(o,s,e-1/3)}return Yt.toWorkingColorSpace(this,r),this}setStyle(e,t=Un){function i(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}let r;if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const o=r[1],a=r[2];switch(o){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(a))return i(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=r[1],o=s.length;if(o===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(o===6)return this.setHex(parseInt(s,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=Un){const i=Ab[e.toLowerCase()];return i!==void 0?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=ql(e.r),this.g=ql(e.g),this.b=ql(e.b),this}copyLinearToSRGB(e){return this.r=Jg(e.r),this.g=Jg(e.g),this.b=Jg(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=Un){return Yt.fromWorkingColorSpace(ai.copy(this),e),Math.round(xn(ai.r*255,0,255))*65536+Math.round(xn(ai.g*255,0,255))*256+Math.round(xn(ai.b*255,0,255))}getHexString(e=Un){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Yt.workingColorSpace){Yt.fromWorkingColorSpace(ai.copy(this),t);const i=ai.r,r=ai.g,s=ai.b,o=Math.max(i,r,s),a=Math.min(i,r,s);let c,f;const d=(a+o)/2;if(a===o)c=0,f=0;else{const h=o-a;switch(f=d<=.5?h/(o+a):h/(2-o-a),o){case i:c=(r-s)/h+(r<s?6:0);break;case r:c=(s-i)/h+2;break;case s:c=(i-r)/h+4;break}c/=6}return e.h=c,e.s=f,e.l=d,e}getRGB(e,t=Yt.workingColorSpace){return Yt.fromWorkingColorSpace(ai.copy(this),t),e.r=ai.r,e.g=ai.g,e.b=ai.b,e}getStyle(e=Un){Yt.fromWorkingColorSpace(ai.copy(this),e);const t=ai.r,i=ai.g,r=ai.b;return e!==Un?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(i*255)},${Math.round(r*255)})`}offsetHSL(e,t,i){return this.getHSL(Js),this.setHSL(Js.h+e,Js.s+t,Js.l+i)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(Js),e.getHSL(Wd);const i=gc(Js.h,Wd.h,t),r=gc(Js.s,Wd.s,t),s=gc(Js.l,Wd.l,t);return this.setHSL(i,r,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,i=this.g,r=this.b,s=e.elements;return this.r=s[0]*t+s[3]*i+s[6]*r,this.g=s[1]*t+s[4]*i+s[7]*r,this.b=s[2]*t+s[5]*i+s[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const ai=new nt;nt.NAMES=Ab;let UL=0;class mi extends ks{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:UL++}),this.uuid=er(),this.name="",this.type="Material",this.blending=pa,this.side=Ns,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=Mp,this.blendDst=wp,this.blendEquation=so,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new nt(0,0,0),this.blendAlpha=0,this.depthFunc=kc,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=dy,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=ta,this.stencilZFail=ta,this.stencilZPass=ta,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const i=e[t];if(i===void 0){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}const r=this[t];if(r===void 0){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(i.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==pa&&(i.blending=this.blending),this.side!==Ns&&(i.side=this.side),this.vertexColors===!0&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=!0),this.blendSrc!==Mp&&(i.blendSrc=this.blendSrc),this.blendDst!==wp&&(i.blendDst=this.blendDst),this.blendEquation!==so&&(i.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(i.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(i.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(i.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(i.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(i.blendAlpha=this.blendAlpha),this.depthFunc!==kc&&(i.depthFunc=this.depthFunc),this.depthTest===!1&&(i.depthTest=this.depthTest),this.depthWrite===!1&&(i.depthWrite=this.depthWrite),this.colorWrite===!1&&(i.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(i.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==dy&&(i.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(i.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(i.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==ta&&(i.stencilFail=this.stencilFail),this.stencilZFail!==ta&&(i.stencilZFail=this.stencilZFail),this.stencilZPass!==ta&&(i.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(i.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaHash===!0&&(i.alphaHash=!0),this.alphaToCoverage===!0&&(i.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=!0),this.forceSinglePass===!0&&(i.forceSinglePass=!0),this.wireframe===!0&&(i.wireframe=!0),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=!0),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData);function r(s){const o=[];for(const a in s){const c=s[a];delete c.metadata,o.push(c)}return o}if(t){const s=r(e.textures),o=r(e.images);s.length>0&&(i.textures=s),o.length>0&&(i.images=o)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let i=null;if(t!==null){const r=t.length;i=new Array(r);for(let s=0;s!==r;++s)i[s]=t[s].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class Ro extends mi{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new nt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=ff,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const Ms=OL();function OL(){const n=new ArrayBuffer(4),e=new Float32Array(n),t=new Uint32Array(n),i=new Uint32Array(512),r=new Uint32Array(512);for(let c=0;c<256;++c){const f=c-127;f<-27?(i[c]=0,i[c|256]=32768,r[c]=24,r[c|256]=24):f<-14?(i[c]=1024>>-f-14,i[c|256]=1024>>-f-14|32768,r[c]=-f-1,r[c|256]=-f-1):f<=15?(i[c]=f+15<<10,i[c|256]=f+15<<10|32768,r[c]=13,r[c|256]=13):f<128?(i[c]=31744,i[c|256]=64512,r[c]=24,r[c|256]=24):(i[c]=31744,i[c|256]=64512,r[c]=13,r[c|256]=13)}const s=new Uint32Array(2048),o=new Uint32Array(64),a=new Uint32Array(64);for(let c=1;c<1024;++c){let f=c<<13,d=0;for(;!(f&8388608);)f<<=1,d-=8388608;f&=-8388609,d+=947912704,s[c]=f|d}for(let c=1024;c<2048;++c)s[c]=939524096+(c-1024<<13);for(let c=1;c<31;++c)o[c]=c<<23;o[31]=1199570944,o[32]=2147483648;for(let c=33;c<63;++c)o[c]=2147483648+(c-32<<23);o[63]=3347054592;for(let c=1;c<64;++c)c!==32&&(a[c]=1024);return{floatView:e,uint32View:t,baseTable:i,shiftTable:r,mantissaTable:s,exponentTable:o,offsetTable:a}}function Ii(n){Math.abs(n)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),n=xn(n,-65504,65504),Ms.floatView[0]=n;const e=Ms.uint32View[0],t=e>>23&511;return Ms.baseTable[t]+((e&8388607)>>Ms.shiftTable[t])}function rc(n){const e=n>>10;return Ms.uint32View[0]=Ms.mantissaTable[Ms.offsetTable[e]+(n&1023)]+Ms.exponentTable[e],Ms.floatView[0]}const kL={toHalfFloat:Ii,fromHalfFloat:rc},Pn=new k,Xd=new be;class Kt{constructor(e,t,i=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=i,this.usage=qc,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=vr,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return console.warn("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,s=this.itemSize;r<s;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,i=this.count;t<i;t++)Xd.fromBufferAttribute(this,t),Xd.applyMatrix3(e),this.setXY(t,Xd.x,Xd.y);else if(this.itemSize===3)for(let t=0,i=this.count;t<i;t++)Pn.fromBufferAttribute(this,t),Pn.applyMatrix3(e),this.setXYZ(t,Pn.x,Pn.y,Pn.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)Pn.fromBufferAttribute(this,t),Pn.applyMatrix4(e),this.setXYZ(t,Pn.x,Pn.y,Pn.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)Pn.fromBufferAttribute(this,t),Pn.applyNormalMatrix(e),this.setXYZ(t,Pn.x,Pn.y,Pn.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)Pn.fromBufferAttribute(this,t),Pn.transformDirection(e),this.setXYZ(t,Pn.x,Pn.y,Pn.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let i=this.array[e*this.itemSize+t];return this.normalized&&(i=Ui(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=Lt(i,this.array)),this.array[e*this.itemSize+t]=i,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=Ui(t,this.array)),t}setX(e,t){return this.normalized&&(t=Lt(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=Ui(t,this.array)),t}setY(e,t){return this.normalized&&(t=Lt(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=Ui(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Lt(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=Ui(t,this.array)),t}setW(e,t){return this.normalized&&(t=Lt(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=Lt(t,this.array),i=Lt(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=Lt(t,this.array),i=Lt(i,this.array),r=Lt(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=Lt(t,this.array),i=Lt(i,this.array),r=Lt(r,this.array),s=Lt(s,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==qc&&(e.usage=this.usage),e}}class FL extends Kt{constructor(e,t,i){super(new Int8Array(e),t,i)}}class zL extends Kt{constructor(e,t,i){super(new Uint8Array(e),t,i)}}class BL extends Kt{constructor(e,t,i){super(new Uint8ClampedArray(e),t,i)}}class HL extends Kt{constructor(e,t,i){super(new Int16Array(e),t,i)}}class F_ extends Kt{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class VL extends Kt{constructor(e,t,i){super(new Int32Array(e),t,i)}}class z_ extends Kt{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class GL extends Kt{constructor(e,t,i){super(new Uint16Array(e),t,i),this.isFloat16BufferAttribute=!0}getX(e){let t=rc(this.array[e*this.itemSize]);return this.normalized&&(t=Ui(t,this.array)),t}setX(e,t){return this.normalized&&(t=Lt(t,this.array)),this.array[e*this.itemSize]=Ii(t),this}getY(e){let t=rc(this.array[e*this.itemSize+1]);return this.normalized&&(t=Ui(t,this.array)),t}setY(e,t){return this.normalized&&(t=Lt(t,this.array)),this.array[e*this.itemSize+1]=Ii(t),this}getZ(e){let t=rc(this.array[e*this.itemSize+2]);return this.normalized&&(t=Ui(t,this.array)),t}setZ(e,t){return this.normalized&&(t=Lt(t,this.array)),this.array[e*this.itemSize+2]=Ii(t),this}getW(e){let t=rc(this.array[e*this.itemSize+3]);return this.normalized&&(t=Ui(t,this.array)),t}setW(e,t){return this.normalized&&(t=Lt(t,this.array)),this.array[e*this.itemSize+3]=Ii(t),this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=Lt(t,this.array),i=Lt(i,this.array)),this.array[e+0]=Ii(t),this.array[e+1]=Ii(i),this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=Lt(t,this.array),i=Lt(i,this.array),r=Lt(r,this.array)),this.array[e+0]=Ii(t),this.array[e+1]=Ii(i),this.array[e+2]=Ii(r),this}setXYZW(e,t,i,r,s){return e*=this.itemSize,this.normalized&&(t=Lt(t,this.array),i=Lt(i,this.array),r=Lt(r,this.array),s=Lt(s,this.array)),this.array[e+0]=Ii(t),this.array[e+1]=Ii(i),this.array[e+2]=Ii(r),this.array[e+3]=Ii(s),this}}class ft extends Kt{constructor(e,t,i){super(new Float32Array(e),t,i)}}class WL extends Kt{constructor(e,t,i){super(new Float64Array(e),t,i)}}let XL=0;const hr=new Mt,c0=new Wt,sl=new k,qi=new Ti,Wu=new Ti,Wn=new k;class Dt extends ks{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:XL++}),this.uuid=er(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(wb(e)?z_:F_)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const s=new Nt().getNormalMatrix(e);i.applyNormalMatrix(s),i.needsUpdate=!0}const r=this.attributes.tangent;return r!==void 0&&(r.transformDirection(e),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return hr.makeRotationFromQuaternion(e),this.applyMatrix4(hr),this}rotateX(e){return hr.makeRotationX(e),this.applyMatrix4(hr),this}rotateY(e){return hr.makeRotationY(e),this.applyMatrix4(hr),this}rotateZ(e){return hr.makeRotationZ(e),this.applyMatrix4(hr),this}translate(e,t,i){return hr.makeTranslation(e,t,i),this.applyMatrix4(hr),this}scale(e,t,i){return hr.makeScale(e,t,i),this.applyMatrix4(hr),this}lookAt(e){return c0.lookAt(e),c0.updateMatrix(),this.applyMatrix4(c0.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(sl).negate(),this.translate(sl.x,sl.y,sl.z),this}setFromPoints(e){const t=[];for(let i=0,r=e.length;i<r;i++){const s=e[i];t.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new ft(t,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Ti);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new k(-1/0,-1/0,-1/0),new k(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let i=0,r=t.length;i<r;i++){const s=t[i];qi.setFromBufferAttribute(s),this.morphTargetsRelative?(Wn.addVectors(this.boundingBox.min,qi.min),this.boundingBox.expandByPoint(Wn),Wn.addVectors(this.boundingBox.max,qi.max),this.boundingBox.expandByPoint(Wn)):(this.boundingBox.expandByPoint(qi.min),this.boundingBox.expandByPoint(qi.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new hi);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new k,1/0);return}if(e){const i=this.boundingSphere.center;if(qi.setFromBufferAttribute(e),t)for(let s=0,o=t.length;s<o;s++){const a=t[s];Wu.setFromBufferAttribute(a),this.morphTargetsRelative?(Wn.addVectors(qi.min,Wu.min),qi.expandByPoint(Wn),Wn.addVectors(qi.max,Wu.max),qi.expandByPoint(Wn)):(qi.expandByPoint(Wu.min),qi.expandByPoint(Wu.max))}qi.getCenter(i);let r=0;for(let s=0,o=e.count;s<o;s++)Wn.fromBufferAttribute(e,s),r=Math.max(r,i.distanceToSquared(Wn));if(t)for(let s=0,o=t.length;s<o;s++){const a=t[s],c=this.morphTargetsRelative;for(let f=0,d=a.count;f<d;f++)Wn.fromBufferAttribute(a,f),c&&(sl.fromBufferAttribute(e,f),Wn.add(sl)),r=Math.max(r,i.distanceToSquared(Wn))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=e.array,r=t.position.array,s=t.normal.array,o=t.uv.array,a=r.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Kt(new Float32Array(4*a),4));const c=this.getAttribute("tangent").array,f=[],d=[];for(let R=0;R<a;R++)f[R]=new k,d[R]=new k;const h=new k,m=new k,v=new k,y=new be,w=new be,x=new be,g=new k,S=new k;function M(R,B,$){h.fromArray(r,R*3),m.fromArray(r,B*3),v.fromArray(r,$*3),y.fromArray(o,R*2),w.fromArray(o,B*2),x.fromArray(o,$*2),m.sub(h),v.sub(h),w.sub(y),x.sub(y);const me=1/(w.x*x.y-x.x*w.y);isFinite(me)&&(g.copy(m).multiplyScalar(x.y).addScaledVector(v,-w.y).multiplyScalar(me),S.copy(v).multiplyScalar(w.x).addScaledVector(m,-x.x).multiplyScalar(me),f[R].add(g),f[B].add(g),f[$].add(g),d[R].add(S),d[B].add(S),d[$].add(S))}let T=this.groups;T.length===0&&(T=[{start:0,count:i.length}]);for(let R=0,B=T.length;R<B;++R){const $=T[R],me=$.start,G=$.count;for(let Z=me,ne=me+G;Z<ne;Z+=3)M(i[Z+0],i[Z+1],i[Z+2])}const P=new k,b=new k,L=new k,O=new k;function C(R){L.fromArray(s,R*3),O.copy(L);const B=f[R];P.copy(B),P.sub(L.multiplyScalar(L.dot(B))).normalize(),b.crossVectors(O,B);const me=b.dot(d[R])<0?-1:1;c[R*4]=P.x,c[R*4+1]=P.y,c[R*4+2]=P.z,c[R*4+3]=me}for(let R=0,B=T.length;R<B;++R){const $=T[R],me=$.start,G=$.count;for(let Z=me,ne=me+G;Z<ne;Z+=3)C(i[Z+0]),C(i[Z+1]),C(i[Z+2])}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new Kt(new Float32Array(t.count*3),3),this.setAttribute("normal",i);else for(let m=0,v=i.count;m<v;m++)i.setXYZ(m,0,0,0);const r=new k,s=new k,o=new k,a=new k,c=new k,f=new k,d=new k,h=new k;if(e)for(let m=0,v=e.count;m<v;m+=3){const y=e.getX(m+0),w=e.getX(m+1),x=e.getX(m+2);r.fromBufferAttribute(t,y),s.fromBufferAttribute(t,w),o.fromBufferAttribute(t,x),d.subVectors(o,s),h.subVectors(r,s),d.cross(h),a.fromBufferAttribute(i,y),c.fromBufferAttribute(i,w),f.fromBufferAttribute(i,x),a.add(d),c.add(d),f.add(d),i.setXYZ(y,a.x,a.y,a.z),i.setXYZ(w,c.x,c.y,c.z),i.setXYZ(x,f.x,f.y,f.z)}else for(let m=0,v=t.count;m<v;m+=3)r.fromBufferAttribute(t,m+0),s.fromBufferAttribute(t,m+1),o.fromBufferAttribute(t,m+2),d.subVectors(o,s),h.subVectors(r,s),d.cross(h),i.setXYZ(m+0,d.x,d.y,d.z),i.setXYZ(m+1,d.x,d.y,d.z),i.setXYZ(m+2,d.x,d.y,d.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)Wn.fromBufferAttribute(e,t),Wn.normalize(),e.setXYZ(t,Wn.x,Wn.y,Wn.z)}toNonIndexed(){function e(a,c){const f=a.array,d=a.itemSize,h=a.normalized,m=new f.constructor(c.length*d);let v=0,y=0;for(let w=0,x=c.length;w<x;w++){a.isInterleavedBufferAttribute?v=c[w]*a.data.stride+a.offset:v=c[w]*d;for(let g=0;g<d;g++)m[y++]=f[v++]}return new Kt(m,d,h)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Dt,i=this.index.array,r=this.attributes;for(const a in r){const c=r[a],f=e(c,i);t.setAttribute(a,f)}const s=this.morphAttributes;for(const a in s){const c=[],f=s[a];for(let d=0,h=f.length;d<h;d++){const m=f[d],v=e(m,i);c.push(v)}t.morphAttributes[a]=c}t.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let a=0,c=o.length;a<c;a++){const f=o[a];t.addGroup(f.start,f.count,f.materialIndex)}return t}toJSON(){const e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const c=this.parameters;for(const f in c)c[f]!==void 0&&(e[f]=c[f]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const i=this.attributes;for(const c in i){const f=i[c];e.data.attributes[c]=f.toJSON(e.data)}const r={};let s=!1;for(const c in this.morphAttributes){const f=this.morphAttributes[c],d=[];for(let h=0,m=f.length;h<m;h++){const v=f[h];d.push(v.toJSON(e.data))}d.length>0&&(r[c]=d,s=!0)}s&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(e.data.groups=JSON.parse(JSON.stringify(o)));const a=this.boundingSphere;return a!==null&&(e.data.boundingSphere={center:a.center.toArray(),radius:a.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const i=e.index;i!==null&&this.setIndex(i.clone(t));const r=e.attributes;for(const f in r){const d=r[f];this.setAttribute(f,d.clone(t))}const s=e.morphAttributes;for(const f in s){const d=[],h=s[f];for(let m=0,v=h.length;m<v;m++)d.push(h[m].clone(t));this.morphAttributes[f]=d}this.morphTargetsRelative=e.morphTargetsRelative;const o=e.groups;for(let f=0,d=o.length;f<d;f++){const h=o[f];this.addGroup(h.start,h.count,h.materialIndex)}const a=e.boundingBox;a!==null&&(this.boundingBox=a.clone());const c=e.boundingSphere;return c!==null&&(this.boundingSphere=c.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const wM=new Mt,Go=new Pa,jd=new hi,EM=new k,ol=new k,al=new k,ll=new k,f0=new k,Yd=new k,qd=new be,Zd=new be,Kd=new be,TM=new k,AM=new k,bM=new k,Jd=new k,Qd=new k;class kn extends Wt{constructor(e=new Dt,t=new Ro){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}getVertexPosition(e,t){const i=this.geometry,r=i.attributes.position,s=i.morphAttributes.position,o=i.morphTargetsRelative;t.fromBufferAttribute(r,e);const a=this.morphTargetInfluences;if(s&&a){Yd.set(0,0,0);for(let c=0,f=s.length;c<f;c++){const d=a[c],h=s[c];d!==0&&(f0.fromBufferAttribute(h,e),o?Yd.addScaledVector(f0,d):Yd.addScaledVector(f0.sub(t),d))}t.add(Yd)}return t}raycast(e,t){const i=this.geometry,r=this.material,s=this.matrixWorld;r!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),jd.copy(i.boundingSphere),jd.applyMatrix4(s),Go.copy(e.ray).recast(e.near),!(jd.containsPoint(Go.origin)===!1&&(Go.intersectSphere(jd,EM)===null||Go.origin.distanceToSquared(EM)>(e.far-e.near)**2))&&(wM.copy(s).invert(),Go.copy(e.ray).applyMatrix4(wM),!(i.boundingBox!==null&&Go.intersectsBox(i.boundingBox)===!1)&&this._computeIntersections(e,t,Go)))}_computeIntersections(e,t,i){let r;const s=this.geometry,o=this.material,a=s.index,c=s.attributes.position,f=s.attributes.uv,d=s.attributes.uv1,h=s.attributes.normal,m=s.groups,v=s.drawRange;if(a!==null)if(Array.isArray(o))for(let y=0,w=m.length;y<w;y++){const x=m[y],g=o[x.materialIndex],S=Math.max(x.start,v.start),M=Math.min(a.count,Math.min(x.start+x.count,v.start+v.count));for(let T=S,P=M;T<P;T+=3){const b=a.getX(T),L=a.getX(T+1),O=a.getX(T+2);r=$d(this,g,e,i,f,d,h,b,L,O),r&&(r.faceIndex=Math.floor(T/3),r.face.materialIndex=x.materialIndex,t.push(r))}}else{const y=Math.max(0,v.start),w=Math.min(a.count,v.start+v.count);for(let x=y,g=w;x<g;x+=3){const S=a.getX(x),M=a.getX(x+1),T=a.getX(x+2);r=$d(this,o,e,i,f,d,h,S,M,T),r&&(r.faceIndex=Math.floor(x/3),t.push(r))}}else if(c!==void 0)if(Array.isArray(o))for(let y=0,w=m.length;y<w;y++){const x=m[y],g=o[x.materialIndex],S=Math.max(x.start,v.start),M=Math.min(c.count,Math.min(x.start+x.count,v.start+v.count));for(let T=S,P=M;T<P;T+=3){const b=T,L=T+1,O=T+2;r=$d(this,g,e,i,f,d,h,b,L,O),r&&(r.faceIndex=Math.floor(T/3),r.face.materialIndex=x.materialIndex,t.push(r))}}else{const y=Math.max(0,v.start),w=Math.min(c.count,v.start+v.count);for(let x=y,g=w;x<g;x+=3){const S=x,M=x+1,T=x+2;r=$d(this,o,e,i,f,d,h,S,M,T),r&&(r.faceIndex=Math.floor(x/3),t.push(r))}}}}function jL(n,e,t,i,r,s,o,a){let c;if(e.side===Ei?c=i.intersectTriangle(o,s,r,!0,a):c=i.intersectTriangle(r,s,o,e.side===Ns,a),c===null)return null;Qd.copy(a),Qd.applyMatrix4(n.matrixWorld);const f=t.ray.origin.distanceTo(Qd);return f<t.near||f>t.far?null:{distance:f,point:Qd.clone(),object:n}}function $d(n,e,t,i,r,s,o,a,c,f){n.getVertexPosition(a,ol),n.getVertexPosition(c,al),n.getVertexPosition(f,ll);const d=jL(n,e,t,i,ol,al,ll,Jd);if(d){r&&(qd.fromBufferAttribute(r,a),Zd.fromBufferAttribute(r,c),Kd.fromBufferAttribute(r,f),d.uv=Di.getInterpolation(Jd,ol,al,ll,qd,Zd,Kd,new be)),s&&(qd.fromBufferAttribute(s,a),Zd.fromBufferAttribute(s,c),Kd.fromBufferAttribute(s,f),d.uv1=Di.getInterpolation(Jd,ol,al,ll,qd,Zd,Kd,new be),d.uv2=d.uv1),o&&(TM.fromBufferAttribute(o,a),AM.fromBufferAttribute(o,c),bM.fromBufferAttribute(o,f),d.normal=Di.getInterpolation(Jd,ol,al,ll,TM,AM,bM,new k),d.normal.dot(i.direction)>0&&d.normal.multiplyScalar(-1));const h={a,b:c,c:f,normal:new k,materialIndex:0};Di.getNormal(ol,al,ll,h.normal),d.face=h}return d}class La extends Dt{constructor(e=1,t=1,i=1,r=1,s=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:s,depthSegments:o};const a=this;r=Math.floor(r),s=Math.floor(s),o=Math.floor(o);const c=[],f=[],d=[],h=[];let m=0,v=0;y("z","y","x",-1,-1,i,t,e,o,s,0),y("z","y","x",1,-1,i,t,-e,o,s,1),y("x","z","y",1,1,e,i,t,r,o,2),y("x","z","y",1,-1,e,i,-t,r,o,3),y("x","y","z",1,-1,e,t,i,r,s,4),y("x","y","z",-1,-1,e,t,-i,r,s,5),this.setIndex(c),this.setAttribute("position",new ft(f,3)),this.setAttribute("normal",new ft(d,3)),this.setAttribute("uv",new ft(h,2));function y(w,x,g,S,M,T,P,b,L,O,C){const R=T/L,B=P/O,$=T/2,me=P/2,G=b/2,Z=L+1,ne=O+1;let he=0,F=0;const W=new k;for(let V=0;V<ne;V++){const Q=V*B-me;for(let se=0;se<Z;se++){const J=se*R-$;W[w]=J*S,W[x]=Q*M,W[g]=G,f.push(W.x,W.y,W.z),W[w]=0,W[x]=0,W[g]=b>0?1:-1,d.push(W.x,W.y,W.z),h.push(se/L),h.push(1-V/O),he+=1}}for(let V=0;V<O;V++)for(let Q=0;Q<L;Q++){const se=m+Q+Z*V,J=m+Q+Z*(V+1),ge=m+(Q+1)+Z*(V+1),Ie=m+(Q+1)+Z*V;c.push(se,J,Ie),c.push(J,ge,Ie),F+=6}a.addGroup(v,F,C),v+=F,m+=he}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new La(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function ru(n){const e={};for(const t in n){e[t]={};for(const i in n[t]){const r=n[t][i];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture||r.isQuaternion)?r.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][i]=null):e[t][i]=r.clone():Array.isArray(r)?e[t][i]=r.slice():e[t][i]=r}}return e}function xi(n){const e={};for(let t=0;t<n.length;t++){const i=ru(n[t]);for(const r in i)e[r]=i[r]}return e}function YL(n){const e=[];for(let t=0;t<n.length;t++)e.push(n[t].clone());return e}function bb(n){return n.getRenderTarget()===null?n.outputColorSpace:Yt.workingColorSpace}const B_={clone:ru,merge:xi};var qL=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,ZL=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class kr extends mi{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=qL,this.fragmentShader=ZL,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1,clipCullDistance:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=ru(e.uniforms),this.uniformsGroups=YL(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const r in this.uniforms){const o=this.uniforms[r].value;o&&o.isTexture?t.uniforms[r]={type:"t",value:o.toJSON(e).uuid}:o&&o.isColor?t.uniforms[r]={type:"c",value:o.getHex()}:o&&o.isVector2?t.uniforms[r]={type:"v2",value:o.toArray()}:o&&o.isVector3?t.uniforms[r]={type:"v3",value:o.toArray()}:o&&o.isVector4?t.uniforms[r]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?t.uniforms[r]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?t.uniforms[r]={type:"m4",value:o.toArray()}:t.uniforms[r]={value:o}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const i={};for(const r in this.extensions)this.extensions[r]===!0&&(i[r]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class pf extends Wt{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Mt,this.projectionMatrix=new Mt,this.projectionMatrixInverse=new Mt,this.coordinateSystem=Nr}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}let dn=class extends pf{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=iu*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(ma*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return iu*2*Math.atan(Math.tan(ma*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,r,s,o){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(ma*.5*this.fov)/this.zoom,i=2*t,r=this.aspect*i,s=-.5*r;const o=this.view;if(this.view!==null&&this.view.enabled){const c=o.fullWidth,f=o.fullHeight;s+=o.offsetX*r/c,t-=o.offsetY*i/f,r*=o.width/c,i*=o.height/f}const a=this.filmOffset;a!==0&&(s+=e*a/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+r,t,t-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}};const ul=-90,cl=1;class Cb extends Wt{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null,this.activeMipmapLevel=0;const r=new dn(ul,cl,e,t);r.layers=this.layers,this.add(r);const s=new dn(ul,cl,e,t);s.layers=this.layers,this.add(s);const o=new dn(ul,cl,e,t);o.layers=this.layers,this.add(o);const a=new dn(ul,cl,e,t);a.layers=this.layers,this.add(a);const c=new dn(ul,cl,e,t);c.layers=this.layers,this.add(c);const f=new dn(ul,cl,e,t);f.layers=this.layers,this.add(f)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[i,r,s,o,a,c]=t;for(const f of t)this.remove(f);if(e===Nr)i.up.set(0,1,0),i.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),a.up.set(0,1,0),a.lookAt(0,0,1),c.up.set(0,1,0),c.lookAt(0,0,-1);else if(e===nu)i.up.set(0,-1,0),i.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),a.up.set(0,-1,0),a.lookAt(0,0,1),c.up.set(0,-1,0),c.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const f of t)this.add(f),f.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:i,activeMipmapLevel:r}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,o,a,c,f,d]=this.children,h=e.getRenderTarget(),m=e.getActiveCubeFace(),v=e.getActiveMipmapLevel(),y=e.xr.enabled;e.xr.enabled=!1;const w=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0,r),e.render(t,s),e.setRenderTarget(i,1,r),e.render(t,o),e.setRenderTarget(i,2,r),e.render(t,a),e.setRenderTarget(i,3,r),e.render(t,c),e.setRenderTarget(i,4,r),e.render(t,f),i.texture.generateMipmaps=w,e.setRenderTarget(i,5,r),e.render(t,d),e.setRenderTarget(h,m,v),e.xr.enabled=y,i.texture.needsPMREMUpdate=!0}}class mf extends bn{constructor(e,t,i,r,s,o,a,c,f,d){e=e!==void 0?e:[],t=t!==void 0?t:Ds,super(e,t,i,r,s,o,a,c,f,d),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class Rb extends Sr{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];t.encoding!==void 0&&(vc("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),t.colorSpace=t.encoding===_o?Un:Ji),this.texture=new mf(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=t.generateMipmaps!==void 0?t.generateMipmaps:!1,this.texture.minFilter=t.minFilter!==void 0?t.minFilter:fn}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new La(5,5,5),s=new kr({name:"CubemapFromEquirect",uniforms:ru(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:Ei,blending:Cs});s.uniforms.tEquirect.value=t;const o=new kn(r,s),a=t.minFilter;return t.minFilter===wo&&(t.minFilter=fn),new Cb(1,10,this).update(e,o),t.minFilter=a,o.geometry.dispose(),o.material.dispose(),this}clear(e,t,i,r){const s=e.getRenderTarget();for(let o=0;o<6;o++)e.setRenderTarget(this,o),e.clear(t,i,r);e.setRenderTarget(s)}}const d0=new k,KL=new k,JL=new Nt;class Ss{constructor(e=new k(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){const r=d0.subVectors(i,t).cross(KL.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const i=e.delta(d0),r=this.normal.dot(i);if(r===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/r;return s<0||s>1?null:t.copy(e.start).addScaledVector(i,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const i=t||JL.getNormalMatrix(e),r=this.coplanarPoint(d0).applyMatrix4(e),s=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Wo=new hi,eh=new k;class gf{constructor(e=new Ss,t=new Ss,i=new Ss,r=new Ss,s=new Ss,o=new Ss){this.planes=[e,t,i,r,s,o]}set(e,t,i,r,s,o){const a=this.planes;return a[0].copy(e),a[1].copy(t),a[2].copy(i),a[3].copy(r),a[4].copy(s),a[5].copy(o),this}copy(e){const t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=Nr){const i=this.planes,r=e.elements,s=r[0],o=r[1],a=r[2],c=r[3],f=r[4],d=r[5],h=r[6],m=r[7],v=r[8],y=r[9],w=r[10],x=r[11],g=r[12],S=r[13],M=r[14],T=r[15];if(i[0].setComponents(c-s,m-f,x-v,T-g).normalize(),i[1].setComponents(c+s,m+f,x+v,T+g).normalize(),i[2].setComponents(c+o,m+d,x+y,T+S).normalize(),i[3].setComponents(c-o,m-d,x-y,T-S).normalize(),i[4].setComponents(c-a,m-h,x-w,T-M).normalize(),t===Nr)i[5].setComponents(c+a,m+h,x+w,T+M).normalize();else if(t===nu)i[5].setComponents(a,h,w,M).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),Wo.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),Wo.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(Wo)}intersectsSprite(e){return Wo.center.set(0,0,0),Wo.radius=.7071067811865476,Wo.applyMatrix4(e.matrixWorld),this.intersectsSphere(Wo)}intersectsSphere(e){const t=this.planes,i=e.center,r=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(i)<r)return!1;return!0}intersectsBox(e){const t=this.planes;for(let i=0;i<6;i++){const r=t[i];if(eh.x=r.normal.x>0?e.max.x:e.min.x,eh.y=r.normal.y>0?e.max.y:e.min.y,eh.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(eh)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let i=0;i<6;i++)if(t[i].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function Pb(){let n=null,e=!1,t=null,i=null;function r(s,o){t(s,o),i=n.requestAnimationFrame(r)}return{start:function(){e!==!0&&t!==null&&(i=n.requestAnimationFrame(r),e=!0)},stop:function(){n.cancelAnimationFrame(i),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){n=s}}}function QL(n,e){const t=e.isWebGL2,i=new WeakMap;function r(f,d){const h=f.array,m=f.usage,v=h.byteLength,y=n.createBuffer();n.bindBuffer(d,y),n.bufferData(d,h,m),f.onUploadCallback();let w;if(h instanceof Float32Array)w=n.FLOAT;else if(h instanceof Uint16Array)if(f.isFloat16BufferAttribute)if(t)w=n.HALF_FLOAT;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else w=n.UNSIGNED_SHORT;else if(h instanceof Int16Array)w=n.SHORT;else if(h instanceof Uint32Array)w=n.UNSIGNED_INT;else if(h instanceof Int32Array)w=n.INT;else if(h instanceof Int8Array)w=n.BYTE;else if(h instanceof Uint8Array)w=n.UNSIGNED_BYTE;else if(h instanceof Uint8ClampedArray)w=n.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+h);return{buffer:y,type:w,bytesPerElement:h.BYTES_PER_ELEMENT,version:f.version,size:v}}function s(f,d,h){const m=d.array,v=d._updateRange,y=d.updateRanges;if(n.bindBuffer(h,f),v.count===-1&&y.length===0&&n.bufferSubData(h,0,m),y.length!==0){for(let w=0,x=y.length;w<x;w++){const g=y[w];t?n.bufferSubData(h,g.start*m.BYTES_PER_ELEMENT,m,g.start,g.count):n.bufferSubData(h,g.start*m.BYTES_PER_ELEMENT,m.subarray(g.start,g.start+g.count))}d.clearUpdateRanges()}v.count!==-1&&(t?n.bufferSubData(h,v.offset*m.BYTES_PER_ELEMENT,m,v.offset,v.count):n.bufferSubData(h,v.offset*m.BYTES_PER_ELEMENT,m.subarray(v.offset,v.offset+v.count)),v.count=-1),d.onUploadCallback()}function o(f){return f.isInterleavedBufferAttribute&&(f=f.data),i.get(f)}function a(f){f.isInterleavedBufferAttribute&&(f=f.data);const d=i.get(f);d&&(n.deleteBuffer(d.buffer),i.delete(f))}function c(f,d){if(f.isGLBufferAttribute){const m=i.get(f);(!m||m.version<f.version)&&i.set(f,{buffer:f.buffer,type:f.type,bytesPerElement:f.elementSize,version:f.version});return}f.isInterleavedBufferAttribute&&(f=f.data);const h=i.get(f);if(h===void 0)i.set(f,r(f,d));else if(h.version<f.version){if(h.size!==f.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");s(h.buffer,f,d),h.version=f.version}}return{get:o,remove:a,update:c}}class vf extends Dt{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};const s=e/2,o=t/2,a=Math.floor(i),c=Math.floor(r),f=a+1,d=c+1,h=e/a,m=t/c,v=[],y=[],w=[],x=[];for(let g=0;g<d;g++){const S=g*m-o;for(let M=0;M<f;M++){const T=M*h-s;y.push(T,-S,0),w.push(0,0,1),x.push(M/a),x.push(1-g/c)}}for(let g=0;g<c;g++)for(let S=0;S<a;S++){const M=S+f*g,T=S+f*(g+1),P=S+1+f*(g+1),b=S+1+f*g;v.push(M,T,b),v.push(T,P,b)}this.setIndex(v),this.setAttribute("position",new ft(y,3)),this.setAttribute("normal",new ft(w,3)),this.setAttribute("uv",new ft(x,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new vf(e.width,e.height,e.widthSegments,e.heightSegments)}}var $L=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,eI=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,tI=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,nI=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,iI=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,rI=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,sI=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,oI=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,aI=`#ifdef USE_BATCHING
	attribute float batchId;
	uniform highp sampler2D batchingTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,lI=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( batchId );
#endif`,uI=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,cI=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,fI=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,dI=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,hI=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,pI=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,mI=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,gI=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,vI=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,yI=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,_I=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,xI=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,SI=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,MI=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float luminance( const in vec3 rgb ) {
	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );
	return dot( weights, rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,wI=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,EI=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,TI=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,AI=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,bI=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,CI=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,RI="gl_FragColor = linearToOutputTexel( gl_FragColor );",PI=`
const mat3 LINEAR_SRGB_TO_LINEAR_DISPLAY_P3 = mat3(
	vec3( 0.8224621, 0.177538, 0.0 ),
	vec3( 0.0331941, 0.9668058, 0.0 ),
	vec3( 0.0170827, 0.0723974, 0.9105199 )
);
const mat3 LINEAR_DISPLAY_P3_TO_LINEAR_SRGB = mat3(
	vec3( 1.2249401, - 0.2249404, 0.0 ),
	vec3( - 0.0420569, 1.0420571, 0.0 ),
	vec3( - 0.0196376, - 0.0786361, 1.0982735 )
);
vec4 LinearSRGBToLinearDisplayP3( in vec4 value ) {
	return vec4( value.rgb * LINEAR_SRGB_TO_LINEAR_DISPLAY_P3, value.a );
}
vec4 LinearDisplayP3ToLinearSRGB( in vec4 value ) {
	return vec4( value.rgb * LINEAR_DISPLAY_P3_TO_LINEAR_SRGB, value.a );
}
vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return sRGBTransferOETF( value );
}`,LI=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,II=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,NI=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,DI=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,UI=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,OI=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,kI=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,FI=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,zI=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,BI=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,HI=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,VI=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,GI=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,WI=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,XI=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( LEGACY_LIGHTS )
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#else
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,jI=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,YI=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,qI=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,ZI=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,KI=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,JI=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,QI=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,$I=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,eN=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,tN=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,nN=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,iN=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,rN=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,sN=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,oN=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,aN=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,lN=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,uN=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,cN=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,fN=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,dN=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,hN=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,pN=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,mN=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,gN=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,vN=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,yN=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,_N=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,xN=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,SN=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,MN=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,wN=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,EN=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,TN=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,AN=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,bN=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec2 packDepthToRG( in highp float v ) {
	return packDepthToRGBA( v ).yx;
}
float unpackRGToDepth( const in highp vec2 v ) {
	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,CN=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,RN=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,PN=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,LN=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,IN=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,NN=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,DN=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,UN=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,ON=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,kN=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,FN=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,zN=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,BN=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,HN=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,VN=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,GN=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,WN=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,XN=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color *= toneMappingExposure;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	return color;
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,jN=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,YN=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,qN=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,ZN=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,KN=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,JN=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const QN=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,$N=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,eD=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,tD=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,nD=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,iD=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,rD=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,sD=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,oD=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,aD=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,lD=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,uD=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,cD=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,fD=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,dD=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,hD=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,pD=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,mD=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,gD=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,vD=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,yD=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,_D=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,xD=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,SD=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,MD=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,wD=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,ED=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,TD=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,AD=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,bD=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,CD=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,RD=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,PD=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,LD=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Pt={alphahash_fragment:$L,alphahash_pars_fragment:eI,alphamap_fragment:tI,alphamap_pars_fragment:nI,alphatest_fragment:iI,alphatest_pars_fragment:rI,aomap_fragment:sI,aomap_pars_fragment:oI,batching_pars_vertex:aI,batching_vertex:lI,begin_vertex:uI,beginnormal_vertex:cI,bsdfs:fI,iridescence_fragment:dI,bumpmap_pars_fragment:hI,clipping_planes_fragment:pI,clipping_planes_pars_fragment:mI,clipping_planes_pars_vertex:gI,clipping_planes_vertex:vI,color_fragment:yI,color_pars_fragment:_I,color_pars_vertex:xI,color_vertex:SI,common:MI,cube_uv_reflection_fragment:wI,defaultnormal_vertex:EI,displacementmap_pars_vertex:TI,displacementmap_vertex:AI,emissivemap_fragment:bI,emissivemap_pars_fragment:CI,colorspace_fragment:RI,colorspace_pars_fragment:PI,envmap_fragment:LI,envmap_common_pars_fragment:II,envmap_pars_fragment:NI,envmap_pars_vertex:DI,envmap_physical_pars_fragment:jI,envmap_vertex:UI,fog_vertex:OI,fog_pars_vertex:kI,fog_fragment:FI,fog_pars_fragment:zI,gradientmap_pars_fragment:BI,lightmap_fragment:HI,lightmap_pars_fragment:VI,lights_lambert_fragment:GI,lights_lambert_pars_fragment:WI,lights_pars_begin:XI,lights_toon_fragment:YI,lights_toon_pars_fragment:qI,lights_phong_fragment:ZI,lights_phong_pars_fragment:KI,lights_physical_fragment:JI,lights_physical_pars_fragment:QI,lights_fragment_begin:$I,lights_fragment_maps:eN,lights_fragment_end:tN,logdepthbuf_fragment:nN,logdepthbuf_pars_fragment:iN,logdepthbuf_pars_vertex:rN,logdepthbuf_vertex:sN,map_fragment:oN,map_pars_fragment:aN,map_particle_fragment:lN,map_particle_pars_fragment:uN,metalnessmap_fragment:cN,metalnessmap_pars_fragment:fN,morphcolor_vertex:dN,morphnormal_vertex:hN,morphtarget_pars_vertex:pN,morphtarget_vertex:mN,normal_fragment_begin:gN,normal_fragment_maps:vN,normal_pars_fragment:yN,normal_pars_vertex:_N,normal_vertex:xN,normalmap_pars_fragment:SN,clearcoat_normal_fragment_begin:MN,clearcoat_normal_fragment_maps:wN,clearcoat_pars_fragment:EN,iridescence_pars_fragment:TN,opaque_fragment:AN,packing:bN,premultiplied_alpha_fragment:CN,project_vertex:RN,dithering_fragment:PN,dithering_pars_fragment:LN,roughnessmap_fragment:IN,roughnessmap_pars_fragment:NN,shadowmap_pars_fragment:DN,shadowmap_pars_vertex:UN,shadowmap_vertex:ON,shadowmask_pars_fragment:kN,skinbase_vertex:FN,skinning_pars_vertex:zN,skinning_vertex:BN,skinnormal_vertex:HN,specularmap_fragment:VN,specularmap_pars_fragment:GN,tonemapping_fragment:WN,tonemapping_pars_fragment:XN,transmission_fragment:jN,transmission_pars_fragment:YN,uv_pars_fragment:qN,uv_pars_vertex:ZN,uv_vertex:KN,worldpos_vertex:JN,background_vert:QN,background_frag:$N,backgroundCube_vert:eD,backgroundCube_frag:tD,cube_vert:nD,cube_frag:iD,depth_vert:rD,depth_frag:sD,distanceRGBA_vert:oD,distanceRGBA_frag:aD,equirect_vert:lD,equirect_frag:uD,linedashed_vert:cD,linedashed_frag:fD,meshbasic_vert:dD,meshbasic_frag:hD,meshlambert_vert:pD,meshlambert_frag:mD,meshmatcap_vert:gD,meshmatcap_frag:vD,meshnormal_vert:yD,meshnormal_frag:_D,meshphong_vert:xD,meshphong_frag:SD,meshphysical_vert:MD,meshphysical_frag:wD,meshtoon_vert:ED,meshtoon_frag:TD,points_vert:AD,points_frag:bD,shadow_vert:CD,shadow_frag:RD,sprite_vert:PD,sprite_frag:LD},qe={common:{diffuse:{value:new nt(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Nt},alphaMap:{value:null},alphaMapTransform:{value:new Nt},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Nt}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Nt}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Nt}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Nt},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Nt},normalScale:{value:new be(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Nt},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Nt}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Nt}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Nt}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new nt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new nt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Nt},alphaTest:{value:0},uvTransform:{value:new Nt}},sprite:{diffuse:{value:new nt(16777215)},opacity:{value:1},center:{value:new be(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Nt},alphaMap:{value:null},alphaMapTransform:{value:new Nt},alphaTest:{value:0}}},Ir={basic:{uniforms:xi([qe.common,qe.specularmap,qe.envmap,qe.aomap,qe.lightmap,qe.fog]),vertexShader:Pt.meshbasic_vert,fragmentShader:Pt.meshbasic_frag},lambert:{uniforms:xi([qe.common,qe.specularmap,qe.envmap,qe.aomap,qe.lightmap,qe.emissivemap,qe.bumpmap,qe.normalmap,qe.displacementmap,qe.fog,qe.lights,{emissive:{value:new nt(0)}}]),vertexShader:Pt.meshlambert_vert,fragmentShader:Pt.meshlambert_frag},phong:{uniforms:xi([qe.common,qe.specularmap,qe.envmap,qe.aomap,qe.lightmap,qe.emissivemap,qe.bumpmap,qe.normalmap,qe.displacementmap,qe.fog,qe.lights,{emissive:{value:new nt(0)},specular:{value:new nt(1118481)},shininess:{value:30}}]),vertexShader:Pt.meshphong_vert,fragmentShader:Pt.meshphong_frag},standard:{uniforms:xi([qe.common,qe.envmap,qe.aomap,qe.lightmap,qe.emissivemap,qe.bumpmap,qe.normalmap,qe.displacementmap,qe.roughnessmap,qe.metalnessmap,qe.fog,qe.lights,{emissive:{value:new nt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Pt.meshphysical_vert,fragmentShader:Pt.meshphysical_frag},toon:{uniforms:xi([qe.common,qe.aomap,qe.lightmap,qe.emissivemap,qe.bumpmap,qe.normalmap,qe.displacementmap,qe.gradientmap,qe.fog,qe.lights,{emissive:{value:new nt(0)}}]),vertexShader:Pt.meshtoon_vert,fragmentShader:Pt.meshtoon_frag},matcap:{uniforms:xi([qe.common,qe.bumpmap,qe.normalmap,qe.displacementmap,qe.fog,{matcap:{value:null}}]),vertexShader:Pt.meshmatcap_vert,fragmentShader:Pt.meshmatcap_frag},points:{uniforms:xi([qe.points,qe.fog]),vertexShader:Pt.points_vert,fragmentShader:Pt.points_frag},dashed:{uniforms:xi([qe.common,qe.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Pt.linedashed_vert,fragmentShader:Pt.linedashed_frag},depth:{uniforms:xi([qe.common,qe.displacementmap]),vertexShader:Pt.depth_vert,fragmentShader:Pt.depth_frag},normal:{uniforms:xi([qe.common,qe.bumpmap,qe.normalmap,qe.displacementmap,{opacity:{value:1}}]),vertexShader:Pt.meshnormal_vert,fragmentShader:Pt.meshnormal_frag},sprite:{uniforms:xi([qe.sprite,qe.fog]),vertexShader:Pt.sprite_vert,fragmentShader:Pt.sprite_frag},background:{uniforms:{uvTransform:{value:new Nt},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Pt.background_vert,fragmentShader:Pt.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:Pt.backgroundCube_vert,fragmentShader:Pt.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Pt.cube_vert,fragmentShader:Pt.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Pt.equirect_vert,fragmentShader:Pt.equirect_frag},distanceRGBA:{uniforms:xi([qe.common,qe.displacementmap,{referencePosition:{value:new k},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Pt.distanceRGBA_vert,fragmentShader:Pt.distanceRGBA_frag},shadow:{uniforms:xi([qe.lights,qe.fog,{color:{value:new nt(0)},opacity:{value:1}}]),vertexShader:Pt.shadow_vert,fragmentShader:Pt.shadow_frag}};Ir.physical={uniforms:xi([Ir.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Nt},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Nt},clearcoatNormalScale:{value:new be(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Nt},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Nt},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Nt},sheen:{value:0},sheenColor:{value:new nt(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Nt},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Nt},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Nt},transmissionSamplerSize:{value:new be},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Nt},attenuationDistance:{value:0},attenuationColor:{value:new nt(0)},specularColor:{value:new nt(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Nt},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Nt},anisotropyVector:{value:new be},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Nt}}]),vertexShader:Pt.meshphysical_vert,fragmentShader:Pt.meshphysical_frag};const th={r:0,b:0,g:0};function ID(n,e,t,i,r,s,o){const a=new nt(0);let c=s===!0?0:1,f,d,h=null,m=0,v=null;function y(x,g){let S=!1,M=g.isScene===!0?g.background:null;M&&M.isTexture&&(M=(g.backgroundBlurriness>0?t:e).get(M)),M===null?w(a,c):M&&M.isColor&&(w(M,1),S=!0);const T=n.xr.getEnvironmentBlendMode();T==="additive"?i.buffers.color.setClear(0,0,0,1,o):T==="alpha-blend"&&i.buffers.color.setClear(0,0,0,0,o),(n.autoClear||S)&&n.clear(n.autoClearColor,n.autoClearDepth,n.autoClearStencil),M&&(M.isCubeTexture||M.mapping===cu)?(d===void 0&&(d=new kn(new La(1,1,1),new kr({name:"BackgroundCubeMaterial",uniforms:ru(Ir.backgroundCube.uniforms),vertexShader:Ir.backgroundCube.vertexShader,fragmentShader:Ir.backgroundCube.fragmentShader,side:Ei,depthTest:!1,depthWrite:!1,fog:!1})),d.geometry.deleteAttribute("normal"),d.geometry.deleteAttribute("uv"),d.onBeforeRender=function(P,b,L){this.matrixWorld.copyPosition(L.matrixWorld)},Object.defineProperty(d.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(d)),d.material.uniforms.envMap.value=M,d.material.uniforms.flipEnvMap.value=M.isCubeTexture&&M.isRenderTargetTexture===!1?-1:1,d.material.uniforms.backgroundBlurriness.value=g.backgroundBlurriness,d.material.uniforms.backgroundIntensity.value=g.backgroundIntensity,d.material.toneMapped=Yt.getTransfer(M.colorSpace)!==tn,(h!==M||m!==M.version||v!==n.toneMapping)&&(d.material.needsUpdate=!0,h=M,m=M.version,v=n.toneMapping),d.layers.enableAll(),x.unshift(d,d.geometry,d.material,0,0,null)):M&&M.isTexture&&(f===void 0&&(f=new kn(new vf(2,2),new kr({name:"BackgroundMaterial",uniforms:ru(Ir.background.uniforms),vertexShader:Ir.background.vertexShader,fragmentShader:Ir.background.fragmentShader,side:Ns,depthTest:!1,depthWrite:!1,fog:!1})),f.geometry.deleteAttribute("normal"),Object.defineProperty(f.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(f)),f.material.uniforms.t2D.value=M,f.material.uniforms.backgroundIntensity.value=g.backgroundIntensity,f.material.toneMapped=Yt.getTransfer(M.colorSpace)!==tn,M.matrixAutoUpdate===!0&&M.updateMatrix(),f.material.uniforms.uvTransform.value.copy(M.matrix),(h!==M||m!==M.version||v!==n.toneMapping)&&(f.material.needsUpdate=!0,h=M,m=M.version,v=n.toneMapping),f.layers.enableAll(),x.unshift(f,f.geometry,f.material,0,0,null))}function w(x,g){x.getRGB(th,bb(n)),i.buffers.color.setClear(th.r,th.g,th.b,g,o)}return{getClearColor:function(){return a},setClearColor:function(x,g=1){a.set(x),c=g,w(a,c)},getClearAlpha:function(){return c},setClearAlpha:function(x){c=x,w(a,c)},render:y}}function ND(n,e,t,i){const r=n.getParameter(n.MAX_VERTEX_ATTRIBS),s=i.isWebGL2?null:e.get("OES_vertex_array_object"),o=i.isWebGL2||s!==null,a={},c=x(null);let f=c,d=!1;function h(G,Z,ne,he,F){let W=!1;if(o){const V=w(he,ne,Z);f!==V&&(f=V,v(f.object)),W=g(G,he,ne,F),W&&S(G,he,ne,F)}else{const V=Z.wireframe===!0;(f.geometry!==he.id||f.program!==ne.id||f.wireframe!==V)&&(f.geometry=he.id,f.program=ne.id,f.wireframe=V,W=!0)}F!==null&&t.update(F,n.ELEMENT_ARRAY_BUFFER),(W||d)&&(d=!1,O(G,Z,ne,he),F!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t.get(F).buffer))}function m(){return i.isWebGL2?n.createVertexArray():s.createVertexArrayOES()}function v(G){return i.isWebGL2?n.bindVertexArray(G):s.bindVertexArrayOES(G)}function y(G){return i.isWebGL2?n.deleteVertexArray(G):s.deleteVertexArrayOES(G)}function w(G,Z,ne){const he=ne.wireframe===!0;let F=a[G.id];F===void 0&&(F={},a[G.id]=F);let W=F[Z.id];W===void 0&&(W={},F[Z.id]=W);let V=W[he];return V===void 0&&(V=x(m()),W[he]=V),V}function x(G){const Z=[],ne=[],he=[];for(let F=0;F<r;F++)Z[F]=0,ne[F]=0,he[F]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Z,enabledAttributes:ne,attributeDivisors:he,object:G,attributes:{},index:null}}function g(G,Z,ne,he){const F=f.attributes,W=Z.attributes;let V=0;const Q=ne.getAttributes();for(const se in Q)if(Q[se].location>=0){const ge=F[se];let Ie=W[se];if(Ie===void 0&&(se==="instanceMatrix"&&G.instanceMatrix&&(Ie=G.instanceMatrix),se==="instanceColor"&&G.instanceColor&&(Ie=G.instanceColor)),ge===void 0||ge.attribute!==Ie||Ie&&ge.data!==Ie.data)return!0;V++}return f.attributesNum!==V||f.index!==he}function S(G,Z,ne,he){const F={},W=Z.attributes;let V=0;const Q=ne.getAttributes();for(const se in Q)if(Q[se].location>=0){let ge=W[se];ge===void 0&&(se==="instanceMatrix"&&G.instanceMatrix&&(ge=G.instanceMatrix),se==="instanceColor"&&G.instanceColor&&(ge=G.instanceColor));const Ie={};Ie.attribute=ge,ge&&ge.data&&(Ie.data=ge.data),F[se]=Ie,V++}f.attributes=F,f.attributesNum=V,f.index=he}function M(){const G=f.newAttributes;for(let Z=0,ne=G.length;Z<ne;Z++)G[Z]=0}function T(G){P(G,0)}function P(G,Z){const ne=f.newAttributes,he=f.enabledAttributes,F=f.attributeDivisors;ne[G]=1,he[G]===0&&(n.enableVertexAttribArray(G),he[G]=1),F[G]!==Z&&((i.isWebGL2?n:e.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](G,Z),F[G]=Z)}function b(){const G=f.newAttributes,Z=f.enabledAttributes;for(let ne=0,he=Z.length;ne<he;ne++)Z[ne]!==G[ne]&&(n.disableVertexAttribArray(ne),Z[ne]=0)}function L(G,Z,ne,he,F,W,V){V===!0?n.vertexAttribIPointer(G,Z,ne,F,W):n.vertexAttribPointer(G,Z,ne,he,F,W)}function O(G,Z,ne,he){if(i.isWebGL2===!1&&(G.isInstancedMesh||he.isInstancedBufferGeometry)&&e.get("ANGLE_instanced_arrays")===null)return;M();const F=he.attributes,W=ne.getAttributes(),V=Z.defaultAttributeValues;for(const Q in W){const se=W[Q];if(se.location>=0){let J=F[Q];if(J===void 0&&(Q==="instanceMatrix"&&G.instanceMatrix&&(J=G.instanceMatrix),Q==="instanceColor"&&G.instanceColor&&(J=G.instanceColor)),J!==void 0){const ge=J.normalized,Ie=J.itemSize,Be=t.get(J);if(Be===void 0)continue;const Fe=Be.buffer,Ne=Be.type,je=Be.bytesPerElement,ke=i.isWebGL2===!0&&(Ne===n.INT||Ne===n.UNSIGNED_INT||J.gpuType===E_);if(J.isInterleavedBufferAttribute){const Le=J.data,H=Le.stride,xe=J.offset;if(Le.isInstancedInterleavedBuffer){for(let oe=0;oe<se.locationSize;oe++)P(se.location+oe,Le.meshPerAttribute);G.isInstancedMesh!==!0&&he._maxInstanceCount===void 0&&(he._maxInstanceCount=Le.meshPerAttribute*Le.count)}else for(let oe=0;oe<se.locationSize;oe++)T(se.location+oe);n.bindBuffer(n.ARRAY_BUFFER,Fe);for(let oe=0;oe<se.locationSize;oe++)L(se.location+oe,Ie/se.locationSize,Ne,ge,H*je,(xe+Ie/se.locationSize*oe)*je,ke)}else{if(J.isInstancedBufferAttribute){for(let Le=0;Le<se.locationSize;Le++)P(se.location+Le,J.meshPerAttribute);G.isInstancedMesh!==!0&&he._maxInstanceCount===void 0&&(he._maxInstanceCount=J.meshPerAttribute*J.count)}else for(let Le=0;Le<se.locationSize;Le++)T(se.location+Le);n.bindBuffer(n.ARRAY_BUFFER,Fe);for(let Le=0;Le<se.locationSize;Le++)L(se.location+Le,Ie/se.locationSize,Ne,ge,Ie*je,Ie/se.locationSize*Le*je,ke)}}else if(V!==void 0){const ge=V[Q];if(ge!==void 0)switch(ge.length){case 2:n.vertexAttrib2fv(se.location,ge);break;case 3:n.vertexAttrib3fv(se.location,ge);break;case 4:n.vertexAttrib4fv(se.location,ge);break;default:n.vertexAttrib1fv(se.location,ge)}}}}b()}function C(){$();for(const G in a){const Z=a[G];for(const ne in Z){const he=Z[ne];for(const F in he)y(he[F].object),delete he[F];delete Z[ne]}delete a[G]}}function R(G){if(a[G.id]===void 0)return;const Z=a[G.id];for(const ne in Z){const he=Z[ne];for(const F in he)y(he[F].object),delete he[F];delete Z[ne]}delete a[G.id]}function B(G){for(const Z in a){const ne=a[Z];if(ne[G.id]===void 0)continue;const he=ne[G.id];for(const F in he)y(he[F].object),delete he[F];delete ne[G.id]}}function $(){me(),d=!0,f!==c&&(f=c,v(f.object))}function me(){c.geometry=null,c.program=null,c.wireframe=!1}return{setup:h,reset:$,resetDefaultState:me,dispose:C,releaseStatesOfGeometry:R,releaseStatesOfProgram:B,initAttributes:M,enableAttribute:T,disableUnusedAttributes:b}}function DD(n,e,t,i){const r=i.isWebGL2;let s;function o(d){s=d}function a(d,h){n.drawArrays(s,d,h),t.update(h,s,1)}function c(d,h,m){if(m===0)return;let v,y;if(r)v=n,y="drawArraysInstanced";else if(v=e.get("ANGLE_instanced_arrays"),y="drawArraysInstancedANGLE",v===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}v[y](s,d,h,m),t.update(h,s,m)}function f(d,h,m){if(m===0)return;const v=e.get("WEBGL_multi_draw");if(v===null)for(let y=0;y<m;y++)this.render(d[y],h[y]);else{v.multiDrawArraysWEBGL(s,d,0,h,0,m);let y=0;for(let w=0;w<m;w++)y+=h[w];t.update(y,s,1)}}this.setMode=o,this.render=a,this.renderInstances=c,this.renderMultiDraw=f}function UD(n,e,t){let i;function r(){if(i!==void 0)return i;if(e.has("EXT_texture_filter_anisotropic")===!0){const L=e.get("EXT_texture_filter_anisotropic");i=n.getParameter(L.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function s(L){if(L==="highp"){if(n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.HIGH_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.HIGH_FLOAT).precision>0)return"highp";L="mediump"}return L==="mediump"&&n.getShaderPrecisionFormat(n.VERTEX_SHADER,n.MEDIUM_FLOAT).precision>0&&n.getShaderPrecisionFormat(n.FRAGMENT_SHADER,n.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const o=typeof WebGL2RenderingContext<"u"&&n.constructor.name==="WebGL2RenderingContext";let a=t.precision!==void 0?t.precision:"highp";const c=s(a);c!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",c,"instead."),a=c);const f=o||e.has("WEBGL_draw_buffers"),d=t.logarithmicDepthBuffer===!0,h=n.getParameter(n.MAX_TEXTURE_IMAGE_UNITS),m=n.getParameter(n.MAX_VERTEX_TEXTURE_IMAGE_UNITS),v=n.getParameter(n.MAX_TEXTURE_SIZE),y=n.getParameter(n.MAX_CUBE_MAP_TEXTURE_SIZE),w=n.getParameter(n.MAX_VERTEX_ATTRIBS),x=n.getParameter(n.MAX_VERTEX_UNIFORM_VECTORS),g=n.getParameter(n.MAX_VARYING_VECTORS),S=n.getParameter(n.MAX_FRAGMENT_UNIFORM_VECTORS),M=m>0,T=o||e.has("OES_texture_float"),P=M&&T,b=o?n.getParameter(n.MAX_SAMPLES):0;return{isWebGL2:o,drawBuffers:f,getMaxAnisotropy:r,getMaxPrecision:s,precision:a,logarithmicDepthBuffer:d,maxTextures:h,maxVertexTextures:m,maxTextureSize:v,maxCubemapSize:y,maxAttributes:w,maxVertexUniforms:x,maxVaryings:g,maxFragmentUniforms:S,vertexTextures:M,floatFragmentTextures:T,floatVertexTextures:P,maxSamples:b}}function OD(n){const e=this;let t=null,i=0,r=!1,s=!1;const o=new Ss,a=new Nt,c={value:null,needsUpdate:!1};this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(h,m){const v=h.length!==0||m||i!==0||r;return r=m,i=h.length,v},this.beginShadows=function(){s=!0,d(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(h,m){t=d(h,m,0)},this.setState=function(h,m,v){const y=h.clippingPlanes,w=h.clipIntersection,x=h.clipShadows,g=n.get(h);if(!r||y===null||y.length===0||s&&!x)s?d(null):f();else{const S=s?0:i,M=S*4;let T=g.clippingState||null;c.value=T,T=d(y,m,M,v);for(let P=0;P!==M;++P)T[P]=t[P];g.clippingState=T,this.numIntersection=w?this.numPlanes:0,this.numPlanes+=S}};function f(){c.value!==t&&(c.value=t,c.needsUpdate=i>0),e.numPlanes=i,e.numIntersection=0}function d(h,m,v,y){const w=h!==null?h.length:0;let x=null;if(w!==0){if(x=c.value,y!==!0||x===null){const g=v+w*4,S=m.matrixWorldInverse;a.getNormalMatrix(S),(x===null||x.length<g)&&(x=new Float32Array(g));for(let M=0,T=v;M!==w;++M,T+=4)o.copy(h[M]).applyMatrix4(S,a),o.normal.toArray(x,T),x[T+3]=o.constant}c.value=x,c.needsUpdate=!0}return e.numPlanes=w,e.numIntersection=0,x}}function kD(n){let e=new WeakMap;function t(o,a){return a===Fc?o.mapping=Ds:a===zc&&(o.mapping=Mo),o}function i(o){if(o&&o.isTexture){const a=o.mapping;if(a===Fc||a===zc)if(e.has(o)){const c=e.get(o).texture;return t(c,o.mapping)}else{const c=o.image;if(c&&c.height>0){const f=new Rb(c.height/2);return f.fromEquirectangularTexture(n,o),e.set(o,f),o.addEventListener("dispose",r),t(f.texture,o.mapping)}else return null}}return o}function r(o){const a=o.target;a.removeEventListener("dispose",r);const c=e.get(a);c!==void 0&&(e.delete(a),c.dispose())}function s(){e=new WeakMap}return{get:i,dispose:s}}class ns extends pf{constructor(e=-1,t=1,i=1,r=-1,s=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=s,this.far=o,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,s,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=s,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2;let s=i-e,o=i+e,a=r+t,c=r-t;if(this.view!==null&&this.view.enabled){const f=(this.right-this.left)/this.view.fullWidth/this.zoom,d=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=f*this.view.offsetX,o=s+f*this.view.width,a-=d*this.view.offsetY,c=a-d*this.view.height}this.projectionMatrix.makeOrthographic(s,o,a,c,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}const kl=4,CM=[.125,.215,.35,.446,.526,.582],ra=20,h0=new ns,RM=new nt;let p0=null,m0=0,g0=0;const na=(1+Math.sqrt(5))/2,fl=1/na,PM=[new k(1,1,1),new k(-1,1,1),new k(1,1,-1),new k(-1,1,-1),new k(0,na,fl),new k(0,na,-fl),new k(fl,0,na),new k(-fl,0,na),new k(na,fl,0),new k(-na,fl,0)];class my{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){p0=this._renderer.getRenderTarget(),m0=this._renderer.getActiveCubeFace(),g0=this._renderer.getActiveMipmapLevel(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(e,i,r,s),t>0&&this._blur(s,0,0,t),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=NM(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=IM(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(p0,m0,g0),e.scissorTest=!1,nh(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===Ds||e.mapping===Mo?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),p0=this._renderer.getRenderTarget(),m0=this._renderer.getActiveCubeFace(),g0=this._renderer.getActiveMipmapLevel();const i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:fn,minFilter:fn,generateMipmaps:!1,type:Ea,format:Mi,colorSpace:rs,depthBuffer:!1},r=LM(e,t,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=LM(e,t,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=FD(s)),this._blurMaterial=zD(s,e,t)}return r}_compileMaterial(e){const t=new kn(this._lodPlanes[0],e);this._renderer.compile(t,h0)}_sceneToCubeUV(e,t,i,r){const a=new dn(90,1,t,i),c=[1,-1,1,1,1,1],f=[1,1,1,-1,-1,-1],d=this._renderer,h=d.autoClear,m=d.toneMapping;d.getClearColor(RM),d.toneMapping=es,d.autoClear=!1;const v=new Ro({name:"PMREM.Background",side:Ei,depthWrite:!1,depthTest:!1}),y=new kn(new La,v);let w=!1;const x=e.background;x?x.isColor&&(v.color.copy(x),e.background=null,w=!0):(v.color.copy(RM),w=!0);for(let g=0;g<6;g++){const S=g%3;S===0?(a.up.set(0,c[g],0),a.lookAt(f[g],0,0)):S===1?(a.up.set(0,0,c[g]),a.lookAt(0,f[g],0)):(a.up.set(0,c[g],0),a.lookAt(0,0,f[g]));const M=this._cubeSize;nh(r,S*M,g>2?M:0,M,M),d.setRenderTarget(r),w&&d.render(y,a),d.render(e,a)}y.geometry.dispose(),y.material.dispose(),d.toneMapping=m,d.autoClear=h,e.background=x}_textureToCubeUV(e,t){const i=this._renderer,r=e.mapping===Ds||e.mapping===Mo;r?(this._cubemapMaterial===null&&(this._cubemapMaterial=NM()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=IM());const s=r?this._cubemapMaterial:this._equirectMaterial,o=new kn(this._lodPlanes[0],s),a=s.uniforms;a.envMap.value=e;const c=this._cubeSize;nh(t,0,0,3*c,2*c),i.setRenderTarget(t),i.render(o,h0)}_applyPMREM(e){const t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let r=1;r<this._lodPlanes.length;r++){const s=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),o=PM[(r-1)%PM.length];this._blur(e,r-1,r,s,o)}t.autoClear=i}_blur(e,t,i,r,s){const o=this._pingPongRenderTarget;this._halfBlur(e,o,t,i,r,"latitudinal",s),this._halfBlur(o,e,i,i,r,"longitudinal",s)}_halfBlur(e,t,i,r,s,o,a){const c=this._renderer,f=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const d=3,h=new kn(this._lodPlanes[r],f),m=f.uniforms,v=this._sizeLods[i]-1,y=isFinite(s)?Math.PI/(2*v):2*Math.PI/(2*ra-1),w=s/y,x=isFinite(s)?1+Math.floor(d*w):ra;x>ra&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${x} samples when the maximum is set to ${ra}`);const g=[];let S=0;for(let L=0;L<ra;++L){const O=L/w,C=Math.exp(-O*O/2);g.push(C),L===0?S+=C:L<x&&(S+=2*C)}for(let L=0;L<g.length;L++)g[L]=g[L]/S;m.envMap.value=e.texture,m.samples.value=x,m.weights.value=g,m.latitudinal.value=o==="latitudinal",a&&(m.poleAxis.value=a);const{_lodMax:M}=this;m.dTheta.value=y,m.mipInt.value=M-i;const T=this._sizeLods[r],P=3*T*(r>M-kl?r-M+kl:0),b=4*(this._cubeSize-T);nh(t,P,b,3*T,2*T),c.setRenderTarget(t),c.render(h,h0)}}function FD(n){const e=[],t=[],i=[];let r=n;const s=n-kl+1+CM.length;for(let o=0;o<s;o++){const a=Math.pow(2,r);t.push(a);let c=1/a;o>n-kl?c=CM[o-n+kl-1]:o===0&&(c=0),i.push(c);const f=1/(a-2),d=-f,h=1+f,m=[d,d,h,d,h,h,d,d,h,h,d,h],v=6,y=6,w=3,x=2,g=1,S=new Float32Array(w*y*v),M=new Float32Array(x*y*v),T=new Float32Array(g*y*v);for(let b=0;b<v;b++){const L=b%3*2/3-1,O=b>2?0:-1,C=[L,O,0,L+2/3,O,0,L+2/3,O+1,0,L,O,0,L+2/3,O+1,0,L,O+1,0];S.set(C,w*y*b),M.set(m,x*y*b);const R=[b,b,b,b,b,b];T.set(R,g*y*b)}const P=new Dt;P.setAttribute("position",new Kt(S,w)),P.setAttribute("uv",new Kt(M,x)),P.setAttribute("faceIndex",new Kt(T,g)),e.push(P),r>kl&&r--}return{lodPlanes:e,sizeLods:t,sigmas:i}}function LM(n,e,t){const i=new Sr(n,e,t);return i.texture.mapping=cu,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function nh(n,e,t,i,r){n.viewport.set(e,t,i,r),n.scissor.set(e,t,i,r)}function zD(n,e,t){const i=new Float32Array(ra),r=new k(0,1,0);return new kr({name:"SphericalGaussianBlur",defines:{n:ra,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${n}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:r}},vertexShader:H_(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Cs,depthTest:!1,depthWrite:!1})}function IM(){return new kr({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:H_(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Cs,depthTest:!1,depthWrite:!1})}function NM(){return new kr({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:H_(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Cs,depthTest:!1,depthWrite:!1})}function H_(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function BD(n){let e=new WeakMap,t=null;function i(a){if(a&&a.isTexture){const c=a.mapping,f=c===Fc||c===zc,d=c===Ds||c===Mo;if(f||d)if(a.isRenderTargetTexture&&a.needsPMREMUpdate===!0){a.needsPMREMUpdate=!1;let h=e.get(a);return t===null&&(t=new my(n)),h=f?t.fromEquirectangular(a,h):t.fromCubemap(a,h),e.set(a,h),h.texture}else{if(e.has(a))return e.get(a).texture;{const h=a.image;if(f&&h&&h.height>0||d&&h&&r(h)){t===null&&(t=new my(n));const m=f?t.fromEquirectangular(a):t.fromCubemap(a);return e.set(a,m),a.addEventListener("dispose",s),m.texture}else return null}}}return a}function r(a){let c=0;const f=6;for(let d=0;d<f;d++)a[d]!==void 0&&c++;return c===f}function s(a){const c=a.target;c.removeEventListener("dispose",s);const f=e.get(c);f!==void 0&&(e.delete(c),f.dispose())}function o(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:i,dispose:o}}function HD(n){const e={};function t(i){if(e[i]!==void 0)return e[i];let r;switch(i){case"WEBGL_depth_texture":r=n.getExtension("WEBGL_depth_texture")||n.getExtension("MOZ_WEBGL_depth_texture")||n.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=n.getExtension("WEBGL_compressed_texture_s3tc")||n.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=n.getExtension("WEBGL_compressed_texture_pvrtc")||n.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=n.getExtension(i)}return e[i]=r,r}return{has:function(i){return t(i)!==null},init:function(i){i.isWebGL2?(t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance")):(t("WEBGL_depth_texture"),t("OES_texture_float"),t("OES_texture_half_float"),t("OES_texture_half_float_linear"),t("OES_standard_derivatives"),t("OES_element_index_uint"),t("OES_vertex_array_object"),t("ANGLE_instanced_arrays")),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture")},get:function(i){const r=t(i);return r===null&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r}}}function VD(n,e,t,i){const r={},s=new WeakMap;function o(h){const m=h.target;m.index!==null&&e.remove(m.index);for(const y in m.attributes)e.remove(m.attributes[y]);for(const y in m.morphAttributes){const w=m.morphAttributes[y];for(let x=0,g=w.length;x<g;x++)e.remove(w[x])}m.removeEventListener("dispose",o),delete r[m.id];const v=s.get(m);v&&(e.remove(v),s.delete(m)),i.releaseStatesOfGeometry(m),m.isInstancedBufferGeometry===!0&&delete m._maxInstanceCount,t.memory.geometries--}function a(h,m){return r[m.id]===!0||(m.addEventListener("dispose",o),r[m.id]=!0,t.memory.geometries++),m}function c(h){const m=h.attributes;for(const y in m)e.update(m[y],n.ARRAY_BUFFER);const v=h.morphAttributes;for(const y in v){const w=v[y];for(let x=0,g=w.length;x<g;x++)e.update(w[x],n.ARRAY_BUFFER)}}function f(h){const m=[],v=h.index,y=h.attributes.position;let w=0;if(v!==null){const S=v.array;w=v.version;for(let M=0,T=S.length;M<T;M+=3){const P=S[M+0],b=S[M+1],L=S[M+2];m.push(P,b,b,L,L,P)}}else if(y!==void 0){const S=y.array;w=y.version;for(let M=0,T=S.length/3-1;M<T;M+=3){const P=M+0,b=M+1,L=M+2;m.push(P,b,b,L,L,P)}}else return;const x=new(wb(m)?z_:F_)(m,1);x.version=w;const g=s.get(h);g&&e.remove(g),s.set(h,x)}function d(h){const m=s.get(h);if(m){const v=h.index;v!==null&&m.version<v.version&&f(h)}else f(h);return s.get(h)}return{get:a,update:c,getWireframeAttribute:d}}function GD(n,e,t,i){const r=i.isWebGL2;let s;function o(v){s=v}let a,c;function f(v){a=v.type,c=v.bytesPerElement}function d(v,y){n.drawElements(s,y,a,v*c),t.update(y,s,1)}function h(v,y,w){if(w===0)return;let x,g;if(r)x=n,g="drawElementsInstanced";else if(x=e.get("ANGLE_instanced_arrays"),g="drawElementsInstancedANGLE",x===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}x[g](s,y,a,v*c,w),t.update(y,s,w)}function m(v,y,w){if(w===0)return;const x=e.get("WEBGL_multi_draw");if(x===null)for(let g=0;g<w;g++)this.render(v[g]/c,y[g]);else{x.multiDrawElementsWEBGL(s,y,0,a,v,0,w);let g=0;for(let S=0;S<w;S++)g+=y[S];t.update(g,s,1)}}this.setMode=o,this.setIndex=f,this.render=d,this.renderInstances=h,this.renderMultiDraw=m}function WD(n){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function i(s,o,a){switch(t.calls++,o){case n.TRIANGLES:t.triangles+=a*(s/3);break;case n.LINES:t.lines+=a*(s/2);break;case n.LINE_STRIP:t.lines+=a*(s-1);break;case n.LINE_LOOP:t.lines+=a*s;break;case n.POINTS:t.points+=a*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function r(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:r,update:i}}function XD(n,e){return n[0]-e[0]}function jD(n,e){return Math.abs(e[1])-Math.abs(n[1])}function YD(n,e,t){const i={},r=new Float32Array(8),s=new WeakMap,o=new qt,a=[];for(let f=0;f<8;f++)a[f]=[f,0];function c(f,d,h){const m=f.morphTargetInfluences;if(e.isWebGL2===!0){const y=d.morphAttributes.position||d.morphAttributes.normal||d.morphAttributes.color,w=y!==void 0?y.length:0;let x=s.get(d);if(x===void 0||x.count!==w){let Z=function(){me.dispose(),s.delete(d),d.removeEventListener("dispose",Z)};var v=Z;x!==void 0&&x.texture.dispose();const M=d.morphAttributes.position!==void 0,T=d.morphAttributes.normal!==void 0,P=d.morphAttributes.color!==void 0,b=d.morphAttributes.position||[],L=d.morphAttributes.normal||[],O=d.morphAttributes.color||[];let C=0;M===!0&&(C=1),T===!0&&(C=2),P===!0&&(C=3);let R=d.attributes.position.count*C,B=1;R>e.maxTextureSize&&(B=Math.ceil(R/e.maxTextureSize),R=e.maxTextureSize);const $=new Float32Array(R*B*4*w),me=new Jp($,R,B,w);me.type=vr,me.needsUpdate=!0;const G=C*4;for(let ne=0;ne<w;ne++){const he=b[ne],F=L[ne],W=O[ne],V=R*B*4*ne;for(let Q=0;Q<he.count;Q++){const se=Q*G;M===!0&&(o.fromBufferAttribute(he,Q),$[V+se+0]=o.x,$[V+se+1]=o.y,$[V+se+2]=o.z,$[V+se+3]=0),T===!0&&(o.fromBufferAttribute(F,Q),$[V+se+4]=o.x,$[V+se+5]=o.y,$[V+se+6]=o.z,$[V+se+7]=0),P===!0&&(o.fromBufferAttribute(W,Q),$[V+se+8]=o.x,$[V+se+9]=o.y,$[V+se+10]=o.z,$[V+se+11]=W.itemSize===4?o.w:1)}}x={count:w,texture:me,size:new be(R,B)},s.set(d,x),d.addEventListener("dispose",Z)}let g=0;for(let M=0;M<m.length;M++)g+=m[M];const S=d.morphTargetsRelative?1:1-g;h.getUniforms().setValue(n,"morphTargetBaseInfluence",S),h.getUniforms().setValue(n,"morphTargetInfluences",m),h.getUniforms().setValue(n,"morphTargetsTexture",x.texture,t),h.getUniforms().setValue(n,"morphTargetsTextureSize",x.size)}else{const y=m===void 0?0:m.length;let w=i[d.id];if(w===void 0||w.length!==y){w=[];for(let T=0;T<y;T++)w[T]=[T,0];i[d.id]=w}for(let T=0;T<y;T++){const P=w[T];P[0]=T,P[1]=m[T]}w.sort(jD);for(let T=0;T<8;T++)T<y&&w[T][1]?(a[T][0]=w[T][0],a[T][1]=w[T][1]):(a[T][0]=Number.MAX_SAFE_INTEGER,a[T][1]=0);a.sort(XD);const x=d.morphAttributes.position,g=d.morphAttributes.normal;let S=0;for(let T=0;T<8;T++){const P=a[T],b=P[0],L=P[1];b!==Number.MAX_SAFE_INTEGER&&L?(x&&d.getAttribute("morphTarget"+T)!==x[b]&&d.setAttribute("morphTarget"+T,x[b]),g&&d.getAttribute("morphNormal"+T)!==g[b]&&d.setAttribute("morphNormal"+T,g[b]),r[T]=L,S+=L):(x&&d.hasAttribute("morphTarget"+T)===!0&&d.deleteAttribute("morphTarget"+T),g&&d.hasAttribute("morphNormal"+T)===!0&&d.deleteAttribute("morphNormal"+T),r[T]=0)}const M=d.morphTargetsRelative?1:1-S;h.getUniforms().setValue(n,"morphTargetBaseInfluence",M),h.getUniforms().setValue(n,"morphTargetInfluences",r)}}return{update:c}}function qD(n,e,t,i){let r=new WeakMap;function s(c){const f=i.render.frame,d=c.geometry,h=e.get(c,d);if(r.get(h)!==f&&(e.update(h),r.set(h,f)),c.isInstancedMesh&&(c.hasEventListener("dispose",a)===!1&&c.addEventListener("dispose",a),r.get(c)!==f&&(t.update(c.instanceMatrix,n.ARRAY_BUFFER),c.instanceColor!==null&&t.update(c.instanceColor,n.ARRAY_BUFFER),r.set(c,f))),c.isSkinnedMesh){const m=c.skeleton;r.get(m)!==f&&(m.update(),r.set(m,f))}return h}function o(){r=new WeakMap}function a(c){const f=c.target;f.removeEventListener("dispose",a),t.remove(f.instanceMatrix),f.instanceColor!==null&&t.remove(f.instanceColor)}return{update:s,dispose:o}}class Qp extends bn{constructor(e,t,i,r,s,o,a,c,f,d){if(d=d!==void 0?d:yo,d!==yo&&d!==Ta)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&d===yo&&(i=Ts),i===void 0&&d===Ta&&(i=vo),super(null,r,s,o,a,c,d,i,f),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=a!==void 0?a:Tn,this.minFilter=c!==void 0?c:Tn,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}const Lb=new bn,Ib=new Qp(1,1);Ib.compareFunction=N_;const Nb=new Jp,Db=new k_,Ub=new mf,DM=[],UM=[],OM=new Float32Array(16),kM=new Float32Array(9),FM=new Float32Array(4);function fu(n,e,t){const i=n[0];if(i<=0||i>0)return n;const r=e*t;let s=DM[r];if(s===void 0&&(s=new Float32Array(r),DM[r]=s),e!==0){i.toArray(s,0);for(let o=1,a=0;o!==e;++o)a+=t,n[o].toArray(s,a)}return s}function Fn(n,e){if(n.length!==e.length)return!1;for(let t=0,i=n.length;t<i;t++)if(n[t]!==e[t])return!1;return!0}function zn(n,e){for(let t=0,i=e.length;t<i;t++)n[t]=e[t]}function $p(n,e){let t=UM[e];t===void 0&&(t=new Int32Array(e),UM[e]=t);for(let i=0;i!==e;++i)t[i]=n.allocateTextureUnit();return t}function ZD(n,e){const t=this.cache;t[0]!==e&&(n.uniform1f(this.addr,e),t[0]=e)}function KD(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Fn(t,e))return;n.uniform2fv(this.addr,e),zn(t,e)}}function JD(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(n.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(Fn(t,e))return;n.uniform3fv(this.addr,e),zn(t,e)}}function QD(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Fn(t,e))return;n.uniform4fv(this.addr,e),zn(t,e)}}function $D(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(Fn(t,e))return;n.uniformMatrix2fv(this.addr,!1,e),zn(t,e)}else{if(Fn(t,i))return;FM.set(i),n.uniformMatrix2fv(this.addr,!1,FM),zn(t,i)}}function eU(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(Fn(t,e))return;n.uniformMatrix3fv(this.addr,!1,e),zn(t,e)}else{if(Fn(t,i))return;kM.set(i),n.uniformMatrix3fv(this.addr,!1,kM),zn(t,i)}}function tU(n,e){const t=this.cache,i=e.elements;if(i===void 0){if(Fn(t,e))return;n.uniformMatrix4fv(this.addr,!1,e),zn(t,e)}else{if(Fn(t,i))return;OM.set(i),n.uniformMatrix4fv(this.addr,!1,OM),zn(t,i)}}function nU(n,e){const t=this.cache;t[0]!==e&&(n.uniform1i(this.addr,e),t[0]=e)}function iU(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Fn(t,e))return;n.uniform2iv(this.addr,e),zn(t,e)}}function rU(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Fn(t,e))return;n.uniform3iv(this.addr,e),zn(t,e)}}function sU(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Fn(t,e))return;n.uniform4iv(this.addr,e),zn(t,e)}}function oU(n,e){const t=this.cache;t[0]!==e&&(n.uniform1ui(this.addr,e),t[0]=e)}function aU(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(n.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(Fn(t,e))return;n.uniform2uiv(this.addr,e),zn(t,e)}}function lU(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(n.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(Fn(t,e))return;n.uniform3uiv(this.addr,e),zn(t,e)}}function uU(n,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(n.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(Fn(t,e))return;n.uniform4uiv(this.addr,e),zn(t,e)}}function cU(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r);const s=this.type===n.SAMPLER_2D_SHADOW?Ib:Lb;t.setTexture2D(e||s,r)}function fU(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture3D(e||Db,r)}function dU(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTextureCube(e||Ub,r)}function hU(n,e,t){const i=this.cache,r=t.allocateTextureUnit();i[0]!==r&&(n.uniform1i(this.addr,r),i[0]=r),t.setTexture2DArray(e||Nb,r)}function pU(n){switch(n){case 5126:return ZD;case 35664:return KD;case 35665:return JD;case 35666:return QD;case 35674:return $D;case 35675:return eU;case 35676:return tU;case 5124:case 35670:return nU;case 35667:case 35671:return iU;case 35668:case 35672:return rU;case 35669:case 35673:return sU;case 5125:return oU;case 36294:return aU;case 36295:return lU;case 36296:return uU;case 35678:case 36198:case 36298:case 36306:case 35682:return cU;case 35679:case 36299:case 36307:return fU;case 35680:case 36300:case 36308:case 36293:return dU;case 36289:case 36303:case 36311:case 36292:return hU}}function mU(n,e){n.uniform1fv(this.addr,e)}function gU(n,e){const t=fu(e,this.size,2);n.uniform2fv(this.addr,t)}function vU(n,e){const t=fu(e,this.size,3);n.uniform3fv(this.addr,t)}function yU(n,e){const t=fu(e,this.size,4);n.uniform4fv(this.addr,t)}function _U(n,e){const t=fu(e,this.size,4);n.uniformMatrix2fv(this.addr,!1,t)}function xU(n,e){const t=fu(e,this.size,9);n.uniformMatrix3fv(this.addr,!1,t)}function SU(n,e){const t=fu(e,this.size,16);n.uniformMatrix4fv(this.addr,!1,t)}function MU(n,e){n.uniform1iv(this.addr,e)}function wU(n,e){n.uniform2iv(this.addr,e)}function EU(n,e){n.uniform3iv(this.addr,e)}function TU(n,e){n.uniform4iv(this.addr,e)}function AU(n,e){n.uniform1uiv(this.addr,e)}function bU(n,e){n.uniform2uiv(this.addr,e)}function CU(n,e){n.uniform3uiv(this.addr,e)}function RU(n,e){n.uniform4uiv(this.addr,e)}function PU(n,e,t){const i=this.cache,r=e.length,s=$p(t,r);Fn(i,s)||(n.uniform1iv(this.addr,s),zn(i,s));for(let o=0;o!==r;++o)t.setTexture2D(e[o]||Lb,s[o])}function LU(n,e,t){const i=this.cache,r=e.length,s=$p(t,r);Fn(i,s)||(n.uniform1iv(this.addr,s),zn(i,s));for(let o=0;o!==r;++o)t.setTexture3D(e[o]||Db,s[o])}function IU(n,e,t){const i=this.cache,r=e.length,s=$p(t,r);Fn(i,s)||(n.uniform1iv(this.addr,s),zn(i,s));for(let o=0;o!==r;++o)t.setTextureCube(e[o]||Ub,s[o])}function NU(n,e,t){const i=this.cache,r=e.length,s=$p(t,r);Fn(i,s)||(n.uniform1iv(this.addr,s),zn(i,s));for(let o=0;o!==r;++o)t.setTexture2DArray(e[o]||Nb,s[o])}function DU(n){switch(n){case 5126:return mU;case 35664:return gU;case 35665:return vU;case 35666:return yU;case 35674:return _U;case 35675:return xU;case 35676:return SU;case 5124:case 35670:return MU;case 35667:case 35671:return wU;case 35668:case 35672:return EU;case 35669:case 35673:return TU;case 5125:return AU;case 36294:return bU;case 36295:return CU;case 36296:return RU;case 35678:case 36198:case 36298:case 36306:case 35682:return PU;case 35679:case 36299:case 36307:return LU;case 35680:case 36300:case 36308:case 36293:return IU;case 36289:case 36303:case 36311:case 36292:return NU}}class UU{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.setValue=pU(t.type)}}class OU{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=DU(t.type)}}class kU{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){const r=this.seq;for(let s=0,o=r.length;s!==o;++s){const a=r[s];a.setValue(e,t[a.id],i)}}}const v0=/(\w+)(\])?(\[|\.)?/g;function zM(n,e){n.seq.push(e),n.map[e.id]=e}function FU(n,e,t){const i=n.name,r=i.length;for(v0.lastIndex=0;;){const s=v0.exec(i),o=v0.lastIndex;let a=s[1];const c=s[2]==="]",f=s[3];if(c&&(a=a|0),f===void 0||f==="["&&o+2===r){zM(t,f===void 0?new UU(a,n,e):new OU(a,n,e));break}else{let h=t.map[a];h===void 0&&(h=new kU(a),zM(t,h)),t=h}}}class Kh{constructor(e,t){this.seq=[],this.map={};const i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<i;++r){const s=e.getActiveUniform(t,r),o=e.getUniformLocation(t,s.name);FU(s,o,this)}}setValue(e,t,i,r){const s=this.map[t];s!==void 0&&s.setValue(e,i,r)}setOptional(e,t,i){const r=t[i];r!==void 0&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let s=0,o=t.length;s!==o;++s){const a=t[s],c=i[a.id];c.needsUpdate!==!1&&a.setValue(e,c.value,r)}}static seqWithValue(e,t){const i=[];for(let r=0,s=e.length;r!==s;++r){const o=e[r];o.id in t&&i.push(o)}return i}}function BM(n,e,t){const i=n.createShader(e);return n.shaderSource(i,t),n.compileShader(i),i}const zU=37297;let BU=0;function HU(n,e){const t=n.split(`
`),i=[],r=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let o=r;o<s;o++){const a=o+1;i.push(`${a===e?">":" "} ${a}: ${t[o]}`)}return i.join(`
`)}function VU(n){const e=Yt.getPrimaries(Yt.workingColorSpace),t=Yt.getPrimaries(n);let i;switch(e===t?i="":e===Yc&&t===jc?i="LinearDisplayP3ToLinearSRGB":e===jc&&t===Yc&&(i="LinearSRGBToLinearDisplayP3"),n){case rs:case df:return[i,"LinearTransferOETF"];case Un:case Kp:return[i,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",n),[i,"LinearTransferOETF"]}}function HM(n,e,t){const i=n.getShaderParameter(e,n.COMPILE_STATUS),r=n.getShaderInfoLog(e).trim();if(i&&r==="")return"";const s=/ERROR: 0:(\d+)/.exec(r);if(s){const o=parseInt(s[1]);return t.toUpperCase()+`

`+r+`

`+HU(n.getShaderSource(e),o)}else return r}function GU(n,e){const t=VU(e);return`vec4 ${n}( vec4 value ) { return ${t[0]}( ${t[1]}( value ) ); }`}function WU(n,e){let t;switch(e){case KA:t="Linear";break;case JA:t="Reinhard";break;case QA:t="OptimizedCineon";break;case M_:t="ACESFilmic";break;case eb:t="AgX";break;case $A:t="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",e),t="Linear"}return"vec3 "+n+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}function XU(n){return[n.extensionDerivatives||n.envMapCubeUVHeight||n.bumpMap||n.normalMapTangentSpace||n.clearcoatNormalMap||n.flatShading||n.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(n.extensionFragDepth||n.logarithmicDepthBuffer)&&n.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",n.extensionDrawBuffers&&n.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(n.extensionShaderTextureLOD||n.envMap||n.transmission)&&n.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Fl).join(`
`)}function jU(n){return[n.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":""].filter(Fl).join(`
`)}function YU(n){const e=[];for(const t in n){const i=n[t];i!==!1&&e.push("#define "+t+" "+i)}return e.join(`
`)}function qU(n,e){const t={},i=n.getProgramParameter(e,n.ACTIVE_ATTRIBUTES);for(let r=0;r<i;r++){const s=n.getActiveAttrib(e,r),o=s.name;let a=1;s.type===n.FLOAT_MAT2&&(a=2),s.type===n.FLOAT_MAT3&&(a=3),s.type===n.FLOAT_MAT4&&(a=4),t[o]={type:s.type,location:n.getAttribLocation(e,o),locationSize:a}}return t}function Fl(n){return n!==""}function VM(n,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return n.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function GM(n,e){return n.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const ZU=/^[ \t]*#include +<([\w\d./]+)>/gm;function gy(n){return n.replace(ZU,JU)}const KU=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function JU(n,e){let t=Pt[e];if(t===void 0){const i=KU.get(e);if(i!==void 0)t=Pt[i],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,i);else throw new Error("Can not resolve #include <"+e+">")}return gy(t)}const QU=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function WM(n){return n.replace(QU,$U)}function $U(n,e,t,i){let r="";for(let s=parseInt(e);s<parseInt(t);s++)r+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return r}function XM(n){let e="precision "+n.precision+` float;
precision `+n.precision+" int;";return n.precision==="highp"?e+=`
#define HIGH_PRECISION`:n.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:n.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}function eO(n){let e="SHADOWMAP_TYPE_BASIC";return n.shadowMapType===jp?e="SHADOWMAP_TYPE_PCF":n.shadowMapType===pc?e="SHADOWMAP_TYPE_PCF_SOFT":n.shadowMapType===Rr&&(e="SHADOWMAP_TYPE_VSM"),e}function tO(n){let e="ENVMAP_TYPE_CUBE";if(n.envMap)switch(n.envMapMode){case Ds:case Mo:e="ENVMAP_TYPE_CUBE";break;case cu:e="ENVMAP_TYPE_CUBE_UV";break}return e}function nO(n){let e="ENVMAP_MODE_REFLECTION";if(n.envMap)switch(n.envMapMode){case Mo:e="ENVMAP_MODE_REFRACTION";break}return e}function iO(n){let e="ENVMAP_BLENDING_NONE";if(n.envMap)switch(n.combine){case ff:e="ENVMAP_BLENDING_MULTIPLY";break;case qA:e="ENVMAP_BLENDING_MIX";break;case ZA:e="ENVMAP_BLENDING_ADD";break}return e}function rO(n){const e=n.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,i=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),7*16)),texelHeight:i,maxMip:t}}function sO(n,e,t,i){const r=n.getContext(),s=t.defines;let o=t.vertexShader,a=t.fragmentShader;const c=eO(t),f=tO(t),d=nO(t),h=iO(t),m=rO(t),v=t.isWebGL2?"":XU(t),y=jU(t),w=YU(s),x=r.createProgram();let g,S,M=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(g=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,w].filter(Fl).join(`
`),g.length>0&&(g+=`
`),S=[v,"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,w].filter(Fl).join(`
`),S.length>0&&(S+=`
`)):(g=[XM(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,w,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+d:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors&&t.isWebGL2?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0&&t.isWebGL2?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+c:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Fl).join(`
`),S=[v,XM(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,w,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+f:"",t.envMap?"#define "+d:"",t.envMap?"#define "+h:"",m?"#define CUBEUV_TEXEL_WIDTH "+m.texelWidth:"",m?"#define CUBEUV_TEXEL_HEIGHT "+m.texelHeight:"",m?"#define CUBEUV_MAX_MIP "+m.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+c:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.useLegacyLights?"#define LEGACY_LIGHTS":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",t.logarithmicDepthBuffer&&t.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==es?"#define TONE_MAPPING":"",t.toneMapping!==es?Pt.tonemapping_pars_fragment:"",t.toneMapping!==es?WU("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",Pt.colorspace_pars_fragment,GU("linearToOutputTexel",t.outputColorSpace),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(Fl).join(`
`)),o=gy(o),o=VM(o,t),o=GM(o,t),a=gy(a),a=VM(a,t),a=GM(a,t),o=WM(o),a=WM(a),t.isWebGL2&&t.isRawShaderMaterial!==!0&&(M=`#version 300 es
`,g=[y,"precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+g,S=["precision mediump sampler2DArray;","#define varying in",t.glslVersion===hy?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===hy?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+S);const T=M+g+o,P=M+S+a,b=BM(r,r.VERTEX_SHADER,T),L=BM(r,r.FRAGMENT_SHADER,P);r.attachShader(x,b),r.attachShader(x,L),t.index0AttributeName!==void 0?r.bindAttribLocation(x,0,t.index0AttributeName):t.morphTargets===!0&&r.bindAttribLocation(x,0,"position"),r.linkProgram(x);function O($){if(n.debug.checkShaderErrors){const me=r.getProgramInfoLog(x).trim(),G=r.getShaderInfoLog(b).trim(),Z=r.getShaderInfoLog(L).trim();let ne=!0,he=!0;if(r.getProgramParameter(x,r.LINK_STATUS)===!1)if(ne=!1,typeof n.debug.onShaderError=="function")n.debug.onShaderError(r,x,b,L);else{const F=HM(r,b,"vertex"),W=HM(r,L,"fragment");console.error("THREE.WebGLProgram: Shader Error "+r.getError()+" - VALIDATE_STATUS "+r.getProgramParameter(x,r.VALIDATE_STATUS)+`

Program Info Log: `+me+`
`+F+`
`+W)}else me!==""?console.warn("THREE.WebGLProgram: Program Info Log:",me):(G===""||Z==="")&&(he=!1);he&&($.diagnostics={runnable:ne,programLog:me,vertexShader:{log:G,prefix:g},fragmentShader:{log:Z,prefix:S}})}r.deleteShader(b),r.deleteShader(L),C=new Kh(r,x),R=qU(r,x)}let C;this.getUniforms=function(){return C===void 0&&O(this),C};let R;this.getAttributes=function(){return R===void 0&&O(this),R};let B=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return B===!1&&(B=r.getProgramParameter(x,zU)),B},this.destroy=function(){i.releaseStatesOfProgram(this),r.deleteProgram(x),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=BU++,this.cacheKey=e,this.usedTimes=1,this.program=x,this.vertexShader=b,this.fragmentShader=L,this}let oO=0;class aO{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,i=e.fragmentShader,r=this._getShaderStage(t),s=this._getShaderStage(i),o=this._getShaderCacheForMaterial(e);return o.has(r)===!1&&(o.add(r),r.usedTimes++),o.has(s)===!1&&(o.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const i of t)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let i=t.get(e);return i===void 0&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){const t=this.shaderCache;let i=t.get(e);return i===void 0&&(i=new lO(e),t.set(e,i)),i}}class lO{constructor(e){this.id=oO++,this.code=e,this.usedTimes=0}}function uO(n,e,t,i,r,s,o){const a=new ga,c=new aO,f=[],d=r.isWebGL2,h=r.logarithmicDepthBuffer,m=r.vertexTextures;let v=r.precision;const y={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function w(C){return C===0?"uv":`uv${C}`}function x(C,R,B,$,me){const G=$.fog,Z=me.geometry,ne=C.isMeshStandardMaterial?$.environment:null,he=(C.isMeshStandardMaterial?t:e).get(C.envMap||ne),F=he&&he.mapping===cu?he.image.height:null,W=y[C.type];C.precision!==null&&(v=r.getMaxPrecision(C.precision),v!==C.precision&&console.warn("THREE.WebGLProgram.getParameters:",C.precision,"not supported, using",v,"instead."));const V=Z.morphAttributes.position||Z.morphAttributes.normal||Z.morphAttributes.color,Q=V!==void 0?V.length:0;let se=0;Z.morphAttributes.position!==void 0&&(se=1),Z.morphAttributes.normal!==void 0&&(se=2),Z.morphAttributes.color!==void 0&&(se=3);let J,ge,Ie,Be;if(W){const Pe=Ir[W];J=Pe.vertexShader,ge=Pe.fragmentShader}else J=C.vertexShader,ge=C.fragmentShader,c.update(C),Ie=c.getVertexShaderID(C),Be=c.getFragmentShaderID(C);const Fe=n.getRenderTarget(),Ne=me.isInstancedMesh===!0,je=me.isBatchedMesh===!0,ke=!!C.map,Le=!!C.matcap,H=!!he,xe=!!C.aoMap,oe=!!C.lightMap,Ue=!!C.bumpMap,ve=!!C.normalMap,Ze=!!C.displacementMap,Ve=!!C.emissiveMap,N=!!C.metalnessMap,I=!!C.roughnessMap,te=C.anisotropy>0,Ce=C.clearcoat>0,we=C.iridescence>0,Ee=C.sheen>0,Ke=C.transmission>0,Oe=te&&!!C.anisotropyMap,Ge=Ce&&!!C.clearcoatMap,lt=Ce&&!!C.clearcoatNormalMap,yt=Ce&&!!C.clearcoatRoughnessMap,Te=we&&!!C.iridescenceMap,Ct=we&&!!C.iridescenceThicknessMap,ot=Ee&&!!C.sheenColorMap,ut=Ee&&!!C.sheenRoughnessMap,ct=!!C.specularMap,$e=!!C.specularColorMap,j=!!C.specularIntensityMap,Ae=Ke&&!!C.transmissionMap,Ye=Ke&&!!C.thicknessMap,Je=!!C.gradientMap,De=!!C.alphaMap,Y=C.alphaTest>0,pe=!!C.alphaHash,D=!!C.extensions,re=!!Z.attributes.uv1,ue=!!Z.attributes.uv2,Me=!!Z.attributes.uv3;let ye=es;return C.toneMapped&&(Fe===null||Fe.isXRRenderTarget===!0)&&(ye=n.toneMapping),{isWebGL2:d,shaderID:W,shaderType:C.type,shaderName:C.name,vertexShader:J,fragmentShader:ge,defines:C.defines,customVertexShaderID:Ie,customFragmentShaderID:Be,isRawShaderMaterial:C.isRawShaderMaterial===!0,glslVersion:C.glslVersion,precision:v,batching:je,instancing:Ne,instancingColor:Ne&&me.instanceColor!==null,supportsVertexTextures:m,outputColorSpace:Fe===null?n.outputColorSpace:Fe.isXRRenderTarget===!0?Fe.texture.colorSpace:rs,map:ke,matcap:Le,envMap:H,envMapMode:H&&he.mapping,envMapCubeUVHeight:F,aoMap:xe,lightMap:oe,bumpMap:Ue,normalMap:ve,displacementMap:m&&Ze,emissiveMap:Ve,normalMapObjectSpace:ve&&C.normalMapType===mb,normalMapTangentSpace:ve&&C.normalMapType===Co,metalnessMap:N,roughnessMap:I,anisotropy:te,anisotropyMap:Oe,clearcoat:Ce,clearcoatMap:Ge,clearcoatNormalMap:lt,clearcoatRoughnessMap:yt,iridescence:we,iridescenceMap:Te,iridescenceThicknessMap:Ct,sheen:Ee,sheenColorMap:ot,sheenRoughnessMap:ut,specularMap:ct,specularColorMap:$e,specularIntensityMap:j,transmission:Ke,transmissionMap:Ae,thicknessMap:Ye,gradientMap:Je,opaque:C.transparent===!1&&C.blending===pa,alphaMap:De,alphaTest:Y,alphaHash:pe,combine:C.combine,mapUv:ke&&w(C.map.channel),aoMapUv:xe&&w(C.aoMap.channel),lightMapUv:oe&&w(C.lightMap.channel),bumpMapUv:Ue&&w(C.bumpMap.channel),normalMapUv:ve&&w(C.normalMap.channel),displacementMapUv:Ze&&w(C.displacementMap.channel),emissiveMapUv:Ve&&w(C.emissiveMap.channel),metalnessMapUv:N&&w(C.metalnessMap.channel),roughnessMapUv:I&&w(C.roughnessMap.channel),anisotropyMapUv:Oe&&w(C.anisotropyMap.channel),clearcoatMapUv:Ge&&w(C.clearcoatMap.channel),clearcoatNormalMapUv:lt&&w(C.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:yt&&w(C.clearcoatRoughnessMap.channel),iridescenceMapUv:Te&&w(C.iridescenceMap.channel),iridescenceThicknessMapUv:Ct&&w(C.iridescenceThicknessMap.channel),sheenColorMapUv:ot&&w(C.sheenColorMap.channel),sheenRoughnessMapUv:ut&&w(C.sheenRoughnessMap.channel),specularMapUv:ct&&w(C.specularMap.channel),specularColorMapUv:$e&&w(C.specularColorMap.channel),specularIntensityMapUv:j&&w(C.specularIntensityMap.channel),transmissionMapUv:Ae&&w(C.transmissionMap.channel),thicknessMapUv:Ye&&w(C.thicknessMap.channel),alphaMapUv:De&&w(C.alphaMap.channel),vertexTangents:!!Z.attributes.tangent&&(ve||te),vertexColors:C.vertexColors,vertexAlphas:C.vertexColors===!0&&!!Z.attributes.color&&Z.attributes.color.itemSize===4,vertexUv1s:re,vertexUv2s:ue,vertexUv3s:Me,pointsUvs:me.isPoints===!0&&!!Z.attributes.uv&&(ke||De),fog:!!G,useFog:C.fog===!0,fogExp2:G&&G.isFogExp2,flatShading:C.flatShading===!0,sizeAttenuation:C.sizeAttenuation===!0,logarithmicDepthBuffer:h,skinning:me.isSkinnedMesh===!0,morphTargets:Z.morphAttributes.position!==void 0,morphNormals:Z.morphAttributes.normal!==void 0,morphColors:Z.morphAttributes.color!==void 0,morphTargetsCount:Q,morphTextureStride:se,numDirLights:R.directional.length,numPointLights:R.point.length,numSpotLights:R.spot.length,numSpotLightMaps:R.spotLightMap.length,numRectAreaLights:R.rectArea.length,numHemiLights:R.hemi.length,numDirLightShadows:R.directionalShadowMap.length,numPointLightShadows:R.pointShadowMap.length,numSpotLightShadows:R.spotShadowMap.length,numSpotLightShadowsWithMaps:R.numSpotLightShadowsWithMaps,numLightProbes:R.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:C.dithering,shadowMapEnabled:n.shadowMap.enabled&&B.length>0,shadowMapType:n.shadowMap.type,toneMapping:ye,useLegacyLights:n._useLegacyLights,decodeVideoTexture:ke&&C.map.isVideoTexture===!0&&Yt.getTransfer(C.map.colorSpace)===tn,premultipliedAlpha:C.premultipliedAlpha,doubleSided:C.side===Ki,flipSided:C.side===Ei,useDepthPacking:C.depthPacking>=0,depthPacking:C.depthPacking||0,index0AttributeName:C.index0AttributeName,extensionDerivatives:D&&C.extensions.derivatives===!0,extensionFragDepth:D&&C.extensions.fragDepth===!0,extensionDrawBuffers:D&&C.extensions.drawBuffers===!0,extensionShaderTextureLOD:D&&C.extensions.shaderTextureLOD===!0,extensionClipCullDistance:D&&C.extensions.clipCullDistance&&i.has("WEBGL_clip_cull_distance"),rendererExtensionFragDepth:d||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:d||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:d||i.has("EXT_shader_texture_lod"),rendererExtensionParallelShaderCompile:i.has("KHR_parallel_shader_compile"),customProgramCacheKey:C.customProgramCacheKey()}}function g(C){const R=[];if(C.shaderID?R.push(C.shaderID):(R.push(C.customVertexShaderID),R.push(C.customFragmentShaderID)),C.defines!==void 0)for(const B in C.defines)R.push(B),R.push(C.defines[B]);return C.isRawShaderMaterial===!1&&(S(R,C),M(R,C),R.push(n.outputColorSpace)),R.push(C.customProgramCacheKey),R.join()}function S(C,R){C.push(R.precision),C.push(R.outputColorSpace),C.push(R.envMapMode),C.push(R.envMapCubeUVHeight),C.push(R.mapUv),C.push(R.alphaMapUv),C.push(R.lightMapUv),C.push(R.aoMapUv),C.push(R.bumpMapUv),C.push(R.normalMapUv),C.push(R.displacementMapUv),C.push(R.emissiveMapUv),C.push(R.metalnessMapUv),C.push(R.roughnessMapUv),C.push(R.anisotropyMapUv),C.push(R.clearcoatMapUv),C.push(R.clearcoatNormalMapUv),C.push(R.clearcoatRoughnessMapUv),C.push(R.iridescenceMapUv),C.push(R.iridescenceThicknessMapUv),C.push(R.sheenColorMapUv),C.push(R.sheenRoughnessMapUv),C.push(R.specularMapUv),C.push(R.specularColorMapUv),C.push(R.specularIntensityMapUv),C.push(R.transmissionMapUv),C.push(R.thicknessMapUv),C.push(R.combine),C.push(R.fogExp2),C.push(R.sizeAttenuation),C.push(R.morphTargetsCount),C.push(R.morphAttributeCount),C.push(R.numDirLights),C.push(R.numPointLights),C.push(R.numSpotLights),C.push(R.numSpotLightMaps),C.push(R.numHemiLights),C.push(R.numRectAreaLights),C.push(R.numDirLightShadows),C.push(R.numPointLightShadows),C.push(R.numSpotLightShadows),C.push(R.numSpotLightShadowsWithMaps),C.push(R.numLightProbes),C.push(R.shadowMapType),C.push(R.toneMapping),C.push(R.numClippingPlanes),C.push(R.numClipIntersection),C.push(R.depthPacking)}function M(C,R){a.disableAll(),R.isWebGL2&&a.enable(0),R.supportsVertexTextures&&a.enable(1),R.instancing&&a.enable(2),R.instancingColor&&a.enable(3),R.matcap&&a.enable(4),R.envMap&&a.enable(5),R.normalMapObjectSpace&&a.enable(6),R.normalMapTangentSpace&&a.enable(7),R.clearcoat&&a.enable(8),R.iridescence&&a.enable(9),R.alphaTest&&a.enable(10),R.vertexColors&&a.enable(11),R.vertexAlphas&&a.enable(12),R.vertexUv1s&&a.enable(13),R.vertexUv2s&&a.enable(14),R.vertexUv3s&&a.enable(15),R.vertexTangents&&a.enable(16),R.anisotropy&&a.enable(17),R.alphaHash&&a.enable(18),R.batching&&a.enable(19),C.push(a.mask),a.disableAll(),R.fog&&a.enable(0),R.useFog&&a.enable(1),R.flatShading&&a.enable(2),R.logarithmicDepthBuffer&&a.enable(3),R.skinning&&a.enable(4),R.morphTargets&&a.enable(5),R.morphNormals&&a.enable(6),R.morphColors&&a.enable(7),R.premultipliedAlpha&&a.enable(8),R.shadowMapEnabled&&a.enable(9),R.useLegacyLights&&a.enable(10),R.doubleSided&&a.enable(11),R.flipSided&&a.enable(12),R.useDepthPacking&&a.enable(13),R.dithering&&a.enable(14),R.transmission&&a.enable(15),R.sheen&&a.enable(16),R.opaque&&a.enable(17),R.pointsUvs&&a.enable(18),R.decodeVideoTexture&&a.enable(19),C.push(a.mask)}function T(C){const R=y[C.type];let B;if(R){const $=Ir[R];B=B_.clone($.uniforms)}else B=C.uniforms;return B}function P(C,R){let B;for(let $=0,me=f.length;$<me;$++){const G=f[$];if(G.cacheKey===R){B=G,++B.usedTimes;break}}return B===void 0&&(B=new sO(n,R,C,s),f.push(B)),B}function b(C){if(--C.usedTimes===0){const R=f.indexOf(C);f[R]=f[f.length-1],f.pop(),C.destroy()}}function L(C){c.remove(C)}function O(){c.dispose()}return{getParameters:x,getProgramCacheKey:g,getUniforms:T,acquireProgram:P,releaseProgram:b,releaseShaderCache:L,programs:f,dispose:O}}function cO(){let n=new WeakMap;function e(s){let o=n.get(s);return o===void 0&&(o={},n.set(s,o)),o}function t(s){n.delete(s)}function i(s,o,a){n.get(s)[o]=a}function r(){n=new WeakMap}return{get:e,remove:t,update:i,dispose:r}}function fO(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.material.id!==e.material.id?n.material.id-e.material.id:n.z!==e.z?n.z-e.z:n.id-e.id}function jM(n,e){return n.groupOrder!==e.groupOrder?n.groupOrder-e.groupOrder:n.renderOrder!==e.renderOrder?n.renderOrder-e.renderOrder:n.z!==e.z?e.z-n.z:n.id-e.id}function YM(){const n=[];let e=0;const t=[],i=[],r=[];function s(){e=0,t.length=0,i.length=0,r.length=0}function o(h,m,v,y,w,x){let g=n[e];return g===void 0?(g={id:h.id,object:h,geometry:m,material:v,groupOrder:y,renderOrder:h.renderOrder,z:w,group:x},n[e]=g):(g.id=h.id,g.object=h,g.geometry=m,g.material=v,g.groupOrder=y,g.renderOrder=h.renderOrder,g.z=w,g.group=x),e++,g}function a(h,m,v,y,w,x){const g=o(h,m,v,y,w,x);v.transmission>0?i.push(g):v.transparent===!0?r.push(g):t.push(g)}function c(h,m,v,y,w,x){const g=o(h,m,v,y,w,x);v.transmission>0?i.unshift(g):v.transparent===!0?r.unshift(g):t.unshift(g)}function f(h,m){t.length>1&&t.sort(h||fO),i.length>1&&i.sort(m||jM),r.length>1&&r.sort(m||jM)}function d(){for(let h=e,m=n.length;h<m;h++){const v=n[h];if(v.id===null)break;v.id=null,v.object=null,v.geometry=null,v.material=null,v.group=null}}return{opaque:t,transmissive:i,transparent:r,init:s,push:a,unshift:c,finish:d,sort:f}}function dO(){let n=new WeakMap;function e(i,r){const s=n.get(i);let o;return s===void 0?(o=new YM,n.set(i,[o])):r>=s.length?(o=new YM,s.push(o)):o=s[r],o}function t(){n=new WeakMap}return{get:e,dispose:t}}function hO(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new k,color:new nt};break;case"SpotLight":t={position:new k,direction:new k,color:new nt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new k,color:new nt,distance:0,decay:0};break;case"HemisphereLight":t={direction:new k,skyColor:new nt,groundColor:new nt};break;case"RectAreaLight":t={color:new nt,position:new k,halfWidth:new k,halfHeight:new k};break}return n[e.id]=t,t}}}function pO(){const n={};return{get:function(e){if(n[e.id]!==void 0)return n[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new be};break;case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new be};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new be,shadowCameraNear:1,shadowCameraFar:1e3};break}return n[e.id]=t,t}}}let mO=0;function gO(n,e){return(e.castShadow?2:0)-(n.castShadow?2:0)+(e.map?1:0)-(n.map?1:0)}function vO(n,e){const t=new hO,i=pO(),r={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let d=0;d<9;d++)r.probe.push(new k);const s=new k,o=new Mt,a=new Mt;function c(d,h){let m=0,v=0,y=0;for(let $=0;$<9;$++)r.probe[$].set(0,0,0);let w=0,x=0,g=0,S=0,M=0,T=0,P=0,b=0,L=0,O=0,C=0;d.sort(gO);const R=h===!0?Math.PI:1;for(let $=0,me=d.length;$<me;$++){const G=d[$],Z=G.color,ne=G.intensity,he=G.distance,F=G.shadow&&G.shadow.map?G.shadow.map.texture:null;if(G.isAmbientLight)m+=Z.r*ne*R,v+=Z.g*ne*R,y+=Z.b*ne*R;else if(G.isLightProbe){for(let W=0;W<9;W++)r.probe[W].addScaledVector(G.sh.coefficients[W],ne);C++}else if(G.isDirectionalLight){const W=t.get(G);if(W.color.copy(G.color).multiplyScalar(G.intensity*R),G.castShadow){const V=G.shadow,Q=i.get(G);Q.shadowBias=V.bias,Q.shadowNormalBias=V.normalBias,Q.shadowRadius=V.radius,Q.shadowMapSize=V.mapSize,r.directionalShadow[w]=Q,r.directionalShadowMap[w]=F,r.directionalShadowMatrix[w]=G.shadow.matrix,T++}r.directional[w]=W,w++}else if(G.isSpotLight){const W=t.get(G);W.position.setFromMatrixPosition(G.matrixWorld),W.color.copy(Z).multiplyScalar(ne*R),W.distance=he,W.coneCos=Math.cos(G.angle),W.penumbraCos=Math.cos(G.angle*(1-G.penumbra)),W.decay=G.decay,r.spot[g]=W;const V=G.shadow;if(G.map&&(r.spotLightMap[L]=G.map,L++,V.updateMatrices(G),G.castShadow&&O++),r.spotLightMatrix[g]=V.matrix,G.castShadow){const Q=i.get(G);Q.shadowBias=V.bias,Q.shadowNormalBias=V.normalBias,Q.shadowRadius=V.radius,Q.shadowMapSize=V.mapSize,r.spotShadow[g]=Q,r.spotShadowMap[g]=F,b++}g++}else if(G.isRectAreaLight){const W=t.get(G);W.color.copy(Z).multiplyScalar(ne),W.halfWidth.set(G.width*.5,0,0),W.halfHeight.set(0,G.height*.5,0),r.rectArea[S]=W,S++}else if(G.isPointLight){const W=t.get(G);if(W.color.copy(G.color).multiplyScalar(G.intensity*R),W.distance=G.distance,W.decay=G.decay,G.castShadow){const V=G.shadow,Q=i.get(G);Q.shadowBias=V.bias,Q.shadowNormalBias=V.normalBias,Q.shadowRadius=V.radius,Q.shadowMapSize=V.mapSize,Q.shadowCameraNear=V.camera.near,Q.shadowCameraFar=V.camera.far,r.pointShadow[x]=Q,r.pointShadowMap[x]=F,r.pointShadowMatrix[x]=G.shadow.matrix,P++}r.point[x]=W,x++}else if(G.isHemisphereLight){const W=t.get(G);W.skyColor.copy(G.color).multiplyScalar(ne*R),W.groundColor.copy(G.groundColor).multiplyScalar(ne*R),r.hemi[M]=W,M++}}S>0&&(e.isWebGL2?n.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=qe.LTC_FLOAT_1,r.rectAreaLTC2=qe.LTC_FLOAT_2):(r.rectAreaLTC1=qe.LTC_HALF_1,r.rectAreaLTC2=qe.LTC_HALF_2):n.has("OES_texture_float_linear")===!0?(r.rectAreaLTC1=qe.LTC_FLOAT_1,r.rectAreaLTC2=qe.LTC_FLOAT_2):n.has("OES_texture_half_float_linear")===!0?(r.rectAreaLTC1=qe.LTC_HALF_1,r.rectAreaLTC2=qe.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),r.ambient[0]=m,r.ambient[1]=v,r.ambient[2]=y;const B=r.hash;(B.directionalLength!==w||B.pointLength!==x||B.spotLength!==g||B.rectAreaLength!==S||B.hemiLength!==M||B.numDirectionalShadows!==T||B.numPointShadows!==P||B.numSpotShadows!==b||B.numSpotMaps!==L||B.numLightProbes!==C)&&(r.directional.length=w,r.spot.length=g,r.rectArea.length=S,r.point.length=x,r.hemi.length=M,r.directionalShadow.length=T,r.directionalShadowMap.length=T,r.pointShadow.length=P,r.pointShadowMap.length=P,r.spotShadow.length=b,r.spotShadowMap.length=b,r.directionalShadowMatrix.length=T,r.pointShadowMatrix.length=P,r.spotLightMatrix.length=b+L-O,r.spotLightMap.length=L,r.numSpotLightShadowsWithMaps=O,r.numLightProbes=C,B.directionalLength=w,B.pointLength=x,B.spotLength=g,B.rectAreaLength=S,B.hemiLength=M,B.numDirectionalShadows=T,B.numPointShadows=P,B.numSpotShadows=b,B.numSpotMaps=L,B.numLightProbes=C,r.version=mO++)}function f(d,h){let m=0,v=0,y=0,w=0,x=0;const g=h.matrixWorldInverse;for(let S=0,M=d.length;S<M;S++){const T=d[S];if(T.isDirectionalLight){const P=r.directional[m];P.direction.setFromMatrixPosition(T.matrixWorld),s.setFromMatrixPosition(T.target.matrixWorld),P.direction.sub(s),P.direction.transformDirection(g),m++}else if(T.isSpotLight){const P=r.spot[y];P.position.setFromMatrixPosition(T.matrixWorld),P.position.applyMatrix4(g),P.direction.setFromMatrixPosition(T.matrixWorld),s.setFromMatrixPosition(T.target.matrixWorld),P.direction.sub(s),P.direction.transformDirection(g),y++}else if(T.isRectAreaLight){const P=r.rectArea[w];P.position.setFromMatrixPosition(T.matrixWorld),P.position.applyMatrix4(g),a.identity(),o.copy(T.matrixWorld),o.premultiply(g),a.extractRotation(o),P.halfWidth.set(T.width*.5,0,0),P.halfHeight.set(0,T.height*.5,0),P.halfWidth.applyMatrix4(a),P.halfHeight.applyMatrix4(a),w++}else if(T.isPointLight){const P=r.point[v];P.position.setFromMatrixPosition(T.matrixWorld),P.position.applyMatrix4(g),v++}else if(T.isHemisphereLight){const P=r.hemi[x];P.direction.setFromMatrixPosition(T.matrixWorld),P.direction.transformDirection(g),x++}}}return{setup:c,setupView:f,state:r}}function qM(n,e){const t=new vO(n,e),i=[],r=[];function s(){i.length=0,r.length=0}function o(h){i.push(h)}function a(h){r.push(h)}function c(h){t.setup(i,h)}function f(h){t.setupView(i,h)}return{init:s,state:{lightsArray:i,shadowsArray:r,lights:t},setupLights:c,setupLightsView:f,pushLight:o,pushShadow:a}}function yO(n,e){let t=new WeakMap;function i(s,o=0){const a=t.get(s);let c;return a===void 0?(c=new qM(n,e),t.set(s,[c])):o>=a.length?(c=new qM(n,e),a.push(c)):c=a[o],c}function r(){t=new WeakMap}return{get:i,dispose:r}}class V_ extends mi{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=hb,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class G_ extends mi{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}const _O=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,xO=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function SO(n,e,t){let i=new gf;const r=new be,s=new be,o=new qt,a=new V_({depthPacking:pb}),c=new G_,f={},d=t.maxTextureSize,h={[Ns]:Ei,[Ei]:Ns,[Ki]:Ki},m=new kr({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new be},radius:{value:4}},vertexShader:_O,fragmentShader:xO}),v=m.clone();v.defines.HORIZONTAL_PASS=1;const y=new Dt;y.setAttribute("position",new Kt(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const w=new kn(y,m),x=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=jp;let g=this.type;this.render=function(b,L,O){if(x.enabled===!1||x.autoUpdate===!1&&x.needsUpdate===!1||b.length===0)return;const C=n.getRenderTarget(),R=n.getActiveCubeFace(),B=n.getActiveMipmapLevel(),$=n.state;$.setBlending(Cs),$.buffers.color.setClear(1,1,1,1),$.buffers.depth.setTest(!0),$.setScissorTest(!1);const me=g!==Rr&&this.type===Rr,G=g===Rr&&this.type!==Rr;for(let Z=0,ne=b.length;Z<ne;Z++){const he=b[Z],F=he.shadow;if(F===void 0){console.warn("THREE.WebGLShadowMap:",he,"has no shadow.");continue}if(F.autoUpdate===!1&&F.needsUpdate===!1)continue;r.copy(F.mapSize);const W=F.getFrameExtents();if(r.multiply(W),s.copy(F.mapSize),(r.x>d||r.y>d)&&(r.x>d&&(s.x=Math.floor(d/W.x),r.x=s.x*W.x,F.mapSize.x=s.x),r.y>d&&(s.y=Math.floor(d/W.y),r.y=s.y*W.y,F.mapSize.y=s.y)),F.map===null||me===!0||G===!0){const Q=this.type!==Rr?{minFilter:Tn,magFilter:Tn}:{};F.map!==null&&F.map.dispose(),F.map=new Sr(r.x,r.y,Q),F.map.texture.name=he.name+".shadowMap",F.camera.updateProjectionMatrix()}n.setRenderTarget(F.map),n.clear();const V=F.getViewportCount();for(let Q=0;Q<V;Q++){const se=F.getViewport(Q);o.set(s.x*se.x,s.y*se.y,s.x*se.z,s.y*se.w),$.viewport(o),F.updateMatrices(he,Q),i=F.getFrustum(),T(L,O,F.camera,he,this.type)}F.isPointLightShadow!==!0&&this.type===Rr&&S(F,O),F.needsUpdate=!1}g=this.type,x.needsUpdate=!1,n.setRenderTarget(C,R,B)};function S(b,L){const O=e.update(w);m.defines.VSM_SAMPLES!==b.blurSamples&&(m.defines.VSM_SAMPLES=b.blurSamples,v.defines.VSM_SAMPLES=b.blurSamples,m.needsUpdate=!0,v.needsUpdate=!0),b.mapPass===null&&(b.mapPass=new Sr(r.x,r.y)),m.uniforms.shadow_pass.value=b.map.texture,m.uniforms.resolution.value=b.mapSize,m.uniforms.radius.value=b.radius,n.setRenderTarget(b.mapPass),n.clear(),n.renderBufferDirect(L,null,O,m,w,null),v.uniforms.shadow_pass.value=b.mapPass.texture,v.uniforms.resolution.value=b.mapSize,v.uniforms.radius.value=b.radius,n.setRenderTarget(b.map),n.clear(),n.renderBufferDirect(L,null,O,v,w,null)}function M(b,L,O,C){let R=null;const B=O.isPointLight===!0?b.customDistanceMaterial:b.customDepthMaterial;if(B!==void 0)R=B;else if(R=O.isPointLight===!0?c:a,n.localClippingEnabled&&L.clipShadows===!0&&Array.isArray(L.clippingPlanes)&&L.clippingPlanes.length!==0||L.displacementMap&&L.displacementScale!==0||L.alphaMap&&L.alphaTest>0||L.map&&L.alphaTest>0){const $=R.uuid,me=L.uuid;let G=f[$];G===void 0&&(G={},f[$]=G);let Z=G[me];Z===void 0&&(Z=R.clone(),G[me]=Z,L.addEventListener("dispose",P)),R=Z}if(R.visible=L.visible,R.wireframe=L.wireframe,C===Rr?R.side=L.shadowSide!==null?L.shadowSide:L.side:R.side=L.shadowSide!==null?L.shadowSide:h[L.side],R.alphaMap=L.alphaMap,R.alphaTest=L.alphaTest,R.map=L.map,R.clipShadows=L.clipShadows,R.clippingPlanes=L.clippingPlanes,R.clipIntersection=L.clipIntersection,R.displacementMap=L.displacementMap,R.displacementScale=L.displacementScale,R.displacementBias=L.displacementBias,R.wireframeLinewidth=L.wireframeLinewidth,R.linewidth=L.linewidth,O.isPointLight===!0&&R.isMeshDistanceMaterial===!0){const $=n.properties.get(R);$.light=O}return R}function T(b,L,O,C,R){if(b.visible===!1)return;if(b.layers.test(L.layers)&&(b.isMesh||b.isLine||b.isPoints)&&(b.castShadow||b.receiveShadow&&R===Rr)&&(!b.frustumCulled||i.intersectsObject(b))){b.modelViewMatrix.multiplyMatrices(O.matrixWorldInverse,b.matrixWorld);const me=e.update(b),G=b.material;if(Array.isArray(G)){const Z=me.groups;for(let ne=0,he=Z.length;ne<he;ne++){const F=Z[ne],W=G[F.materialIndex];if(W&&W.visible){const V=M(b,W,C,R);b.onBeforeShadow(n,b,L,O,me,V,F),n.renderBufferDirect(O,null,me,V,b,F),b.onAfterShadow(n,b,L,O,me,V,F)}}}else if(G.visible){const Z=M(b,G,C,R);b.onBeforeShadow(n,b,L,O,me,Z,null),n.renderBufferDirect(O,null,me,Z,b,null),b.onAfterShadow(n,b,L,O,me,Z,null)}}const $=b.children;for(let me=0,G=$.length;me<G;me++)T($[me],L,O,C,R)}function P(b){b.target.removeEventListener("dispose",P);for(const O in f){const C=f[O],R=b.target.uuid;R in C&&(C[R].dispose(),delete C[R])}}}function MO(n,e,t){const i=t.isWebGL2;function r(){let Y=!1;const pe=new qt;let D=null;const re=new qt(0,0,0,0);return{setMask:function(ue){D!==ue&&!Y&&(n.colorMask(ue,ue,ue,ue),D=ue)},setLocked:function(ue){Y=ue},setClear:function(ue,Me,ye,Re,Pe){Pe===!0&&(ue*=Re,Me*=Re,ye*=Re),pe.set(ue,Me,ye,Re),re.equals(pe)===!1&&(n.clearColor(ue,Me,ye,Re),re.copy(pe))},reset:function(){Y=!1,D=null,re.set(-1,0,0,0)}}}function s(){let Y=!1,pe=null,D=null,re=null;return{setTest:function(ue){ue?je(n.DEPTH_TEST):ke(n.DEPTH_TEST)},setMask:function(ue){pe!==ue&&!Y&&(n.depthMask(ue),pe=ue)},setFunc:function(ue){if(D!==ue){switch(ue){case HA:n.depthFunc(n.NEVER);break;case VA:n.depthFunc(n.ALWAYS);break;case GA:n.depthFunc(n.LESS);break;case kc:n.depthFunc(n.LEQUAL);break;case WA:n.depthFunc(n.EQUAL);break;case XA:n.depthFunc(n.GEQUAL);break;case jA:n.depthFunc(n.GREATER);break;case YA:n.depthFunc(n.NOTEQUAL);break;default:n.depthFunc(n.LEQUAL)}D=ue}},setLocked:function(ue){Y=ue},setClear:function(ue){re!==ue&&(n.clearDepth(ue),re=ue)},reset:function(){Y=!1,pe=null,D=null,re=null}}}function o(){let Y=!1,pe=null,D=null,re=null,ue=null,Me=null,ye=null,Re=null,Pe=null;return{setTest:function(fe){Y||(fe?je(n.STENCIL_TEST):ke(n.STENCIL_TEST))},setMask:function(fe){pe!==fe&&!Y&&(n.stencilMask(fe),pe=fe)},setFunc:function(fe,Qe,Et){(D!==fe||re!==Qe||ue!==Et)&&(n.stencilFunc(fe,Qe,Et),D=fe,re=Qe,ue=Et)},setOp:function(fe,Qe,Et){(Me!==fe||ye!==Qe||Re!==Et)&&(n.stencilOp(fe,Qe,Et),Me=fe,ye=Qe,Re=Et)},setLocked:function(fe){Y=fe},setClear:function(fe){Pe!==fe&&(n.clearStencil(fe),Pe=fe)},reset:function(){Y=!1,pe=null,D=null,re=null,ue=null,Me=null,ye=null,Re=null,Pe=null}}}const a=new r,c=new s,f=new o,d=new WeakMap,h=new WeakMap;let m={},v={},y=new WeakMap,w=[],x=null,g=!1,S=null,M=null,T=null,P=null,b=null,L=null,O=null,C=new nt(0,0,0),R=0,B=!1,$=null,me=null,G=null,Z=null,ne=null;const he=n.getParameter(n.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let F=!1,W=0;const V=n.getParameter(n.VERSION);V.indexOf("WebGL")!==-1?(W=parseFloat(/^WebGL (\d)/.exec(V)[1]),F=W>=1):V.indexOf("OpenGL ES")!==-1&&(W=parseFloat(/^OpenGL ES (\d)/.exec(V)[1]),F=W>=2);let Q=null,se={};const J=n.getParameter(n.SCISSOR_BOX),ge=n.getParameter(n.VIEWPORT),Ie=new qt().fromArray(J),Be=new qt().fromArray(ge);function Fe(Y,pe,D,re){const ue=new Uint8Array(4),Me=n.createTexture();n.bindTexture(Y,Me),n.texParameteri(Y,n.TEXTURE_MIN_FILTER,n.NEAREST),n.texParameteri(Y,n.TEXTURE_MAG_FILTER,n.NEAREST);for(let ye=0;ye<D;ye++)i&&(Y===n.TEXTURE_3D||Y===n.TEXTURE_2D_ARRAY)?n.texImage3D(pe,0,n.RGBA,1,1,re,0,n.RGBA,n.UNSIGNED_BYTE,ue):n.texImage2D(pe+ye,0,n.RGBA,1,1,0,n.RGBA,n.UNSIGNED_BYTE,ue);return Me}const Ne={};Ne[n.TEXTURE_2D]=Fe(n.TEXTURE_2D,n.TEXTURE_2D,1),Ne[n.TEXTURE_CUBE_MAP]=Fe(n.TEXTURE_CUBE_MAP,n.TEXTURE_CUBE_MAP_POSITIVE_X,6),i&&(Ne[n.TEXTURE_2D_ARRAY]=Fe(n.TEXTURE_2D_ARRAY,n.TEXTURE_2D_ARRAY,1,1),Ne[n.TEXTURE_3D]=Fe(n.TEXTURE_3D,n.TEXTURE_3D,1,1)),a.setClear(0,0,0,1),c.setClear(1),f.setClear(0),je(n.DEPTH_TEST),c.setFunc(kc),Ve(!1),N(Dv),je(n.CULL_FACE),ve(Cs);function je(Y){m[Y]!==!0&&(n.enable(Y),m[Y]=!0)}function ke(Y){m[Y]!==!1&&(n.disable(Y),m[Y]=!1)}function Le(Y,pe){return v[Y]!==pe?(n.bindFramebuffer(Y,pe),v[Y]=pe,i&&(Y===n.DRAW_FRAMEBUFFER&&(v[n.FRAMEBUFFER]=pe),Y===n.FRAMEBUFFER&&(v[n.DRAW_FRAMEBUFFER]=pe)),!0):!1}function H(Y,pe){let D=w,re=!1;if(Y)if(D=y.get(pe),D===void 0&&(D=[],y.set(pe,D)),Y.isWebGLMultipleRenderTargets){const ue=Y.texture;if(D.length!==ue.length||D[0]!==n.COLOR_ATTACHMENT0){for(let Me=0,ye=ue.length;Me<ye;Me++)D[Me]=n.COLOR_ATTACHMENT0+Me;D.length=ue.length,re=!0}}else D[0]!==n.COLOR_ATTACHMENT0&&(D[0]=n.COLOR_ATTACHMENT0,re=!0);else D[0]!==n.BACK&&(D[0]=n.BACK,re=!0);re&&(t.isWebGL2?n.drawBuffers(D):e.get("WEBGL_draw_buffers").drawBuffersWEBGL(D))}function xe(Y){return x!==Y?(n.useProgram(Y),x=Y,!0):!1}const oe={[so]:n.FUNC_ADD,[AA]:n.FUNC_SUBTRACT,[bA]:n.FUNC_REVERSE_SUBTRACT};if(i)oe[Fv]=n.MIN,oe[zv]=n.MAX;else{const Y=e.get("EXT_blend_minmax");Y!==null&&(oe[Fv]=Y.MIN_EXT,oe[zv]=Y.MAX_EXT)}const Ue={[CA]:n.ZERO,[RA]:n.ONE,[PA]:n.SRC_COLOR,[Mp]:n.SRC_ALPHA,[OA]:n.SRC_ALPHA_SATURATE,[DA]:n.DST_COLOR,[IA]:n.DST_ALPHA,[LA]:n.ONE_MINUS_SRC_COLOR,[wp]:n.ONE_MINUS_SRC_ALPHA,[UA]:n.ONE_MINUS_DST_COLOR,[NA]:n.ONE_MINUS_DST_ALPHA,[kA]:n.CONSTANT_COLOR,[FA]:n.ONE_MINUS_CONSTANT_COLOR,[zA]:n.CONSTANT_ALPHA,[BA]:n.ONE_MINUS_CONSTANT_ALPHA};function ve(Y,pe,D,re,ue,Me,ye,Re,Pe,fe){if(Y===Cs){g===!0&&(ke(n.BLEND),g=!1);return}if(g===!1&&(je(n.BLEND),g=!0),Y!==TA){if(Y!==S||fe!==B){if((M!==so||b!==so)&&(n.blendEquation(n.FUNC_ADD),M=so,b=so),fe)switch(Y){case pa:n.blendFuncSeparate(n.ONE,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case Uv:n.blendFunc(n.ONE,n.ONE);break;case Ov:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case kv:n.blendFuncSeparate(n.ZERO,n.SRC_COLOR,n.ZERO,n.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",Y);break}else switch(Y){case pa:n.blendFuncSeparate(n.SRC_ALPHA,n.ONE_MINUS_SRC_ALPHA,n.ONE,n.ONE_MINUS_SRC_ALPHA);break;case Uv:n.blendFunc(n.SRC_ALPHA,n.ONE);break;case Ov:n.blendFuncSeparate(n.ZERO,n.ONE_MINUS_SRC_COLOR,n.ZERO,n.ONE);break;case kv:n.blendFunc(n.ZERO,n.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",Y);break}T=null,P=null,L=null,O=null,C.set(0,0,0),R=0,S=Y,B=fe}return}ue=ue||pe,Me=Me||D,ye=ye||re,(pe!==M||ue!==b)&&(n.blendEquationSeparate(oe[pe],oe[ue]),M=pe,b=ue),(D!==T||re!==P||Me!==L||ye!==O)&&(n.blendFuncSeparate(Ue[D],Ue[re],Ue[Me],Ue[ye]),T=D,P=re,L=Me,O=ye),(Re.equals(C)===!1||Pe!==R)&&(n.blendColor(Re.r,Re.g,Re.b,Pe),C.copy(Re),R=Pe),S=Y,B=!1}function Ze(Y,pe){Y.side===Ki?ke(n.CULL_FACE):je(n.CULL_FACE);let D=Y.side===Ei;pe&&(D=!D),Ve(D),Y.blending===pa&&Y.transparent===!1?ve(Cs):ve(Y.blending,Y.blendEquation,Y.blendSrc,Y.blendDst,Y.blendEquationAlpha,Y.blendSrcAlpha,Y.blendDstAlpha,Y.blendColor,Y.blendAlpha,Y.premultipliedAlpha),c.setFunc(Y.depthFunc),c.setTest(Y.depthTest),c.setMask(Y.depthWrite),a.setMask(Y.colorWrite);const re=Y.stencilWrite;f.setTest(re),re&&(f.setMask(Y.stencilWriteMask),f.setFunc(Y.stencilFunc,Y.stencilRef,Y.stencilFuncMask),f.setOp(Y.stencilFail,Y.stencilZFail,Y.stencilZPass)),te(Y.polygonOffset,Y.polygonOffsetFactor,Y.polygonOffsetUnits),Y.alphaToCoverage===!0?je(n.SAMPLE_ALPHA_TO_COVERAGE):ke(n.SAMPLE_ALPHA_TO_COVERAGE)}function Ve(Y){$!==Y&&(Y?n.frontFace(n.CW):n.frontFace(n.CCW),$=Y)}function N(Y){Y!==MA?(je(n.CULL_FACE),Y!==me&&(Y===Dv?n.cullFace(n.BACK):Y===wA?n.cullFace(n.FRONT):n.cullFace(n.FRONT_AND_BACK))):ke(n.CULL_FACE),me=Y}function I(Y){Y!==G&&(F&&n.lineWidth(Y),G=Y)}function te(Y,pe,D){Y?(je(n.POLYGON_OFFSET_FILL),(Z!==pe||ne!==D)&&(n.polygonOffset(pe,D),Z=pe,ne=D)):ke(n.POLYGON_OFFSET_FILL)}function Ce(Y){Y?je(n.SCISSOR_TEST):ke(n.SCISSOR_TEST)}function we(Y){Y===void 0&&(Y=n.TEXTURE0+he-1),Q!==Y&&(n.activeTexture(Y),Q=Y)}function Ee(Y,pe,D){D===void 0&&(Q===null?D=n.TEXTURE0+he-1:D=Q);let re=se[D];re===void 0&&(re={type:void 0,texture:void 0},se[D]=re),(re.type!==Y||re.texture!==pe)&&(Q!==D&&(n.activeTexture(D),Q=D),n.bindTexture(Y,pe||Ne[Y]),re.type=Y,re.texture=pe)}function Ke(){const Y=se[Q];Y!==void 0&&Y.type!==void 0&&(n.bindTexture(Y.type,null),Y.type=void 0,Y.texture=void 0)}function Oe(){try{n.compressedTexImage2D.apply(n,arguments)}catch(Y){console.error("THREE.WebGLState:",Y)}}function Ge(){try{n.compressedTexImage3D.apply(n,arguments)}catch(Y){console.error("THREE.WebGLState:",Y)}}function lt(){try{n.texSubImage2D.apply(n,arguments)}catch(Y){console.error("THREE.WebGLState:",Y)}}function yt(){try{n.texSubImage3D.apply(n,arguments)}catch(Y){console.error("THREE.WebGLState:",Y)}}function Te(){try{n.compressedTexSubImage2D.apply(n,arguments)}catch(Y){console.error("THREE.WebGLState:",Y)}}function Ct(){try{n.compressedTexSubImage3D.apply(n,arguments)}catch(Y){console.error("THREE.WebGLState:",Y)}}function ot(){try{n.texStorage2D.apply(n,arguments)}catch(Y){console.error("THREE.WebGLState:",Y)}}function ut(){try{n.texStorage3D.apply(n,arguments)}catch(Y){console.error("THREE.WebGLState:",Y)}}function ct(){try{n.texImage2D.apply(n,arguments)}catch(Y){console.error("THREE.WebGLState:",Y)}}function $e(){try{n.texImage3D.apply(n,arguments)}catch(Y){console.error("THREE.WebGLState:",Y)}}function j(Y){Ie.equals(Y)===!1&&(n.scissor(Y.x,Y.y,Y.z,Y.w),Ie.copy(Y))}function Ae(Y){Be.equals(Y)===!1&&(n.viewport(Y.x,Y.y,Y.z,Y.w),Be.copy(Y))}function Ye(Y,pe){let D=h.get(pe);D===void 0&&(D=new WeakMap,h.set(pe,D));let re=D.get(Y);re===void 0&&(re=n.getUniformBlockIndex(pe,Y.name),D.set(Y,re))}function Je(Y,pe){const re=h.get(pe).get(Y);d.get(pe)!==re&&(n.uniformBlockBinding(pe,re,Y.__bindingPointIndex),d.set(pe,re))}function De(){n.disable(n.BLEND),n.disable(n.CULL_FACE),n.disable(n.DEPTH_TEST),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SCISSOR_TEST),n.disable(n.STENCIL_TEST),n.disable(n.SAMPLE_ALPHA_TO_COVERAGE),n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ZERO),n.blendFuncSeparate(n.ONE,n.ZERO,n.ONE,n.ZERO),n.blendColor(0,0,0,0),n.colorMask(!0,!0,!0,!0),n.clearColor(0,0,0,0),n.depthMask(!0),n.depthFunc(n.LESS),n.clearDepth(1),n.stencilMask(4294967295),n.stencilFunc(n.ALWAYS,0,4294967295),n.stencilOp(n.KEEP,n.KEEP,n.KEEP),n.clearStencil(0),n.cullFace(n.BACK),n.frontFace(n.CCW),n.polygonOffset(0,0),n.activeTexture(n.TEXTURE0),n.bindFramebuffer(n.FRAMEBUFFER,null),i===!0&&(n.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),n.bindFramebuffer(n.READ_FRAMEBUFFER,null)),n.useProgram(null),n.lineWidth(1),n.scissor(0,0,n.canvas.width,n.canvas.height),n.viewport(0,0,n.canvas.width,n.canvas.height),m={},Q=null,se={},v={},y=new WeakMap,w=[],x=null,g=!1,S=null,M=null,T=null,P=null,b=null,L=null,O=null,C=new nt(0,0,0),R=0,B=!1,$=null,me=null,G=null,Z=null,ne=null,Ie.set(0,0,n.canvas.width,n.canvas.height),Be.set(0,0,n.canvas.width,n.canvas.height),a.reset(),c.reset(),f.reset()}return{buffers:{color:a,depth:c,stencil:f},enable:je,disable:ke,bindFramebuffer:Le,drawBuffers:H,useProgram:xe,setBlending:ve,setMaterial:Ze,setFlipSided:Ve,setCullFace:N,setLineWidth:I,setPolygonOffset:te,setScissorTest:Ce,activeTexture:we,bindTexture:Ee,unbindTexture:Ke,compressedTexImage2D:Oe,compressedTexImage3D:Ge,texImage2D:ct,texImage3D:$e,updateUBOMapping:Ye,uniformBlockBinding:Je,texStorage2D:ot,texStorage3D:ut,texSubImage2D:lt,texSubImage3D:yt,compressedTexSubImage2D:Te,compressedTexSubImage3D:Ct,scissor:j,viewport:Ae,reset:De}}function wO(n,e,t,i,r,s,o){const a=r.isWebGL2,c=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,f=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),d=new WeakMap;let h;const m=new WeakMap;let v=!1;try{v=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function y(N,I){return v?new OffscreenCanvas(N,I):Zc("canvas")}function w(N,I,te,Ce){let we=1;if((N.width>Ce||N.height>Ce)&&(we=Ce/Math.max(N.width,N.height)),we<1||I===!0)if(typeof HTMLImageElement<"u"&&N instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&N instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&N instanceof ImageBitmap){const Ee=I?Ap:Math.floor,Ke=Ee(we*N.width),Oe=Ee(we*N.height);h===void 0&&(h=y(Ke,Oe));const Ge=te?y(Ke,Oe):h;return Ge.width=Ke,Ge.height=Oe,Ge.getContext("2d").drawImage(N,0,0,Ke,Oe),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+N.width+"x"+N.height+") to ("+Ke+"x"+Oe+")."),Ge}else return"data"in N&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+N.width+"x"+N.height+")."),N;return N}function x(N){return py(N.width)&&py(N.height)}function g(N){return a?!1:N.wrapS!==fi||N.wrapT!==fi||N.minFilter!==Tn&&N.minFilter!==fn}function S(N,I){return N.generateMipmaps&&I&&N.minFilter!==Tn&&N.minFilter!==fn}function M(N){n.generateMipmap(N)}function T(N,I,te,Ce,we=!1){if(a===!1)return I;if(N!==null){if(n[N]!==void 0)return n[N];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+N+"'")}let Ee=I;if(I===n.RED&&(te===n.FLOAT&&(Ee=n.R32F),te===n.HALF_FLOAT&&(Ee=n.R16F),te===n.UNSIGNED_BYTE&&(Ee=n.R8)),I===n.RED_INTEGER&&(te===n.UNSIGNED_BYTE&&(Ee=n.R8UI),te===n.UNSIGNED_SHORT&&(Ee=n.R16UI),te===n.UNSIGNED_INT&&(Ee=n.R32UI),te===n.BYTE&&(Ee=n.R8I),te===n.SHORT&&(Ee=n.R16I),te===n.INT&&(Ee=n.R32I)),I===n.RG&&(te===n.FLOAT&&(Ee=n.RG32F),te===n.HALF_FLOAT&&(Ee=n.RG16F),te===n.UNSIGNED_BYTE&&(Ee=n.RG8)),I===n.RGBA){const Ke=we?Xc:Yt.getTransfer(Ce);te===n.FLOAT&&(Ee=n.RGBA32F),te===n.HALF_FLOAT&&(Ee=n.RGBA16F),te===n.UNSIGNED_BYTE&&(Ee=Ke===tn?n.SRGB8_ALPHA8:n.RGBA8),te===n.UNSIGNED_SHORT_4_4_4_4&&(Ee=n.RGBA4),te===n.UNSIGNED_SHORT_5_5_5_1&&(Ee=n.RGB5_A1)}return(Ee===n.R16F||Ee===n.R32F||Ee===n.RG16F||Ee===n.RG32F||Ee===n.RGBA16F||Ee===n.RGBA32F)&&e.get("EXT_color_buffer_float"),Ee}function P(N,I,te){return S(N,te)===!0||N.isFramebufferTexture&&N.minFilter!==Tn&&N.minFilter!==fn?Math.log2(Math.max(I.width,I.height))+1:N.mipmaps!==void 0&&N.mipmaps.length>0?N.mipmaps.length:N.isCompressedTexture&&Array.isArray(N.image)?I.mipmaps.length:1}function b(N){return N===Tn||N===Ep||N===mc?n.NEAREST:n.LINEAR}function L(N){const I=N.target;I.removeEventListener("dispose",L),C(I),I.isVideoTexture&&d.delete(I)}function O(N){const I=N.target;I.removeEventListener("dispose",O),B(I)}function C(N){const I=i.get(N);if(I.__webglInit===void 0)return;const te=N.source,Ce=m.get(te);if(Ce){const we=Ce[I.__cacheKey];we.usedTimes--,we.usedTimes===0&&R(N),Object.keys(Ce).length===0&&m.delete(te)}i.remove(N)}function R(N){const I=i.get(N);n.deleteTexture(I.__webglTexture);const te=N.source,Ce=m.get(te);delete Ce[I.__cacheKey],o.memory.textures--}function B(N){const I=N.texture,te=i.get(N),Ce=i.get(I);if(Ce.__webglTexture!==void 0&&(n.deleteTexture(Ce.__webglTexture),o.memory.textures--),N.depthTexture&&N.depthTexture.dispose(),N.isWebGLCubeRenderTarget)for(let we=0;we<6;we++){if(Array.isArray(te.__webglFramebuffer[we]))for(let Ee=0;Ee<te.__webglFramebuffer[we].length;Ee++)n.deleteFramebuffer(te.__webglFramebuffer[we][Ee]);else n.deleteFramebuffer(te.__webglFramebuffer[we]);te.__webglDepthbuffer&&n.deleteRenderbuffer(te.__webglDepthbuffer[we])}else{if(Array.isArray(te.__webglFramebuffer))for(let we=0;we<te.__webglFramebuffer.length;we++)n.deleteFramebuffer(te.__webglFramebuffer[we]);else n.deleteFramebuffer(te.__webglFramebuffer);if(te.__webglDepthbuffer&&n.deleteRenderbuffer(te.__webglDepthbuffer),te.__webglMultisampledFramebuffer&&n.deleteFramebuffer(te.__webglMultisampledFramebuffer),te.__webglColorRenderbuffer)for(let we=0;we<te.__webglColorRenderbuffer.length;we++)te.__webglColorRenderbuffer[we]&&n.deleteRenderbuffer(te.__webglColorRenderbuffer[we]);te.__webglDepthRenderbuffer&&n.deleteRenderbuffer(te.__webglDepthRenderbuffer)}if(N.isWebGLMultipleRenderTargets)for(let we=0,Ee=I.length;we<Ee;we++){const Ke=i.get(I[we]);Ke.__webglTexture&&(n.deleteTexture(Ke.__webglTexture),o.memory.textures--),i.remove(I[we])}i.remove(I),i.remove(N)}let $=0;function me(){$=0}function G(){const N=$;return N>=r.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+N+" texture units while this GPU supports only "+r.maxTextures),$+=1,N}function Z(N){const I=[];return I.push(N.wrapS),I.push(N.wrapT),I.push(N.wrapR||0),I.push(N.magFilter),I.push(N.minFilter),I.push(N.anisotropy),I.push(N.internalFormat),I.push(N.format),I.push(N.type),I.push(N.generateMipmaps),I.push(N.premultiplyAlpha),I.push(N.flipY),I.push(N.unpackAlignment),I.push(N.colorSpace),I.join()}function ne(N,I){const te=i.get(N);if(N.isVideoTexture&&Ze(N),N.isRenderTargetTexture===!1&&N.version>0&&te.__version!==N.version){const Ce=N.image;if(Ce===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(Ce.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Ie(te,N,I);return}}t.bindTexture(n.TEXTURE_2D,te.__webglTexture,n.TEXTURE0+I)}function he(N,I){const te=i.get(N);if(N.version>0&&te.__version!==N.version){Ie(te,N,I);return}t.bindTexture(n.TEXTURE_2D_ARRAY,te.__webglTexture,n.TEXTURE0+I)}function F(N,I){const te=i.get(N);if(N.version>0&&te.__version!==N.version){Ie(te,N,I);return}t.bindTexture(n.TEXTURE_3D,te.__webglTexture,n.TEXTURE0+I)}function W(N,I){const te=i.get(N);if(N.version>0&&te.__version!==N.version){Be(te,N,I);return}t.bindTexture(n.TEXTURE_CUBE_MAP,te.__webglTexture,n.TEXTURE0+I)}const V={[Bc]:n.REPEAT,[fi]:n.CLAMP_TO_EDGE,[Hc]:n.MIRRORED_REPEAT},Q={[Tn]:n.NEAREST,[Ep]:n.NEAREST_MIPMAP_NEAREST,[mc]:n.NEAREST_MIPMAP_LINEAR,[fn]:n.LINEAR,[w_]:n.LINEAR_MIPMAP_NEAREST,[wo]:n.LINEAR_MIPMAP_LINEAR},se={[gb]:n.NEVER,[Mb]:n.ALWAYS,[vb]:n.LESS,[N_]:n.LEQUAL,[yb]:n.EQUAL,[Sb]:n.GEQUAL,[_b]:n.GREATER,[xb]:n.NOTEQUAL};function J(N,I,te){if(te?(n.texParameteri(N,n.TEXTURE_WRAP_S,V[I.wrapS]),n.texParameteri(N,n.TEXTURE_WRAP_T,V[I.wrapT]),(N===n.TEXTURE_3D||N===n.TEXTURE_2D_ARRAY)&&n.texParameteri(N,n.TEXTURE_WRAP_R,V[I.wrapR]),n.texParameteri(N,n.TEXTURE_MAG_FILTER,Q[I.magFilter]),n.texParameteri(N,n.TEXTURE_MIN_FILTER,Q[I.minFilter])):(n.texParameteri(N,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(N,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),(N===n.TEXTURE_3D||N===n.TEXTURE_2D_ARRAY)&&n.texParameteri(N,n.TEXTURE_WRAP_R,n.CLAMP_TO_EDGE),(I.wrapS!==fi||I.wrapT!==fi)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),n.texParameteri(N,n.TEXTURE_MAG_FILTER,b(I.magFilter)),n.texParameteri(N,n.TEXTURE_MIN_FILTER,b(I.minFilter)),I.minFilter!==Tn&&I.minFilter!==fn&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),I.compareFunction&&(n.texParameteri(N,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(N,n.TEXTURE_COMPARE_FUNC,se[I.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){const Ce=e.get("EXT_texture_filter_anisotropic");if(I.magFilter===Tn||I.minFilter!==mc&&I.minFilter!==wo||I.type===vr&&e.has("OES_texture_float_linear")===!1||a===!1&&I.type===Ea&&e.has("OES_texture_half_float_linear")===!1)return;(I.anisotropy>1||i.get(I).__currentAnisotropy)&&(n.texParameterf(N,Ce.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(I.anisotropy,r.getMaxAnisotropy())),i.get(I).__currentAnisotropy=I.anisotropy)}}function ge(N,I){let te=!1;N.__webglInit===void 0&&(N.__webglInit=!0,I.addEventListener("dispose",L));const Ce=I.source;let we=m.get(Ce);we===void 0&&(we={},m.set(Ce,we));const Ee=Z(I);if(Ee!==N.__cacheKey){we[Ee]===void 0&&(we[Ee]={texture:n.createTexture(),usedTimes:0},o.memory.textures++,te=!0),we[Ee].usedTimes++;const Ke=we[N.__cacheKey];Ke!==void 0&&(we[N.__cacheKey].usedTimes--,Ke.usedTimes===0&&R(I)),N.__cacheKey=Ee,N.__webglTexture=we[Ee].texture}return te}function Ie(N,I,te){let Ce=n.TEXTURE_2D;(I.isDataArrayTexture||I.isCompressedArrayTexture)&&(Ce=n.TEXTURE_2D_ARRAY),I.isData3DTexture&&(Ce=n.TEXTURE_3D);const we=ge(N,I),Ee=I.source;t.bindTexture(Ce,N.__webglTexture,n.TEXTURE0+te);const Ke=i.get(Ee);if(Ee.version!==Ke.__version||we===!0){t.activeTexture(n.TEXTURE0+te);const Oe=Yt.getPrimaries(Yt.workingColorSpace),Ge=I.colorSpace===Ji?null:Yt.getPrimaries(I.colorSpace),lt=I.colorSpace===Ji||Oe===Ge?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,I.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,I.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,I.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,lt);const yt=g(I)&&x(I.image)===!1;let Te=w(I.image,yt,!1,r.maxTextureSize);Te=Ve(I,Te);const Ct=x(Te)||a,ot=s.convert(I.format,I.colorSpace);let ut=s.convert(I.type),ct=T(I.internalFormat,ot,ut,I.colorSpace,I.isVideoTexture);J(Ce,I,Ct);let $e;const j=I.mipmaps,Ae=a&&I.isVideoTexture!==!0&&ct!==P_,Ye=Ke.__version===void 0||we===!0,Je=P(I,Te,Ct);if(I.isDepthTexture)ct=n.DEPTH_COMPONENT,a?I.type===vr?ct=n.DEPTH_COMPONENT32F:I.type===Ts?ct=n.DEPTH_COMPONENT24:I.type===vo?ct=n.DEPTH24_STENCIL8:ct=n.DEPTH_COMPONENT16:I.type===vr&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),I.format===yo&&ct===n.DEPTH_COMPONENT&&I.type!==qp&&I.type!==Ts&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),I.type=Ts,ut=s.convert(I.type)),I.format===Ta&&ct===n.DEPTH_COMPONENT&&(ct=n.DEPTH_STENCIL,I.type!==vo&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),I.type=vo,ut=s.convert(I.type))),Ye&&(Ae?t.texStorage2D(n.TEXTURE_2D,1,ct,Te.width,Te.height):t.texImage2D(n.TEXTURE_2D,0,ct,Te.width,Te.height,0,ot,ut,null));else if(I.isDataTexture)if(j.length>0&&Ct){Ae&&Ye&&t.texStorage2D(n.TEXTURE_2D,Je,ct,j[0].width,j[0].height);for(let De=0,Y=j.length;De<Y;De++)$e=j[De],Ae?t.texSubImage2D(n.TEXTURE_2D,De,0,0,$e.width,$e.height,ot,ut,$e.data):t.texImage2D(n.TEXTURE_2D,De,ct,$e.width,$e.height,0,ot,ut,$e.data);I.generateMipmaps=!1}else Ae?(Ye&&t.texStorage2D(n.TEXTURE_2D,Je,ct,Te.width,Te.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,Te.width,Te.height,ot,ut,Te.data)):t.texImage2D(n.TEXTURE_2D,0,ct,Te.width,Te.height,0,ot,ut,Te.data);else if(I.isCompressedTexture)if(I.isCompressedArrayTexture){Ae&&Ye&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Je,ct,j[0].width,j[0].height,Te.depth);for(let De=0,Y=j.length;De<Y;De++)$e=j[De],I.format!==Mi?ot!==null?Ae?t.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,De,0,0,0,$e.width,$e.height,Te.depth,ot,$e.data,0,0):t.compressedTexImage3D(n.TEXTURE_2D_ARRAY,De,ct,$e.width,$e.height,Te.depth,0,$e.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ae?t.texSubImage3D(n.TEXTURE_2D_ARRAY,De,0,0,0,$e.width,$e.height,Te.depth,ot,ut,$e.data):t.texImage3D(n.TEXTURE_2D_ARRAY,De,ct,$e.width,$e.height,Te.depth,0,ot,ut,$e.data)}else{Ae&&Ye&&t.texStorage2D(n.TEXTURE_2D,Je,ct,j[0].width,j[0].height);for(let De=0,Y=j.length;De<Y;De++)$e=j[De],I.format!==Mi?ot!==null?Ae?t.compressedTexSubImage2D(n.TEXTURE_2D,De,0,0,$e.width,$e.height,ot,$e.data):t.compressedTexImage2D(n.TEXTURE_2D,De,ct,$e.width,$e.height,0,$e.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Ae?t.texSubImage2D(n.TEXTURE_2D,De,0,0,$e.width,$e.height,ot,ut,$e.data):t.texImage2D(n.TEXTURE_2D,De,ct,$e.width,$e.height,0,ot,ut,$e.data)}else if(I.isDataArrayTexture)Ae?(Ye&&t.texStorage3D(n.TEXTURE_2D_ARRAY,Je,ct,Te.width,Te.height,Te.depth),t.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,Te.width,Te.height,Te.depth,ot,ut,Te.data)):t.texImage3D(n.TEXTURE_2D_ARRAY,0,ct,Te.width,Te.height,Te.depth,0,ot,ut,Te.data);else if(I.isData3DTexture)Ae?(Ye&&t.texStorage3D(n.TEXTURE_3D,Je,ct,Te.width,Te.height,Te.depth),t.texSubImage3D(n.TEXTURE_3D,0,0,0,0,Te.width,Te.height,Te.depth,ot,ut,Te.data)):t.texImage3D(n.TEXTURE_3D,0,ct,Te.width,Te.height,Te.depth,0,ot,ut,Te.data);else if(I.isFramebufferTexture){if(Ye)if(Ae)t.texStorage2D(n.TEXTURE_2D,Je,ct,Te.width,Te.height);else{let De=Te.width,Y=Te.height;for(let pe=0;pe<Je;pe++)t.texImage2D(n.TEXTURE_2D,pe,ct,De,Y,0,ot,ut,null),De>>=1,Y>>=1}}else if(j.length>0&&Ct){Ae&&Ye&&t.texStorage2D(n.TEXTURE_2D,Je,ct,j[0].width,j[0].height);for(let De=0,Y=j.length;De<Y;De++)$e=j[De],Ae?t.texSubImage2D(n.TEXTURE_2D,De,0,0,ot,ut,$e):t.texImage2D(n.TEXTURE_2D,De,ct,ot,ut,$e);I.generateMipmaps=!1}else Ae?(Ye&&t.texStorage2D(n.TEXTURE_2D,Je,ct,Te.width,Te.height),t.texSubImage2D(n.TEXTURE_2D,0,0,0,ot,ut,Te)):t.texImage2D(n.TEXTURE_2D,0,ct,ot,ut,Te);S(I,Ct)&&M(Ce),Ke.__version=Ee.version,I.onUpdate&&I.onUpdate(I)}N.__version=I.version}function Be(N,I,te){if(I.image.length!==6)return;const Ce=ge(N,I),we=I.source;t.bindTexture(n.TEXTURE_CUBE_MAP,N.__webglTexture,n.TEXTURE0+te);const Ee=i.get(we);if(we.version!==Ee.__version||Ce===!0){t.activeTexture(n.TEXTURE0+te);const Ke=Yt.getPrimaries(Yt.workingColorSpace),Oe=I.colorSpace===Ji?null:Yt.getPrimaries(I.colorSpace),Ge=I.colorSpace===Ji||Ke===Oe?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,I.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,I.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,I.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,Ge);const lt=I.isCompressedTexture||I.image[0].isCompressedTexture,yt=I.image[0]&&I.image[0].isDataTexture,Te=[];for(let De=0;De<6;De++)!lt&&!yt?Te[De]=w(I.image[De],!1,!0,r.maxCubemapSize):Te[De]=yt?I.image[De].image:I.image[De],Te[De]=Ve(I,Te[De]);const Ct=Te[0],ot=x(Ct)||a,ut=s.convert(I.format,I.colorSpace),ct=s.convert(I.type),$e=T(I.internalFormat,ut,ct,I.colorSpace),j=a&&I.isVideoTexture!==!0,Ae=Ee.__version===void 0||Ce===!0;let Ye=P(I,Ct,ot);J(n.TEXTURE_CUBE_MAP,I,ot);let Je;if(lt){j&&Ae&&t.texStorage2D(n.TEXTURE_CUBE_MAP,Ye,$e,Ct.width,Ct.height);for(let De=0;De<6;De++){Je=Te[De].mipmaps;for(let Y=0;Y<Je.length;Y++){const pe=Je[Y];I.format!==Mi?ut!==null?j?t.compressedTexSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+De,Y,0,0,pe.width,pe.height,ut,pe.data):t.compressedTexImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+De,Y,$e,pe.width,pe.height,0,pe.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):j?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+De,Y,0,0,pe.width,pe.height,ut,ct,pe.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+De,Y,$e,pe.width,pe.height,0,ut,ct,pe.data)}}}else{Je=I.mipmaps,j&&Ae&&(Je.length>0&&Ye++,t.texStorage2D(n.TEXTURE_CUBE_MAP,Ye,$e,Te[0].width,Te[0].height));for(let De=0;De<6;De++)if(yt){j?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+De,0,0,0,Te[De].width,Te[De].height,ut,ct,Te[De].data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+De,0,$e,Te[De].width,Te[De].height,0,ut,ct,Te[De].data);for(let Y=0;Y<Je.length;Y++){const D=Je[Y].image[De].image;j?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+De,Y+1,0,0,D.width,D.height,ut,ct,D.data):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+De,Y+1,$e,D.width,D.height,0,ut,ct,D.data)}}else{j?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+De,0,0,0,ut,ct,Te[De]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+De,0,$e,ut,ct,Te[De]);for(let Y=0;Y<Je.length;Y++){const pe=Je[Y];j?t.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+De,Y+1,0,0,ut,ct,pe.image[De]):t.texImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+De,Y+1,$e,ut,ct,pe.image[De])}}}S(I,ot)&&M(n.TEXTURE_CUBE_MAP),Ee.__version=we.version,I.onUpdate&&I.onUpdate(I)}N.__version=I.version}function Fe(N,I,te,Ce,we,Ee){const Ke=s.convert(te.format,te.colorSpace),Oe=s.convert(te.type),Ge=T(te.internalFormat,Ke,Oe,te.colorSpace);if(!i.get(I).__hasExternalTextures){const yt=Math.max(1,I.width>>Ee),Te=Math.max(1,I.height>>Ee);we===n.TEXTURE_3D||we===n.TEXTURE_2D_ARRAY?t.texImage3D(we,Ee,Ge,yt,Te,I.depth,0,Ke,Oe,null):t.texImage2D(we,Ee,Ge,yt,Te,0,Ke,Oe,null)}t.bindFramebuffer(n.FRAMEBUFFER,N),ve(I)?c.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,Ce,we,i.get(te).__webglTexture,0,Ue(I)):(we===n.TEXTURE_2D||we>=n.TEXTURE_CUBE_MAP_POSITIVE_X&&we<=n.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&n.framebufferTexture2D(n.FRAMEBUFFER,Ce,we,i.get(te).__webglTexture,Ee),t.bindFramebuffer(n.FRAMEBUFFER,null)}function Ne(N,I,te){if(n.bindRenderbuffer(n.RENDERBUFFER,N),I.depthBuffer&&!I.stencilBuffer){let Ce=a===!0?n.DEPTH_COMPONENT24:n.DEPTH_COMPONENT16;if(te||ve(I)){const we=I.depthTexture;we&&we.isDepthTexture&&(we.type===vr?Ce=n.DEPTH_COMPONENT32F:we.type===Ts&&(Ce=n.DEPTH_COMPONENT24));const Ee=Ue(I);ve(I)?c.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Ee,Ce,I.width,I.height):n.renderbufferStorageMultisample(n.RENDERBUFFER,Ee,Ce,I.width,I.height)}else n.renderbufferStorage(n.RENDERBUFFER,Ce,I.width,I.height);n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.RENDERBUFFER,N)}else if(I.depthBuffer&&I.stencilBuffer){const Ce=Ue(I);te&&ve(I)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,Ce,n.DEPTH24_STENCIL8,I.width,I.height):ve(I)?c.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,Ce,n.DEPTH24_STENCIL8,I.width,I.height):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,I.width,I.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,N)}else{const Ce=I.isWebGLMultipleRenderTargets===!0?I.texture:[I.texture];for(let we=0;we<Ce.length;we++){const Ee=Ce[we],Ke=s.convert(Ee.format,Ee.colorSpace),Oe=s.convert(Ee.type),Ge=T(Ee.internalFormat,Ke,Oe,Ee.colorSpace),lt=Ue(I);te&&ve(I)===!1?n.renderbufferStorageMultisample(n.RENDERBUFFER,lt,Ge,I.width,I.height):ve(I)?c.renderbufferStorageMultisampleEXT(n.RENDERBUFFER,lt,Ge,I.width,I.height):n.renderbufferStorage(n.RENDERBUFFER,Ge,I.width,I.height)}}n.bindRenderbuffer(n.RENDERBUFFER,null)}function je(N,I){if(I&&I.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(n.FRAMEBUFFER,N),!(I.depthTexture&&I.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(I.depthTexture).__webglTexture||I.depthTexture.image.width!==I.width||I.depthTexture.image.height!==I.height)&&(I.depthTexture.image.width=I.width,I.depthTexture.image.height=I.height,I.depthTexture.needsUpdate=!0),ne(I.depthTexture,0);const Ce=i.get(I.depthTexture).__webglTexture,we=Ue(I);if(I.depthTexture.format===yo)ve(I)?c.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,Ce,0,we):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_ATTACHMENT,n.TEXTURE_2D,Ce,0);else if(I.depthTexture.format===Ta)ve(I)?c.framebufferTexture2DMultisampleEXT(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,Ce,0,we):n.framebufferTexture2D(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.TEXTURE_2D,Ce,0);else throw new Error("Unknown depthTexture format")}function ke(N){const I=i.get(N),te=N.isWebGLCubeRenderTarget===!0;if(N.depthTexture&&!I.__autoAllocateDepthBuffer){if(te)throw new Error("target.depthTexture not supported in Cube render targets");je(I.__webglFramebuffer,N)}else if(te){I.__webglDepthbuffer=[];for(let Ce=0;Ce<6;Ce++)t.bindFramebuffer(n.FRAMEBUFFER,I.__webglFramebuffer[Ce]),I.__webglDepthbuffer[Ce]=n.createRenderbuffer(),Ne(I.__webglDepthbuffer[Ce],N,!1)}else t.bindFramebuffer(n.FRAMEBUFFER,I.__webglFramebuffer),I.__webglDepthbuffer=n.createRenderbuffer(),Ne(I.__webglDepthbuffer,N,!1);t.bindFramebuffer(n.FRAMEBUFFER,null)}function Le(N,I,te){const Ce=i.get(N);I!==void 0&&Fe(Ce.__webglFramebuffer,N,N.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,0),te!==void 0&&ke(N)}function H(N){const I=N.texture,te=i.get(N),Ce=i.get(I);N.addEventListener("dispose",O),N.isWebGLMultipleRenderTargets!==!0&&(Ce.__webglTexture===void 0&&(Ce.__webglTexture=n.createTexture()),Ce.__version=I.version,o.memory.textures++);const we=N.isWebGLCubeRenderTarget===!0,Ee=N.isWebGLMultipleRenderTargets===!0,Ke=x(N)||a;if(we){te.__webglFramebuffer=[];for(let Oe=0;Oe<6;Oe++)if(a&&I.mipmaps&&I.mipmaps.length>0){te.__webglFramebuffer[Oe]=[];for(let Ge=0;Ge<I.mipmaps.length;Ge++)te.__webglFramebuffer[Oe][Ge]=n.createFramebuffer()}else te.__webglFramebuffer[Oe]=n.createFramebuffer()}else{if(a&&I.mipmaps&&I.mipmaps.length>0){te.__webglFramebuffer=[];for(let Oe=0;Oe<I.mipmaps.length;Oe++)te.__webglFramebuffer[Oe]=n.createFramebuffer()}else te.__webglFramebuffer=n.createFramebuffer();if(Ee)if(r.drawBuffers){const Oe=N.texture;for(let Ge=0,lt=Oe.length;Ge<lt;Ge++){const yt=i.get(Oe[Ge]);yt.__webglTexture===void 0&&(yt.__webglTexture=n.createTexture(),o.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(a&&N.samples>0&&ve(N)===!1){const Oe=Ee?I:[I];te.__webglMultisampledFramebuffer=n.createFramebuffer(),te.__webglColorRenderbuffer=[],t.bindFramebuffer(n.FRAMEBUFFER,te.__webglMultisampledFramebuffer);for(let Ge=0;Ge<Oe.length;Ge++){const lt=Oe[Ge];te.__webglColorRenderbuffer[Ge]=n.createRenderbuffer(),n.bindRenderbuffer(n.RENDERBUFFER,te.__webglColorRenderbuffer[Ge]);const yt=s.convert(lt.format,lt.colorSpace),Te=s.convert(lt.type),Ct=T(lt.internalFormat,yt,Te,lt.colorSpace,N.isXRRenderTarget===!0),ot=Ue(N);n.renderbufferStorageMultisample(n.RENDERBUFFER,ot,Ct,N.width,N.height),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+Ge,n.RENDERBUFFER,te.__webglColorRenderbuffer[Ge])}n.bindRenderbuffer(n.RENDERBUFFER,null),N.depthBuffer&&(te.__webglDepthRenderbuffer=n.createRenderbuffer(),Ne(te.__webglDepthRenderbuffer,N,!0)),t.bindFramebuffer(n.FRAMEBUFFER,null)}}if(we){t.bindTexture(n.TEXTURE_CUBE_MAP,Ce.__webglTexture),J(n.TEXTURE_CUBE_MAP,I,Ke);for(let Oe=0;Oe<6;Oe++)if(a&&I.mipmaps&&I.mipmaps.length>0)for(let Ge=0;Ge<I.mipmaps.length;Ge++)Fe(te.__webglFramebuffer[Oe][Ge],N,I,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Oe,Ge);else Fe(te.__webglFramebuffer[Oe],N,I,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+Oe,0);S(I,Ke)&&M(n.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(Ee){const Oe=N.texture;for(let Ge=0,lt=Oe.length;Ge<lt;Ge++){const yt=Oe[Ge],Te=i.get(yt);t.bindTexture(n.TEXTURE_2D,Te.__webglTexture),J(n.TEXTURE_2D,yt,Ke),Fe(te.__webglFramebuffer,N,yt,n.COLOR_ATTACHMENT0+Ge,n.TEXTURE_2D,0),S(yt,Ke)&&M(n.TEXTURE_2D)}t.unbindTexture()}else{let Oe=n.TEXTURE_2D;if((N.isWebGL3DRenderTarget||N.isWebGLArrayRenderTarget)&&(a?Oe=N.isWebGL3DRenderTarget?n.TEXTURE_3D:n.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),t.bindTexture(Oe,Ce.__webglTexture),J(Oe,I,Ke),a&&I.mipmaps&&I.mipmaps.length>0)for(let Ge=0;Ge<I.mipmaps.length;Ge++)Fe(te.__webglFramebuffer[Ge],N,I,n.COLOR_ATTACHMENT0,Oe,Ge);else Fe(te.__webglFramebuffer,N,I,n.COLOR_ATTACHMENT0,Oe,0);S(I,Ke)&&M(Oe),t.unbindTexture()}N.depthBuffer&&ke(N)}function xe(N){const I=x(N)||a,te=N.isWebGLMultipleRenderTargets===!0?N.texture:[N.texture];for(let Ce=0,we=te.length;Ce<we;Ce++){const Ee=te[Ce];if(S(Ee,I)){const Ke=N.isWebGLCubeRenderTarget?n.TEXTURE_CUBE_MAP:n.TEXTURE_2D,Oe=i.get(Ee).__webglTexture;t.bindTexture(Ke,Oe),M(Ke),t.unbindTexture()}}}function oe(N){if(a&&N.samples>0&&ve(N)===!1){const I=N.isWebGLMultipleRenderTargets?N.texture:[N.texture],te=N.width,Ce=N.height;let we=n.COLOR_BUFFER_BIT;const Ee=[],Ke=N.stencilBuffer?n.DEPTH_STENCIL_ATTACHMENT:n.DEPTH_ATTACHMENT,Oe=i.get(N),Ge=N.isWebGLMultipleRenderTargets===!0;if(Ge)for(let lt=0;lt<I.length;lt++)t.bindFramebuffer(n.FRAMEBUFFER,Oe.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+lt,n.RENDERBUFFER,null),t.bindFramebuffer(n.FRAMEBUFFER,Oe.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+lt,n.TEXTURE_2D,null,0);t.bindFramebuffer(n.READ_FRAMEBUFFER,Oe.__webglMultisampledFramebuffer),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Oe.__webglFramebuffer);for(let lt=0;lt<I.length;lt++){Ee.push(n.COLOR_ATTACHMENT0+lt),N.depthBuffer&&Ee.push(Ke);const yt=Oe.__ignoreDepthValues!==void 0?Oe.__ignoreDepthValues:!1;if(yt===!1&&(N.depthBuffer&&(we|=n.DEPTH_BUFFER_BIT),N.stencilBuffer&&(we|=n.STENCIL_BUFFER_BIT)),Ge&&n.framebufferRenderbuffer(n.READ_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.RENDERBUFFER,Oe.__webglColorRenderbuffer[lt]),yt===!0&&(n.invalidateFramebuffer(n.READ_FRAMEBUFFER,[Ke]),n.invalidateFramebuffer(n.DRAW_FRAMEBUFFER,[Ke])),Ge){const Te=i.get(I[lt]).__webglTexture;n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,Te,0)}n.blitFramebuffer(0,0,te,Ce,0,0,te,Ce,we,n.NEAREST),f&&n.invalidateFramebuffer(n.READ_FRAMEBUFFER,Ee)}if(t.bindFramebuffer(n.READ_FRAMEBUFFER,null),t.bindFramebuffer(n.DRAW_FRAMEBUFFER,null),Ge)for(let lt=0;lt<I.length;lt++){t.bindFramebuffer(n.FRAMEBUFFER,Oe.__webglMultisampledFramebuffer),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+lt,n.RENDERBUFFER,Oe.__webglColorRenderbuffer[lt]);const yt=i.get(I[lt]).__webglTexture;t.bindFramebuffer(n.FRAMEBUFFER,Oe.__webglFramebuffer),n.framebufferTexture2D(n.DRAW_FRAMEBUFFER,n.COLOR_ATTACHMENT0+lt,n.TEXTURE_2D,yt,0)}t.bindFramebuffer(n.DRAW_FRAMEBUFFER,Oe.__webglMultisampledFramebuffer)}}function Ue(N){return Math.min(r.maxSamples,N.samples)}function ve(N){const I=i.get(N);return a&&N.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&I.__useRenderToTexture!==!1}function Ze(N){const I=o.render.frame;d.get(N)!==I&&(d.set(N,I),N.update())}function Ve(N,I){const te=N.colorSpace,Ce=N.format,we=N.type;return N.isCompressedTexture===!0||N.isVideoTexture===!0||N.format===Tp||te!==rs&&te!==Ji&&(Yt.getTransfer(te)===tn?a===!1?e.has("EXT_sRGB")===!0&&Ce===Mi?(N.format=Tp,N.minFilter=fn,N.generateMipmaps=!1):I=O_.sRGBToLinear(I):(Ce!==Mi||we!==ts)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",te)),I}this.allocateTextureUnit=G,this.resetTextureUnits=me,this.setTexture2D=ne,this.setTexture2DArray=he,this.setTexture3D=F,this.setTextureCube=W,this.rebindTextures=Le,this.setupRenderTarget=H,this.updateRenderTargetMipmap=xe,this.updateMultisampleRenderTarget=oe,this.setupDepthRenderbuffer=ke,this.setupFrameBufferTexture=Fe,this.useMultisampledRTT=ve}function Ob(n,e,t){const i=t.isWebGL2;function r(s,o=Ji){let a;const c=Yt.getTransfer(o);if(s===ts)return n.UNSIGNED_BYTE;if(s===T_)return n.UNSIGNED_SHORT_4_4_4_4;if(s===A_)return n.UNSIGNED_SHORT_5_5_5_1;if(s===nb)return n.BYTE;if(s===ib)return n.SHORT;if(s===qp)return n.UNSIGNED_SHORT;if(s===E_)return n.INT;if(s===Ts)return n.UNSIGNED_INT;if(s===vr)return n.FLOAT;if(s===Ea)return i?n.HALF_FLOAT:(a=e.get("OES_texture_half_float"),a!==null?a.HALF_FLOAT_OES:null);if(s===rb)return n.ALPHA;if(s===Mi)return n.RGBA;if(s===sb)return n.LUMINANCE;if(s===ob)return n.LUMINANCE_ALPHA;if(s===yo)return n.DEPTH_COMPONENT;if(s===Ta)return n.DEPTH_STENCIL;if(s===Tp)return a=e.get("EXT_sRGB"),a!==null?a.SRGB_ALPHA_EXT:null;if(s===ab)return n.RED;if(s===b_)return n.RED_INTEGER;if(s===lb)return n.RG;if(s===C_)return n.RG_INTEGER;if(s===R_)return n.RGBA_INTEGER;if(s===Wh||s===Xh||s===jh||s===Yh)if(c===tn)if(a=e.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(s===Wh)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===Xh)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===jh)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===Yh)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=e.get("WEBGL_compressed_texture_s3tc"),a!==null){if(s===Wh)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===Xh)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===jh)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===Yh)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===Hv||s===Vv||s===Gv||s===Wv)if(a=e.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(s===Hv)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===Vv)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===Gv)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===Wv)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===P_)return a=e.get("WEBGL_compressed_texture_etc1"),a!==null?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===Xv||s===jv)if(a=e.get("WEBGL_compressed_texture_etc"),a!==null){if(s===Xv)return c===tn?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(s===jv)return c===tn?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===Yv||s===qv||s===Zv||s===Kv||s===Jv||s===Qv||s===$v||s===ey||s===ty||s===ny||s===iy||s===ry||s===sy||s===oy)if(a=e.get("WEBGL_compressed_texture_astc"),a!==null){if(s===Yv)return c===tn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===qv)return c===tn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===Zv)return c===tn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===Kv)return c===tn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===Jv)return c===tn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===Qv)return c===tn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===$v)return c===tn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===ey)return c===tn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===ty)return c===tn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===ny)return c===tn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===iy)return c===tn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===ry)return c===tn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===sy)return c===tn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===oy)return c===tn?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===qh||s===ay||s===ly)if(a=e.get("EXT_texture_compression_bptc"),a!==null){if(s===qh)return c===tn?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(s===ay)return a.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(s===ly)return a.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(s===ub||s===uy||s===cy||s===fy)if(a=e.get("EXT_texture_compression_rgtc"),a!==null){if(s===qh)return a.COMPRESSED_RED_RGTC1_EXT;if(s===uy)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(s===cy)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(s===fy)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return s===vo?i?n.UNSIGNED_INT_24_8:(a=e.get("WEBGL_depth_texture"),a!==null?a.UNSIGNED_INT_24_8_WEBGL:null):n[s]!==void 0?n[s]:null}return{convert:r}}class kb extends dn{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class zl extends Wt{constructor(){super(),this.isGroup=!0,this.type="Group"}}const EO={type:"move"};class y0{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new zl,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new zl,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new k,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new k),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new zl,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new k,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new k),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,i){let r=null,s=null,o=null;const a=this._targetRay,c=this._grip,f=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(f&&e.hand){o=!0;for(const w of e.hand.values()){const x=t.getJointPose(w,i),g=this._getHandJoint(f,w);x!==null&&(g.matrix.fromArray(x.transform.matrix),g.matrix.decompose(g.position,g.rotation,g.scale),g.matrixWorldNeedsUpdate=!0,g.jointRadius=x.radius),g.visible=x!==null}const d=f.joints["index-finger-tip"],h=f.joints["thumb-tip"],m=d.position.distanceTo(h.position),v=.02,y=.005;f.inputState.pinching&&m>v+y?(f.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!f.inputState.pinching&&m<=v-y&&(f.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else c!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,i),s!==null&&(c.matrix.fromArray(s.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale),c.matrixWorldNeedsUpdate=!0,s.linearVelocity?(c.hasLinearVelocity=!0,c.linearVelocity.copy(s.linearVelocity)):c.hasLinearVelocity=!1,s.angularVelocity?(c.hasAngularVelocity=!0,c.angularVelocity.copy(s.angularVelocity)):c.hasAngularVelocity=!1));a!==null&&(r=t.getPose(e.targetRaySpace,i),r===null&&s!==null&&(r=s),r!==null&&(a.matrix.fromArray(r.transform.matrix),a.matrix.decompose(a.position,a.rotation,a.scale),a.matrixWorldNeedsUpdate=!0,r.linearVelocity?(a.hasLinearVelocity=!0,a.linearVelocity.copy(r.linearVelocity)):a.hasLinearVelocity=!1,r.angularVelocity?(a.hasAngularVelocity=!0,a.angularVelocity.copy(r.angularVelocity)):a.hasAngularVelocity=!1,this.dispatchEvent(EO)))}return a!==null&&(a.visible=r!==null),c!==null&&(c.visible=s!==null),f!==null&&(f.visible=o!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const i=new zl;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}class TO extends ks{constructor(e,t){super();const i=this;let r=null,s=1,o=null,a="local-floor",c=1,f=null,d=null,h=null,m=null,v=null,y=null;const w=t.getContextAttributes();let x=null,g=null;const S=[],M=[],T=new be;let P=null;const b=new dn;b.layers.enable(1),b.viewport=new qt;const L=new dn;L.layers.enable(2),L.viewport=new qt;const O=[b,L],C=new kb;C.layers.enable(1),C.layers.enable(2);let R=null,B=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(J){let ge=S[J];return ge===void 0&&(ge=new y0,S[J]=ge),ge.getTargetRaySpace()},this.getControllerGrip=function(J){let ge=S[J];return ge===void 0&&(ge=new y0,S[J]=ge),ge.getGripSpace()},this.getHand=function(J){let ge=S[J];return ge===void 0&&(ge=new y0,S[J]=ge),ge.getHandSpace()};function $(J){const ge=M.indexOf(J.inputSource);if(ge===-1)return;const Ie=S[ge];Ie!==void 0&&(Ie.update(J.inputSource,J.frame,f||o),Ie.dispatchEvent({type:J.type,data:J.inputSource}))}function me(){r.removeEventListener("select",$),r.removeEventListener("selectstart",$),r.removeEventListener("selectend",$),r.removeEventListener("squeeze",$),r.removeEventListener("squeezestart",$),r.removeEventListener("squeezeend",$),r.removeEventListener("end",me),r.removeEventListener("inputsourceschange",G);for(let J=0;J<S.length;J++){const ge=M[J];ge!==null&&(M[J]=null,S[J].disconnect(ge))}R=null,B=null,e.setRenderTarget(x),v=null,m=null,h=null,r=null,g=null,se.stop(),i.isPresenting=!1,e.setPixelRatio(P),e.setSize(T.width,T.height,!1),i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(J){s=J,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(J){a=J,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return f||o},this.setReferenceSpace=function(J){f=J},this.getBaseLayer=function(){return m!==null?m:v},this.getBinding=function(){return h},this.getFrame=function(){return y},this.getSession=function(){return r},this.setSession=async function(J){if(r=J,r!==null){if(x=e.getRenderTarget(),r.addEventListener("select",$),r.addEventListener("selectstart",$),r.addEventListener("selectend",$),r.addEventListener("squeeze",$),r.addEventListener("squeezestart",$),r.addEventListener("squeezeend",$),r.addEventListener("end",me),r.addEventListener("inputsourceschange",G),w.xrCompatible!==!0&&await t.makeXRCompatible(),P=e.getPixelRatio(),e.getSize(T),r.renderState.layers===void 0||e.capabilities.isWebGL2===!1){const ge={antialias:r.renderState.layers===void 0?w.antialias:!0,alpha:!0,depth:w.depth,stencil:w.stencil,framebufferScaleFactor:s};v=new XRWebGLLayer(r,t,ge),r.updateRenderState({baseLayer:v}),e.setPixelRatio(1),e.setSize(v.framebufferWidth,v.framebufferHeight,!1),g=new Sr(v.framebufferWidth,v.framebufferHeight,{format:Mi,type:ts,colorSpace:e.outputColorSpace,stencilBuffer:w.stencil})}else{let ge=null,Ie=null,Be=null;w.depth&&(Be=w.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,ge=w.stencil?Ta:yo,Ie=w.stencil?vo:Ts);const Fe={colorFormat:t.RGBA8,depthFormat:Be,scaleFactor:s};h=new XRWebGLBinding(r,t),m=h.createProjectionLayer(Fe),r.updateRenderState({layers:[m]}),e.setPixelRatio(1),e.setSize(m.textureWidth,m.textureHeight,!1),g=new Sr(m.textureWidth,m.textureHeight,{format:Mi,type:ts,depthTexture:new Qp(m.textureWidth,m.textureHeight,Ie,void 0,void 0,void 0,void 0,void 0,void 0,ge),stencilBuffer:w.stencil,colorSpace:e.outputColorSpace,samples:w.antialias?4:0});const Ne=e.properties.get(g);Ne.__ignoreDepthValues=m.ignoreDepthValues}g.isXRRenderTarget=!0,this.setFoveation(c),f=null,o=await r.requestReferenceSpace(a),se.setContext(r),se.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(r!==null)return r.environmentBlendMode};function G(J){for(let ge=0;ge<J.removed.length;ge++){const Ie=J.removed[ge],Be=M.indexOf(Ie);Be>=0&&(M[Be]=null,S[Be].disconnect(Ie))}for(let ge=0;ge<J.added.length;ge++){const Ie=J.added[ge];let Be=M.indexOf(Ie);if(Be===-1){for(let Ne=0;Ne<S.length;Ne++)if(Ne>=M.length){M.push(Ie),Be=Ne;break}else if(M[Ne]===null){M[Ne]=Ie,Be=Ne;break}if(Be===-1)break}const Fe=S[Be];Fe&&Fe.connect(Ie)}}const Z=new k,ne=new k;function he(J,ge,Ie){Z.setFromMatrixPosition(ge.matrixWorld),ne.setFromMatrixPosition(Ie.matrixWorld);const Be=Z.distanceTo(ne),Fe=ge.projectionMatrix.elements,Ne=Ie.projectionMatrix.elements,je=Fe[14]/(Fe[10]-1),ke=Fe[14]/(Fe[10]+1),Le=(Fe[9]+1)/Fe[5],H=(Fe[9]-1)/Fe[5],xe=(Fe[8]-1)/Fe[0],oe=(Ne[8]+1)/Ne[0],Ue=je*xe,ve=je*oe,Ze=Be/(-xe+oe),Ve=Ze*-xe;ge.matrixWorld.decompose(J.position,J.quaternion,J.scale),J.translateX(Ve),J.translateZ(Ze),J.matrixWorld.compose(J.position,J.quaternion,J.scale),J.matrixWorldInverse.copy(J.matrixWorld).invert();const N=je+Ze,I=ke+Ze,te=Ue-Ve,Ce=ve+(Be-Ve),we=Le*ke/I*N,Ee=H*ke/I*N;J.projectionMatrix.makePerspective(te,Ce,we,Ee,N,I),J.projectionMatrixInverse.copy(J.projectionMatrix).invert()}function F(J,ge){ge===null?J.matrixWorld.copy(J.matrix):J.matrixWorld.multiplyMatrices(ge.matrixWorld,J.matrix),J.matrixWorldInverse.copy(J.matrixWorld).invert()}this.updateCamera=function(J){if(r===null)return;C.near=L.near=b.near=J.near,C.far=L.far=b.far=J.far,(R!==C.near||B!==C.far)&&(r.updateRenderState({depthNear:C.near,depthFar:C.far}),R=C.near,B=C.far);const ge=J.parent,Ie=C.cameras;F(C,ge);for(let Be=0;Be<Ie.length;Be++)F(Ie[Be],ge);Ie.length===2?he(C,b,L):C.projectionMatrix.copy(b.projectionMatrix),W(J,C,ge)};function W(J,ge,Ie){Ie===null?J.matrix.copy(ge.matrixWorld):(J.matrix.copy(Ie.matrixWorld),J.matrix.invert(),J.matrix.multiply(ge.matrixWorld)),J.matrix.decompose(J.position,J.quaternion,J.scale),J.updateMatrixWorld(!0),J.projectionMatrix.copy(ge.projectionMatrix),J.projectionMatrixInverse.copy(ge.projectionMatrixInverse),J.isPerspectiveCamera&&(J.fov=iu*2*Math.atan(1/J.projectionMatrix.elements[5]),J.zoom=1)}this.getCamera=function(){return C},this.getFoveation=function(){if(!(m===null&&v===null))return c},this.setFoveation=function(J){c=J,m!==null&&(m.fixedFoveation=J),v!==null&&v.fixedFoveation!==void 0&&(v.fixedFoveation=J)};let V=null;function Q(J,ge){if(d=ge.getViewerPose(f||o),y=ge,d!==null){const Ie=d.views;v!==null&&(e.setRenderTargetFramebuffer(g,v.framebuffer),e.setRenderTarget(g));let Be=!1;Ie.length!==C.cameras.length&&(C.cameras.length=0,Be=!0);for(let Fe=0;Fe<Ie.length;Fe++){const Ne=Ie[Fe];let je=null;if(v!==null)je=v.getViewport(Ne);else{const Le=h.getViewSubImage(m,Ne);je=Le.viewport,Fe===0&&(e.setRenderTargetTextures(g,Le.colorTexture,m.ignoreDepthValues?void 0:Le.depthStencilTexture),e.setRenderTarget(g))}let ke=O[Fe];ke===void 0&&(ke=new dn,ke.layers.enable(Fe),ke.viewport=new qt,O[Fe]=ke),ke.matrix.fromArray(Ne.transform.matrix),ke.matrix.decompose(ke.position,ke.quaternion,ke.scale),ke.projectionMatrix.fromArray(Ne.projectionMatrix),ke.projectionMatrixInverse.copy(ke.projectionMatrix).invert(),ke.viewport.set(je.x,je.y,je.width,je.height),Fe===0&&(C.matrix.copy(ke.matrix),C.matrix.decompose(C.position,C.quaternion,C.scale)),Be===!0&&C.cameras.push(ke)}}for(let Ie=0;Ie<S.length;Ie++){const Be=M[Ie],Fe=S[Ie];Be!==null&&Fe!==void 0&&Fe.update(Be,ge,f||o)}V&&V(J,ge),ge.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:ge}),y=null}const se=new Pb;se.setAnimationLoop(Q),this.setAnimationLoop=function(J){V=J},this.dispose=function(){}}}function AO(n,e){function t(x,g){x.matrixAutoUpdate===!0&&x.updateMatrix(),g.value.copy(x.matrix)}function i(x,g){g.color.getRGB(x.fogColor.value,bb(n)),g.isFog?(x.fogNear.value=g.near,x.fogFar.value=g.far):g.isFogExp2&&(x.fogDensity.value=g.density)}function r(x,g,S,M,T){g.isMeshBasicMaterial||g.isMeshLambertMaterial?s(x,g):g.isMeshToonMaterial?(s(x,g),h(x,g)):g.isMeshPhongMaterial?(s(x,g),d(x,g)):g.isMeshStandardMaterial?(s(x,g),m(x,g),g.isMeshPhysicalMaterial&&v(x,g,T)):g.isMeshMatcapMaterial?(s(x,g),y(x,g)):g.isMeshDepthMaterial?s(x,g):g.isMeshDistanceMaterial?(s(x,g),w(x,g)):g.isMeshNormalMaterial?s(x,g):g.isLineBasicMaterial?(o(x,g),g.isLineDashedMaterial&&a(x,g)):g.isPointsMaterial?c(x,g,S,M):g.isSpriteMaterial?f(x,g):g.isShadowMaterial?(x.color.value.copy(g.color),x.opacity.value=g.opacity):g.isShaderMaterial&&(g.uniformsNeedUpdate=!1)}function s(x,g){x.opacity.value=g.opacity,g.color&&x.diffuse.value.copy(g.color),g.emissive&&x.emissive.value.copy(g.emissive).multiplyScalar(g.emissiveIntensity),g.map&&(x.map.value=g.map,t(g.map,x.mapTransform)),g.alphaMap&&(x.alphaMap.value=g.alphaMap,t(g.alphaMap,x.alphaMapTransform)),g.bumpMap&&(x.bumpMap.value=g.bumpMap,t(g.bumpMap,x.bumpMapTransform),x.bumpScale.value=g.bumpScale,g.side===Ei&&(x.bumpScale.value*=-1)),g.normalMap&&(x.normalMap.value=g.normalMap,t(g.normalMap,x.normalMapTransform),x.normalScale.value.copy(g.normalScale),g.side===Ei&&x.normalScale.value.negate()),g.displacementMap&&(x.displacementMap.value=g.displacementMap,t(g.displacementMap,x.displacementMapTransform),x.displacementScale.value=g.displacementScale,x.displacementBias.value=g.displacementBias),g.emissiveMap&&(x.emissiveMap.value=g.emissiveMap,t(g.emissiveMap,x.emissiveMapTransform)),g.specularMap&&(x.specularMap.value=g.specularMap,t(g.specularMap,x.specularMapTransform)),g.alphaTest>0&&(x.alphaTest.value=g.alphaTest);const S=e.get(g).envMap;if(S&&(x.envMap.value=S,x.flipEnvMap.value=S.isCubeTexture&&S.isRenderTargetTexture===!1?-1:1,x.reflectivity.value=g.reflectivity,x.ior.value=g.ior,x.refractionRatio.value=g.refractionRatio),g.lightMap){x.lightMap.value=g.lightMap;const M=n._useLegacyLights===!0?Math.PI:1;x.lightMapIntensity.value=g.lightMapIntensity*M,t(g.lightMap,x.lightMapTransform)}g.aoMap&&(x.aoMap.value=g.aoMap,x.aoMapIntensity.value=g.aoMapIntensity,t(g.aoMap,x.aoMapTransform))}function o(x,g){x.diffuse.value.copy(g.color),x.opacity.value=g.opacity,g.map&&(x.map.value=g.map,t(g.map,x.mapTransform))}function a(x,g){x.dashSize.value=g.dashSize,x.totalSize.value=g.dashSize+g.gapSize,x.scale.value=g.scale}function c(x,g,S,M){x.diffuse.value.copy(g.color),x.opacity.value=g.opacity,x.size.value=g.size*S,x.scale.value=M*.5,g.map&&(x.map.value=g.map,t(g.map,x.uvTransform)),g.alphaMap&&(x.alphaMap.value=g.alphaMap,t(g.alphaMap,x.alphaMapTransform)),g.alphaTest>0&&(x.alphaTest.value=g.alphaTest)}function f(x,g){x.diffuse.value.copy(g.color),x.opacity.value=g.opacity,x.rotation.value=g.rotation,g.map&&(x.map.value=g.map,t(g.map,x.mapTransform)),g.alphaMap&&(x.alphaMap.value=g.alphaMap,t(g.alphaMap,x.alphaMapTransform)),g.alphaTest>0&&(x.alphaTest.value=g.alphaTest)}function d(x,g){x.specular.value.copy(g.specular),x.shininess.value=Math.max(g.shininess,1e-4)}function h(x,g){g.gradientMap&&(x.gradientMap.value=g.gradientMap)}function m(x,g){x.metalness.value=g.metalness,g.metalnessMap&&(x.metalnessMap.value=g.metalnessMap,t(g.metalnessMap,x.metalnessMapTransform)),x.roughness.value=g.roughness,g.roughnessMap&&(x.roughnessMap.value=g.roughnessMap,t(g.roughnessMap,x.roughnessMapTransform)),e.get(g).envMap&&(x.envMapIntensity.value=g.envMapIntensity)}function v(x,g,S){x.ior.value=g.ior,g.sheen>0&&(x.sheenColor.value.copy(g.sheenColor).multiplyScalar(g.sheen),x.sheenRoughness.value=g.sheenRoughness,g.sheenColorMap&&(x.sheenColorMap.value=g.sheenColorMap,t(g.sheenColorMap,x.sheenColorMapTransform)),g.sheenRoughnessMap&&(x.sheenRoughnessMap.value=g.sheenRoughnessMap,t(g.sheenRoughnessMap,x.sheenRoughnessMapTransform))),g.clearcoat>0&&(x.clearcoat.value=g.clearcoat,x.clearcoatRoughness.value=g.clearcoatRoughness,g.clearcoatMap&&(x.clearcoatMap.value=g.clearcoatMap,t(g.clearcoatMap,x.clearcoatMapTransform)),g.clearcoatRoughnessMap&&(x.clearcoatRoughnessMap.value=g.clearcoatRoughnessMap,t(g.clearcoatRoughnessMap,x.clearcoatRoughnessMapTransform)),g.clearcoatNormalMap&&(x.clearcoatNormalMap.value=g.clearcoatNormalMap,t(g.clearcoatNormalMap,x.clearcoatNormalMapTransform),x.clearcoatNormalScale.value.copy(g.clearcoatNormalScale),g.side===Ei&&x.clearcoatNormalScale.value.negate())),g.iridescence>0&&(x.iridescence.value=g.iridescence,x.iridescenceIOR.value=g.iridescenceIOR,x.iridescenceThicknessMinimum.value=g.iridescenceThicknessRange[0],x.iridescenceThicknessMaximum.value=g.iridescenceThicknessRange[1],g.iridescenceMap&&(x.iridescenceMap.value=g.iridescenceMap,t(g.iridescenceMap,x.iridescenceMapTransform)),g.iridescenceThicknessMap&&(x.iridescenceThicknessMap.value=g.iridescenceThicknessMap,t(g.iridescenceThicknessMap,x.iridescenceThicknessMapTransform))),g.transmission>0&&(x.transmission.value=g.transmission,x.transmissionSamplerMap.value=S.texture,x.transmissionSamplerSize.value.set(S.width,S.height),g.transmissionMap&&(x.transmissionMap.value=g.transmissionMap,t(g.transmissionMap,x.transmissionMapTransform)),x.thickness.value=g.thickness,g.thicknessMap&&(x.thicknessMap.value=g.thicknessMap,t(g.thicknessMap,x.thicknessMapTransform)),x.attenuationDistance.value=g.attenuationDistance,x.attenuationColor.value.copy(g.attenuationColor)),g.anisotropy>0&&(x.anisotropyVector.value.set(g.anisotropy*Math.cos(g.anisotropyRotation),g.anisotropy*Math.sin(g.anisotropyRotation)),g.anisotropyMap&&(x.anisotropyMap.value=g.anisotropyMap,t(g.anisotropyMap,x.anisotropyMapTransform))),x.specularIntensity.value=g.specularIntensity,x.specularColor.value.copy(g.specularColor),g.specularColorMap&&(x.specularColorMap.value=g.specularColorMap,t(g.specularColorMap,x.specularColorMapTransform)),g.specularIntensityMap&&(x.specularIntensityMap.value=g.specularIntensityMap,t(g.specularIntensityMap,x.specularIntensityMapTransform))}function y(x,g){g.matcap&&(x.matcap.value=g.matcap)}function w(x,g){const S=e.get(g).light;x.referencePosition.value.setFromMatrixPosition(S.matrixWorld),x.nearDistance.value=S.shadow.camera.near,x.farDistance.value=S.shadow.camera.far}return{refreshFogUniforms:i,refreshMaterialUniforms:r}}function bO(n,e,t,i){let r={},s={},o=[];const a=t.isWebGL2?n.getParameter(n.MAX_UNIFORM_BUFFER_BINDINGS):0;function c(S,M){const T=M.program;i.uniformBlockBinding(S,T)}function f(S,M){let T=r[S.id];T===void 0&&(y(S),T=d(S),r[S.id]=T,S.addEventListener("dispose",x));const P=M.program;i.updateUBOMapping(S,P);const b=e.render.frame;s[S.id]!==b&&(m(S),s[S.id]=b)}function d(S){const M=h();S.__bindingPointIndex=M;const T=n.createBuffer(),P=S.__size,b=S.usage;return n.bindBuffer(n.UNIFORM_BUFFER,T),n.bufferData(n.UNIFORM_BUFFER,P,b),n.bindBuffer(n.UNIFORM_BUFFER,null),n.bindBufferBase(n.UNIFORM_BUFFER,M,T),T}function h(){for(let S=0;S<a;S++)if(o.indexOf(S)===-1)return o.push(S),S;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function m(S){const M=r[S.id],T=S.uniforms,P=S.__cache;n.bindBuffer(n.UNIFORM_BUFFER,M);for(let b=0,L=T.length;b<L;b++){const O=Array.isArray(T[b])?T[b]:[T[b]];for(let C=0,R=O.length;C<R;C++){const B=O[C];if(v(B,b,C,P)===!0){const $=B.__offset,me=Array.isArray(B.value)?B.value:[B.value];let G=0;for(let Z=0;Z<me.length;Z++){const ne=me[Z],he=w(ne);typeof ne=="number"||typeof ne=="boolean"?(B.__data[0]=ne,n.bufferSubData(n.UNIFORM_BUFFER,$+G,B.__data)):ne.isMatrix3?(B.__data[0]=ne.elements[0],B.__data[1]=ne.elements[1],B.__data[2]=ne.elements[2],B.__data[3]=0,B.__data[4]=ne.elements[3],B.__data[5]=ne.elements[4],B.__data[6]=ne.elements[5],B.__data[7]=0,B.__data[8]=ne.elements[6],B.__data[9]=ne.elements[7],B.__data[10]=ne.elements[8],B.__data[11]=0):(ne.toArray(B.__data,G),G+=he.storage/Float32Array.BYTES_PER_ELEMENT)}n.bufferSubData(n.UNIFORM_BUFFER,$,B.__data)}}}n.bindBuffer(n.UNIFORM_BUFFER,null)}function v(S,M,T,P){const b=S.value,L=M+"_"+T;if(P[L]===void 0)return typeof b=="number"||typeof b=="boolean"?P[L]=b:P[L]=b.clone(),!0;{const O=P[L];if(typeof b=="number"||typeof b=="boolean"){if(O!==b)return P[L]=b,!0}else if(O.equals(b)===!1)return O.copy(b),!0}return!1}function y(S){const M=S.uniforms;let T=0;const P=16;for(let L=0,O=M.length;L<O;L++){const C=Array.isArray(M[L])?M[L]:[M[L]];for(let R=0,B=C.length;R<B;R++){const $=C[R],me=Array.isArray($.value)?$.value:[$.value];for(let G=0,Z=me.length;G<Z;G++){const ne=me[G],he=w(ne),F=T%P;F!==0&&P-F<he.boundary&&(T+=P-F),$.__data=new Float32Array(he.storage/Float32Array.BYTES_PER_ELEMENT),$.__offset=T,T+=he.storage}}}const b=T%P;return b>0&&(T+=P-b),S.__size=T,S.__cache={},this}function w(S){const M={boundary:0,storage:0};return typeof S=="number"||typeof S=="boolean"?(M.boundary=4,M.storage=4):S.isVector2?(M.boundary=8,M.storage=8):S.isVector3||S.isColor?(M.boundary=16,M.storage=12):S.isVector4?(M.boundary=16,M.storage=16):S.isMatrix3?(M.boundary=48,M.storage=48):S.isMatrix4?(M.boundary=64,M.storage=64):S.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",S),M}function x(S){const M=S.target;M.removeEventListener("dispose",x);const T=o.indexOf(M.__bindingPointIndex);o.splice(T,1),n.deleteBuffer(r[M.id]),delete r[M.id],delete s[M.id]}function g(){for(const S in r)n.deleteBuffer(r[S]);o=[],r={},s={}}return{bind:c,update:f,dispose:g}}class W_{constructor(e={}){const{canvas:t=Eb(),context:i=null,depth:r=!0,stencil:s=!0,alpha:o=!1,antialias:a=!1,premultipliedAlpha:c=!0,preserveDrawingBuffer:f=!1,powerPreference:d="default",failIfMajorPerformanceCaveat:h=!1}=e;this.isWebGLRenderer=!0;let m;i!==null?m=i.getContextAttributes().alpha:m=o;const v=new Uint32Array(4),y=new Int32Array(4);let w=null,x=null;const g=[],S=[];this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=Un,this._useLegacyLights=!1,this.toneMapping=es,this.toneMappingExposure=1;const M=this;let T=!1,P=0,b=0,L=null,O=-1,C=null;const R=new qt,B=new qt;let $=null;const me=new nt(0);let G=0,Z=t.width,ne=t.height,he=1,F=null,W=null;const V=new qt(0,0,Z,ne),Q=new qt(0,0,Z,ne);let se=!1;const J=new gf;let ge=!1,Ie=!1,Be=null;const Fe=new Mt,Ne=new be,je=new k,ke={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Le(){return L===null?he:1}let H=i;function xe(U,q){for(let ae=0;ae<U.length;ae++){const ce=U[ae],ie=t.getContext(ce,q);if(ie!==null)return ie}return null}try{const U={alpha:!0,depth:r,stencil:s,antialias:a,premultipliedAlpha:c,preserveDrawingBuffer:f,powerPreference:d,failIfMajorPerformanceCaveat:h};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${Xp}`),t.addEventListener("webglcontextlost",De,!1),t.addEventListener("webglcontextrestored",Y,!1),t.addEventListener("webglcontextcreationerror",pe,!1),H===null){const q=["webgl2","webgl","experimental-webgl"];if(M.isWebGL1Renderer===!0&&q.shift(),H=xe(q,U),H===null)throw xe(q)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}typeof WebGLRenderingContext<"u"&&H instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),H.getShaderPrecisionFormat===void 0&&(H.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(U){throw console.error("THREE.WebGLRenderer: "+U.message),U}let oe,Ue,ve,Ze,Ve,N,I,te,Ce,we,Ee,Ke,Oe,Ge,lt,yt,Te,Ct,ot,ut,ct,$e,j,Ae;function Ye(){oe=new HD(H),Ue=new UD(H,oe,e),oe.init(Ue),$e=new Ob(H,oe,Ue),ve=new MO(H,oe,Ue),Ze=new WD(H),Ve=new cO,N=new wO(H,oe,ve,Ve,Ue,$e,Ze),I=new kD(M),te=new BD(M),Ce=new QL(H,Ue),j=new ND(H,oe,Ce,Ue),we=new VD(H,Ce,Ze,j),Ee=new qD(H,we,Ce,Ze),ot=new YD(H,Ue,N),yt=new OD(Ve),Ke=new uO(M,I,te,oe,Ue,j,yt),Oe=new AO(M,Ve),Ge=new dO,lt=new yO(oe,Ue),Ct=new ID(M,I,te,ve,Ee,m,c),Te=new SO(M,Ee,Ue),Ae=new bO(H,Ze,Ue,ve),ut=new DD(H,oe,Ze,Ue),ct=new GD(H,oe,Ze,Ue),Ze.programs=Ke.programs,M.capabilities=Ue,M.extensions=oe,M.properties=Ve,M.renderLists=Ge,M.shadowMap=Te,M.state=ve,M.info=Ze}Ye();const Je=new TO(M,H);this.xr=Je,this.getContext=function(){return H},this.getContextAttributes=function(){return H.getContextAttributes()},this.forceContextLoss=function(){const U=oe.get("WEBGL_lose_context");U&&U.loseContext()},this.forceContextRestore=function(){const U=oe.get("WEBGL_lose_context");U&&U.restoreContext()},this.getPixelRatio=function(){return he},this.setPixelRatio=function(U){U!==void 0&&(he=U,this.setSize(Z,ne,!1))},this.getSize=function(U){return U.set(Z,ne)},this.setSize=function(U,q,ae=!0){if(Je.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}Z=U,ne=q,t.width=Math.floor(U*he),t.height=Math.floor(q*he),ae===!0&&(t.style.width=U+"px",t.style.height=q+"px"),this.setViewport(0,0,U,q)},this.getDrawingBufferSize=function(U){return U.set(Z*he,ne*he).floor()},this.setDrawingBufferSize=function(U,q,ae){Z=U,ne=q,he=ae,t.width=Math.floor(U*ae),t.height=Math.floor(q*ae),this.setViewport(0,0,U,q)},this.getCurrentViewport=function(U){return U.copy(R)},this.getViewport=function(U){return U.copy(V)},this.setViewport=function(U,q,ae,ce){U.isVector4?V.set(U.x,U.y,U.z,U.w):V.set(U,q,ae,ce),ve.viewport(R.copy(V).multiplyScalar(he).floor())},this.getScissor=function(U){return U.copy(Q)},this.setScissor=function(U,q,ae,ce){U.isVector4?Q.set(U.x,U.y,U.z,U.w):Q.set(U,q,ae,ce),ve.scissor(B.copy(Q).multiplyScalar(he).floor())},this.getScissorTest=function(){return se},this.setScissorTest=function(U){ve.setScissorTest(se=U)},this.setOpaqueSort=function(U){F=U},this.setTransparentSort=function(U){W=U},this.getClearColor=function(U){return U.copy(Ct.getClearColor())},this.setClearColor=function(){Ct.setClearColor.apply(Ct,arguments)},this.getClearAlpha=function(){return Ct.getClearAlpha()},this.setClearAlpha=function(){Ct.setClearAlpha.apply(Ct,arguments)},this.clear=function(U=!0,q=!0,ae=!0){let ce=0;if(U){let ie=!1;if(L!==null){const We=L.texture.format;ie=We===R_||We===C_||We===b_}if(ie){const We=L.texture.type,at=We===ts||We===Ts||We===qp||We===vo||We===T_||We===A_,pt=Ct.getClearColor(),mt=Ct.getClearAlpha(),St=pt.r,xt=pt.g,wt=pt.b;at?(v[0]=St,v[1]=xt,v[2]=wt,v[3]=mt,H.clearBufferuiv(H.COLOR,0,v)):(y[0]=St,y[1]=xt,y[2]=wt,y[3]=mt,H.clearBufferiv(H.COLOR,0,y))}else ce|=H.COLOR_BUFFER_BIT}q&&(ce|=H.DEPTH_BUFFER_BIT),ae&&(ce|=H.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),H.clear(ce)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",De,!1),t.removeEventListener("webglcontextrestored",Y,!1),t.removeEventListener("webglcontextcreationerror",pe,!1),Ge.dispose(),lt.dispose(),Ve.dispose(),I.dispose(),te.dispose(),Ee.dispose(),j.dispose(),Ae.dispose(),Ke.dispose(),Je.dispose(),Je.removeEventListener("sessionstart",Pe),Je.removeEventListener("sessionend",fe),Be&&(Be.dispose(),Be=null),Qe.stop()};function De(U){U.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),T=!0}function Y(){console.log("THREE.WebGLRenderer: Context Restored."),T=!1;const U=Ze.autoReset,q=Te.enabled,ae=Te.autoUpdate,ce=Te.needsUpdate,ie=Te.type;Ye(),Ze.autoReset=U,Te.enabled=q,Te.autoUpdate=ae,Te.needsUpdate=ce,Te.type=ie}function pe(U){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",U.statusMessage)}function D(U){const q=U.target;q.removeEventListener("dispose",D),re(q)}function re(U){ue(U),Ve.remove(U)}function ue(U){const q=Ve.get(U).programs;q!==void 0&&(q.forEach(function(ae){Ke.releaseProgram(ae)}),U.isShaderMaterial&&Ke.releaseShaderCache(U))}this.renderBufferDirect=function(U,q,ae,ce,ie,We){q===null&&(q=ke);const at=ie.isMesh&&ie.matrixWorld.determinant()<0,pt=Yn(U,q,ae,ce,ie);ve.setMaterial(ce,at);let mt=ae.index,St=1;if(ce.wireframe===!0){if(mt=we.getWireframeAttribute(ae),mt===void 0)return;St=2}const xt=ae.drawRange,wt=ae.attributes.position;let en=xt.start*St,In=(xt.start+xt.count)*St;We!==null&&(en=Math.max(en,We.start*St),In=Math.min(In,(We.start+We.count)*St)),mt!==null?(en=Math.max(en,0),In=Math.min(In,mt.count)):wt!=null&&(en=Math.max(en,0),In=Math.min(In,wt.count));const Jt=In-en;if(Jt<0||Jt===1/0)return;j.setup(ie,ce,pt,ae,mt);let Sn,_t=ut;if(mt!==null&&(Sn=Ce.get(mt),_t=ct,_t.setIndex(Sn)),ie.isMesh)ce.wireframe===!0?(ve.setLineWidth(ce.wireframeLinewidth*Le()),_t.setMode(H.LINES)):_t.setMode(H.TRIANGLES);else if(ie.isLine){let it=ce.linewidth;it===void 0&&(it=1),ve.setLineWidth(it*Le()),ie.isLineSegments?_t.setMode(H.LINES):ie.isLineLoop?_t.setMode(H.LINE_LOOP):_t.setMode(H.LINE_STRIP)}else ie.isPoints?_t.setMode(H.POINTS):ie.isSprite&&_t.setMode(H.TRIANGLES);if(ie.isBatchedMesh)_t.renderMultiDraw(ie._multiDrawStarts,ie._multiDrawCounts,ie._multiDrawCount);else if(ie.isInstancedMesh)_t.renderInstances(en,Jt,ie.count);else if(ae.isInstancedBufferGeometry){const it=ae._maxInstanceCount!==void 0?ae._maxInstanceCount:1/0,$n=Math.min(ae.instanceCount,it);_t.renderInstances(en,Jt,$n)}else _t.render(en,Jt)};function Me(U,q,ae){U.transparent===!0&&U.side===Ki&&U.forceSinglePass===!1?(U.side=Ei,U.needsUpdate=!0,Ft(U,q,ae),U.side=Ns,U.needsUpdate=!0,Ft(U,q,ae),U.side=Ki):Ft(U,q,ae)}this.compile=function(U,q,ae=null){ae===null&&(ae=U),x=lt.get(ae),x.init(),S.push(x),ae.traverseVisible(function(ie){ie.isLight&&ie.layers.test(q.layers)&&(x.pushLight(ie),ie.castShadow&&x.pushShadow(ie))}),U!==ae&&U.traverseVisible(function(ie){ie.isLight&&ie.layers.test(q.layers)&&(x.pushLight(ie),ie.castShadow&&x.pushShadow(ie))}),x.setupLights(M._useLegacyLights);const ce=new Set;return U.traverse(function(ie){const We=ie.material;if(We)if(Array.isArray(We))for(let at=0;at<We.length;at++){const pt=We[at];Me(pt,ae,ie),ce.add(pt)}else Me(We,ae,ie),ce.add(We)}),S.pop(),x=null,ce},this.compileAsync=function(U,q,ae=null){const ce=this.compile(U,q,ae);return new Promise(ie=>{function We(){if(ce.forEach(function(at){Ve.get(at).currentProgram.isReady()&&ce.delete(at)}),ce.size===0){ie(U);return}setTimeout(We,10)}oe.get("KHR_parallel_shader_compile")!==null?We():setTimeout(We,10)})};let ye=null;function Re(U){ye&&ye(U)}function Pe(){Qe.stop()}function fe(){Qe.start()}const Qe=new Pb;Qe.setAnimationLoop(Re),typeof self<"u"&&Qe.setContext(self),this.setAnimationLoop=function(U){ye=U,Je.setAnimationLoop(U),U===null?Qe.stop():Qe.start()},Je.addEventListener("sessionstart",Pe),Je.addEventListener("sessionend",fe),this.render=function(U,q){if(q!==void 0&&q.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(T===!0)return;U.matrixWorldAutoUpdate===!0&&U.updateMatrixWorld(),q.parent===null&&q.matrixWorldAutoUpdate===!0&&q.updateMatrixWorld(),Je.enabled===!0&&Je.isPresenting===!0&&(Je.cameraAutoUpdate===!0&&Je.updateCamera(q),q=Je.getCamera()),U.isScene===!0&&U.onBeforeRender(M,U,q,L),x=lt.get(U,S.length),x.init(),S.push(x),Fe.multiplyMatrices(q.projectionMatrix,q.matrixWorldInverse),J.setFromProjectionMatrix(Fe),Ie=this.localClippingEnabled,ge=yt.init(this.clippingPlanes,Ie),w=Ge.get(U,g.length),w.init(),g.push(w),Et(U,q,0,M.sortObjects),w.finish(),M.sortObjects===!0&&w.sort(F,W),this.info.render.frame++,ge===!0&&yt.beginShadows();const ae=x.state.shadowsArray;if(Te.render(ae,U,q),ge===!0&&yt.endShadows(),this.info.autoReset===!0&&this.info.reset(),Ct.render(w,U),x.setupLights(M._useLegacyLights),q.isArrayCamera){const ce=q.cameras;for(let ie=0,We=ce.length;ie<We;ie++){const at=ce[ie];Tt(w,U,at,at.viewport)}}else Tt(w,U,q);L!==null&&(N.updateMultisampleRenderTarget(L),N.updateRenderTargetMipmap(L)),U.isScene===!0&&U.onAfterRender(M,U,q),j.resetDefaultState(),O=-1,C=null,S.pop(),S.length>0?x=S[S.length-1]:x=null,g.pop(),g.length>0?w=g[g.length-1]:w=null};function Et(U,q,ae,ce){if(U.visible===!1)return;if(U.layers.test(q.layers)){if(U.isGroup)ae=U.renderOrder;else if(U.isLOD)U.autoUpdate===!0&&U.update(q);else if(U.isLight)x.pushLight(U),U.castShadow&&x.pushShadow(U);else if(U.isSprite){if(!U.frustumCulled||J.intersectsSprite(U)){ce&&je.setFromMatrixPosition(U.matrixWorld).applyMatrix4(Fe);const at=Ee.update(U),pt=U.material;pt.visible&&w.push(U,at,pt,ae,je.z,null)}}else if((U.isMesh||U.isLine||U.isPoints)&&(!U.frustumCulled||J.intersectsObject(U))){const at=Ee.update(U),pt=U.material;if(ce&&(U.boundingSphere!==void 0?(U.boundingSphere===null&&U.computeBoundingSphere(),je.copy(U.boundingSphere.center)):(at.boundingSphere===null&&at.computeBoundingSphere(),je.copy(at.boundingSphere.center)),je.applyMatrix4(U.matrixWorld).applyMatrix4(Fe)),Array.isArray(pt)){const mt=at.groups;for(let St=0,xt=mt.length;St<xt;St++){const wt=mt[St],en=pt[wt.materialIndex];en&&en.visible&&w.push(U,at,en,ae,je.z,wt)}}else pt.visible&&w.push(U,at,pt,ae,je.z,null)}}const We=U.children;for(let at=0,pt=We.length;at<pt;at++)Et(We[at],q,ae,ce)}function Tt(U,q,ae,ce){const ie=U.opaque,We=U.transmissive,at=U.transparent;x.setupLightsView(ae),ge===!0&&yt.setGlobalState(M.clippingPlanes,ae),We.length>0&&Xt(ie,We,q,ae),ce&&ve.viewport(R.copy(ce)),ie.length>0&&Ut(ie,q,ae),We.length>0&&Ut(We,q,ae),at.length>0&&Ut(at,q,ae),ve.buffers.depth.setTest(!0),ve.buffers.depth.setMask(!0),ve.buffers.color.setMask(!0),ve.setPolygonOffset(!1)}function Xt(U,q,ae,ce){if((ae.isScene===!0?ae.overrideMaterial:null)!==null)return;const We=Ue.isWebGL2;Be===null&&(Be=new Sr(1,1,{generateMipmaps:!0,type:oe.has("EXT_color_buffer_half_float")?Ea:ts,minFilter:wo,samples:We?4:0})),M.getDrawingBufferSize(Ne),We?Be.setSize(Ne.x,Ne.y):Be.setSize(Ap(Ne.x),Ap(Ne.y));const at=M.getRenderTarget();M.setRenderTarget(Be),M.getClearColor(me),G=M.getClearAlpha(),G<1&&M.setClearColor(16777215,.5),M.clear();const pt=M.toneMapping;M.toneMapping=es,Ut(U,ae,ce),N.updateMultisampleRenderTarget(Be),N.updateRenderTargetMipmap(Be);let mt=!1;for(let St=0,xt=q.length;St<xt;St++){const wt=q[St],en=wt.object,In=wt.geometry,Jt=wt.material,Sn=wt.group;if(Jt.side===Ki&&en.layers.test(ce.layers)){const _t=Jt.side;Jt.side=Ei,Jt.needsUpdate=!0,Xe(en,ae,ce,In,Jt,Sn),Jt.side=_t,Jt.needsUpdate=!0,mt=!0}}mt===!0&&(N.updateMultisampleRenderTarget(Be),N.updateRenderTargetMipmap(Be)),M.setRenderTarget(at),M.setClearColor(me,G),M.toneMapping=pt}function Ut(U,q,ae){const ce=q.isScene===!0?q.overrideMaterial:null;for(let ie=0,We=U.length;ie<We;ie++){const at=U[ie],pt=at.object,mt=at.geometry,St=ce===null?at.material:ce,xt=at.group;pt.layers.test(ae.layers)&&Xe(pt,q,ae,mt,St,xt)}}function Xe(U,q,ae,ce,ie,We){U.onBeforeRender(M,q,ae,ce,ie,We),U.modelViewMatrix.multiplyMatrices(ae.matrixWorldInverse,U.matrixWorld),U.normalMatrix.getNormalMatrix(U.modelViewMatrix),ie.onBeforeRender(M,q,ae,ce,U,We),ie.transparent===!0&&ie.side===Ki&&ie.forceSinglePass===!1?(ie.side=Ei,ie.needsUpdate=!0,M.renderBufferDirect(ae,q,ce,ie,U,We),ie.side=Ns,ie.needsUpdate=!0,M.renderBufferDirect(ae,q,ce,ie,U,We),ie.side=Ki):M.renderBufferDirect(ae,q,ce,ie,U,We),U.onAfterRender(M,q,ae,ce,ie,We)}function Ft(U,q,ae){q.isScene!==!0&&(q=ke);const ce=Ve.get(U),ie=x.state.lights,We=x.state.shadowsArray,at=ie.state.version,pt=Ke.getParameters(U,ie.state,We,q,ae),mt=Ke.getProgramCacheKey(pt);let St=ce.programs;ce.environment=U.isMeshStandardMaterial?q.environment:null,ce.fog=q.fog,ce.envMap=(U.isMeshStandardMaterial?te:I).get(U.envMap||ce.environment),St===void 0&&(U.addEventListener("dispose",D),St=new Map,ce.programs=St);let xt=St.get(mt);if(xt!==void 0){if(ce.currentProgram===xt&&ce.lightsStateVersion===at)return $t(U,pt),xt}else pt.uniforms=Ke.getUniforms(U),U.onBuild(ae,pt,M),U.onBeforeCompile(pt,M),xt=Ke.acquireProgram(pt,mt),St.set(mt,xt),ce.uniforms=pt.uniforms;const wt=ce.uniforms;return(!U.isShaderMaterial&&!U.isRawShaderMaterial||U.clipping===!0)&&(wt.clippingPlanes=yt.uniform),$t(U,pt),ce.needsLights=Hi(U),ce.lightsStateVersion=at,ce.needsLights&&(wt.ambientLightColor.value=ie.state.ambient,wt.lightProbe.value=ie.state.probe,wt.directionalLights.value=ie.state.directional,wt.directionalLightShadows.value=ie.state.directionalShadow,wt.spotLights.value=ie.state.spot,wt.spotLightShadows.value=ie.state.spotShadow,wt.rectAreaLights.value=ie.state.rectArea,wt.ltc_1.value=ie.state.rectAreaLTC1,wt.ltc_2.value=ie.state.rectAreaLTC2,wt.pointLights.value=ie.state.point,wt.pointLightShadows.value=ie.state.pointShadow,wt.hemisphereLights.value=ie.state.hemi,wt.directionalShadowMap.value=ie.state.directionalShadowMap,wt.directionalShadowMatrix.value=ie.state.directionalShadowMatrix,wt.spotShadowMap.value=ie.state.spotShadowMap,wt.spotLightMatrix.value=ie.state.spotLightMatrix,wt.spotLightMap.value=ie.state.spotLightMap,wt.pointShadowMap.value=ie.state.pointShadowMap,wt.pointShadowMatrix.value=ie.state.pointShadowMatrix),ce.currentProgram=xt,ce.uniformsList=null,xt}function jt(U){if(U.uniformsList===null){const q=U.currentProgram.getUniforms();U.uniformsList=Kh.seqWithValue(q.seq,U.uniforms)}return U.uniformsList}function $t(U,q){const ae=Ve.get(U);ae.outputColorSpace=q.outputColorSpace,ae.batching=q.batching,ae.instancing=q.instancing,ae.instancingColor=q.instancingColor,ae.skinning=q.skinning,ae.morphTargets=q.morphTargets,ae.morphNormals=q.morphNormals,ae.morphColors=q.morphColors,ae.morphTargetsCount=q.morphTargetsCount,ae.numClippingPlanes=q.numClippingPlanes,ae.numIntersection=q.numClipIntersection,ae.vertexAlphas=q.vertexAlphas,ae.vertexTangents=q.vertexTangents,ae.toneMapping=q.toneMapping}function Yn(U,q,ae,ce,ie){q.isScene!==!0&&(q=ke),N.resetTextureUnits();const We=q.fog,at=ce.isMeshStandardMaterial?q.environment:null,pt=L===null?M.outputColorSpace:L.isXRRenderTarget===!0?L.texture.colorSpace:rs,mt=(ce.isMeshStandardMaterial?te:I).get(ce.envMap||at),St=ce.vertexColors===!0&&!!ae.attributes.color&&ae.attributes.color.itemSize===4,xt=!!ae.attributes.tangent&&(!!ce.normalMap||ce.anisotropy>0),wt=!!ae.morphAttributes.position,en=!!ae.morphAttributes.normal,In=!!ae.morphAttributes.color;let Jt=es;ce.toneMapped&&(L===null||L.isXRRenderTarget===!0)&&(Jt=M.toneMapping);const Sn=ae.morphAttributes.position||ae.morphAttributes.normal||ae.morphAttributes.color,_t=Sn!==void 0?Sn.length:0,it=Ve.get(ce),$n=x.state.lights;if(ge===!0&&(Ie===!0||U!==C)){const qn=U===C&&ce.id===O;yt.setState(ce,U,qn)}let Rt=!1;ce.version===it.__version?(it.needsLights&&it.lightsStateVersion!==$n.state.version||it.outputColorSpace!==pt||ie.isBatchedMesh&&it.batching===!1||!ie.isBatchedMesh&&it.batching===!0||ie.isInstancedMesh&&it.instancing===!1||!ie.isInstancedMesh&&it.instancing===!0||ie.isSkinnedMesh&&it.skinning===!1||!ie.isSkinnedMesh&&it.skinning===!0||ie.isInstancedMesh&&it.instancingColor===!0&&ie.instanceColor===null||ie.isInstancedMesh&&it.instancingColor===!1&&ie.instanceColor!==null||it.envMap!==mt||ce.fog===!0&&it.fog!==We||it.numClippingPlanes!==void 0&&(it.numClippingPlanes!==yt.numPlanes||it.numIntersection!==yt.numIntersection)||it.vertexAlphas!==St||it.vertexTangents!==xt||it.morphTargets!==wt||it.morphNormals!==en||it.morphColors!==In||it.toneMapping!==Jt||Ue.isWebGL2===!0&&it.morphTargetsCount!==_t)&&(Rt=!0):(Rt=!0,it.__version=ce.version);let gn=it.currentProgram;Rt===!0&&(gn=Ft(ce,q,ie));let Br=!1,rr=!1,Bn=!1;const Mn=gn.getUniforms(),Hr=it.uniforms;if(ve.useProgram(gn.program)&&(Br=!0,rr=!0,Bn=!0),ce.id!==O&&(O=ce.id,rr=!0),Br||C!==U){Mn.setValue(H,"projectionMatrix",U.projectionMatrix),Mn.setValue(H,"viewMatrix",U.matrixWorldInverse);const qn=Mn.map.cameraPosition;qn!==void 0&&qn.setValue(H,je.setFromMatrixPosition(U.matrixWorld)),Ue.logarithmicDepthBuffer&&Mn.setValue(H,"logDepthBufFC",2/(Math.log(U.far+1)/Math.LN2)),(ce.isMeshPhongMaterial||ce.isMeshToonMaterial||ce.isMeshLambertMaterial||ce.isMeshBasicMaterial||ce.isMeshStandardMaterial||ce.isShaderMaterial)&&Mn.setValue(H,"isOrthographic",U.isOrthographicCamera===!0),C!==U&&(C=U,rr=!0,Bn=!0)}if(ie.isSkinnedMesh){Mn.setOptional(H,ie,"bindMatrix"),Mn.setOptional(H,ie,"bindMatrixInverse");const qn=ie.skeleton;qn&&(Ue.floatVertexTextures?(qn.boneTexture===null&&qn.computeBoneTexture(),Mn.setValue(H,"boneTexture",qn.boneTexture,N)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}ie.isBatchedMesh&&(Mn.setOptional(H,ie,"batchingTexture"),Mn.setValue(H,"batchingTexture",ie._matricesTexture,N));const Ua=ae.morphAttributes;if((Ua.position!==void 0||Ua.normal!==void 0||Ua.color!==void 0&&Ue.isWebGL2===!0)&&ot.update(ie,ae,gn),(rr||it.receiveShadow!==ie.receiveShadow)&&(it.receiveShadow=ie.receiveShadow,Mn.setValue(H,"receiveShadow",ie.receiveShadow)),ce.isMeshGouraudMaterial&&ce.envMap!==null&&(Hr.envMap.value=mt,Hr.flipEnvMap.value=mt.isCubeTexture&&mt.isRenderTargetTexture===!1?-1:1),rr&&(Mn.setValue(H,"toneMappingExposure",M.toneMappingExposure),it.needsLights&&gi(Hr,Bn),We&&ce.fog===!0&&Oe.refreshFogUniforms(Hr,We),Oe.refreshMaterialUniforms(Hr,ce,he,ne,Be),Kh.upload(H,jt(it),Hr,N)),ce.isShaderMaterial&&ce.uniformsNeedUpdate===!0&&(Kh.upload(H,jt(it),Hr,N),ce.uniformsNeedUpdate=!1),ce.isSpriteMaterial&&Mn.setValue(H,"center",ie.center),Mn.setValue(H,"modelViewMatrix",ie.modelViewMatrix),Mn.setValue(H,"normalMatrix",ie.normalMatrix),Mn.setValue(H,"modelMatrix",ie.matrixWorld),ce.isShaderMaterial||ce.isRawShaderMaterial){const qn=ce.uniformsGroups;for(let Oa=0,Vi=qn.length;Oa<Vi;Oa++)if(Ue.isWebGL2){const Tf=qn[Oa];Ae.update(Tf,gn),Ae.bind(Tf,gn)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return gn}function gi(U,q){U.ambientLightColor.needsUpdate=q,U.lightProbe.needsUpdate=q,U.directionalLights.needsUpdate=q,U.directionalLightShadows.needsUpdate=q,U.pointLights.needsUpdate=q,U.pointLightShadows.needsUpdate=q,U.spotLights.needsUpdate=q,U.spotLightShadows.needsUpdate=q,U.rectAreaLights.needsUpdate=q,U.hemisphereLights.needsUpdate=q}function Hi(U){return U.isMeshLambertMaterial||U.isMeshToonMaterial||U.isMeshPhongMaterial||U.isMeshStandardMaterial||U.isShadowMaterial||U.isShaderMaterial&&U.lights===!0}this.getActiveCubeFace=function(){return P},this.getActiveMipmapLevel=function(){return b},this.getRenderTarget=function(){return L},this.setRenderTargetTextures=function(U,q,ae){Ve.get(U.texture).__webglTexture=q,Ve.get(U.depthTexture).__webglTexture=ae;const ce=Ve.get(U);ce.__hasExternalTextures=!0,ce.__hasExternalTextures&&(ce.__autoAllocateDepthBuffer=ae===void 0,ce.__autoAllocateDepthBuffer||oe.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),ce.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(U,q){const ae=Ve.get(U);ae.__webglFramebuffer=q,ae.__useDefaultFramebuffer=q===void 0},this.setRenderTarget=function(U,q=0,ae=0){L=U,P=q,b=ae;let ce=!0,ie=null,We=!1,at=!1;if(U){const mt=Ve.get(U);mt.__useDefaultFramebuffer!==void 0?(ve.bindFramebuffer(H.FRAMEBUFFER,null),ce=!1):mt.__webglFramebuffer===void 0?N.setupRenderTarget(U):mt.__hasExternalTextures&&N.rebindTextures(U,Ve.get(U.texture).__webglTexture,Ve.get(U.depthTexture).__webglTexture);const St=U.texture;(St.isData3DTexture||St.isDataArrayTexture||St.isCompressedArrayTexture)&&(at=!0);const xt=Ve.get(U).__webglFramebuffer;U.isWebGLCubeRenderTarget?(Array.isArray(xt[q])?ie=xt[q][ae]:ie=xt[q],We=!0):Ue.isWebGL2&&U.samples>0&&N.useMultisampledRTT(U)===!1?ie=Ve.get(U).__webglMultisampledFramebuffer:Array.isArray(xt)?ie=xt[ae]:ie=xt,R.copy(U.viewport),B.copy(U.scissor),$=U.scissorTest}else R.copy(V).multiplyScalar(he).floor(),B.copy(Q).multiplyScalar(he).floor(),$=se;if(ve.bindFramebuffer(H.FRAMEBUFFER,ie)&&Ue.drawBuffers&&ce&&ve.drawBuffers(U,ie),ve.viewport(R),ve.scissor(B),ve.setScissorTest($),We){const mt=Ve.get(U.texture);H.framebufferTexture2D(H.FRAMEBUFFER,H.COLOR_ATTACHMENT0,H.TEXTURE_CUBE_MAP_POSITIVE_X+q,mt.__webglTexture,ae)}else if(at){const mt=Ve.get(U.texture),St=q||0;H.framebufferTextureLayer(H.FRAMEBUFFER,H.COLOR_ATTACHMENT0,mt.__webglTexture,ae||0,St)}O=-1},this.readRenderTargetPixels=function(U,q,ae,ce,ie,We,at){if(!(U&&U.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let pt=Ve.get(U).__webglFramebuffer;if(U.isWebGLCubeRenderTarget&&at!==void 0&&(pt=pt[at]),pt){ve.bindFramebuffer(H.FRAMEBUFFER,pt);try{const mt=U.texture,St=mt.format,xt=mt.type;if(St!==Mi&&$e.convert(St)!==H.getParameter(H.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const wt=xt===Ea&&(oe.has("EXT_color_buffer_half_float")||Ue.isWebGL2&&oe.has("EXT_color_buffer_float"));if(xt!==ts&&$e.convert(xt)!==H.getParameter(H.IMPLEMENTATION_COLOR_READ_TYPE)&&!(xt===vr&&(Ue.isWebGL2||oe.has("OES_texture_float")||oe.has("WEBGL_color_buffer_float")))&&!wt){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}q>=0&&q<=U.width-ce&&ae>=0&&ae<=U.height-ie&&H.readPixels(q,ae,ce,ie,$e.convert(St),$e.convert(xt),We)}finally{const mt=L!==null?Ve.get(L).__webglFramebuffer:null;ve.bindFramebuffer(H.FRAMEBUFFER,mt)}}},this.copyFramebufferToTexture=function(U,q,ae=0){const ce=Math.pow(2,-ae),ie=Math.floor(q.image.width*ce),We=Math.floor(q.image.height*ce);N.setTexture2D(q,0),H.copyTexSubImage2D(H.TEXTURE_2D,ae,0,0,U.x,U.y,ie,We),ve.unbindTexture()},this.copyTextureToTexture=function(U,q,ae,ce=0){const ie=q.image.width,We=q.image.height,at=$e.convert(ae.format),pt=$e.convert(ae.type);N.setTexture2D(ae,0),H.pixelStorei(H.UNPACK_FLIP_Y_WEBGL,ae.flipY),H.pixelStorei(H.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ae.premultiplyAlpha),H.pixelStorei(H.UNPACK_ALIGNMENT,ae.unpackAlignment),q.isDataTexture?H.texSubImage2D(H.TEXTURE_2D,ce,U.x,U.y,ie,We,at,pt,q.image.data):q.isCompressedTexture?H.compressedTexSubImage2D(H.TEXTURE_2D,ce,U.x,U.y,q.mipmaps[0].width,q.mipmaps[0].height,at,q.mipmaps[0].data):H.texSubImage2D(H.TEXTURE_2D,ce,U.x,U.y,at,pt,q.image),ce===0&&ae.generateMipmaps&&H.generateMipmap(H.TEXTURE_2D),ve.unbindTexture()},this.copyTextureToTexture3D=function(U,q,ae,ce,ie=0){if(M.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const We=U.max.x-U.min.x+1,at=U.max.y-U.min.y+1,pt=U.max.z-U.min.z+1,mt=$e.convert(ce.format),St=$e.convert(ce.type);let xt;if(ce.isData3DTexture)N.setTexture3D(ce,0),xt=H.TEXTURE_3D;else if(ce.isDataArrayTexture||ce.isCompressedArrayTexture)N.setTexture2DArray(ce,0),xt=H.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}H.pixelStorei(H.UNPACK_FLIP_Y_WEBGL,ce.flipY),H.pixelStorei(H.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ce.premultiplyAlpha),H.pixelStorei(H.UNPACK_ALIGNMENT,ce.unpackAlignment);const wt=H.getParameter(H.UNPACK_ROW_LENGTH),en=H.getParameter(H.UNPACK_IMAGE_HEIGHT),In=H.getParameter(H.UNPACK_SKIP_PIXELS),Jt=H.getParameter(H.UNPACK_SKIP_ROWS),Sn=H.getParameter(H.UNPACK_SKIP_IMAGES),_t=ae.isCompressedTexture?ae.mipmaps[ie]:ae.image;H.pixelStorei(H.UNPACK_ROW_LENGTH,_t.width),H.pixelStorei(H.UNPACK_IMAGE_HEIGHT,_t.height),H.pixelStorei(H.UNPACK_SKIP_PIXELS,U.min.x),H.pixelStorei(H.UNPACK_SKIP_ROWS,U.min.y),H.pixelStorei(H.UNPACK_SKIP_IMAGES,U.min.z),ae.isDataTexture||ae.isData3DTexture?H.texSubImage3D(xt,ie,q.x,q.y,q.z,We,at,pt,mt,St,_t.data):ae.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),H.compressedTexSubImage3D(xt,ie,q.x,q.y,q.z,We,at,pt,mt,_t.data)):H.texSubImage3D(xt,ie,q.x,q.y,q.z,We,at,pt,mt,St,_t),H.pixelStorei(H.UNPACK_ROW_LENGTH,wt),H.pixelStorei(H.UNPACK_IMAGE_HEIGHT,en),H.pixelStorei(H.UNPACK_SKIP_PIXELS,In),H.pixelStorei(H.UNPACK_SKIP_ROWS,Jt),H.pixelStorei(H.UNPACK_SKIP_IMAGES,Sn),ie===0&&ce.generateMipmaps&&H.generateMipmap(xt),ve.unbindTexture()},this.initTexture=function(U){U.isCubeTexture?N.setTextureCube(U,0):U.isData3DTexture?N.setTexture3D(U,0):U.isDataArrayTexture||U.isCompressedArrayTexture?N.setTexture2DArray(U,0):N.setTexture2D(U,0),ve.unbindTexture()},this.resetState=function(){P=0,b=0,L=null,ve.reset(),j.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Nr}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=e===Kp?"display-p3":"srgb",t.unpackColorSpace=Yt.workingColorSpace===df?"display-p3":"srgb"}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===Un?_o:I_}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===_o?Un:rs}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}class Fb extends W_{}Fb.prototype.isWebGL1Renderer=!0;class em{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new nt(e),this.density=t}clone(){return new em(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class tm{constructor(e,t=1,i=1e3){this.isFog=!0,this.name="",this.color=new nt(e),this.near=t,this.far=i}clone(){return new tm(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}class X_ extends Wt{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t}}class nm{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=qc,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=er()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}get updateRange(){return console.warn("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let r=0,s=this.stride;r<s;r++)this.array[e+r]=t.array[i+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=er()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=er()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const _i=new k;class Aa{constructor(e,t,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)_i.fromBufferAttribute(this,t),_i.applyMatrix4(e),this.setXYZ(t,_i.x,_i.y,_i.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)_i.fromBufferAttribute(this,t),_i.applyNormalMatrix(e),this.setXYZ(t,_i.x,_i.y,_i.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)_i.fromBufferAttribute(this,t),_i.transformDirection(e),this.setXYZ(t,_i.x,_i.y,_i.z);return this}setX(e,t){return this.normalized&&(t=Lt(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=Lt(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=Lt(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=Lt(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=Ui(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=Ui(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=Ui(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=Ui(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=Lt(t,this.array),i=Lt(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=Lt(t,this.array),i=Lt(i,this.array),r=Lt(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,t,i,r,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=Lt(t,this.array),i=Lt(i,this.array),r=Lt(r,this.array),s=Lt(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=s,this}clone(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return new Kt(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Aa(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let i=0;i<this.count;i++){const r=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[r+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class j_ extends mi{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new nt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let dl;const Xu=new k,hl=new k,pl=new k,ml=new be,ju=new be,zb=new Mt,ih=new k,Yu=new k,rh=new k,ZM=new be,_0=new be,KM=new be;class Bb extends Wt{constructor(e=new j_){if(super(),this.isSprite=!0,this.type="Sprite",dl===void 0){dl=new Dt;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new nm(t,5);dl.setIndex([0,1,2,0,2,3]),dl.setAttribute("position",new Aa(i,3,0,!1)),dl.setAttribute("uv",new Aa(i,2,3,!1))}this.geometry=dl,this.material=e,this.center=new be(.5,.5)}raycast(e,t){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),hl.setFromMatrixScale(this.matrixWorld),zb.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),pl.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&hl.multiplyScalar(-pl.z);const i=this.material.rotation;let r,s;i!==0&&(s=Math.cos(i),r=Math.sin(i));const o=this.center;sh(ih.set(-.5,-.5,0),pl,o,hl,r,s),sh(Yu.set(.5,-.5,0),pl,o,hl,r,s),sh(rh.set(.5,.5,0),pl,o,hl,r,s),ZM.set(0,0),_0.set(1,0),KM.set(1,1);let a=e.ray.intersectTriangle(ih,Yu,rh,!1,Xu);if(a===null&&(sh(Yu.set(-.5,.5,0),pl,o,hl,r,s),_0.set(0,1),a=e.ray.intersectTriangle(ih,rh,Yu,!1,Xu),a===null))return;const c=e.ray.origin.distanceTo(Xu);c<e.near||c>e.far||t.push({distance:c,point:Xu.clone(),uv:Di.getInterpolation(Xu,ih,Yu,rh,ZM,_0,KM,new be),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function sh(n,e,t,i,r,s){ml.subVectors(n,t).addScalar(.5).multiply(i),r!==void 0?(ju.x=s*ml.x-r*ml.y,ju.y=r*ml.x+s*ml.y):ju.copy(ml),n.copy(e),n.x+=ju.x,n.y+=ju.y,n.applyMatrix4(zb)}const oh=new k,JM=new k;class Hb extends Wt{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let i=0,r=t.length;i<r;i++){const s=t[i];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,i=0){t=Math.abs(t);const r=this.levels;let s;for(s=0;s<r.length&&!(t<r[s].distance);s++);return r.splice(s,0,{distance:t,hysteresis:i,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let i,r;for(i=1,r=t.length;i<r;i++){let s=t[i].distance;if(t[i].object.visible&&(s-=s*t[i].hysteresis),e<s)break}return t[i-1].object}return null}raycast(e,t){if(this.levels.length>0){oh.setFromMatrixPosition(this.matrixWorld);const r=e.ray.origin.distanceTo(oh);this.getObjectForDistance(r).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){oh.setFromMatrixPosition(e.matrixWorld),JM.setFromMatrixPosition(this.matrixWorld);const i=oh.distanceTo(JM)/e.zoom;t[0].object.visible=!0;let r,s;for(r=1,s=t.length;r<s;r++){let o=t[r].distance;if(t[r].object.visible&&(o-=o*t[r].hysteresis),i>=o)t[r-1].object.visible=!1,t[r].object.visible=!0;else break}for(this._currentLevel=r-1;r<s;r++)t[r].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const i=this.levels;for(let r=0,s=i.length;r<s;r++){const o=i[r];t.object.levels.push({object:o.object.uuid,distance:o.distance,hysteresis:o.hysteresis})}return t}}const QM=new k,$M=new qt,ew=new qt,CO=new k,tw=new Mt,ah=new k,x0=new hi,nw=new Mt,S0=new Pa;class Vb extends kn{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=Bv,this.bindMatrix=new Mt,this.bindMatrixInverse=new Mt,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new Ti),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)this.getVertexPosition(i,ah),this.boundingBox.expandByPoint(ah)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new hi),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let i=0;i<t.count;i++)this.getVertexPosition(i,ah),this.boundingSphere.expandByPoint(ah)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const i=this.material,r=this.matrixWorld;i!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),x0.copy(this.boundingSphere),x0.applyMatrix4(r),e.ray.intersectsSphere(x0)!==!1&&(nw.copy(r).invert(),S0.copy(e.ray).applyMatrix4(nw),!(this.boundingBox!==null&&S0.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,S0)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new qt,t=this.geometry.attributes.skinWeight;for(let i=0,r=t.count;i<r;i++){e.fromBufferAttribute(t,i);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===Bv?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===tb?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const i=this.skeleton,r=this.geometry;$M.fromBufferAttribute(r.attributes.skinIndex,e),ew.fromBufferAttribute(r.attributes.skinWeight,e),QM.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const o=ew.getComponent(s);if(o!==0){const a=$M.getComponent(s);tw.multiplyMatrices(i.bones[a].matrixWorld,i.boneInverses[a]),t.addScaledVector(CO.copy(QM).applyMatrix4(tw),o)}}return t.applyMatrix4(this.bindMatrixInverse)}boneTransform(e,t){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(e,t)}}class Y_ extends Wt{constructor(){super(),this.isBone=!0,this.type="Bone"}}class va extends bn{constructor(e=null,t=1,i=1,r,s,o,a,c,f=Tn,d=Tn,h,m){super(null,o,a,c,f,d,r,s,h,m),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const iw=new Mt,RO=new Mt;class im{constructor(e=[],t=[]){this.uuid=er(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,r=this.bones.length;i<r;i++)this.boneInverses.push(new Mt)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const i=new Mt;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const e=this.bones,t=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let s=0,o=e.length;s<o;s++){const a=e[s]?e[s].matrixWorld:RO;iw.multiplyMatrices(a,t[s]),iw.toArray(i,s*16)}r!==null&&(r.needsUpdate=!0)}clone(){return new im(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const i=new va(t,e,e,Mi,vr);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){const r=this.bones[t];if(r.name===e)return r}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){const s=e.bones[i];let o=t[s];o===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),o=new Y_),this.bones.push(o),this.boneInverses.push(new Mt().fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){const e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,i=this.boneInverses;for(let r=0,s=t.length;r<s;r++){const o=t[r];e.bones.push(o.uuid);const a=i[r];e.boneInverses.push(a.toArray())}return e}}class su extends Kt{constructor(e,t,i,r=1){super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const gl=new Mt,rw=new Mt,lh=[],sw=new Ti,PO=new Mt,qu=new kn,Zu=new hi;class Gb extends kn{constructor(e,t,i){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new su(new Float32Array(i*16),16),this.instanceColor=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let r=0;r<i;r++)this.setMatrixAt(r,PO)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new Ti),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,gl),sw.copy(e.boundingBox).applyMatrix4(gl),this.boundingBox.union(sw)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new hi),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,gl),Zu.copy(e.boundingSphere).applyMatrix4(gl),this.boundingSphere.union(Zu)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}raycast(e,t){const i=this.matrixWorld,r=this.count;if(qu.geometry=this.geometry,qu.material=this.material,qu.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),Zu.copy(this.boundingSphere),Zu.applyMatrix4(i),e.ray.intersectsSphere(Zu)!==!1))for(let s=0;s<r;s++){this.getMatrixAt(s,gl),rw.multiplyMatrices(i,gl),qu.matrixWorld=rw,qu.raycast(e,lh);for(let o=0,a=lh.length;o<a;o++){const c=lh[o];c.instanceId=s,c.object=this,t.push(c)}lh.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new su(new Float32Array(this.instanceMatrix.count*3),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}function LO(n,e){return n.z-e.z}function IO(n,e){return e.z-n.z}class NO{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t){const i=this.pool,r=this.list;this.index>=i.length&&i.push({start:-1,count:-1,z:-1});const s=i[this.index];r.push(s),this.index++,s.start=e.start,s.count=e.count,s.z=t}reset(){this.list.length=0,this.index=0}}const vl="batchId",Qs=new Mt,ow=new Mt,DO=new Mt,aw=new Mt,M0=new gf,uh=new Ti,Xo=new hi,Ku=new k,w0=new NO,li=new kn,ch=[];function UO(n,e,t=0){const i=e.itemSize;if(n.isInterleavedBufferAttribute||n.array.constructor!==e.array.constructor){const r=n.count;for(let s=0;s<r;s++)for(let o=0;o<i;o++)e.setComponent(s+t,o,n.getComponent(s,o))}else e.array.set(n.array,t*i);e.needsUpdate=!0}class Wb extends kn{get maxGeometryCount(){return this._maxGeometryCount}constructor(e,t,i=t*2,r){super(new Dt,r),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._drawRanges=[],this._reservedRanges=[],this._visibility=[],this._active=[],this._bounds=[],this._maxGeometryCount=e,this._maxVertexCount=t,this._maxIndexCount=i,this._geometryInitialized=!1,this._geometryCount=0,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._visibilityChanged=!0,this._matricesTexture=null,this._initMatricesTexture()}_initMatricesTexture(){let e=Math.sqrt(this._maxGeometryCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4),i=new va(t,e,e,Mi,vr);this._matricesTexture=i}_initializeGeometry(e){const t=this.geometry,i=this._maxVertexCount,r=this._maxGeometryCount,s=this._maxIndexCount;if(this._geometryInitialized===!1){for(const a in e.attributes){const c=e.getAttribute(a),{array:f,itemSize:d,normalized:h}=c,m=new f.constructor(i*d),v=new c.constructor(m,d,h);v.setUsage(c.usage),t.setAttribute(a,v)}if(e.getIndex()!==null){const a=i>65536?new Uint32Array(s):new Uint16Array(s);t.setIndex(new Kt(a,1))}const o=r>65536?new Uint32Array(i):new Uint16Array(i);t.setAttribute(vl,new Kt(o,1)),this._geometryInitialized=!0}}_validateGeometry(e){if(e.getAttribute(vl))throw new Error(`BatchedMesh: Geometry cannot use attribute "${vl}"`);const t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('BatchedMesh: All geometries must consistently have "index".');for(const i in t.attributes){if(i===vl)continue;if(!e.hasAttribute(i))throw new Error(`BatchedMesh: Added geometry missing "${i}". All geometries must have consistent attributes.`);const r=e.getAttribute(i),s=t.getAttribute(i);if(r.itemSize!==s.itemSize||r.normalized!==s.normalized)throw new Error("BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Ti);const e=this._geometryCount,t=this.boundingBox,i=this._active;t.makeEmpty();for(let r=0;r<e;r++)i[r]!==!1&&(this.getMatrixAt(r,Qs),this.getBoundingBoxAt(r,uh).applyMatrix4(Qs),t.union(uh))}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new hi);const e=this._geometryCount,t=this.boundingSphere,i=this._active;t.makeEmpty();for(let r=0;r<e;r++)i[r]!==!1&&(this.getMatrixAt(r,Qs),this.getBoundingSphereAt(r,Xo).applyMatrix4(Qs),t.union(Xo))}addGeometry(e,t=-1,i=-1){if(this._initializeGeometry(e),this._validateGeometry(e),this._geometryCount>=this._maxGeometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");const r={vertexStart:-1,vertexCount:-1,indexStart:-1,indexCount:-1};let s=null;const o=this._reservedRanges,a=this._drawRanges,c=this._bounds;this._geometryCount!==0&&(s=o[o.length-1]),t===-1?r.vertexCount=e.getAttribute("position").count:r.vertexCount=t,s===null?r.vertexStart=0:r.vertexStart=s.vertexStart+s.vertexCount;const f=e.getIndex(),d=f!==null;if(d&&(i===-1?r.indexCount=f.count:r.indexCount=i,s===null?r.indexStart=0:r.indexStart=s.indexStart+s.indexCount),r.indexStart!==-1&&r.indexStart+r.indexCount>this._maxIndexCount||r.vertexStart+r.vertexCount>this._maxVertexCount)throw new Error("BatchedMesh: Reserved space request exceeds the maximum buffer size.");const h=this._visibility,m=this._active,v=this._matricesTexture,y=this._matricesTexture.image.data;h.push(!0),m.push(!0);const w=this._geometryCount;this._geometryCount++,DO.toArray(y,w*16),v.needsUpdate=!0,o.push(r),a.push({start:d?r.indexStart:r.vertexStart,count:-1}),c.push({boxInitialized:!1,box:new Ti,sphereInitialized:!1,sphere:new hi});const x=this.geometry.getAttribute(vl);for(let g=0;g<r.vertexCount;g++)x.setX(r.vertexStart+g,w);return x.needsUpdate=!0,this.setGeometryAt(w,e),w}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const i=this.geometry,r=i.getIndex()!==null,s=i.getIndex(),o=t.getIndex(),a=this._reservedRanges[e];if(r&&o.count>a.indexCount||t.attributes.position.count>a.vertexCount)throw new Error("BatchedMesh: Reserved space not large enough for provided geometry.");const c=a.vertexStart,f=a.vertexCount;for(const v in i.attributes){if(v===vl)continue;const y=t.getAttribute(v),w=i.getAttribute(v);UO(y,w,c);const x=y.itemSize;for(let g=y.count,S=f;g<S;g++){const M=c+g;for(let T=0;T<x;T++)w.setComponent(M,T,0)}w.needsUpdate=!0}if(r){const v=a.indexStart;for(let y=0;y<o.count;y++)s.setX(v+y,c+o.getX(y));for(let y=o.count,w=a.indexCount;y<w;y++)s.setX(v+y,c);s.needsUpdate=!0}const d=this._bounds[e];t.boundingBox!==null?(d.box.copy(t.boundingBox),d.boxInitialized=!0):d.boxInitialized=!1,t.boundingSphere!==null?(d.sphere.copy(t.boundingSphere),d.sphereInitialized=!0):d.sphereInitialized=!1;const h=this._drawRanges[e],m=t.getAttribute("position");return h.count=r?o.count:m.count,this._visibilityChanged=!0,e}deleteGeometry(e){const t=this._active;return e>=t.length||t[e]===!1?this:(t[e]=!1,this._visibilityChanged=!0,this)}getBoundingBoxAt(e,t){if(this._active[e]===!1)return this;const r=this._bounds[e],s=r.box,o=this.geometry;if(r.boxInitialized===!1){s.makeEmpty();const a=o.index,c=o.attributes.position,f=this._drawRanges[e];for(let d=f.start,h=f.start+f.count;d<h;d++){let m=d;a&&(m=a.getX(m)),s.expandByPoint(Ku.fromBufferAttribute(c,m))}r.boxInitialized=!0}return t.copy(s),t}getBoundingSphereAt(e,t){if(this._active[e]===!1)return this;const r=this._bounds[e],s=r.sphere,o=this.geometry;if(r.sphereInitialized===!1){s.makeEmpty(),this.getBoundingBoxAt(e,uh),uh.getCenter(s.center);const a=o.index,c=o.attributes.position,f=this._drawRanges[e];let d=0;for(let h=f.start,m=f.start+f.count;h<m;h++){let v=h;a&&(v=a.getX(v)),Ku.fromBufferAttribute(c,v),d=Math.max(d,s.center.distanceToSquared(Ku))}s.radius=Math.sqrt(d),r.sphereInitialized=!0}return t.copy(s),t}setMatrixAt(e,t){const i=this._active,r=this._matricesTexture,s=this._matricesTexture.image.data,o=this._geometryCount;return e>=o||i[e]===!1?this:(t.toArray(s,e*16),r.needsUpdate=!0,this)}getMatrixAt(e,t){const i=this._active,r=this._matricesTexture.image.data,s=this._geometryCount;return e>=s||i[e]===!1?null:t.fromArray(r,e*16)}setVisibleAt(e,t){const i=this._visibility,r=this._active,s=this._geometryCount;return e>=s||r[e]===!1||i[e]===t?this:(i[e]=t,this._visibilityChanged=!0,this)}getVisibleAt(e){const t=this._visibility,i=this._active,r=this._geometryCount;return e>=r||i[e]===!1?!1:t[e]}raycast(e,t){const i=this._visibility,r=this._active,s=this._drawRanges,o=this._geometryCount,a=this.matrixWorld,c=this.geometry;li.material=this.material,li.geometry.index=c.index,li.geometry.attributes=c.attributes,li.geometry.boundingBox===null&&(li.geometry.boundingBox=new Ti),li.geometry.boundingSphere===null&&(li.geometry.boundingSphere=new hi);for(let f=0;f<o;f++){if(!i[f]||!r[f])continue;const d=s[f];li.geometry.setDrawRange(d.start,d.count),this.getMatrixAt(f,li.matrixWorld).premultiply(a),this.getBoundingBoxAt(f,li.geometry.boundingBox),this.getBoundingSphereAt(f,li.geometry.boundingSphere),li.raycast(e,ch);for(let h=0,m=ch.length;h<m;h++){const v=ch[h];v.object=this,v.batchId=f,t.push(v)}ch.length=0}li.material=null,li.geometry.index=null,li.geometry.attributes={},li.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._drawRanges=e._drawRanges.map(t=>({...t})),this._reservedRanges=e._reservedRanges.map(t=>({...t})),this._visibility=e._visibility.slice(),this._active=e._active.slice(),this._bounds=e._bounds.map(t=>({boxInitialized:t.boxInitialized,box:t.box.clone(),sphereInitialized:t.sphereInitialized,sphere:t.sphere.clone()})),this._maxGeometryCount=e._maxGeometryCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._geometryCount=e._geometryCount,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.slice(),this}dispose(){return this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this}onBeforeRender(e,t,i,r,s){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const o=r.getIndex(),a=o===null?1:o.array.BYTES_PER_ELEMENT,c=this._visibility,f=this._multiDrawStarts,d=this._multiDrawCounts,h=this._drawRanges,m=this.perObjectFrustumCulled;m&&(aw.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse).multiply(this.matrixWorld),M0.setFromProjectionMatrix(aw,e.isWebGPURenderer?nu:Nr));let v=0;if(this.sortObjects){ow.copy(this.matrixWorld).invert(),Ku.setFromMatrixPosition(i.matrixWorld).applyMatrix4(ow);for(let x=0,g=c.length;x<g;x++)if(c[x]){this.getMatrixAt(x,Qs),this.getBoundingSphereAt(x,Xo).applyMatrix4(Qs);let S=!1;if(m&&(S=!M0.intersectsSphere(Xo)),!S){const M=Ku.distanceTo(Xo.center);w0.push(h[x],M)}}const y=w0.list,w=this.customSort;w===null?y.sort(s.transparent?IO:LO):w.call(this,y,i);for(let x=0,g=y.length;x<g;x++){const S=y[x];f[v]=S.start*a,d[v]=S.count,v++}w0.reset()}else for(let y=0,w=c.length;y<w;y++)if(c[y]){let x=!1;if(m&&(this.getMatrixAt(y,Qs),this.getBoundingSphereAt(y,Xo).applyMatrix4(Qs),x=!M0.intersectsSphere(Xo)),!x){const g=h[y];f[v]=g.start*a,d[v]=g.count,v++}}this._multiDrawCount=v,this._visibilityChanged=!1}onBeforeShadow(e,t,i,r,s,o){this.onBeforeRender(e,null,r,s,o)}}class Ci extends mi{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new nt(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const lw=new k,uw=new k,cw=new Mt,E0=new Pa,fh=new hi;class Eo extends Wt{constructor(e=new Dt,t=new Ci){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[0];for(let r=1,s=t.count;r<s;r++)lw.fromBufferAttribute(t,r-1),uw.fromBufferAttribute(t,r),i[r]=i[r-1],i[r]+=lw.distanceTo(uw);e.setAttribute("lineDistance",new ft(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Line.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),fh.copy(i.boundingSphere),fh.applyMatrix4(r),fh.radius+=s,e.ray.intersectsSphere(fh)===!1)return;cw.copy(r).invert(),E0.copy(e.ray).applyMatrix4(cw);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),c=a*a,f=new k,d=new k,h=new k,m=new k,v=this.isLineSegments?2:1,y=i.index,x=i.attributes.position;if(y!==null){const g=Math.max(0,o.start),S=Math.min(y.count,o.start+o.count);for(let M=g,T=S-1;M<T;M+=v){const P=y.getX(M),b=y.getX(M+1);if(f.fromBufferAttribute(x,P),d.fromBufferAttribute(x,b),E0.distanceSqToSegment(f,d,m,h)>c)continue;m.applyMatrix4(this.matrixWorld);const O=e.ray.origin.distanceTo(m);O<e.near||O>e.far||t.push({distance:O,point:h.clone().applyMatrix4(this.matrixWorld),index:M,face:null,faceIndex:null,object:this})}}else{const g=Math.max(0,o.start),S=Math.min(x.count,o.start+o.count);for(let M=g,T=S-1;M<T;M+=v){if(f.fromBufferAttribute(x,M),d.fromBufferAttribute(x,M+1),E0.distanceSqToSegment(f,d,m,h)>c)continue;m.applyMatrix4(this.matrixWorld);const b=e.ray.origin.distanceTo(m);b<e.near||b>e.far||t.push({distance:b,point:h.clone().applyMatrix4(this.matrixWorld),index:M,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}const fw=new k,dw=new k;class ss extends Eo{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,i=[];for(let r=0,s=t.count;r<s;r+=2)fw.fromBufferAttribute(t,r),dw.fromBufferAttribute(t,r+1),i[r]=r===0?0:i[r-1],i[r+1]=i[r]+fw.distanceTo(dw);e.setAttribute("lineDistance",new ft(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class Xb extends Eo{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class q_ extends mi{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new nt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const hw=new Mt,vy=new Pa,dh=new hi,hh=new k;class jb extends Wt{constructor(e=new Dt,t=new q_){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const i=this.geometry,r=this.matrixWorld,s=e.params.Points.threshold,o=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),dh.copy(i.boundingSphere),dh.applyMatrix4(r),dh.radius+=s,e.ray.intersectsSphere(dh)===!1)return;hw.copy(r).invert(),vy.copy(e.ray).applyMatrix4(hw);const a=s/((this.scale.x+this.scale.y+this.scale.z)/3),c=a*a,f=i.index,h=i.attributes.position;if(f!==null){const m=Math.max(0,o.start),v=Math.min(f.count,o.start+o.count);for(let y=m,w=v;y<w;y++){const x=f.getX(y);hh.fromBufferAttribute(h,x),pw(hh,x,c,r,e,t,this)}}else{const m=Math.max(0,o.start),v=Math.min(h.count,o.start+o.count);for(let y=m,w=v;y<w;y++)hh.fromBufferAttribute(h,y),pw(hh,y,c,r,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,i=Object.keys(t);if(i.length>0){const r=t[i[0]];if(r!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,o=r.length;s<o;s++){const a=r[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[a]=s}}}}}function pw(n,e,t,i,r,s,o){const a=vy.distanceSqToPoint(n);if(a<t){const c=new k;vy.closestPointToPoint(n,c),c.applyMatrix4(i);const f=r.ray.origin.distanceTo(c);if(f<r.near||f>r.far)return;s.push({distance:f,distanceToRay:Math.sqrt(a),point:c,index:e,face:null,object:o})}}class OO extends bn{constructor(e,t,i,r,s,o,a,c,f){super(e,t,i,r,s,o,a,c,f),this.isVideoTexture=!0,this.minFilter=o!==void 0?o:fn,this.magFilter=s!==void 0?s:fn,this.generateMipmaps=!1;const d=this;function h(){d.needsUpdate=!0,e.requestVideoFrameCallback(h)}"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(h)}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class kO extends bn{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=Tn,this.minFilter=Tn,this.generateMipmaps=!1,this.needsUpdate=!0}}class rm extends bn{constructor(e,t,i,r,s,o,a,c,f,d,h,m){super(null,o,a,c,f,d,r,s,h,m),this.isCompressedTexture=!0,this.image={width:t,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class FO extends rm{constructor(e,t,i,r,s,o){super(e,t,i,s,o),this.isCompressedArrayTexture=!0,this.image.depth=r,this.wrapR=fi}}class zO extends rm{constructor(e,t,i){super(void 0,e[0].width,e[0].height,t,i,Ds),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class BO extends bn{constructor(e,t,i,r,s,o,a,c,f){super(e,t,i,r,s,o,a,c,f),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Fr{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){const i=this.getUtoTmapping(e);return this.getPoint(i,t)}getPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return t}getSpacedPoints(e=5){const t=[];for(let i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let i,r=this.getPoint(0),s=0;t.push(0);for(let o=1;o<=e;o++)i=this.getPoint(o/e),s+=i.distanceTo(r),t.push(s),r=i;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){const i=this.getLengths();let r=0;const s=i.length;let o;t?o=t:o=e*i[s-1];let a=0,c=s-1,f;for(;a<=c;)if(r=Math.floor(a+(c-a)/2),f=i[r]-o,f<0)a=r+1;else if(f>0)c=r-1;else{c=r;break}if(r=c,i[r]===o)return r/(s-1);const d=i[r],m=i[r+1]-d,v=(o-d)/m;return(r+v)/(s-1)}getTangent(e,t){let r=e-1e-4,s=e+1e-4;r<0&&(r=0),s>1&&(s=1);const o=this.getPoint(r),a=this.getPoint(s),c=t||(o.isVector2?new be:new k);return c.copy(a).sub(o).normalize(),c}getTangentAt(e,t){const i=this.getUtoTmapping(e);return this.getTangent(i,t)}computeFrenetFrames(e,t){const i=new k,r=[],s=[],o=[],a=new k,c=new Mt;for(let v=0;v<=e;v++){const y=v/e;r[v]=this.getTangentAt(y,new k)}s[0]=new k,o[0]=new k;let f=Number.MAX_VALUE;const d=Math.abs(r[0].x),h=Math.abs(r[0].y),m=Math.abs(r[0].z);d<=f&&(f=d,i.set(1,0,0)),h<=f&&(f=h,i.set(0,1,0)),m<=f&&i.set(0,0,1),a.crossVectors(r[0],i).normalize(),s[0].crossVectors(r[0],a),o[0].crossVectors(r[0],s[0]);for(let v=1;v<=e;v++){if(s[v]=s[v-1].clone(),o[v]=o[v-1].clone(),a.crossVectors(r[v-1],r[v]),a.length()>Number.EPSILON){a.normalize();const y=Math.acos(xn(r[v-1].dot(r[v]),-1,1));s[v].applyMatrix4(c.makeRotationAxis(a,y))}o[v].crossVectors(r[v],s[v])}if(t===!0){let v=Math.acos(xn(s[0].dot(s[e]),-1,1));v/=e,r[0].dot(a.crossVectors(s[0],s[e]))>0&&(v=-v);for(let y=1;y<=e;y++)s[y].applyMatrix4(c.makeRotationAxis(r[y],v*y)),o[y].crossVectors(r[y],s[y])}return{tangents:r,normals:s,binormals:o}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class sm extends Fr{constructor(e=0,t=0,i=1,r=1,s=0,o=Math.PI*2,a=!1,c=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=i,this.yRadius=r,this.aStartAngle=s,this.aEndAngle=o,this.aClockwise=a,this.aRotation=c}getPoint(e,t){const i=t||new be,r=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const o=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=r;for(;s>r;)s-=r;s<Number.EPSILON&&(o?s=0:s=r),this.aClockwise===!0&&!o&&(s===r?s=-r:s=s-r);const a=this.aStartAngle+e*s;let c=this.aX+this.xRadius*Math.cos(a),f=this.aY+this.yRadius*Math.sin(a);if(this.aRotation!==0){const d=Math.cos(this.aRotation),h=Math.sin(this.aRotation),m=c-this.aX,v=f-this.aY;c=m*d-v*h+this.aX,f=m*h+v*d+this.aY}return i.set(c,f)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class Yb extends sm{constructor(e,t,i,r,s,o){super(e,t,i,i,r,s,o),this.isArcCurve=!0,this.type="ArcCurve"}}function Z_(){let n=0,e=0,t=0,i=0;function r(s,o,a,c){n=s,e=a,t=-3*s+3*o-2*a-c,i=2*s-2*o+a+c}return{initCatmullRom:function(s,o,a,c,f){r(o,a,f*(a-s),f*(c-o))},initNonuniformCatmullRom:function(s,o,a,c,f,d,h){let m=(o-s)/f-(a-s)/(f+d)+(a-o)/d,v=(a-o)/d-(c-o)/(d+h)+(c-a)/h;m*=d,v*=d,r(o,a,m,v)},calc:function(s){const o=s*s,a=o*s;return n+e*s+t*o+i*a}}}const ph=new k,T0=new Z_,A0=new Z_,b0=new Z_;class qb extends Fr{constructor(e=[],t=!1,i="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=i,this.tension=r}getPoint(e,t=new k){const i=t,r=this.points,s=r.length,o=(s-(this.closed?0:1))*e;let a=Math.floor(o),c=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/s)+1)*s:c===0&&a===s-1&&(a=s-2,c=1);let f,d;this.closed||a>0?f=r[(a-1)%s]:(ph.subVectors(r[0],r[1]).add(r[0]),f=ph);const h=r[a%s],m=r[(a+1)%s];if(this.closed||a+2<s?d=r[(a+2)%s]:(ph.subVectors(r[s-1],r[s-2]).add(r[s-1]),d=ph),this.curveType==="centripetal"||this.curveType==="chordal"){const v=this.curveType==="chordal"?.5:.25;let y=Math.pow(f.distanceToSquared(h),v),w=Math.pow(h.distanceToSquared(m),v),x=Math.pow(m.distanceToSquared(d),v);w<1e-4&&(w=1),y<1e-4&&(y=w),x<1e-4&&(x=w),T0.initNonuniformCatmullRom(f.x,h.x,m.x,d.x,y,w,x),A0.initNonuniformCatmullRom(f.y,h.y,m.y,d.y,y,w,x),b0.initNonuniformCatmullRom(f.z,h.z,m.z,d.z,y,w,x)}else this.curveType==="catmullrom"&&(T0.initCatmullRom(f.x,h.x,m.x,d.x,this.tension),A0.initCatmullRom(f.y,h.y,m.y,d.y,this.tension),b0.initCatmullRom(f.z,h.z,m.z,d.z,this.tension));return i.set(T0.calc(c),A0.calc(c),b0.calc(c)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){const r=this.points[t];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(new k().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function mw(n,e,t,i,r){const s=(i-e)*.5,o=(r-t)*.5,a=n*n,c=n*a;return(2*t-2*i+s+o)*c+(-3*t+3*i-2*s-o)*a+s*n+t}function HO(n,e){const t=1-n;return t*t*e}function VO(n,e){return 2*(1-n)*n*e}function GO(n,e){return n*n*e}function yc(n,e,t,i){return HO(n,e)+VO(n,t)+GO(n,i)}function WO(n,e){const t=1-n;return t*t*t*e}function XO(n,e){const t=1-n;return 3*t*t*n*e}function jO(n,e){return 3*(1-n)*n*n*e}function YO(n,e){return n*n*n*e}function _c(n,e,t,i,r){return WO(n,e)+XO(n,t)+jO(n,i)+YO(n,r)}class K_ extends Fr{constructor(e=new be,t=new be,i=new be,r=new be){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new be){const i=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(_c(e,r.x,s.x,o.x,a.x),_c(e,r.y,s.y,o.y,a.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class Zb extends Fr{constructor(e=new k,t=new k,i=new k,r=new k){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new k){const i=t,r=this.v0,s=this.v1,o=this.v2,a=this.v3;return i.set(_c(e,r.x,s.x,o.x,a.x),_c(e,r.y,s.y,o.y,a.y),_c(e,r.z,s.z,o.z,a.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class J_ extends Fr{constructor(e=new be,t=new be){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new be){const i=t;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new be){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Kb extends Fr{constructor(e=new k,t=new k){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new k){const i=t;return e===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new k){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class Q_ extends Fr{constructor(e=new be,t=new be,i=new be){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new be){const i=t,r=this.v0,s=this.v1,o=this.v2;return i.set(yc(e,r.x,s.x,o.x),yc(e,r.y,s.y,o.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class $_ extends Fr{constructor(e=new k,t=new k,i=new k){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new k){const i=t,r=this.v0,s=this.v1,o=this.v2;return i.set(yc(e,r.x,s.x,o.x),yc(e,r.y,s.y,o.y),yc(e,r.z,s.z,o.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class ex extends Fr{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new be){const i=t,r=this.points,s=(r.length-1)*e,o=Math.floor(s),a=s-o,c=r[o===0?o:o-1],f=r[o],d=r[o>r.length-2?r.length-1:o+1],h=r[o>r.length-3?r.length-1:o+2];return i.set(mw(a,c.x,f.x,d.x,h.x),mw(a,c.y,f.y,d.y,h.y)),i}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){const r=this.points[t];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){const r=e.points[t];this.points.push(new be().fromArray(r))}return this}}var bp=Object.freeze({__proto__:null,ArcCurve:Yb,CatmullRomCurve3:qb,CubicBezierCurve:K_,CubicBezierCurve3:Zb,EllipseCurve:sm,LineCurve:J_,LineCurve3:Kb,QuadraticBezierCurve:Q_,QuadraticBezierCurve3:$_,SplineCurve:ex});class Jb extends Fr{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const i=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new bp[i](t,e))}return this}getPoint(e,t){const i=e*this.getLength(),r=this.getCurveLengths();let s=0;for(;s<r.length;){if(r[s]>=i){const o=r[s]-i,a=this.curves[s],c=a.getLength(),f=c===0?0:1-o/c;return a.getPointAt(f,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let i=0,r=this.curves.length;i<r;i++)t+=this.curves[i].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let i;for(let r=0,s=this.curves;r<s.length;r++){const o=s[r],a=o.isEllipseCurve?e*2:o.isLineCurve||o.isLineCurve3?1:o.isSplineCurve?e*o.points.length:e,c=o.getPoints(a);for(let f=0;f<c.length;f++){const d=c[f];i&&i.equals(d)||(t.push(d),i=d)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const r=e.curves[t];this.curves.push(r.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,i=this.curves.length;t<i;t++){const r=this.curves[t];e.curves.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){const r=e.curves[t];this.curves.push(new bp[r.type]().fromJSON(r))}return this}}class Kc extends Jb{constructor(e){super(),this.type="Path",this.currentPoint=new be,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,i=e.length;t<i;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const i=new J_(this.currentPoint.clone(),new be(e,t));return this.curves.push(i),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,i,r){const s=new Q_(this.currentPoint.clone(),new be(e,t),new be(i,r));return this.curves.push(s),this.currentPoint.set(i,r),this}bezierCurveTo(e,t,i,r,s,o){const a=new K_(this.currentPoint.clone(),new be(e,t),new be(i,r),new be(s,o));return this.curves.push(a),this.currentPoint.set(s,o),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),i=new ex(t);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,i,r,s,o){const a=this.currentPoint.x,c=this.currentPoint.y;return this.absarc(e+a,t+c,i,r,s,o),this}absarc(e,t,i,r,s,o){return this.absellipse(e,t,i,i,r,s,o),this}ellipse(e,t,i,r,s,o,a,c){const f=this.currentPoint.x,d=this.currentPoint.y;return this.absellipse(e+f,t+d,i,r,s,o,a,c),this}absellipse(e,t,i,r,s,o,a,c){const f=new sm(e,t,i,r,s,o,a,c);if(this.curves.length>0){const h=f.getPoint(0);h.equals(this.currentPoint)||this.lineTo(h.x,h.y)}this.curves.push(f);const d=f.getPoint(1);return this.currentPoint.copy(d),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class yf extends Dt{constructor(e=[new be(0,-.5),new be(.5,0),new be(0,.5)],t=12,i=0,r=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:i,phiLength:r},t=Math.floor(t),r=xn(r,0,Math.PI*2);const s=[],o=[],a=[],c=[],f=[],d=1/t,h=new k,m=new be,v=new k,y=new k,w=new k;let x=0,g=0;for(let S=0;S<=e.length-1;S++)switch(S){case 0:x=e[S+1].x-e[S].x,g=e[S+1].y-e[S].y,v.x=g*1,v.y=-x,v.z=g*0,w.copy(v),v.normalize(),c.push(v.x,v.y,v.z);break;case e.length-1:c.push(w.x,w.y,w.z);break;default:x=e[S+1].x-e[S].x,g=e[S+1].y-e[S].y,v.x=g*1,v.y=-x,v.z=g*0,y.copy(v),v.x+=w.x,v.y+=w.y,v.z+=w.z,v.normalize(),c.push(v.x,v.y,v.z),w.copy(y)}for(let S=0;S<=t;S++){const M=i+S*d*r,T=Math.sin(M),P=Math.cos(M);for(let b=0;b<=e.length-1;b++){h.x=e[b].x*T,h.y=e[b].y,h.z=e[b].x*P,o.push(h.x,h.y,h.z),m.x=S/t,m.y=b/(e.length-1),a.push(m.x,m.y);const L=c[3*b+0]*T,O=c[3*b+1],C=c[3*b+0]*P;f.push(L,O,C)}}for(let S=0;S<t;S++)for(let M=0;M<e.length-1;M++){const T=M+S*e.length,P=T,b=T+e.length,L=T+e.length+1,O=T+1;s.push(P,b,O),s.push(L,O,b)}this.setIndex(s),this.setAttribute("position",new ft(o,3)),this.setAttribute("uv",new ft(a,2)),this.setAttribute("normal",new ft(f,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new yf(e.points,e.segments,e.phiStart,e.phiLength)}}class om extends yf{constructor(e=1,t=1,i=4,r=8){const s=new Kc;s.absarc(0,-t/2,e,Math.PI*1.5,0),s.absarc(0,t/2,e,0,Math.PI*.5),super(s.getPoints(i),r),this.type="CapsuleGeometry",this.parameters={radius:e,length:t,capSegments:i,radialSegments:r}}static fromJSON(e){return new om(e.radius,e.length,e.capSegments,e.radialSegments)}}class am extends Dt{constructor(e=1,t=32,i=0,r=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:i,thetaLength:r},t=Math.max(3,t);const s=[],o=[],a=[],c=[],f=new k,d=new be;o.push(0,0,0),a.push(0,0,1),c.push(.5,.5);for(let h=0,m=3;h<=t;h++,m+=3){const v=i+h/t*r;f.x=e*Math.cos(v),f.y=e*Math.sin(v),o.push(f.x,f.y,f.z),a.push(0,0,1),d.x=(o[m]/e+1)/2,d.y=(o[m+1]/e+1)/2,c.push(d.x,d.y)}for(let h=1;h<=t;h++)s.push(h,h+1,0);this.setIndex(s),this.setAttribute("position",new ft(o,3)),this.setAttribute("normal",new ft(a,3)),this.setAttribute("uv",new ft(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new am(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class du extends Dt{constructor(e=1,t=1,i=1,r=32,s=1,o=!1,a=0,c=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:r,heightSegments:s,openEnded:o,thetaStart:a,thetaLength:c};const f=this;r=Math.floor(r),s=Math.floor(s);const d=[],h=[],m=[],v=[];let y=0;const w=[],x=i/2;let g=0;S(),o===!1&&(e>0&&M(!0),t>0&&M(!1)),this.setIndex(d),this.setAttribute("position",new ft(h,3)),this.setAttribute("normal",new ft(m,3)),this.setAttribute("uv",new ft(v,2));function S(){const T=new k,P=new k;let b=0;const L=(t-e)/i;for(let O=0;O<=s;O++){const C=[],R=O/s,B=R*(t-e)+e;for(let $=0;$<=r;$++){const me=$/r,G=me*c+a,Z=Math.sin(G),ne=Math.cos(G);P.x=B*Z,P.y=-R*i+x,P.z=B*ne,h.push(P.x,P.y,P.z),T.set(Z,L,ne).normalize(),m.push(T.x,T.y,T.z),v.push(me,1-R),C.push(y++)}w.push(C)}for(let O=0;O<r;O++)for(let C=0;C<s;C++){const R=w[C][O],B=w[C+1][O],$=w[C+1][O+1],me=w[C][O+1];d.push(R,B,me),d.push(B,$,me),b+=6}f.addGroup(g,b,0),g+=b}function M(T){const P=y,b=new be,L=new k;let O=0;const C=T===!0?e:t,R=T===!0?1:-1;for(let $=1;$<=r;$++)h.push(0,x*R,0),m.push(0,R,0),v.push(.5,.5),y++;const B=y;for(let $=0;$<=r;$++){const G=$/r*c+a,Z=Math.cos(G),ne=Math.sin(G);L.x=C*ne,L.y=x*R,L.z=C*Z,h.push(L.x,L.y,L.z),m.push(0,R,0),b.x=Z*.5+.5,b.y=ne*.5*R+.5,v.push(b.x,b.y),y++}for(let $=0;$<r;$++){const me=P+$,G=B+$;T===!0?d.push(G,G+1,me):d.push(G+1,G,me),O+=3}f.addGroup(g,O,T===!0?1:2),g+=O}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new du(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class lm extends du{constructor(e=1,t=1,i=32,r=1,s=!1,o=0,a=Math.PI*2){super(0,e,t,i,r,s,o,a),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:i,heightSegments:r,openEnded:s,thetaStart:o,thetaLength:a}}static fromJSON(e){return new lm(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class Po extends Dt{constructor(e=[],t=[],i=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:i,detail:r};const s=[],o=[];a(r),f(i),d(),this.setAttribute("position",new ft(s,3)),this.setAttribute("normal",new ft(s.slice(),3)),this.setAttribute("uv",new ft(o,2)),r===0?this.computeVertexNormals():this.normalizeNormals();function a(S){const M=new k,T=new k,P=new k;for(let b=0;b<t.length;b+=3)v(t[b+0],M),v(t[b+1],T),v(t[b+2],P),c(M,T,P,S)}function c(S,M,T,P){const b=P+1,L=[];for(let O=0;O<=b;O++){L[O]=[];const C=S.clone().lerp(T,O/b),R=M.clone().lerp(T,O/b),B=b-O;for(let $=0;$<=B;$++)$===0&&O===b?L[O][$]=C:L[O][$]=C.clone().lerp(R,$/B)}for(let O=0;O<b;O++)for(let C=0;C<2*(b-O)-1;C++){const R=Math.floor(C/2);C%2===0?(m(L[O][R+1]),m(L[O+1][R]),m(L[O][R])):(m(L[O][R+1]),m(L[O+1][R+1]),m(L[O+1][R]))}}function f(S){const M=new k;for(let T=0;T<s.length;T+=3)M.x=s[T+0],M.y=s[T+1],M.z=s[T+2],M.normalize().multiplyScalar(S),s[T+0]=M.x,s[T+1]=M.y,s[T+2]=M.z}function d(){const S=new k;for(let M=0;M<s.length;M+=3){S.x=s[M+0],S.y=s[M+1],S.z=s[M+2];const T=x(S)/2/Math.PI+.5,P=g(S)/Math.PI+.5;o.push(T,1-P)}y(),h()}function h(){for(let S=0;S<o.length;S+=6){const M=o[S+0],T=o[S+2],P=o[S+4],b=Math.max(M,T,P),L=Math.min(M,T,P);b>.9&&L<.1&&(M<.2&&(o[S+0]+=1),T<.2&&(o[S+2]+=1),P<.2&&(o[S+4]+=1))}}function m(S){s.push(S.x,S.y,S.z)}function v(S,M){const T=S*3;M.x=e[T+0],M.y=e[T+1],M.z=e[T+2]}function y(){const S=new k,M=new k,T=new k,P=new k,b=new be,L=new be,O=new be;for(let C=0,R=0;C<s.length;C+=9,R+=6){S.set(s[C+0],s[C+1],s[C+2]),M.set(s[C+3],s[C+4],s[C+5]),T.set(s[C+6],s[C+7],s[C+8]),b.set(o[R+0],o[R+1]),L.set(o[R+2],o[R+3]),O.set(o[R+4],o[R+5]),P.copy(S).add(M).add(T).divideScalar(3);const B=x(P);w(b,R+0,S,B),w(L,R+2,M,B),w(O,R+4,T,B)}}function w(S,M,T,P){P<0&&S.x===1&&(o[M]=S.x-1),T.x===0&&T.z===0&&(o[M]=P/2/Math.PI+.5)}function x(S){return Math.atan2(S.z,-S.x)}function g(S){return Math.atan2(-S.y,Math.sqrt(S.x*S.x+S.z*S.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Po(e.vertices,e.indices,e.radius,e.details)}}class um extends Po{constructor(e=1,t=0){const i=(1+Math.sqrt(5))/2,r=1/i,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-i,0,-r,i,0,r,-i,0,r,i,-r,-i,0,-r,i,0,r,-i,0,r,i,0,-i,0,-r,i,0,-r,-i,0,r,i,0,r],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,o,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new um(e.radius,e.detail)}}const mh=new k,gh=new k,C0=new k,vh=new Di;class Qb extends Dt{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const r=Math.pow(10,4),s=Math.cos(ma*t),o=e.getIndex(),a=e.getAttribute("position"),c=o?o.count:a.count,f=[0,0,0],d=["a","b","c"],h=new Array(3),m={},v=[];for(let y=0;y<c;y+=3){o?(f[0]=o.getX(y),f[1]=o.getX(y+1),f[2]=o.getX(y+2)):(f[0]=y,f[1]=y+1,f[2]=y+2);const{a:w,b:x,c:g}=vh;if(w.fromBufferAttribute(a,f[0]),x.fromBufferAttribute(a,f[1]),g.fromBufferAttribute(a,f[2]),vh.getNormal(C0),h[0]=`${Math.round(w.x*r)},${Math.round(w.y*r)},${Math.round(w.z*r)}`,h[1]=`${Math.round(x.x*r)},${Math.round(x.y*r)},${Math.round(x.z*r)}`,h[2]=`${Math.round(g.x*r)},${Math.round(g.y*r)},${Math.round(g.z*r)}`,!(h[0]===h[1]||h[1]===h[2]||h[2]===h[0]))for(let S=0;S<3;S++){const M=(S+1)%3,T=h[S],P=h[M],b=vh[d[S]],L=vh[d[M]],O=`${T}_${P}`,C=`${P}_${T}`;C in m&&m[C]?(C0.dot(m[C].normal)<=s&&(v.push(b.x,b.y,b.z),v.push(L.x,L.y,L.z)),m[C]=null):O in m||(m[O]={index0:f[S],index1:f[M],normal:C0.clone()})}}for(const y in m)if(m[y]){const{index0:w,index1:x}=m[y];mh.fromBufferAttribute(a,w),gh.fromBufferAttribute(a,x),v.push(mh.x,mh.y,mh.z),v.push(gh.x,gh.y,gh.z)}this.setAttribute("position",new ft(v,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class ya extends Kc{constructor(e){super(e),this.uuid=er(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let i=0,r=this.holes.length;i<r;i++)t[i]=this.holes[i].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const r=e.holes[t];this.holes.push(r.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,i=this.holes.length;t<i;t++){const r=this.holes[t];e.holes.push(r.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){const r=e.holes[t];this.holes.push(new Kc().fromJSON(r))}return this}}const qO={triangulate:function(n,e,t=2){const i=e&&e.length,r=i?e[0]*t:n.length;let s=$b(n,0,r,t,!0);const o=[];if(!s||s.next===s.prev)return o;let a,c,f,d,h,m,v;if(i&&(s=$O(n,e,s,t)),n.length>80*t){a=f=n[0],c=d=n[1];for(let y=t;y<r;y+=t)h=n[y],m=n[y+1],h<a&&(a=h),m<c&&(c=m),h>f&&(f=h),m>d&&(d=m);v=Math.max(f-a,d-c),v=v!==0?32767/v:0}return Jc(s,o,t,a,c,v,0),o}};function $b(n,e,t,i,r){let s,o;if(r===ck(n,e,t,i)>0)for(s=e;s<t;s+=i)o=gw(s,n[s],n[s+1],o);else for(s=t-i;s>=e;s-=i)o=gw(s,n[s],n[s+1],o);return o&&cm(o,o.next)&&($c(o),o=o.next),o}function ba(n,e){if(!n)return n;e||(e=n);let t=n,i;do if(i=!1,!t.steiner&&(cm(t,t.next)||hn(t.prev,t,t.next)===0)){if($c(t),t=e=t.prev,t===t.next)break;i=!0}else t=t.next;while(i||t!==e);return e}function Jc(n,e,t,i,r,s,o){if(!n)return;!o&&s&&rk(n,i,r,s);let a=n,c,f;for(;n.prev!==n.next;){if(c=n.prev,f=n.next,s?KO(n,i,r,s):ZO(n)){e.push(c.i/t|0),e.push(n.i/t|0),e.push(f.i/t|0),$c(n),n=f.next,a=f.next;continue}if(n=f,n===a){o?o===1?(n=JO(ba(n),e,t),Jc(n,e,t,i,r,s,2)):o===2&&QO(n,e,t,i,r,s):Jc(ba(n),e,t,i,r,s,1);break}}}function ZO(n){const e=n.prev,t=n,i=n.next;if(hn(e,t,i)>=0)return!1;const r=e.x,s=t.x,o=i.x,a=e.y,c=t.y,f=i.y,d=r<s?r<o?r:o:s<o?s:o,h=a<c?a<f?a:f:c<f?c:f,m=r>s?r>o?r:o:s>o?s:o,v=a>c?a>f?a:f:c>f?c:f;let y=i.next;for(;y!==e;){if(y.x>=d&&y.x<=m&&y.y>=h&&y.y<=v&&Bl(r,a,s,c,o,f,y.x,y.y)&&hn(y.prev,y,y.next)>=0)return!1;y=y.next}return!0}function KO(n,e,t,i){const r=n.prev,s=n,o=n.next;if(hn(r,s,o)>=0)return!1;const a=r.x,c=s.x,f=o.x,d=r.y,h=s.y,m=o.y,v=a<c?a<f?a:f:c<f?c:f,y=d<h?d<m?d:m:h<m?h:m,w=a>c?a>f?a:f:c>f?c:f,x=d>h?d>m?d:m:h>m?h:m,g=yy(v,y,e,t,i),S=yy(w,x,e,t,i);let M=n.prevZ,T=n.nextZ;for(;M&&M.z>=g&&T&&T.z<=S;){if(M.x>=v&&M.x<=w&&M.y>=y&&M.y<=x&&M!==r&&M!==o&&Bl(a,d,c,h,f,m,M.x,M.y)&&hn(M.prev,M,M.next)>=0||(M=M.prevZ,T.x>=v&&T.x<=w&&T.y>=y&&T.y<=x&&T!==r&&T!==o&&Bl(a,d,c,h,f,m,T.x,T.y)&&hn(T.prev,T,T.next)>=0))return!1;T=T.nextZ}for(;M&&M.z>=g;){if(M.x>=v&&M.x<=w&&M.y>=y&&M.y<=x&&M!==r&&M!==o&&Bl(a,d,c,h,f,m,M.x,M.y)&&hn(M.prev,M,M.next)>=0)return!1;M=M.prevZ}for(;T&&T.z<=S;){if(T.x>=v&&T.x<=w&&T.y>=y&&T.y<=x&&T!==r&&T!==o&&Bl(a,d,c,h,f,m,T.x,T.y)&&hn(T.prev,T,T.next)>=0)return!1;T=T.nextZ}return!0}function JO(n,e,t){let i=n;do{const r=i.prev,s=i.next.next;!cm(r,s)&&eC(r,i,i.next,s)&&Qc(r,s)&&Qc(s,r)&&(e.push(r.i/t|0),e.push(i.i/t|0),e.push(s.i/t|0),$c(i),$c(i.next),i=n=s),i=i.next}while(i!==n);return ba(i)}function QO(n,e,t,i,r,s){let o=n;do{let a=o.next.next;for(;a!==o.prev;){if(o.i!==a.i&&ak(o,a)){let c=tC(o,a);o=ba(o,o.next),c=ba(c,c.next),Jc(o,e,t,i,r,s,0),Jc(c,e,t,i,r,s,0);return}a=a.next}o=o.next}while(o!==n)}function $O(n,e,t,i){const r=[];let s,o,a,c,f;for(s=0,o=e.length;s<o;s++)a=e[s]*i,c=s<o-1?e[s+1]*i:n.length,f=$b(n,a,c,i,!1),f===f.next&&(f.steiner=!0),r.push(ok(f));for(r.sort(ek),s=0;s<r.length;s++)t=tk(r[s],t);return t}function ek(n,e){return n.x-e.x}function tk(n,e){const t=nk(n,e);if(!t)return e;const i=tC(t,n);return ba(i,i.next),ba(t,t.next)}function nk(n,e){let t=e,i=-1/0,r;const s=n.x,o=n.y;do{if(o<=t.y&&o>=t.next.y&&t.next.y!==t.y){const m=t.x+(o-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(m<=s&&m>i&&(i=m,r=t.x<t.next.x?t:t.next,m===s))return r}t=t.next}while(t!==e);if(!r)return null;const a=r,c=r.x,f=r.y;let d=1/0,h;t=r;do s>=t.x&&t.x>=c&&s!==t.x&&Bl(o<f?s:i,o,c,f,o<f?i:s,o,t.x,t.y)&&(h=Math.abs(o-t.y)/(s-t.x),Qc(t,n)&&(h<d||h===d&&(t.x>r.x||t.x===r.x&&ik(r,t)))&&(r=t,d=h)),t=t.next;while(t!==a);return r}function ik(n,e){return hn(n.prev,n,e.prev)<0&&hn(e.next,n,n.next)<0}function rk(n,e,t,i){let r=n;do r.z===0&&(r.z=yy(r.x,r.y,e,t,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next;while(r!==n);r.prevZ.nextZ=null,r.prevZ=null,sk(r)}function sk(n){let e,t,i,r,s,o,a,c,f=1;do{for(t=n,n=null,s=null,o=0;t;){for(o++,i=t,a=0,e=0;e<f&&(a++,i=i.nextZ,!!i);e++);for(c=f;a>0||c>0&&i;)a!==0&&(c===0||!i||t.z<=i.z)?(r=t,t=t.nextZ,a--):(r=i,i=i.nextZ,c--),s?s.nextZ=r:n=r,r.prevZ=s,s=r;t=i}s.nextZ=null,f*=2}while(o>1);return n}function yy(n,e,t,i,r){return n=(n-t)*r|0,e=(e-i)*r|0,n=(n|n<<8)&16711935,n=(n|n<<4)&252645135,n=(n|n<<2)&858993459,n=(n|n<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,n|e<<1}function ok(n){let e=n,t=n;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==n);return t}function Bl(n,e,t,i,r,s,o,a){return(r-o)*(e-a)>=(n-o)*(s-a)&&(n-o)*(i-a)>=(t-o)*(e-a)&&(t-o)*(s-a)>=(r-o)*(i-a)}function ak(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!lk(n,e)&&(Qc(n,e)&&Qc(e,n)&&uk(n,e)&&(hn(n.prev,n,e.prev)||hn(n,e.prev,e))||cm(n,e)&&hn(n.prev,n,n.next)>0&&hn(e.prev,e,e.next)>0)}function hn(n,e,t){return(e.y-n.y)*(t.x-e.x)-(e.x-n.x)*(t.y-e.y)}function cm(n,e){return n.x===e.x&&n.y===e.y}function eC(n,e,t,i){const r=_h(hn(n,e,t)),s=_h(hn(n,e,i)),o=_h(hn(t,i,n)),a=_h(hn(t,i,e));return!!(r!==s&&o!==a||r===0&&yh(n,t,e)||s===0&&yh(n,i,e)||o===0&&yh(t,n,i)||a===0&&yh(t,e,i))}function yh(n,e,t){return e.x<=Math.max(n.x,t.x)&&e.x>=Math.min(n.x,t.x)&&e.y<=Math.max(n.y,t.y)&&e.y>=Math.min(n.y,t.y)}function _h(n){return n>0?1:n<0?-1:0}function lk(n,e){let t=n;do{if(t.i!==n.i&&t.next.i!==n.i&&t.i!==e.i&&t.next.i!==e.i&&eC(t,t.next,n,e))return!0;t=t.next}while(t!==n);return!1}function Qc(n,e){return hn(n.prev,n,n.next)<0?hn(n,e,n.next)>=0&&hn(n,n.prev,e)>=0:hn(n,e,n.prev)<0||hn(n,n.next,e)<0}function uk(n,e){let t=n,i=!1;const r=(n.x+e.x)/2,s=(n.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&r<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(i=!i),t=t.next;while(t!==n);return i}function tC(n,e){const t=new _y(n.i,n.x,n.y),i=new _y(e.i,e.x,e.y),r=n.next,s=e.prev;return n.next=e,e.prev=n,t.next=r,r.prev=t,i.next=t,t.prev=i,s.next=i,i.prev=s,i}function gw(n,e,t,i){const r=new _y(n,e,t);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function $c(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function _y(n,e,t){this.i=n,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function ck(n,e,t,i){let r=0;for(let s=e,o=t-i;s<t;s+=i)r+=(n[o]-n[s])*(n[s+1]+n[o+1]),o=s;return r}class is{static area(e){const t=e.length;let i=0;for(let r=t-1,s=0;s<t;r=s++)i+=e[r].x*e[s].y-e[s].x*e[r].y;return i*.5}static isClockWise(e){return is.area(e)<0}static triangulateShape(e,t){const i=[],r=[],s=[];vw(e),yw(i,e);let o=e.length;t.forEach(vw);for(let c=0;c<t.length;c++)r.push(o),o+=t[c].length,yw(i,t[c]);const a=qO.triangulate(i,r);for(let c=0;c<a.length;c+=3)s.push(a.slice(c,c+3));return s}}function vw(n){const e=n.length;e>2&&n[e-1].equals(n[0])&&n.pop()}function yw(n,e){for(let t=0;t<e.length;t++)n.push(e[t].x),n.push(e[t].y)}class fm extends Dt{constructor(e=new ya([new be(.5,.5),new be(-.5,.5),new be(-.5,-.5),new be(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const i=this,r=[],s=[];for(let a=0,c=e.length;a<c;a++){const f=e[a];o(f)}this.setAttribute("position",new ft(r,3)),this.setAttribute("uv",new ft(s,2)),this.computeVertexNormals();function o(a){const c=[],f=t.curveSegments!==void 0?t.curveSegments:12,d=t.steps!==void 0?t.steps:1,h=t.depth!==void 0?t.depth:1;let m=t.bevelEnabled!==void 0?t.bevelEnabled:!0,v=t.bevelThickness!==void 0?t.bevelThickness:.2,y=t.bevelSize!==void 0?t.bevelSize:v-.1,w=t.bevelOffset!==void 0?t.bevelOffset:0,x=t.bevelSegments!==void 0?t.bevelSegments:3;const g=t.extrudePath,S=t.UVGenerator!==void 0?t.UVGenerator:fk;let M,T=!1,P,b,L,O;g&&(M=g.getSpacedPoints(d),T=!0,m=!1,P=g.computeFrenetFrames(d,!1),b=new k,L=new k,O=new k),m||(x=0,v=0,y=0,w=0);const C=a.extractPoints(f);let R=C.shape;const B=C.holes;if(!is.isClockWise(R)){R=R.reverse();for(let H=0,xe=B.length;H<xe;H++){const oe=B[H];is.isClockWise(oe)&&(B[H]=oe.reverse())}}const me=is.triangulateShape(R,B),G=R;for(let H=0,xe=B.length;H<xe;H++){const oe=B[H];R=R.concat(oe)}function Z(H,xe,oe){return xe||console.error("THREE.ExtrudeGeometry: vec does not exist"),H.clone().addScaledVector(xe,oe)}const ne=R.length,he=me.length;function F(H,xe,oe){let Ue,ve,Ze;const Ve=H.x-xe.x,N=H.y-xe.y,I=oe.x-H.x,te=oe.y-H.y,Ce=Ve*Ve+N*N,we=Ve*te-N*I;if(Math.abs(we)>Number.EPSILON){const Ee=Math.sqrt(Ce),Ke=Math.sqrt(I*I+te*te),Oe=xe.x-N/Ee,Ge=xe.y+Ve/Ee,lt=oe.x-te/Ke,yt=oe.y+I/Ke,Te=((lt-Oe)*te-(yt-Ge)*I)/(Ve*te-N*I);Ue=Oe+Ve*Te-H.x,ve=Ge+N*Te-H.y;const Ct=Ue*Ue+ve*ve;if(Ct<=2)return new be(Ue,ve);Ze=Math.sqrt(Ct/2)}else{let Ee=!1;Ve>Number.EPSILON?I>Number.EPSILON&&(Ee=!0):Ve<-Number.EPSILON?I<-Number.EPSILON&&(Ee=!0):Math.sign(N)===Math.sign(te)&&(Ee=!0),Ee?(Ue=-N,ve=Ve,Ze=Math.sqrt(Ce)):(Ue=Ve,ve=N,Ze=Math.sqrt(Ce/2))}return new be(Ue/Ze,ve/Ze)}const W=[];for(let H=0,xe=G.length,oe=xe-1,Ue=H+1;H<xe;H++,oe++,Ue++)oe===xe&&(oe=0),Ue===xe&&(Ue=0),W[H]=F(G[H],G[oe],G[Ue]);const V=[];let Q,se=W.concat();for(let H=0,xe=B.length;H<xe;H++){const oe=B[H];Q=[];for(let Ue=0,ve=oe.length,Ze=ve-1,Ve=Ue+1;Ue<ve;Ue++,Ze++,Ve++)Ze===ve&&(Ze=0),Ve===ve&&(Ve=0),Q[Ue]=F(oe[Ue],oe[Ze],oe[Ve]);V.push(Q),se=se.concat(Q)}for(let H=0;H<x;H++){const xe=H/x,oe=v*Math.cos(xe*Math.PI/2),Ue=y*Math.sin(xe*Math.PI/2)+w;for(let ve=0,Ze=G.length;ve<Ze;ve++){const Ve=Z(G[ve],W[ve],Ue);Fe(Ve.x,Ve.y,-oe)}for(let ve=0,Ze=B.length;ve<Ze;ve++){const Ve=B[ve];Q=V[ve];for(let N=0,I=Ve.length;N<I;N++){const te=Z(Ve[N],Q[N],Ue);Fe(te.x,te.y,-oe)}}}const J=y+w;for(let H=0;H<ne;H++){const xe=m?Z(R[H],se[H],J):R[H];T?(L.copy(P.normals[0]).multiplyScalar(xe.x),b.copy(P.binormals[0]).multiplyScalar(xe.y),O.copy(M[0]).add(L).add(b),Fe(O.x,O.y,O.z)):Fe(xe.x,xe.y,0)}for(let H=1;H<=d;H++)for(let xe=0;xe<ne;xe++){const oe=m?Z(R[xe],se[xe],J):R[xe];T?(L.copy(P.normals[H]).multiplyScalar(oe.x),b.copy(P.binormals[H]).multiplyScalar(oe.y),O.copy(M[H]).add(L).add(b),Fe(O.x,O.y,O.z)):Fe(oe.x,oe.y,h/d*H)}for(let H=x-1;H>=0;H--){const xe=H/x,oe=v*Math.cos(xe*Math.PI/2),Ue=y*Math.sin(xe*Math.PI/2)+w;for(let ve=0,Ze=G.length;ve<Ze;ve++){const Ve=Z(G[ve],W[ve],Ue);Fe(Ve.x,Ve.y,h+oe)}for(let ve=0,Ze=B.length;ve<Ze;ve++){const Ve=B[ve];Q=V[ve];for(let N=0,I=Ve.length;N<I;N++){const te=Z(Ve[N],Q[N],Ue);T?Fe(te.x,te.y+M[d-1].y,M[d-1].x+oe):Fe(te.x,te.y,h+oe)}}}ge(),Ie();function ge(){const H=r.length/3;if(m){let xe=0,oe=ne*xe;for(let Ue=0;Ue<he;Ue++){const ve=me[Ue];Ne(ve[2]+oe,ve[1]+oe,ve[0]+oe)}xe=d+x*2,oe=ne*xe;for(let Ue=0;Ue<he;Ue++){const ve=me[Ue];Ne(ve[0]+oe,ve[1]+oe,ve[2]+oe)}}else{for(let xe=0;xe<he;xe++){const oe=me[xe];Ne(oe[2],oe[1],oe[0])}for(let xe=0;xe<he;xe++){const oe=me[xe];Ne(oe[0]+ne*d,oe[1]+ne*d,oe[2]+ne*d)}}i.addGroup(H,r.length/3-H,0)}function Ie(){const H=r.length/3;let xe=0;Be(G,xe),xe+=G.length;for(let oe=0,Ue=B.length;oe<Ue;oe++){const ve=B[oe];Be(ve,xe),xe+=ve.length}i.addGroup(H,r.length/3-H,1)}function Be(H,xe){let oe=H.length;for(;--oe>=0;){const Ue=oe;let ve=oe-1;ve<0&&(ve=H.length-1);for(let Ze=0,Ve=d+x*2;Ze<Ve;Ze++){const N=ne*Ze,I=ne*(Ze+1),te=xe+Ue+N,Ce=xe+ve+N,we=xe+ve+I,Ee=xe+Ue+I;je(te,Ce,we,Ee)}}}function Fe(H,xe,oe){c.push(H),c.push(xe),c.push(oe)}function Ne(H,xe,oe){ke(H),ke(xe),ke(oe);const Ue=r.length/3,ve=S.generateTopUV(i,r,Ue-3,Ue-2,Ue-1);Le(ve[0]),Le(ve[1]),Le(ve[2])}function je(H,xe,oe,Ue){ke(H),ke(xe),ke(Ue),ke(xe),ke(oe),ke(Ue);const ve=r.length/3,Ze=S.generateSideWallUV(i,r,ve-6,ve-3,ve-2,ve-1);Le(Ze[0]),Le(Ze[1]),Le(Ze[3]),Le(Ze[1]),Le(Ze[2]),Le(Ze[3])}function ke(H){r.push(c[H*3+0]),r.push(c[H*3+1]),r.push(c[H*3+2])}function Le(H){s.push(H.x),s.push(H.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,i=this.parameters.options;return dk(t,i,e)}static fromJSON(e,t){const i=[];for(let s=0,o=e.shapes.length;s<o;s++){const a=t[e.shapes[s]];i.push(a)}const r=e.options.extrudePath;return r!==void 0&&(e.options.extrudePath=new bp[r.type]().fromJSON(r)),new fm(i,e.options)}}const fk={generateTopUV:function(n,e,t,i,r){const s=e[t*3],o=e[t*3+1],a=e[i*3],c=e[i*3+1],f=e[r*3],d=e[r*3+1];return[new be(s,o),new be(a,c),new be(f,d)]},generateSideWallUV:function(n,e,t,i,r,s){const o=e[t*3],a=e[t*3+1],c=e[t*3+2],f=e[i*3],d=e[i*3+1],h=e[i*3+2],m=e[r*3],v=e[r*3+1],y=e[r*3+2],w=e[s*3],x=e[s*3+1],g=e[s*3+2];return Math.abs(a-d)<Math.abs(o-f)?[new be(o,1-c),new be(f,1-h),new be(m,1-y),new be(w,1-g)]:[new be(a,1-c),new be(d,1-h),new be(v,1-y),new be(x,1-g)]}};function dk(n,e,t){if(t.shapes=[],Array.isArray(n))for(let i=0,r=n.length;i<r;i++){const s=n[i];t.shapes.push(s.uuid)}else t.shapes.push(n.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class dm extends Po{constructor(e=1,t=0){const i=(1+Math.sqrt(5))/2,r=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(r,s,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new dm(e.radius,e.detail)}}class _f extends Po{constructor(e=1,t=0){const i=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],r=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(i,r,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new _f(e.radius,e.detail)}}class hm extends Dt{constructor(e=.5,t=1,i=32,r=1,s=0,o=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:i,phiSegments:r,thetaStart:s,thetaLength:o},i=Math.max(3,i),r=Math.max(1,r);const a=[],c=[],f=[],d=[];let h=e;const m=(t-e)/r,v=new k,y=new be;for(let w=0;w<=r;w++){for(let x=0;x<=i;x++){const g=s+x/i*o;v.x=h*Math.cos(g),v.y=h*Math.sin(g),c.push(v.x,v.y,v.z),f.push(0,0,1),y.x=(v.x/t+1)/2,y.y=(v.y/t+1)/2,d.push(y.x,y.y)}h+=m}for(let w=0;w<r;w++){const x=w*(i+1);for(let g=0;g<i;g++){const S=g+x,M=S,T=S+i+1,P=S+i+2,b=S+1;a.push(M,T,b),a.push(T,P,b)}}this.setIndex(a),this.setAttribute("position",new ft(c,3)),this.setAttribute("normal",new ft(f,3)),this.setAttribute("uv",new ft(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new hm(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class pm extends Dt{constructor(e=new ya([new be(0,.5),new be(-.5,-.5),new be(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const i=[],r=[],s=[],o=[];let a=0,c=0;if(Array.isArray(e)===!1)f(e);else for(let d=0;d<e.length;d++)f(e[d]),this.addGroup(a,c,d),a+=c,c=0;this.setIndex(i),this.setAttribute("position",new ft(r,3)),this.setAttribute("normal",new ft(s,3)),this.setAttribute("uv",new ft(o,2));function f(d){const h=r.length/3,m=d.extractPoints(t);let v=m.shape;const y=m.holes;is.isClockWise(v)===!1&&(v=v.reverse());for(let x=0,g=y.length;x<g;x++){const S=y[x];is.isClockWise(S)===!0&&(y[x]=S.reverse())}const w=is.triangulateShape(v,y);for(let x=0,g=y.length;x<g;x++){const S=y[x];v=v.concat(S)}for(let x=0,g=v.length;x<g;x++){const S=v[x];r.push(S.x,S.y,0),s.push(0,0,1),o.push(S.x,S.y)}for(let x=0,g=w.length;x<g;x++){const S=w[x],M=S[0]+h,T=S[1]+h,P=S[2]+h;i.push(M,T,P),c+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return hk(t,e)}static fromJSON(e,t){const i=[];for(let r=0,s=e.shapes.length;r<s;r++){const o=t[e.shapes[r]];i.push(o)}return new pm(i,e.curveSegments)}}function hk(n,e){if(e.shapes=[],Array.isArray(n))for(let t=0,i=n.length;t<i;t++){const r=n[t];e.shapes.push(r.uuid)}else e.shapes.push(n.uuid);return e}class xf extends Dt{constructor(e=1,t=32,i=16,r=0,s=Math.PI*2,o=0,a=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:r,phiLength:s,thetaStart:o,thetaLength:a},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));const c=Math.min(o+a,Math.PI);let f=0;const d=[],h=new k,m=new k,v=[],y=[],w=[],x=[];for(let g=0;g<=i;g++){const S=[],M=g/i;let T=0;g===0&&o===0?T=.5/t:g===i&&c===Math.PI&&(T=-.5/t);for(let P=0;P<=t;P++){const b=P/t;h.x=-e*Math.cos(r+b*s)*Math.sin(o+M*a),h.y=e*Math.cos(o+M*a),h.z=e*Math.sin(r+b*s)*Math.sin(o+M*a),y.push(h.x,h.y,h.z),m.copy(h).normalize(),w.push(m.x,m.y,m.z),x.push(b+T,1-M),S.push(f++)}d.push(S)}for(let g=0;g<i;g++)for(let S=0;S<t;S++){const M=d[g][S+1],T=d[g][S],P=d[g+1][S],b=d[g+1][S+1];(g!==0||o>0)&&v.push(M,T,b),(g!==i-1||c<Math.PI)&&v.push(T,P,b)}this.setIndex(v),this.setAttribute("position",new ft(y,3)),this.setAttribute("normal",new ft(w,3)),this.setAttribute("uv",new ft(x,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new xf(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class mm extends Po{constructor(e=1,t=0){const i=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],r=[2,1,0,0,3,2,1,3,0,2,3,1];super(i,r,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new mm(e.radius,e.detail)}}class gm extends Dt{constructor(e=1,t=.4,i=12,r=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:r,arc:s},i=Math.floor(i),r=Math.floor(r);const o=[],a=[],c=[],f=[],d=new k,h=new k,m=new k;for(let v=0;v<=i;v++)for(let y=0;y<=r;y++){const w=y/r*s,x=v/i*Math.PI*2;h.x=(e+t*Math.cos(x))*Math.cos(w),h.y=(e+t*Math.cos(x))*Math.sin(w),h.z=t*Math.sin(x),a.push(h.x,h.y,h.z),d.x=e*Math.cos(w),d.y=e*Math.sin(w),m.subVectors(h,d).normalize(),c.push(m.x,m.y,m.z),f.push(y/r),f.push(v/i)}for(let v=1;v<=i;v++)for(let y=1;y<=r;y++){const w=(r+1)*v+y-1,x=(r+1)*(v-1)+y-1,g=(r+1)*(v-1)+y,S=(r+1)*v+y;o.push(w,x,S),o.push(x,g,S)}this.setIndex(o),this.setAttribute("position",new ft(a,3)),this.setAttribute("normal",new ft(c,3)),this.setAttribute("uv",new ft(f,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new gm(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class vm extends Dt{constructor(e=1,t=.4,i=64,r=8,s=2,o=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:i,radialSegments:r,p:s,q:o},i=Math.floor(i),r=Math.floor(r);const a=[],c=[],f=[],d=[],h=new k,m=new k,v=new k,y=new k,w=new k,x=new k,g=new k;for(let M=0;M<=i;++M){const T=M/i*s*Math.PI*2;S(T,s,o,e,v),S(T+.01,s,o,e,y),x.subVectors(y,v),g.addVectors(y,v),w.crossVectors(x,g),g.crossVectors(w,x),w.normalize(),g.normalize();for(let P=0;P<=r;++P){const b=P/r*Math.PI*2,L=-t*Math.cos(b),O=t*Math.sin(b);h.x=v.x+(L*g.x+O*w.x),h.y=v.y+(L*g.y+O*w.y),h.z=v.z+(L*g.z+O*w.z),c.push(h.x,h.y,h.z),m.subVectors(h,v).normalize(),f.push(m.x,m.y,m.z),d.push(M/i),d.push(P/r)}}for(let M=1;M<=i;M++)for(let T=1;T<=r;T++){const P=(r+1)*(M-1)+(T-1),b=(r+1)*M+(T-1),L=(r+1)*M+T,O=(r+1)*(M-1)+T;a.push(P,b,O),a.push(b,L,O)}this.setIndex(a),this.setAttribute("position",new ft(c,3)),this.setAttribute("normal",new ft(f,3)),this.setAttribute("uv",new ft(d,2));function S(M,T,P,b,L){const O=Math.cos(M),C=Math.sin(M),R=P/T*M,B=Math.cos(R);L.x=b*(2+B)*.5*O,L.y=b*(2+B)*C*.5,L.z=b*Math.sin(R)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new vm(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class ym extends Dt{constructor(e=new $_(new k(-1,-1,0),new k(-1,1,0),new k(1,1,0)),t=64,i=1,r=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:i,radialSegments:r,closed:s};const o=e.computeFrenetFrames(t,s);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals;const a=new k,c=new k,f=new be;let d=new k;const h=[],m=[],v=[],y=[];w(),this.setIndex(y),this.setAttribute("position",new ft(h,3)),this.setAttribute("normal",new ft(m,3)),this.setAttribute("uv",new ft(v,2));function w(){for(let M=0;M<t;M++)x(M);x(s===!1?t:0),S(),g()}function x(M){d=e.getPointAt(M/t,d);const T=o.normals[M],P=o.binormals[M];for(let b=0;b<=r;b++){const L=b/r*Math.PI*2,O=Math.sin(L),C=-Math.cos(L);c.x=C*T.x+O*P.x,c.y=C*T.y+O*P.y,c.z=C*T.z+O*P.z,c.normalize(),m.push(c.x,c.y,c.z),a.x=d.x+i*c.x,a.y=d.y+i*c.y,a.z=d.z+i*c.z,h.push(a.x,a.y,a.z)}}function g(){for(let M=1;M<=t;M++)for(let T=1;T<=r;T++){const P=(r+1)*(M-1)+(T-1),b=(r+1)*M+(T-1),L=(r+1)*M+T,O=(r+1)*(M-1)+T;y.push(P,b,O),y.push(b,L,O)}}function S(){for(let M=0;M<=t;M++)for(let T=0;T<=r;T++)f.x=M/t,f.y=T/r,v.push(f.x,f.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new ym(new bp[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class nC extends Dt{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],i=new Set,r=new k,s=new k;if(e.index!==null){const o=e.attributes.position,a=e.index;let c=e.groups;c.length===0&&(c=[{start:0,count:a.count,materialIndex:0}]);for(let f=0,d=c.length;f<d;++f){const h=c[f],m=h.start,v=h.count;for(let y=m,w=m+v;y<w;y+=3)for(let x=0;x<3;x++){const g=a.getX(y+x),S=a.getX(y+(x+1)%3);r.fromBufferAttribute(o,g),s.fromBufferAttribute(o,S),_w(r,s,i)===!0&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}}else{const o=e.attributes.position;for(let a=0,c=o.count/3;a<c;a++)for(let f=0;f<3;f++){const d=3*a+f,h=3*a+(f+1)%3;r.fromBufferAttribute(o,d),s.fromBufferAttribute(o,h),_w(r,s,i)===!0&&(t.push(r.x,r.y,r.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new ft(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function _w(n,e,t){const i=`${n.x},${n.y},${n.z}-${e.x},${e.y},${e.z}`,r=`${e.x},${e.y},${e.z}-${n.x},${n.y},${n.z}`;return t.has(i)===!0||t.has(r)===!0?!1:(t.add(i),t.add(r),!0)}var xw=Object.freeze({__proto__:null,BoxGeometry:La,CapsuleGeometry:om,CircleGeometry:am,ConeGeometry:lm,CylinderGeometry:du,DodecahedronGeometry:um,EdgesGeometry:Qb,ExtrudeGeometry:fm,IcosahedronGeometry:dm,LatheGeometry:yf,OctahedronGeometry:_f,PlaneGeometry:vf,PolyhedronGeometry:Po,RingGeometry:hm,ShapeGeometry:pm,SphereGeometry:xf,TetrahedronGeometry:mm,TorusGeometry:gm,TorusKnotGeometry:vm,TubeGeometry:ym,WireframeGeometry:nC});class iC extends mi{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new nt(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class rC extends kr{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class tx extends mi{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new nt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new nt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Co,this.normalScale=new be(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class sC extends tx{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new be(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return xn(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new nt(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new nt(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new nt(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class oC extends mi{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new nt(16777215),this.specular=new nt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new nt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Co,this.normalScale=new be(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=ff,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class aC extends mi{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new nt(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new nt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Co,this.normalScale=new be(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class lC extends mi{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Co,this.normalScale=new be(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class uC extends mi{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new nt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new nt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Co,this.normalScale=new be(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=ff,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class cC extends mi{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new nt(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Co,this.normalScale=new be(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class fC extends Ci{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function fa(n,e,t){return!n||!t&&n.constructor===e?n:typeof e.BYTES_PER_ELEMENT=="number"?new e(n):Array.prototype.slice.call(n)}function dC(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function hC(n){function e(r,s){return n[r]-n[s]}const t=n.length,i=new Array(t);for(let r=0;r!==t;++r)i[r]=r;return i.sort(e),i}function xy(n,e,t){const i=n.length,r=new n.constructor(i);for(let s=0,o=0;o!==i;++s){const a=t[s]*e;for(let c=0;c!==e;++c)r[o++]=n[a+c]}return r}function nx(n,e,t,i){let r=1,s=n[0];for(;s!==void 0&&s[i]===void 0;)s=n[r++];if(s===void 0)return;let o=s[i];if(o!==void 0)if(Array.isArray(o))do o=s[i],o!==void 0&&(e.push(s.time),t.push.apply(t,o)),s=n[r++];while(s!==void 0);else if(o.toArray!==void 0)do o=s[i],o!==void 0&&(e.push(s.time),o.toArray(t,t.length)),s=n[r++];while(s!==void 0);else do o=s[i],o!==void 0&&(e.push(s.time),t.push(o)),s=n[r++];while(s!==void 0)}function pk(n,e,t,i,r=30){const s=n.clone();s.name=e;const o=[];for(let c=0;c<s.tracks.length;++c){const f=s.tracks[c],d=f.getValueSize(),h=[],m=[];for(let v=0;v<f.times.length;++v){const y=f.times[v]*r;if(!(y<t||y>=i)){h.push(f.times[v]);for(let w=0;w<d;++w)m.push(f.values[v*d+w])}}h.length!==0&&(f.times=fa(h,f.times.constructor),f.values=fa(m,f.values.constructor),o.push(f))}s.tracks=o;let a=1/0;for(let c=0;c<s.tracks.length;++c)a>s.tracks[c].times[0]&&(a=s.tracks[c].times[0]);for(let c=0;c<s.tracks.length;++c)s.tracks[c].shift(-1*a);return s.resetDuration(),s}function mk(n,e=0,t=n,i=30){i<=0&&(i=30);const r=t.tracks.length,s=e/i;for(let o=0;o<r;++o){const a=t.tracks[o],c=a.ValueTypeName;if(c==="bool"||c==="string")continue;const f=n.tracks.find(function(g){return g.name===a.name&&g.ValueTypeName===c});if(f===void 0)continue;let d=0;const h=a.getValueSize();a.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(d=h/3);let m=0;const v=f.getValueSize();f.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(m=v/3);const y=a.times.length-1;let w;if(s<=a.times[0]){const g=d,S=h-d;w=a.values.slice(g,S)}else if(s>=a.times[y]){const g=y*h+d,S=g+h-d;w=a.values.slice(g,S)}else{const g=a.createInterpolant(),S=d,M=h-d;g.evaluate(s),w=g.resultBuffer.slice(S,M)}c==="quaternion"&&new di().fromArray(w).normalize().conjugate().toArray(w);const x=f.times.length;for(let g=0;g<x;++g){const S=g*v+m;if(c==="quaternion")di.multiplyQuaternionsFlat(f.values,S,w,0,f.values,S);else{const M=v-m*2;for(let T=0;T<M;++T)f.values[S+T]-=w[T]}}}return n.blendMode=L_,n}const gk={convertArray:fa,isTypedArray:dC,getKeyframeOrder:hC,sortedArray:xy,flattenJSON:nx,subclip:pk,makeClipAdditive:mk};class Sf{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=r!==void 0?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let i=this._cachedIndex,r=t[i],s=t[i-1];e:{t:{let o;n:{i:if(!(e<r)){for(let a=i+2;;){if(r===void 0){if(e<s)break i;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===a)break;if(s=r,r=t[++i],e<r)break t}o=t.length;break n}if(!(e>=s)){const a=t[1];e<a&&(i=2,s=a);for(let c=i-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===c)break;if(r=s,s=t[--i-1],e>=s)break t}o=i,i=0;break n}break e}for(;i<o;){const a=i+o>>>1;e<t[a]?o=a:i=a+1}if(r=t[i],s=t[i-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(r===void 0)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,r)}return this.interpolate_(i,s,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,s=e*r;for(let o=0;o!==r;++o)t[o]=i[s+o];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class pC extends Sf{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:la,endingEnd:la}}intervalChanged_(e,t,i){const r=this.parameterPositions;let s=e-2,o=e+1,a=r[s],c=r[o];if(a===void 0)switch(this.getSettings_().endingStart){case ua:s=e,a=2*t-i;break;case Wc:s=r.length-2,a=t+r[s]-r[s+1];break;default:s=e,a=i}if(c===void 0)switch(this.getSettings_().endingEnd){case ua:o=e,c=2*i-t;break;case Wc:o=1,c=i+r[1]-r[0];break;default:o=e-1,c=t}const f=(i-t)*.5,d=this.valueSize;this._weightPrev=f/(t-a),this._weightNext=f/(c-i),this._offsetPrev=s*d,this._offsetNext=o*d}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=e*a,f=c-a,d=this._offsetPrev,h=this._offsetNext,m=this._weightPrev,v=this._weightNext,y=(i-t)/(r-t),w=y*y,x=w*y,g=-m*x+2*m*w-m*y,S=(1+m)*x+(-1.5-2*m)*w+(-.5+m)*y+1,M=(-1-v)*x+(1.5+v)*w+.5*y,T=v*x-v*w;for(let P=0;P!==a;++P)s[P]=g*o[d+P]+S*o[f+P]+M*o[c+P]+T*o[h+P];return s}}class ix extends Sf{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=e*a,f=c-a,d=(i-t)/(r-t),h=1-d;for(let m=0;m!==a;++m)s[m]=o[f+m]*h+o[c+m]*d;return s}}class mC extends Sf{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class zr{constructor(e,t,i,r){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=fa(t,this.TimeBufferType),this.values=fa(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let i;if(t.toJSON!==this.toJSON)i=t.toJSON(e);else{i={name:e.name,times:fa(e.times,Array),values:fa(e.values,Array)};const r=e.getInterpolation();r!==e.DefaultInterpolation&&(i.interpolation=r)}return i.type=e.ValueTypeName,i}InterpolantFactoryMethodDiscrete(e){return new mC(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new ix(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new pC(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case Vc:t=this.InterpolantFactoryMethodDiscrete;break;case Gc:t=this.InterpolantFactoryMethodLinear;break;case Zh:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Vc;case this.InterpolantFactoryMethodLinear:return Gc;case this.InterpolantFactoryMethodSmooth:return Zh}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){const i=this.times,r=i.length;let s=0,o=r-1;for(;s!==r&&i[s]<e;)++s;for(;o!==-1&&i[o]>t;)--o;if(++o,s!==0||o!==r){s>=o&&(o=Math.max(o,1),s=o-1);const a=this.getValueSize();this.times=i.slice(s,o),this.values=this.values.slice(s*a,o*a)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);const i=this.times,r=this.values,s=i.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let o=null;for(let a=0;a!==s;a++){const c=i[a];if(typeof c=="number"&&isNaN(c)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,c),e=!1;break}if(o!==null&&o>c){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,c,o),e=!1;break}o=c}if(r!==void 0&&dC(r))for(let a=0,c=r.length;a!==c;++a){const f=r[a];if(isNaN(f)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,f),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),i=this.getValueSize(),r=this.getInterpolation()===Zh,s=e.length-1;let o=1;for(let a=1;a<s;++a){let c=!1;const f=e[a],d=e[a+1];if(f!==d&&(a!==1||f!==e[0]))if(r)c=!0;else{const h=a*i,m=h-i,v=h+i;for(let y=0;y!==i;++y){const w=t[h+y];if(w!==t[m+y]||w!==t[v+y]){c=!0;break}}}if(c){if(a!==o){e[o]=e[a];const h=a*i,m=o*i;for(let v=0;v!==i;++v)t[m+v]=t[h+v]}++o}}if(s>0){e[o]=e[s];for(let a=s*i,c=o*i,f=0;f!==i;++f)t[c+f]=t[a+f];++o}return o!==e.length?(this.times=e.slice(0,o),this.values=t.slice(0,o*i)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),i=this.constructor,r=new i(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}zr.prototype.TimeBufferType=Float32Array;zr.prototype.ValueBufferType=Float32Array;zr.prototype.DefaultInterpolation=Gc;class Ia extends zr{}Ia.prototype.ValueTypeName="bool";Ia.prototype.ValueBufferType=Array;Ia.prototype.DefaultInterpolation=Vc;Ia.prototype.InterpolantFactoryMethodLinear=void 0;Ia.prototype.InterpolantFactoryMethodSmooth=void 0;class rx extends zr{}rx.prototype.ValueTypeName="color";class ef extends zr{}ef.prototype.ValueTypeName="number";class gC extends Sf{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){const s=this.resultBuffer,o=this.sampleValues,a=this.valueSize,c=(i-t)/(r-t);let f=e*a;for(let d=f+a;f!==d;f+=4)di.slerpFlat(s,0,o,f-a,o,f,c);return s}}class hu extends zr{InterpolantFactoryMethodLinear(e){return new gC(this.times,this.values,this.getValueSize(),e)}}hu.prototype.ValueTypeName="quaternion";hu.prototype.DefaultInterpolation=Gc;hu.prototype.InterpolantFactoryMethodSmooth=void 0;class Na extends zr{}Na.prototype.ValueTypeName="string";Na.prototype.ValueBufferType=Array;Na.prototype.DefaultInterpolation=Vc;Na.prototype.InterpolantFactoryMethodLinear=void 0;Na.prototype.InterpolantFactoryMethodSmooth=void 0;class tf extends zr{}tf.prototype.ValueTypeName="vector";class nf{constructor(e,t=-1,i,r=Zp){this.name=e,this.tracks=i,this.duration=t,this.blendMode=r,this.uuid=er(),this.duration<0&&this.resetDuration()}static parse(e){const t=[],i=e.tracks,r=1/(e.fps||1);for(let o=0,a=i.length;o!==a;++o)t.push(yk(i[o]).scale(r));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){const t=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let s=0,o=i.length;s!==o;++s)t.push(zr.toJSON(i[s]));return r}static CreateFromMorphTargetSequence(e,t,i,r){const s=t.length,o=[];for(let a=0;a<s;a++){let c=[],f=[];c.push((a+s-1)%s,a,(a+1)%s),f.push(0,1,0);const d=hC(c);c=xy(c,1,d),f=xy(f,1,d),!r&&c[0]===0&&(c.push(s),f.push(f[0])),o.push(new ef(".morphTargetInfluences["+t[a].name+"]",c,f).scale(1/i))}return new this(e,-1,o)}static findByName(e,t){let i=e;if(!Array.isArray(e)){const r=e;i=r.geometry&&r.geometry.animations||r.animations}for(let r=0;r<i.length;r++)if(i[r].name===t)return i[r];return null}static CreateClipsFromMorphTargetSequences(e,t,i){const r={},s=/^([\w-]*?)([\d]+)$/;for(let a=0,c=e.length;a<c;a++){const f=e[a],d=f.name.match(s);if(d&&d.length>1){const h=d[1];let m=r[h];m||(r[h]=m=[]),m.push(f)}}const o=[];for(const a in r)o.push(this.CreateFromMorphTargetSequence(a,r[a],t,i));return o}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(h,m,v,y,w){if(v.length!==0){const x=[],g=[];nx(v,x,g,y),x.length!==0&&w.push(new h(m,x,g))}},r=[],s=e.name||"default",o=e.fps||30,a=e.blendMode;let c=e.length||-1;const f=e.hierarchy||[];for(let h=0;h<f.length;h++){const m=f[h].keys;if(!(!m||m.length===0))if(m[0].morphTargets){const v={};let y;for(y=0;y<m.length;y++)if(m[y].morphTargets)for(let w=0;w<m[y].morphTargets.length;w++)v[m[y].morphTargets[w]]=-1;for(const w in v){const x=[],g=[];for(let S=0;S!==m[y].morphTargets.length;++S){const M=m[y];x.push(M.time),g.push(M.morphTarget===w?1:0)}r.push(new ef(".morphTargetInfluence["+w+"]",x,g))}c=v.length*o}else{const v=".bones["+t[h].name+"]";i(tf,v+".position",m,"pos",r),i(hu,v+".quaternion",m,"rot",r),i(tf,v+".scale",m,"scl",r)}}return r.length===0?null:new this(s,c,r,a)}resetDuration(){const e=this.tracks;let t=0;for(let i=0,r=e.length;i!==r;++i){const s=this.tracks[i];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function vk(n){switch(n.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return ef;case"vector":case"vector2":case"vector3":case"vector4":return tf;case"color":return rx;case"quaternion":return hu;case"bool":case"boolean":return Ia;case"string":return Na}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+n)}function yk(n){if(n.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=vk(n.type);if(n.times===void 0){const t=[],i=[];nx(n.keys,t,i,"value"),n.times=t,n.values=i}return e.parse!==void 0?e.parse(n):new e(n.name,n.times,n.values,n.interpolation)}const As={enabled:!1,files:{},add:function(n,e){this.enabled!==!1&&(this.files[n]=e)},get:function(n){if(this.enabled!==!1)return this.files[n]},remove:function(n){delete this.files[n]},clear:function(){this.files={}}};class sx{constructor(e,t,i){const r=this;let s=!1,o=0,a=0,c;const f=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(d){a++,s===!1&&r.onStart!==void 0&&r.onStart(d,o,a),s=!0},this.itemEnd=function(d){o++,r.onProgress!==void 0&&r.onProgress(d,o,a),o===a&&(s=!1,r.onLoad!==void 0&&r.onLoad())},this.itemError=function(d){r.onError!==void 0&&r.onError(d)},this.resolveURL=function(d){return c?c(d):d},this.setURLModifier=function(d){return c=d,this},this.addHandler=function(d,h){return f.push(d,h),this},this.removeHandler=function(d){const h=f.indexOf(d);return h!==-1&&f.splice(h,2),this},this.getHandler=function(d){for(let h=0,m=f.length;h<m;h+=2){const v=f[h],y=f[h+1];if(v.global&&(v.lastIndex=0),v.test(d))return y}return null}}}const vC=new sx;class Bi{constructor(e){this.manager=e!==void 0?e:vC,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const i=this;return new Promise(function(r,s){i.load(e,r,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}Bi.DEFAULT_MATERIAL_NAME="__DEFAULT";const vs={};class _k extends Error{constructor(e,t){super(e),this.response=t}}class Us extends Bi{constructor(e){super(e)}load(e,t,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=As.get(e);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(vs[e]!==void 0){vs[e].push({onLoad:t,onProgress:i,onError:r});return}vs[e]=[],vs[e].push({onLoad:t,onProgress:i,onError:r});const o=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),a=this.mimeType,c=this.responseType;fetch(o).then(f=>{if(f.status===200||f.status===0){if(f.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||f.body===void 0||f.body.getReader===void 0)return f;const d=vs[e],h=f.body.getReader(),m=f.headers.get("Content-Length")||f.headers.get("X-File-Size"),v=m?parseInt(m):0,y=v!==0;let w=0;const x=new ReadableStream({start(g){S();function S(){h.read().then(({done:M,value:T})=>{if(M)g.close();else{w+=T.byteLength;const P=new ProgressEvent("progress",{lengthComputable:y,loaded:w,total:v});for(let b=0,L=d.length;b<L;b++){const O=d[b];O.onProgress&&O.onProgress(P)}g.enqueue(T),S()}})}}});return new Response(x)}else throw new _k(`fetch for "${f.url}" responded with ${f.status}: ${f.statusText}`,f)}).then(f=>{switch(c){case"arraybuffer":return f.arrayBuffer();case"blob":return f.blob();case"document":return f.text().then(d=>new DOMParser().parseFromString(d,a));case"json":return f.json();default:if(a===void 0)return f.text();{const h=/charset="?([^;"\s]*)"?/i.exec(a),m=h&&h[1]?h[1].toLowerCase():void 0,v=new TextDecoder(m);return f.arrayBuffer().then(y=>v.decode(y))}}}).then(f=>{As.add(e,f);const d=vs[e];delete vs[e];for(let h=0,m=d.length;h<m;h++){const v=d[h];v.onLoad&&v.onLoad(f)}}).catch(f=>{const d=vs[e];if(d===void 0)throw this.manager.itemError(e),f;delete vs[e];for(let h=0,m=d.length;h<m;h++){const v=d[h];v.onError&&v.onError(f)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class xk extends Bi{constructor(e){super(e)}load(e,t,i,r){const s=this,o=new Us(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(c){r?r(c):console.error(c),s.manager.itemError(e)}},i,r)}parse(e){const t=[];for(let i=0;i<e.length;i++){const r=nf.parse(e[i]);t.push(r)}return t}}class Sk extends Bi{constructor(e){super(e)}load(e,t,i,r){const s=this,o=[],a=new rm,c=new Us(this.manager);c.setPath(this.path),c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setWithCredentials(s.withCredentials);let f=0;function d(h){c.load(e[h],function(m){const v=s.parse(m,!0);o[h]={width:v.width,height:v.height,format:v.format,mipmaps:v.mipmaps},f+=1,f===6&&(v.mipmapCount===1&&(a.minFilter=fn),a.image=o,a.format=v.format,a.needsUpdate=!0,t&&t(a))},i,r)}if(Array.isArray(e))for(let h=0,m=e.length;h<m;++h)d(h);else c.load(e,function(h){const m=s.parse(h,!0);if(m.isCubemap){const v=m.mipmaps.length/m.mipmapCount;for(let y=0;y<v;y++){o[y]={mipmaps:[]};for(let w=0;w<m.mipmapCount;w++)o[y].mipmaps.push(m.mipmaps[y*m.mipmapCount+w]),o[y].format=m.format,o[y].width=m.width,o[y].height=m.height}a.image=o}else a.image.width=m.width,a.image.height=m.height,a.mipmaps=m.mipmaps;m.mipmapCount===1&&(a.minFilter=fn),a.format=m.format,a.needsUpdate=!0,t&&t(a)},i,r);return a}}class rf extends Bi{constructor(e){super(e)}load(e,t,i,r){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=As.get(e);if(o!==void 0)return s.manager.itemStart(e),setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o;const a=Zc("img");function c(){d(),As.add(e,this),t&&t(this),s.manager.itemEnd(e)}function f(h){d(),r&&r(h),s.manager.itemError(e),s.manager.itemEnd(e)}function d(){a.removeEventListener("load",c,!1),a.removeEventListener("error",f,!1)}return a.addEventListener("load",c,!1),a.addEventListener("error",f,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(a.crossOrigin=this.crossOrigin),s.manager.itemStart(e),a.src=e,a}}class Mk extends Bi{constructor(e){super(e)}load(e,t,i,r){const s=new mf;s.colorSpace=Un;const o=new rf(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);let a=0;function c(f){o.load(e[f],function(d){s.images[f]=d,a++,a===6&&(s.needsUpdate=!0,t&&t(s))},void 0,r)}for(let f=0;f<e.length;++f)c(f);return s}}class wk extends Bi{constructor(e){super(e)}load(e,t,i,r){const s=this,o=new va,a=new Us(this.manager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(s.withCredentials),a.load(e,function(c){let f;try{f=s.parse(c)}catch(d){if(r!==void 0)r(d);else{console.error(d);return}}f.image!==void 0?o.image=f.image:f.data!==void 0&&(o.image.width=f.width,o.image.height=f.height,o.image.data=f.data),o.wrapS=f.wrapS!==void 0?f.wrapS:fi,o.wrapT=f.wrapT!==void 0?f.wrapT:fi,o.magFilter=f.magFilter!==void 0?f.magFilter:fn,o.minFilter=f.minFilter!==void 0?f.minFilter:fn,o.anisotropy=f.anisotropy!==void 0?f.anisotropy:1,f.colorSpace!==void 0?o.colorSpace=f.colorSpace:f.encoding!==void 0&&(o.encoding=f.encoding),f.flipY!==void 0&&(o.flipY=f.flipY),f.format!==void 0&&(o.format=f.format),f.type!==void 0&&(o.type=f.type),f.mipmaps!==void 0&&(o.mipmaps=f.mipmaps,o.minFilter=wo),f.mipmapCount===1&&(o.minFilter=fn),f.generateMipmaps!==void 0&&(o.generateMipmaps=f.generateMipmaps),o.needsUpdate=!0,t&&t(o,f)},i,r),o}}class Ek extends Bi{constructor(e){super(e)}load(e,t,i,r){const s=new bn,o=new rf(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(e,function(a){s.image=a,s.needsUpdate=!0,t!==void 0&&t(s)},i,r),s}}class Lo extends Wt{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new nt(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}}class yC extends Lo{constructor(e,t,i){super(e,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Wt.DEFAULT_UP),this.updateMatrix(),this.groundColor=new nt(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}const R0=new Mt,Sw=new k,Mw=new k;class ox{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new be(512,512),this.map=null,this.mapPass=null,this.matrix=new Mt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new gf,this._frameExtents=new be(1,1),this._viewportCount=1,this._viewports=[new qt(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,i=this.matrix;Sw.setFromMatrixPosition(e.matrixWorld),t.position.copy(Sw),Mw.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(Mw),t.updateMatrixWorld(),R0.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(R0),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(R0)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class Tk extends ox{constructor(){super(new dn(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){const t=this.camera,i=iu*2*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,s=e.distance||t.far;(i!==t.fov||r!==t.aspect||s!==t.far)&&(t.fov=i,t.aspect=r,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class _C extends Lo{constructor(e,t,i=0,r=Math.PI/3,s=0,o=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Wt.DEFAULT_UP),this.updateMatrix(),this.target=new Wt,this.distance=i,this.angle=r,this.penumbra=s,this.decay=o,this.map=null,this.shadow=new Tk}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}const ww=new Mt,Ju=new k,P0=new k;class Ak extends ox{constructor(){super(new dn(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new be(4,2),this._viewportCount=6,this._viewports=[new qt(2,1,1,1),new qt(0,1,1,1),new qt(3,1,1,1),new qt(1,1,1,1),new qt(3,0,1,1),new qt(1,0,1,1)],this._cubeDirections=[new k(1,0,0),new k(-1,0,0),new k(0,0,1),new k(0,0,-1),new k(0,1,0),new k(0,-1,0)],this._cubeUps=[new k(0,1,0),new k(0,1,0),new k(0,1,0),new k(0,1,0),new k(0,0,1),new k(0,0,-1)]}updateMatrices(e,t=0){const i=this.camera,r=this.matrix,s=e.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),Ju.setFromMatrixPosition(e.matrixWorld),i.position.copy(Ju),P0.copy(i.position),P0.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(P0),i.updateMatrixWorld(),r.makeTranslation(-Ju.x,-Ju.y,-Ju.z),ww.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(ww)}}class xC extends Lo{constructor(e,t,i=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new Ak}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class bk extends ox{constructor(){super(new ns(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class SC extends Lo{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Wt.DEFAULT_UP),this.updateMatrix(),this.target=new Wt,this.shadow=new bk}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class MC extends Lo{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class wC extends Lo{constructor(e,t,i=10,r=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=i,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class EC{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new k)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const i=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.282095),t.addScaledVector(o[1],.488603*r),t.addScaledVector(o[2],.488603*s),t.addScaledVector(o[3],.488603*i),t.addScaledVector(o[4],1.092548*(i*r)),t.addScaledVector(o[5],1.092548*(r*s)),t.addScaledVector(o[6],.315392*(3*s*s-1)),t.addScaledVector(o[7],1.092548*(i*s)),t.addScaledVector(o[8],.546274*(i*i-r*r)),t}getIrradianceAt(e,t){const i=e.x,r=e.y,s=e.z,o=this.coefficients;return t.copy(o[0]).multiplyScalar(.886227),t.addScaledVector(o[1],2*.511664*r),t.addScaledVector(o[2],2*.511664*s),t.addScaledVector(o[3],2*.511664*i),t.addScaledVector(o[4],2*.429043*i*r),t.addScaledVector(o[5],2*.429043*r*s),t.addScaledVector(o[6],.743125*s*s-.247708),t.addScaledVector(o[7],2*.429043*i*s),t.addScaledVector(o[8],.429043*(i*i-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let i=0;i<9;i++)this.coefficients[i].addScaledVector(e.coefficients[i],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let i=0;i<9;i++)this.coefficients[i].lerp(e.coefficients[i],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].fromArray(e,t+r*3);return this}toArray(e=[],t=0){const i=this.coefficients;for(let r=0;r<9;r++)i[r].toArray(e,t+r*3);return e}static getBasisAt(e,t){const i=e.x,r=e.y,s=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*s,t[3]=.488603*i,t[4]=1.092548*i*r,t[5]=1.092548*r*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*i*s,t[8]=.546274*(i*i-r*r)}}class TC extends Lo{constructor(e=new EC,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class _m extends Bi{constructor(e){super(e),this.textures={}}load(e,t,i,r){const s=this,o=new Us(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(c){r?r(c):console.error(c),s.manager.itemError(e)}},i,r)}parse(e){const t=this.textures;function i(s){return t[s]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",s),t[s]}const r=_m.createMaterialFromType(e.type);if(e.uuid!==void 0&&(r.uuid=e.uuid),e.name!==void 0&&(r.name=e.name),e.color!==void 0&&r.color!==void 0&&r.color.setHex(e.color),e.roughness!==void 0&&(r.roughness=e.roughness),e.metalness!==void 0&&(r.metalness=e.metalness),e.sheen!==void 0&&(r.sheen=e.sheen),e.sheenColor!==void 0&&(r.sheenColor=new nt().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(r.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&r.emissive!==void 0&&r.emissive.setHex(e.emissive),e.specular!==void 0&&r.specular!==void 0&&r.specular.setHex(e.specular),e.specularIntensity!==void 0&&(r.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&r.specularColor!==void 0&&r.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(r.shininess=e.shininess),e.clearcoat!==void 0&&(r.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(r.clearcoatRoughness=e.clearcoatRoughness),e.iridescence!==void 0&&(r.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(r.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(r.transmission=e.transmission),e.thickness!==void 0&&(r.thickness=e.thickness),e.attenuationDistance!==void 0&&(r.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&r.attenuationColor!==void 0&&r.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(r.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(r.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(r.fog=e.fog),e.flatShading!==void 0&&(r.flatShading=e.flatShading),e.blending!==void 0&&(r.blending=e.blending),e.combine!==void 0&&(r.combine=e.combine),e.side!==void 0&&(r.side=e.side),e.shadowSide!==void 0&&(r.shadowSide=e.shadowSide),e.opacity!==void 0&&(r.opacity=e.opacity),e.transparent!==void 0&&(r.transparent=e.transparent),e.alphaTest!==void 0&&(r.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(r.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(r.depthFunc=e.depthFunc),e.depthTest!==void 0&&(r.depthTest=e.depthTest),e.depthWrite!==void 0&&(r.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(r.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(r.blendSrc=e.blendSrc),e.blendDst!==void 0&&(r.blendDst=e.blendDst),e.blendEquation!==void 0&&(r.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(r.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(r.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(r.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&r.blendColor!==void 0&&r.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(r.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(r.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(r.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(r.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(r.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(r.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(r.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(r.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(r.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(r.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(r.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(r.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(r.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(r.rotation=e.rotation),e.linewidth!==void 0&&(r.linewidth=e.linewidth),e.dashSize!==void 0&&(r.dashSize=e.dashSize),e.gapSize!==void 0&&(r.gapSize=e.gapSize),e.scale!==void 0&&(r.scale=e.scale),e.polygonOffset!==void 0&&(r.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(r.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(r.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(r.dithering=e.dithering),e.alphaToCoverage!==void 0&&(r.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(r.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(r.forceSinglePass=e.forceSinglePass),e.visible!==void 0&&(r.visible=e.visible),e.toneMapped!==void 0&&(r.toneMapped=e.toneMapped),e.userData!==void 0&&(r.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const s in e.uniforms){const o=e.uniforms[s];switch(r.uniforms[s]={},o.type){case"t":r.uniforms[s].value=i(o.value);break;case"c":r.uniforms[s].value=new nt().setHex(o.value);break;case"v2":r.uniforms[s].value=new be().fromArray(o.value);break;case"v3":r.uniforms[s].value=new k().fromArray(o.value);break;case"v4":r.uniforms[s].value=new qt().fromArray(o.value);break;case"m3":r.uniforms[s].value=new Nt().fromArray(o.value);break;case"m4":r.uniforms[s].value=new Mt().fromArray(o.value);break;default:r.uniforms[s].value=o.value}}if(e.defines!==void 0&&(r.defines=e.defines),e.vertexShader!==void 0&&(r.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(r.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(r.glslVersion=e.glslVersion),e.extensions!==void 0)for(const s in e.extensions)r.extensions[s]=e.extensions[s];if(e.lights!==void 0&&(r.lights=e.lights),e.clipping!==void 0&&(r.clipping=e.clipping),e.size!==void 0&&(r.size=e.size),e.sizeAttenuation!==void 0&&(r.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(r.map=i(e.map)),e.matcap!==void 0&&(r.matcap=i(e.matcap)),e.alphaMap!==void 0&&(r.alphaMap=i(e.alphaMap)),e.bumpMap!==void 0&&(r.bumpMap=i(e.bumpMap)),e.bumpScale!==void 0&&(r.bumpScale=e.bumpScale),e.normalMap!==void 0&&(r.normalMap=i(e.normalMap)),e.normalMapType!==void 0&&(r.normalMapType=e.normalMapType),e.normalScale!==void 0){let s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),r.normalScale=new be().fromArray(s)}return e.displacementMap!==void 0&&(r.displacementMap=i(e.displacementMap)),e.displacementScale!==void 0&&(r.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(r.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(r.roughnessMap=i(e.roughnessMap)),e.metalnessMap!==void 0&&(r.metalnessMap=i(e.metalnessMap)),e.emissiveMap!==void 0&&(r.emissiveMap=i(e.emissiveMap)),e.emissiveIntensity!==void 0&&(r.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(r.specularMap=i(e.specularMap)),e.specularIntensityMap!==void 0&&(r.specularIntensityMap=i(e.specularIntensityMap)),e.specularColorMap!==void 0&&(r.specularColorMap=i(e.specularColorMap)),e.envMap!==void 0&&(r.envMap=i(e.envMap)),e.envMapIntensity!==void 0&&(r.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(r.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(r.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(r.lightMap=i(e.lightMap)),e.lightMapIntensity!==void 0&&(r.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(r.aoMap=i(e.aoMap)),e.aoMapIntensity!==void 0&&(r.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(r.gradientMap=i(e.gradientMap)),e.clearcoatMap!==void 0&&(r.clearcoatMap=i(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(r.clearcoatRoughnessMap=i(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(r.clearcoatNormalMap=i(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(r.clearcoatNormalScale=new be().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(r.iridescenceMap=i(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(r.iridescenceThicknessMap=i(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(r.transmissionMap=i(e.transmissionMap)),e.thicknessMap!==void 0&&(r.thicknessMap=i(e.thicknessMap)),e.anisotropyMap!==void 0&&(r.anisotropyMap=i(e.anisotropyMap)),e.sheenColorMap!==void 0&&(r.sheenColorMap=i(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(r.sheenRoughnessMap=i(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){const t={ShadowMaterial:iC,SpriteMaterial:j_,RawShaderMaterial:rC,ShaderMaterial:kr,PointsMaterial:q_,MeshPhysicalMaterial:sC,MeshStandardMaterial:tx,MeshPhongMaterial:oC,MeshToonMaterial:aC,MeshNormalMaterial:lC,MeshLambertMaterial:uC,MeshDepthMaterial:V_,MeshDistanceMaterial:G_,MeshBasicMaterial:Ro,MeshMatcapMaterial:cC,LineDashedMaterial:fC,LineBasicMaterial:Ci,Material:mi};return new t[e]}}class Sy{static decodeText(e){if(typeof TextDecoder<"u")return new TextDecoder().decode(e);let t="";for(let i=0,r=e.length;i<r;i++)t+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(t))}catch{return t}}static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class AC extends Dt{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class bC extends Bi{constructor(e){super(e)}load(e,t,i,r){const s=this,o=new Us(s.manager);o.setPath(s.path),o.setRequestHeader(s.requestHeader),o.setWithCredentials(s.withCredentials),o.load(e,function(a){try{t(s.parse(JSON.parse(a)))}catch(c){r?r(c):console.error(c),s.manager.itemError(e)}},i,r)}parse(e){const t={},i={};function r(v,y){if(t[y]!==void 0)return t[y];const x=v.interleavedBuffers[y],g=s(v,x.buffer),S=Ol(x.type,g),M=new nm(S,x.stride);return M.uuid=x.uuid,t[y]=M,M}function s(v,y){if(i[y]!==void 0)return i[y];const x=v.arrayBuffers[y],g=new Uint32Array(x).buffer;return i[y]=g,g}const o=e.isInstancedBufferGeometry?new AC:new Dt,a=e.data.index;if(a!==void 0){const v=Ol(a.type,a.array);o.setIndex(new Kt(v,1))}const c=e.data.attributes;for(const v in c){const y=c[v];let w;if(y.isInterleavedBufferAttribute){const x=r(e.data,y.data);w=new Aa(x,y.itemSize,y.offset,y.normalized)}else{const x=Ol(y.type,y.array),g=y.isInstancedBufferAttribute?su:Kt;w=new g(x,y.itemSize,y.normalized)}y.name!==void 0&&(w.name=y.name),y.usage!==void 0&&w.setUsage(y.usage),o.setAttribute(v,w)}const f=e.data.morphAttributes;if(f)for(const v in f){const y=f[v],w=[];for(let x=0,g=y.length;x<g;x++){const S=y[x];let M;if(S.isInterleavedBufferAttribute){const T=r(e.data,S.data);M=new Aa(T,S.itemSize,S.offset,S.normalized)}else{const T=Ol(S.type,S.array);M=new Kt(T,S.itemSize,S.normalized)}S.name!==void 0&&(M.name=S.name),w.push(M)}o.morphAttributes[v]=w}e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0);const h=e.data.groups||e.data.drawcalls||e.data.offsets;if(h!==void 0)for(let v=0,y=h.length;v!==y;++v){const w=h[v];o.addGroup(w.start,w.count,w.materialIndex)}const m=e.data.boundingSphere;if(m!==void 0){const v=new k;m.center!==void 0&&v.fromArray(m.center),o.boundingSphere=new hi(v,m.radius)}return e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}}class Ck extends Bi{constructor(e){super(e)}load(e,t,i,r){const s=this,o=this.path===""?Sy.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||o;const a=new Us(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(c){let f=null;try{f=JSON.parse(c)}catch(h){r!==void 0&&r(h),console.error("THREE:ObjectLoader: Can't parse "+e+".",h.message);return}const d=f.metadata;if(d===void 0||d.type===void 0||d.type.toLowerCase()==="geometry"){r!==void 0&&r(new Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}s.parse(f,t)},i,r)}async loadAsync(e,t){const i=this,r=this.path===""?Sy.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||r;const s=new Us(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);const o=await s.loadAsync(e,t),a=JSON.parse(o),c=a.metadata;if(c===void 0||c.type===void 0||c.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await i.parseAsync(a)}parse(e,t){const i=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,r),o=this.parseImages(e.images,function(){t!==void 0&&t(f)}),a=this.parseTextures(e.textures,o),c=this.parseMaterials(e.materials,a),f=this.parseObject(e.object,s,c,a,i),d=this.parseSkeletons(e.skeletons,f);if(this.bindSkeletons(f,d),t!==void 0){let h=!1;for(const m in o)if(o[m].data instanceof HTMLImageElement){h=!0;break}h===!1&&t(f)}return f}async parseAsync(e){const t=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,i),s=await this.parseImagesAsync(e.images),o=this.parseTextures(e.textures,s),a=this.parseMaterials(e.materials,o),c=this.parseObject(e.object,r,a,o,t),f=this.parseSkeletons(e.skeletons,c);return this.bindSkeletons(c,f),c}parseShapes(e){const t={};if(e!==void 0)for(let i=0,r=e.length;i<r;i++){const s=new ya().fromJSON(e[i]);t[s.uuid]=s}return t}parseSkeletons(e,t){const i={},r={};if(t.traverse(function(s){s.isBone&&(r[s.uuid]=s)}),e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=new im().fromJSON(e[s],r);i[a.uuid]=a}return i}parseGeometries(e,t){const i={};if(e!==void 0){const r=new bC;for(let s=0,o=e.length;s<o;s++){let a;const c=e[s];switch(c.type){case"BufferGeometry":case"InstancedBufferGeometry":a=r.parse(c);break;default:c.type in xw?a=xw[c.type].fromJSON(c,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${c.type}"`)}a.uuid=c.uuid,c.name!==void 0&&(a.name=c.name),c.userData!==void 0&&(a.userData=c.userData),i[c.uuid]=a}}return i}parseMaterials(e,t){const i={},r={};if(e!==void 0){const s=new _m;s.setTextures(t);for(let o=0,a=e.length;o<a;o++){const c=e[o];i[c.uuid]===void 0&&(i[c.uuid]=s.parse(c)),r[c.uuid]=i[c.uuid]}}return r}parseAnimations(e){const t={};if(e!==void 0)for(let i=0;i<e.length;i++){const r=e[i],s=nf.parse(r);t[s.uuid]=s}return t}parseImages(e,t){const i=this,r={};let s;function o(c){return i.manager.itemStart(c),s.load(c,function(){i.manager.itemEnd(c)},void 0,function(){i.manager.itemError(c),i.manager.itemEnd(c)})}function a(c){if(typeof c=="string"){const f=c,d=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(f)?f:i.resourcePath+f;return o(d)}else return c.data?{data:Ol(c.type,c.data),width:c.width,height:c.height}:null}if(e!==void 0&&e.length>0){const c=new sx(t);s=new rf(c),s.setCrossOrigin(this.crossOrigin);for(let f=0,d=e.length;f<d;f++){const h=e[f],m=h.url;if(Array.isArray(m)){const v=[];for(let y=0,w=m.length;y<w;y++){const x=m[y],g=a(x);g!==null&&(g instanceof HTMLImageElement?v.push(g):v.push(new va(g.data,g.width,g.height)))}r[h.uuid]=new ca(v)}else{const v=a(h.url);r[h.uuid]=new ca(v)}}}return r}async parseImagesAsync(e){const t=this,i={};let r;async function s(o){if(typeof o=="string"){const a=o,c=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(a)?a:t.resourcePath+a;return await r.loadAsync(c)}else return o.data?{data:Ol(o.type,o.data),width:o.width,height:o.height}:null}if(e!==void 0&&e.length>0){r=new rf(this.manager),r.setCrossOrigin(this.crossOrigin);for(let o=0,a=e.length;o<a;o++){const c=e[o],f=c.url;if(Array.isArray(f)){const d=[];for(let h=0,m=f.length;h<m;h++){const v=f[h],y=await s(v);y!==null&&(y instanceof HTMLImageElement?d.push(y):d.push(new va(y.data,y.width,y.height)))}i[c.uuid]=new ca(d)}else{const d=await s(c.url);i[c.uuid]=new ca(d)}}}return i}parseTextures(e,t){function i(s,o){return typeof s=="number"?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),o[s])}const r={};if(e!==void 0)for(let s=0,o=e.length;s<o;s++){const a=e[s];a.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),t[a.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",a.image);const c=t[a.image],f=c.data;let d;Array.isArray(f)?(d=new mf,f.length===6&&(d.needsUpdate=!0)):(f&&f.data?d=new va:d=new bn,f&&(d.needsUpdate=!0)),d.source=c,d.uuid=a.uuid,a.name!==void 0&&(d.name=a.name),a.mapping!==void 0&&(d.mapping=i(a.mapping,Rk)),a.channel!==void 0&&(d.channel=a.channel),a.offset!==void 0&&d.offset.fromArray(a.offset),a.repeat!==void 0&&d.repeat.fromArray(a.repeat),a.center!==void 0&&d.center.fromArray(a.center),a.rotation!==void 0&&(d.rotation=a.rotation),a.wrap!==void 0&&(d.wrapS=i(a.wrap[0],Ew),d.wrapT=i(a.wrap[1],Ew)),a.format!==void 0&&(d.format=a.format),a.internalFormat!==void 0&&(d.internalFormat=a.internalFormat),a.type!==void 0&&(d.type=a.type),a.colorSpace!==void 0&&(d.colorSpace=a.colorSpace),a.encoding!==void 0&&(d.encoding=a.encoding),a.minFilter!==void 0&&(d.minFilter=i(a.minFilter,Tw)),a.magFilter!==void 0&&(d.magFilter=i(a.magFilter,Tw)),a.anisotropy!==void 0&&(d.anisotropy=a.anisotropy),a.flipY!==void 0&&(d.flipY=a.flipY),a.generateMipmaps!==void 0&&(d.generateMipmaps=a.generateMipmaps),a.premultiplyAlpha!==void 0&&(d.premultiplyAlpha=a.premultiplyAlpha),a.unpackAlignment!==void 0&&(d.unpackAlignment=a.unpackAlignment),a.compareFunction!==void 0&&(d.compareFunction=a.compareFunction),a.userData!==void 0&&(d.userData=a.userData),r[a.uuid]=d}return r}parseObject(e,t,i,r,s){let o;function a(m){return t[m]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",m),t[m]}function c(m){if(m!==void 0){if(Array.isArray(m)){const v=[];for(let y=0,w=m.length;y<w;y++){const x=m[y];i[x]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",x),v.push(i[x])}return v}return i[m]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",m),i[m]}}function f(m){return r[m]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",m),r[m]}let d,h;switch(e.type){case"Scene":o=new X_,e.background!==void 0&&(Number.isInteger(e.background)?o.background=new nt(e.background):o.background=f(e.background)),e.environment!==void 0&&(o.environment=f(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?o.fog=new tm(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(o.fog=new em(e.fog.color,e.fog.density)),e.fog.name!==""&&(o.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(o.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(o.backgroundIntensity=e.backgroundIntensity);break;case"PerspectiveCamera":o=new dn(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(o.focus=e.focus),e.zoom!==void 0&&(o.zoom=e.zoom),e.filmGauge!==void 0&&(o.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(o.filmOffset=e.filmOffset),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"OrthographicCamera":o=new ns(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(o.zoom=e.zoom),e.view!==void 0&&(o.view=Object.assign({},e.view));break;case"AmbientLight":o=new MC(e.color,e.intensity);break;case"DirectionalLight":o=new SC(e.color,e.intensity);break;case"PointLight":o=new xC(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":o=new wC(e.color,e.intensity,e.width,e.height);break;case"SpotLight":o=new _C(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":o=new yC(e.color,e.groundColor,e.intensity);break;case"LightProbe":o=new TC().fromJSON(e);break;case"SkinnedMesh":d=a(e.geometry),h=c(e.material),o=new Vb(d,h),e.bindMode!==void 0&&(o.bindMode=e.bindMode),e.bindMatrix!==void 0&&o.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(o.skeleton=e.skeleton);break;case"Mesh":d=a(e.geometry),h=c(e.material),o=new kn(d,h);break;case"InstancedMesh":d=a(e.geometry),h=c(e.material);const m=e.count,v=e.instanceMatrix,y=e.instanceColor;o=new Gb(d,h,m),o.instanceMatrix=new su(new Float32Array(v.array),16),y!==void 0&&(o.instanceColor=new su(new Float32Array(y.array),y.itemSize));break;case"BatchedMesh":d=a(e.geometry),h=c(e.material),o=new Wb(e.maxGeometryCount,e.maxVertexCount,e.maxIndexCount,h),o.geometry=d,o.perObjectFrustumCulled=e.perObjectFrustumCulled,o.sortObjects=e.sortObjects,o._drawRanges=e.drawRanges,o._reservedRanges=e.reservedRanges,o._visibility=e.visibility,o._active=e.active,o._bounds=e.bounds.map(w=>{const x=new Ti;x.min.fromArray(w.boxMin),x.max.fromArray(w.boxMax);const g=new hi;return g.radius=w.sphereRadius,g.center.fromArray(w.sphereCenter),{boxInitialized:w.boxInitialized,box:x,sphereInitialized:w.sphereInitialized,sphere:g}}),o._maxGeometryCount=e.maxGeometryCount,o._maxVertexCount=e.maxVertexCount,o._maxIndexCount=e.maxIndexCount,o._geometryInitialized=e.geometryInitialized,o._geometryCount=e.geometryCount,o._matricesTexture=f(e.matricesTexture.uuid);break;case"LOD":o=new Hb;break;case"Line":o=new Eo(a(e.geometry),c(e.material));break;case"LineLoop":o=new Xb(a(e.geometry),c(e.material));break;case"LineSegments":o=new ss(a(e.geometry),c(e.material));break;case"PointCloud":case"Points":o=new jb(a(e.geometry),c(e.material));break;case"Sprite":o=new Bb(c(e.material));break;case"Group":o=new zl;break;case"Bone":o=new Y_;break;default:o=new Wt}if(o.uuid=e.uuid,e.name!==void 0&&(o.name=e.name),e.matrix!==void 0?(o.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(o.matrixAutoUpdate=e.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(e.position!==void 0&&o.position.fromArray(e.position),e.rotation!==void 0&&o.rotation.fromArray(e.rotation),e.quaternion!==void 0&&o.quaternion.fromArray(e.quaternion),e.scale!==void 0&&o.scale.fromArray(e.scale)),e.up!==void 0&&o.up.fromArray(e.up),e.castShadow!==void 0&&(o.castShadow=e.castShadow),e.receiveShadow!==void 0&&(o.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(o.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(o.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(o.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&o.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(o.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(o.visible=e.visible),e.frustumCulled!==void 0&&(o.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(o.renderOrder=e.renderOrder),e.userData!==void 0&&(o.userData=e.userData),e.layers!==void 0&&(o.layers.mask=e.layers),e.children!==void 0){const m=e.children;for(let v=0;v<m.length;v++)o.add(this.parseObject(m[v],t,i,r,s))}if(e.animations!==void 0){const m=e.animations;for(let v=0;v<m.length;v++){const y=m[v];o.animations.push(s[y])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(o.autoUpdate=e.autoUpdate);const m=e.levels;for(let v=0;v<m.length;v++){const y=m[v],w=o.getObjectByProperty("uuid",y.object);w!==void 0&&o.addLevel(w,y.distance,y.hysteresis)}}return o}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(i){if(i.isSkinnedMesh===!0&&i.skeleton!==void 0){const r=t[i.skeleton];r===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",i.skeleton):i.bind(r,i.bindMatrix)}})}}const Rk={UVMapping:Yp,CubeReflectionMapping:Ds,CubeRefractionMapping:Mo,EquirectangularReflectionMapping:Fc,EquirectangularRefractionMapping:zc,CubeUVReflectionMapping:cu},Ew={RepeatWrapping:Bc,ClampToEdgeWrapping:fi,MirroredRepeatWrapping:Hc},Tw={NearestFilter:Tn,NearestMipmapNearestFilter:Ep,NearestMipmapLinearFilter:mc,LinearFilter:fn,LinearMipmapNearestFilter:w_,LinearMipmapLinearFilter:wo};class Pk extends Bi{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,i,r){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,o=As.get(e);if(o!==void 0){if(s.manager.itemStart(e),o.then){o.then(f=>{t&&t(f),s.manager.itemEnd(e)}).catch(f=>{r&&r(f)});return}return setTimeout(function(){t&&t(o),s.manager.itemEnd(e)},0),o}const a={};a.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",a.headers=this.requestHeader;const c=fetch(e,a).then(function(f){return f.blob()}).then(function(f){return createImageBitmap(f,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(f){return As.add(e,f),t&&t(f),s.manager.itemEnd(e),f}).catch(function(f){r&&r(f),As.remove(e),s.manager.itemError(e),s.manager.itemEnd(e)});As.add(e,c),s.manager.itemStart(e)}}let xh;class ax{static getContext(){return xh===void 0&&(xh=new(window.AudioContext||window.webkitAudioContext)),xh}static setContext(e){xh=e}}class Lk extends Bi{constructor(e){super(e)}load(e,t,i,r){const s=this,o=new Us(this.manager);o.setResponseType("arraybuffer"),o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(c){try{const f=c.slice(0);ax.getContext().decodeAudioData(f,function(h){t(h)}).catch(a)}catch(f){a(f)}},i,r);function a(c){r?r(c):console.error(c),s.manager.itemError(e)}}}const Aw=new Mt,bw=new Mt,jo=new Mt;class Ik{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new dn,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new dn,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,jo.copy(e.projectionMatrix);const r=t.eyeSep/2,s=r*t.near/t.focus,o=t.near*Math.tan(ma*t.fov*.5)/t.zoom;let a,c;bw.elements[12]=-r,Aw.elements[12]=r,a=-o*t.aspect+s,c=o*t.aspect+s,jo.elements[0]=2*t.near/(c-a),jo.elements[8]=(c+a)/(c-a),this.cameraL.projectionMatrix.copy(jo),a=-o*t.aspect-s,c=o*t.aspect-s,jo.elements[0]=2*t.near/(c-a),jo.elements[8]=(c+a)/(c-a),this.cameraR.projectionMatrix.copy(jo)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(bw),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(Aw)}}class lx{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=Cw(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=Cw();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function Cw(){return(typeof performance>"u"?Date:performance).now()}const Yo=new k,Rw=new di,Nk=new k,qo=new k;class Dk extends Wt{constructor(){super(),this.type="AudioListener",this.context=ax.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new lx}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener,i=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Yo,Rw,Nk),qo.set(0,0,-1).applyQuaternion(Rw),t.positionX){const r=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(Yo.x,r),t.positionY.linearRampToValueAtTime(Yo.y,r),t.positionZ.linearRampToValueAtTime(Yo.z,r),t.forwardX.linearRampToValueAtTime(qo.x,r),t.forwardY.linearRampToValueAtTime(qo.y,r),t.forwardZ.linearRampToValueAtTime(qo.z,r),t.upX.linearRampToValueAtTime(i.x,r),t.upY.linearRampToValueAtTime(i.y,r),t.upZ.linearRampToValueAtTime(i.z,r)}else t.setPosition(Yo.x,Yo.y,Yo.z),t.setOrientation(qo.x,qo.y,qo.z,i.x,i.y,i.z)}}class CC extends Wt{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}const Zo=new k,Pw=new di,Uk=new k,Ko=new k;class Ok extends CC{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,i){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=i,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Zo,Pw,Uk),Ko.set(0,0,1).applyQuaternion(Pw);const t=this.panner;if(t.positionX){const i=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Zo.x,i),t.positionY.linearRampToValueAtTime(Zo.y,i),t.positionZ.linearRampToValueAtTime(Zo.z,i),t.orientationX.linearRampToValueAtTime(Ko.x,i),t.orientationY.linearRampToValueAtTime(Ko.y,i),t.orientationZ.linearRampToValueAtTime(Ko.z,i)}else t.setPosition(Zo.x,Zo.y,Zo.z),t.setOrientation(Ko.x,Ko.y,Ko.z)}}class kk{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let i=0;i<t.length;i++)e+=t[i];return e/t.length}}class RC{constructor(e,t,i){this.binding=e,this.valueSize=i;let r,s,o;switch(t){case"quaternion":r=this._slerp,s=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(i*6),this._workIndex=5;break;case"string":case"bool":r=this._select,s=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(i*5);break;default:r=this._lerp,s=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(i*5)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=s,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const i=this.buffer,r=this.valueSize,s=e*r+r;let o=this.cumulativeWeight;if(o===0){for(let a=0;a!==r;++a)i[s+a]=i[a];o=t}else{o+=t;const a=t/o;this._mixBufferRegion(i,s,0,a,r)}this.cumulativeWeight=o}accumulateAdditive(e){const t=this.buffer,i=this.valueSize,r=i*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,i),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,i=this.buffer,r=e*t+t,s=this.cumulativeWeight,o=this.cumulativeWeightAdditive,a=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const c=t*this._origIndex;this._mixBufferRegion(i,r,c,1-s,t)}o>0&&this._mixBufferRegionAdditive(i,r,this._addIndex*t,1,t);for(let c=t,f=t+t;c!==f;++c)if(i[c]!==i[c+t]){a.setValue(i,r);break}}saveOriginalState(){const e=this.binding,t=this.buffer,i=this.valueSize,r=i*this._origIndex;e.getValue(t,r);for(let s=i,o=r;s!==o;++s)t[s]=t[r+s%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let i=e;i<t;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[t+i]=this.buffer[e+i]}_select(e,t,i,r,s){if(r>=.5)for(let o=0;o!==s;++o)e[t+o]=e[i+o]}_slerp(e,t,i,r){di.slerpFlat(e,t,e,t,e,i,r)}_slerpAdditive(e,t,i,r,s){const o=this._workIndex*s;di.multiplyQuaternionsFlat(e,o,e,t,e,i),di.slerpFlat(e,t,e,t,e,o,r)}_lerp(e,t,i,r,s){const o=1-r;for(let a=0;a!==s;++a){const c=t+a;e[c]=e[c]*o+e[i+a]*r}}_lerpAdditive(e,t,i,r,s){for(let o=0;o!==s;++o){const a=t+o;e[a]=e[a]+e[i+o]*r}}}const ux="\\[\\]\\.:\\/",Fk=new RegExp("["+ux+"]","g"),cx="[^"+ux+"]",zk="[^"+ux.replace("\\.","")+"]",Bk=/((?:WC+[\/:])*)/.source.replace("WC",cx),Hk=/(WCOD+)?/.source.replace("WCOD",zk),Vk=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",cx),Gk=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",cx),Wk=new RegExp("^"+Bk+Hk+Vk+Gk+"$"),Xk=["material","materials","bones","map"];class jk{constructor(e,t,i){const r=i||zt.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();const i=this._targetGroup.nCachedObjects_,r=this._bindings[i];r!==void 0&&r.getValue(e,t)}setValue(e,t){const i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,s=i.length;r!==s;++r)i[r].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}}class zt{constructor(e,t,i){this.path=t,this.parsedPath=i||zt.parseTrackName(t),this.node=zt.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,i){return e&&e.isAnimationObjectGroup?new zt.Composite(e,t,i):new zt(e,t,i)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(Fk,"")}static parseTrackName(e){const t=Wk.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const i={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=i.nodeName&&i.nodeName.lastIndexOf(".");if(r!==void 0&&r!==-1){const s=i.nodeName.substring(r+1);Xk.indexOf(s)!==-1&&(i.nodeName=i.nodeName.substring(0,r),i.objectName=s)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const i=e.skeleton.getBoneByName(t);if(i!==void 0)return i}if(e.children){const i=function(s){for(let o=0;o<s.length;o++){const a=s[o];if(a.name===t||a.uuid===t)return a;const c=i(a.children);if(c)return c}return null},r=i(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)e[t++]=i[r]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const i=this.resolvedProperty;for(let r=0,s=i.length;r!==s;++r)i[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,i=t.objectName,r=t.propertyName;let s=t.propertyIndex;if(e||(e=zt.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(i){let f=t.objectIndex;switch(i){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let d=0;d<e.length;d++)if(e[d].name===f){f=d;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[i]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[i]}if(f!==void 0){if(e[f]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[f]}}const o=e[r];if(o===void 0){const f=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+f+"."+r+" but it wasn't found.",e);return}let a=this.Versioning.None;this.targetObject=e,e.needsUpdate!==void 0?a=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(a=this.Versioning.MatrixWorldNeedsUpdate);let c=this.BindingType.Direct;if(s!==void 0){if(r==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}c=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=s}else o.fromArray!==void 0&&o.toArray!==void 0?(c=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(c=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=r;this.getValue=this.GetterByBindingType[c],this.setValue=this.SetterByBindingTypeAndVersioning[c][a]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}zt.Composite=jk;zt.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};zt.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};zt.prototype.GetterByBindingType=[zt.prototype._getValue_direct,zt.prototype._getValue_array,zt.prototype._getValue_arrayElement,zt.prototype._getValue_toArray];zt.prototype.SetterByBindingTypeAndVersioning=[[zt.prototype._setValue_direct,zt.prototype._setValue_direct_setNeedsUpdate,zt.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[zt.prototype._setValue_array,zt.prototype._setValue_array_setNeedsUpdate,zt.prototype._setValue_array_setMatrixWorldNeedsUpdate],[zt.prototype._setValue_arrayElement,zt.prototype._setValue_arrayElement_setNeedsUpdate,zt.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[zt.prototype._setValue_fromArray,zt.prototype._setValue_fromArray_setNeedsUpdate,zt.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class Yk{constructor(){this.isAnimationObjectGroup=!0,this.uuid=er(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let i=0,r=arguments.length;i!==r;++i)e[arguments[i].uuid]=i;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,i=this._paths,r=this._parsedPaths,s=this._bindings,o=s.length;let a,c=e.length,f=this.nCachedObjects_;for(let d=0,h=arguments.length;d!==h;++d){const m=arguments[d],v=m.uuid;let y=t[v];if(y===void 0){y=c++,t[v]=y,e.push(m);for(let w=0,x=o;w!==x;++w)s[w].push(new zt(m,i[w],r[w]))}else if(y<f){a=e[y];const w=--f,x=e[w];t[x.uuid]=y,e[y]=x,t[v]=w,e[w]=m;for(let g=0,S=o;g!==S;++g){const M=s[g],T=M[w];let P=M[y];M[y]=T,P===void 0&&(P=new zt(m,i[g],r[g])),M[w]=P}}else e[y]!==a&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=f}remove(){const e=this._objects,t=this._indicesByUUID,i=this._bindings,r=i.length;let s=this.nCachedObjects_;for(let o=0,a=arguments.length;o!==a;++o){const c=arguments[o],f=c.uuid,d=t[f];if(d!==void 0&&d>=s){const h=s++,m=e[h];t[m.uuid]=d,e[d]=m,t[f]=h,e[h]=c;for(let v=0,y=r;v!==y;++v){const w=i[v],x=w[h],g=w[d];w[d]=x,w[h]=g}}}this.nCachedObjects_=s}uncache(){const e=this._objects,t=this._indicesByUUID,i=this._bindings,r=i.length;let s=this.nCachedObjects_,o=e.length;for(let a=0,c=arguments.length;a!==c;++a){const f=arguments[a],d=f.uuid,h=t[d];if(h!==void 0)if(delete t[d],h<s){const m=--s,v=e[m],y=--o,w=e[y];t[v.uuid]=h,e[h]=v,t[w.uuid]=m,e[m]=w,e.pop();for(let x=0,g=r;x!==g;++x){const S=i[x],M=S[m],T=S[y];S[h]=M,S[m]=T,S.pop()}}else{const m=--o,v=e[m];m>0&&(t[v.uuid]=h),e[h]=v,e.pop();for(let y=0,w=r;y!==w;++y){const x=i[y];x[h]=x[m],x.pop()}}}this.nCachedObjects_=s}subscribe_(e,t){const i=this._bindingsIndicesByPath;let r=i[e];const s=this._bindings;if(r!==void 0)return s[r];const o=this._paths,a=this._parsedPaths,c=this._objects,f=c.length,d=this.nCachedObjects_,h=new Array(f);r=s.length,i[e]=r,o.push(e),a.push(t),s.push(h);for(let m=d,v=c.length;m!==v;++m){const y=c[m];h[m]=new zt(y,e,t)}return h}unsubscribe_(e){const t=this._bindingsIndicesByPath,i=t[e];if(i!==void 0){const r=this._paths,s=this._parsedPaths,o=this._bindings,a=o.length-1,c=o[a],f=e[a];t[f]=i,o[i]=c,o.pop(),s[i]=s[a],s.pop(),r[i]=r[a],r.pop()}}}class PC{constructor(e,t,i=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=i,this.blendMode=r;const s=t.tracks,o=s.length,a=new Array(o),c={endingStart:la,endingEnd:la};for(let f=0;f!==o;++f){const d=s[f].createInterpolant(null);a[f]=d,d.settings=c}this._interpolantSettings=c,this._interpolants=a,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=fb,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,i){if(e.fadeOut(t),this.fadeIn(t),i){const r=this._clip.duration,s=e._clip.duration,o=s/r,a=r/s;e.warp(1,o,t),this.warp(a,1,t)}return this}crossFadeTo(e,t,i){return e.crossFadeFrom(this,t,i)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,i){const r=this._mixer,s=r.time,o=this.timeScale;let a=this._timeScaleInterpolant;a===null&&(a=r._lendControlInterpolant(),this._timeScaleInterpolant=a);const c=a.parameterPositions,f=a.sampleValues;return c[0]=s,c[1]=s+i,f[0]=e/o,f[1]=t/o,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,i,r){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const c=(e-s)*i;c<0||i===0?t=0:(this._startTime=null,t=i*c)}t*=this._updateTimeScale(e);const o=this._updateTime(t),a=this._updateWeight(e);if(a>0){const c=this._interpolants,f=this._propertyBindings;switch(this.blendMode){case L_:for(let d=0,h=c.length;d!==h;++d)c[d].evaluate(o),f[d].accumulateAdditive(a);break;case Zp:default:for(let d=0,h=c.length;d!==h;++d)c[d].evaluate(o),f[d].accumulate(r,a)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const i=this._weightInterpolant;if(i!==null){const r=i.evaluate(e)[0];t*=r,e>i.parameterPositions[1]&&(this.stopFading(),r===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const i=this._timeScaleInterpolant;if(i!==null){const r=i.evaluate(e)[0];t*=r,e>i.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,i=this.loop;let r=this.time+e,s=this._loopCount;const o=i===db;if(e===0)return s===-1?r:o&&(s&1)===1?t-r:r;if(i===cb){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else if(r<0)r=0;else{this.time=r;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,o)):this._setEndings(this.repetitions===0,!0,o)),r>=t||r<0){const a=Math.floor(r/t);r-=t*a,s+=Math.abs(a);const c=this.repetitions-s;if(c<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(c===1){const f=e<0;this._setEndings(f,!f,o)}else this._setEndings(!1,!1,o);this._loopCount=s,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}else this.time=r;if(o&&(s&1)===1)return t-r}return r}_setEndings(e,t,i){const r=this._interpolantSettings;i?(r.endingStart=ua,r.endingEnd=ua):(e?r.endingStart=this.zeroSlopeAtStart?ua:la:r.endingStart=Wc,t?r.endingEnd=this.zeroSlopeAtEnd?ua:la:r.endingEnd=Wc)}_scheduleFading(e,t,i){const r=this._mixer,s=r.time;let o=this._weightInterpolant;o===null&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);const a=o.parameterPositions,c=o.sampleValues;return a[0]=s,c[0]=t,a[1]=s+e,c[1]=i,this}}const qk=new Float32Array(1);class Zk extends ks{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const i=e._localRoot||this._root,r=e._clip.tracks,s=r.length,o=e._propertyBindings,a=e._interpolants,c=i.uuid,f=this._bindingsByRootAndName;let d=f[c];d===void 0&&(d={},f[c]=d);for(let h=0;h!==s;++h){const m=r[h],v=m.name;let y=d[v];if(y!==void 0)++y.referenceCount,o[h]=y;else{if(y=o[h],y!==void 0){y._cacheIndex===null&&(++y.referenceCount,this._addInactiveBinding(y,c,v));continue}const w=t&&t._propertyBindings[h].binding.parsedPath;y=new RC(zt.create(i,v,w),m.ValueTypeName,m.getValueSize()),++y.referenceCount,this._addInactiveBinding(y,c,v),o[h]=y}a[h].resultBuffer=y.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const i=(e._localRoot||this._root).uuid,r=e._clip.uuid,s=this._actionsByClip[r];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,r,i)}const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const s=t[i];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const s=t[i];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,i){const r=this._actions,s=this._actionsByClip;let o=s[t];if(o===void 0)o={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=o;else{const a=o.knownActions;e._byClipCacheIndex=a.length,a.push(e)}e._cacheIndex=r.length,r.push(e),o.actionByRoot[i]=e}_removeInactiveAction(e){const t=this._actions,i=t[t.length-1],r=e._cacheIndex;i._cacheIndex=r,t[r]=i,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,o=this._actionsByClip,a=o[s],c=a.knownActions,f=c[c.length-1],d=e._byClipCacheIndex;f._byClipCacheIndex=d,c[d]=f,c.pop(),e._byClipCacheIndex=null;const h=a.actionByRoot,m=(e._localRoot||this._root).uuid;delete h[m],c.length===0&&delete o[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let i=0,r=t.length;i!==r;++i){const s=t[i];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const t=this._actions,i=e._cacheIndex,r=this._nActiveActions++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_takeBackAction(e){const t=this._actions,i=e._cacheIndex,r=--this._nActiveActions,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_addInactiveBinding(e,t,i){const r=this._bindingsByRootAndName,s=this._bindings;let o=r[t];o===void 0&&(o={},r[t]=o),o[i]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,i=e.binding,r=i.rootNode.uuid,s=i.path,o=this._bindingsByRootAndName,a=o[r],c=t[t.length-1],f=e._cacheIndex;c._cacheIndex=f,t[f]=c,t.pop(),delete a[s],Object.keys(a).length===0&&delete o[r]}_lendBinding(e){const t=this._bindings,i=e._cacheIndex,r=this._nActiveBindings++,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_takeBackBinding(e){const t=this._bindings,i=e._cacheIndex,r=--this._nActiveBindings,s=t[r];e._cacheIndex=r,t[r]=e,s._cacheIndex=i,t[i]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let i=e[t];return i===void 0&&(i=new ix(new Float32Array(2),new Float32Array(2),1,qk),i.__cacheIndex=t,e[t]=i),i}_takeBackControlInterpolant(e){const t=this._controlInterpolants,i=e.__cacheIndex,r=--this._nActiveControlInterpolants,s=t[r];e.__cacheIndex=r,t[r]=e,s.__cacheIndex=i,t[i]=s}clipAction(e,t,i){const r=t||this._root,s=r.uuid;let o=typeof e=="string"?nf.findByName(r,e):e;const a=o!==null?o.uuid:e,c=this._actionsByClip[a];let f=null;if(i===void 0&&(o!==null?i=o.blendMode:i=Zp),c!==void 0){const h=c.actionByRoot[s];if(h!==void 0&&h.blendMode===i)return h;f=c.knownActions[0],o===null&&(o=f._clip)}if(o===null)return null;const d=new PC(this,o,t,i);return this._bindAction(d,f),this._addInactiveAction(d,a,s),d}existingAction(e,t){const i=t||this._root,r=i.uuid,s=typeof e=="string"?nf.findByName(i,e):e,o=s?s.uuid:e,a=this._actionsByClip[o];return a!==void 0&&a.actionByRoot[r]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let i=t-1;i>=0;--i)e[i].stop();return this}update(e){e*=this.timeScale;const t=this._actions,i=this._nActiveActions,r=this.time+=e,s=Math.sign(e),o=this._accuIndex^=1;for(let f=0;f!==i;++f)t[f]._update(r,e,s,o);const a=this._bindings,c=this._nActiveBindings;for(let f=0;f!==c;++f)a[f].apply(o);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,i=e.uuid,r=this._actionsByClip,s=r[i];if(s!==void 0){const o=s.knownActions;for(let a=0,c=o.length;a!==c;++a){const f=o[a];this._deactivateAction(f);const d=f._cacheIndex,h=t[t.length-1];f._cacheIndex=null,f._byClipCacheIndex=null,h._cacheIndex=d,t[d]=h,t.pop(),this._removeInactiveBindingsForAction(f)}delete r[i]}}uncacheRoot(e){const t=e.uuid,i=this._actionsByClip;for(const o in i){const a=i[o].actionByRoot,c=a[t];c!==void 0&&(this._deactivateAction(c),this._removeInactiveAction(c))}const r=this._bindingsByRootAndName,s=r[t];if(s!==void 0)for(const o in s){const a=s[o];a.restoreOriginalState(),this._removeInactiveBinding(a)}}uncacheAction(e,t){const i=this.existingAction(e,t);i!==null&&(this._deactivateAction(i),this._removeInactiveAction(i))}}class fx{constructor(e){this.value=e}clone(){return new fx(this.value.clone===void 0?this.value:this.value.clone())}}let Kk=0;class Jk extends ks{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:Kk++}),this.name="",this.usage=qc,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let i=0,r=t.length;i<r;i++){const s=Array.isArray(t[i])?t[i]:[t[i]];for(let o=0;o<s.length;o++)this.uniforms.push(s[o].clone())}return this}clone(){return new this.constructor().copy(this)}}class Qk extends nm{constructor(e,t,i=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class $k{constructor(e,t,i,r,s){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=i,this.elementSize=r,this.count=s,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}class LC{constructor(e,t,i=0,r=1/0){this.ray=new Pa(e,t),this.near=i,this.far=r,this.camera=null,this.layers=new ga,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,i=[]){return My(e,this,i,t),i.sort(Lw),i}intersectObjects(e,t=!0,i=[]){for(let r=0,s=e.length;r<s;r++)My(e[r],this,i,t);return i.sort(Lw),i}}function Lw(n,e){return n.distance-e.distance}function My(n,e,t,i){if(n.layers.test(e.layers)&&n.raycast(e,t),i===!0){const r=n.children;for(let s=0,o=r.length;s<o;s++)My(r[s],e,t,!0)}}class wy{constructor(e=1,t=0,i=0){return this.radius=e,this.phi=t,this.theta=i,this}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(xn(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class eF{constructor(e=1,t=0,i=0){return this.radius=e,this.theta=t,this.y=i,this}set(e,t,i){return this.radius=e,this.theta=t,this.y=i,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+i*i),this.theta=Math.atan2(e,i),this.y=t,this}clone(){return new this.constructor().copy(this)}}const Iw=new be;class tF{constructor(e=new be(1/0,1/0),t=new be(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const i=Iw.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Iw).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const Nw=new k,Sh=new k;class nF{constructor(e=new k,t=new k){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){Nw.subVectors(e,this.start),Sh.subVectors(this.end,this.start);const i=Sh.dot(Sh);let s=Sh.dot(Nw)/i;return t&&(s=xn(s,0,1)),s}closestPointToPoint(e,t,i){const r=this.closestPointToPointParameter(e,t);return this.delta(i).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const Dw=new k;class iF extends Wt{constructor(e,t){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const i=new Dt,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let o=0,a=1,c=32;o<c;o++,a++){const f=o/c*Math.PI*2,d=a/c*Math.PI*2;r.push(Math.cos(f),Math.sin(f),1,Math.cos(d),Math.sin(d),1)}i.setAttribute("position",new ft(r,3));const s=new Ci({fog:!1,toneMapped:!1});this.cone=new ss(i,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),Dw.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Dw),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const $s=new k,Mh=new Mt,L0=new Mt;class rF extends ss{constructor(e){const t=IC(e),i=new Dt,r=[],s=[],o=new nt(0,0,1),a=new nt(0,1,0);for(let f=0;f<t.length;f++){const d=t[f];d.parent&&d.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),s.push(o.r,o.g,o.b),s.push(a.r,a.g,a.b))}i.setAttribute("position",new ft(r,3)),i.setAttribute("color",new ft(s,3));const c=new Ci({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(i,c),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){const t=this.bones,i=this.geometry,r=i.getAttribute("position");L0.copy(this.root.matrixWorld).invert();for(let s=0,o=0;s<t.length;s++){const a=t[s];a.parent&&a.parent.isBone&&(Mh.multiplyMatrices(L0,a.matrixWorld),$s.setFromMatrixPosition(Mh),r.setXYZ(o,$s.x,$s.y,$s.z),Mh.multiplyMatrices(L0,a.parent.matrixWorld),$s.setFromMatrixPosition(Mh),r.setXYZ(o+1,$s.x,$s.y,$s.z),o+=2)}i.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}function IC(n){const e=[];n.isBone===!0&&e.push(n);for(let t=0;t<n.children.length;t++)e.push.apply(e,IC(n.children[t]));return e}class sF extends kn{constructor(e,t,i){const r=new xf(t,4,2),s=new Ro({wireframe:!0,fog:!1,toneMapped:!1});super(r,s),this.light=e,this.color=i,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const oF=new k,Uw=new nt,Ow=new nt;class aF extends Wt{constructor(e,t,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="HemisphereLightHelper";const r=new _f(t);r.rotateY(Math.PI*.5),this.material=new Ro({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=r.getAttribute("position"),o=new Float32Array(s.count*3);r.setAttribute("color",new Kt(o,3)),this.add(new kn(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");Uw.copy(this.light.color),Ow.copy(this.light.groundColor);for(let i=0,r=t.count;i<r;i++){const s=i<r/2?Uw:Ow;t.setXYZ(i,s.r,s.g,s.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(oF.setFromMatrixPosition(this.light.matrixWorld).negate())}}class lF extends ss{constructor(e=10,t=10,i=4473924,r=8947848){i=new nt(i),r=new nt(r);const s=t/2,o=e/t,a=e/2,c=[],f=[];for(let m=0,v=0,y=-a;m<=t;m++,y+=o){c.push(-a,0,y,a,0,y),c.push(y,0,-a,y,0,a);const w=m===s?i:r;w.toArray(f,v),v+=3,w.toArray(f,v),v+=3,w.toArray(f,v),v+=3,w.toArray(f,v),v+=3}const d=new Dt;d.setAttribute("position",new ft(c,3)),d.setAttribute("color",new ft(f,3));const h=new Ci({vertexColors:!0,toneMapped:!1});super(d,h),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class uF extends ss{constructor(e=10,t=16,i=8,r=64,s=4473924,o=8947848){s=new nt(s),o=new nt(o);const a=[],c=[];if(t>1)for(let h=0;h<t;h++){const m=h/t*(Math.PI*2),v=Math.sin(m)*e,y=Math.cos(m)*e;a.push(0,0,0),a.push(v,0,y);const w=h&1?s:o;c.push(w.r,w.g,w.b),c.push(w.r,w.g,w.b)}for(let h=0;h<i;h++){const m=h&1?s:o,v=e-e/i*h;for(let y=0;y<r;y++){let w=y/r*(Math.PI*2),x=Math.sin(w)*v,g=Math.cos(w)*v;a.push(x,0,g),c.push(m.r,m.g,m.b),w=(y+1)/r*(Math.PI*2),x=Math.sin(w)*v,g=Math.cos(w)*v,a.push(x,0,g),c.push(m.r,m.g,m.b)}}const f=new Dt;f.setAttribute("position",new ft(a,3)),f.setAttribute("color",new ft(c,3));const d=new Ci({vertexColors:!0,toneMapped:!1});super(f,d),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const kw=new k,wh=new k,Fw=new k;class cF extends Wt{constructor(e,t,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="DirectionalLightHelper",t===void 0&&(t=1);let r=new Dt;r.setAttribute("position",new ft([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const s=new Ci({fog:!1,toneMapped:!1});this.lightPlane=new Eo(r,s),this.add(this.lightPlane),r=new Dt,r.setAttribute("position",new ft([0,0,0,0,0,1],3)),this.targetLine=new Eo(r,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),kw.setFromMatrixPosition(this.light.matrixWorld),wh.setFromMatrixPosition(this.light.target.matrixWorld),Fw.subVectors(wh,kw),this.lightPlane.lookAt(wh),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(wh),this.targetLine.scale.z=Fw.length()}}const Eh=new k,yn=new pf;class fF extends ss{constructor(e){const t=new Dt,i=new Ci({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],s=[],o={};a("n1","n2"),a("n2","n4"),a("n4","n3"),a("n3","n1"),a("f1","f2"),a("f2","f4"),a("f4","f3"),a("f3","f1"),a("n1","f1"),a("n2","f2"),a("n3","f3"),a("n4","f4"),a("p","n1"),a("p","n2"),a("p","n3"),a("p","n4"),a("u1","u2"),a("u2","u3"),a("u3","u1"),a("c","t"),a("p","c"),a("cn1","cn2"),a("cn3","cn4"),a("cf1","cf2"),a("cf3","cf4");function a(y,w){c(y),c(w)}function c(y){r.push(0,0,0),s.push(0,0,0),o[y]===void 0&&(o[y]=[]),o[y].push(r.length/3-1)}t.setAttribute("position",new ft(r,3)),t.setAttribute("color",new ft(s,3)),super(t,i),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=o,this.update();const f=new nt(16755200),d=new nt(16711680),h=new nt(43775),m=new nt(16777215),v=new nt(3355443);this.setColors(f,d,h,m,v)}setColors(e,t,i,r,s){const a=this.geometry.getAttribute("color");a.setXYZ(0,e.r,e.g,e.b),a.setXYZ(1,e.r,e.g,e.b),a.setXYZ(2,e.r,e.g,e.b),a.setXYZ(3,e.r,e.g,e.b),a.setXYZ(4,e.r,e.g,e.b),a.setXYZ(5,e.r,e.g,e.b),a.setXYZ(6,e.r,e.g,e.b),a.setXYZ(7,e.r,e.g,e.b),a.setXYZ(8,e.r,e.g,e.b),a.setXYZ(9,e.r,e.g,e.b),a.setXYZ(10,e.r,e.g,e.b),a.setXYZ(11,e.r,e.g,e.b),a.setXYZ(12,e.r,e.g,e.b),a.setXYZ(13,e.r,e.g,e.b),a.setXYZ(14,e.r,e.g,e.b),a.setXYZ(15,e.r,e.g,e.b),a.setXYZ(16,e.r,e.g,e.b),a.setXYZ(17,e.r,e.g,e.b),a.setXYZ(18,e.r,e.g,e.b),a.setXYZ(19,e.r,e.g,e.b),a.setXYZ(20,e.r,e.g,e.b),a.setXYZ(21,e.r,e.g,e.b),a.setXYZ(22,e.r,e.g,e.b),a.setXYZ(23,e.r,e.g,e.b),a.setXYZ(24,t.r,t.g,t.b),a.setXYZ(25,t.r,t.g,t.b),a.setXYZ(26,t.r,t.g,t.b),a.setXYZ(27,t.r,t.g,t.b),a.setXYZ(28,t.r,t.g,t.b),a.setXYZ(29,t.r,t.g,t.b),a.setXYZ(30,t.r,t.g,t.b),a.setXYZ(31,t.r,t.g,t.b),a.setXYZ(32,i.r,i.g,i.b),a.setXYZ(33,i.r,i.g,i.b),a.setXYZ(34,i.r,i.g,i.b),a.setXYZ(35,i.r,i.g,i.b),a.setXYZ(36,i.r,i.g,i.b),a.setXYZ(37,i.r,i.g,i.b),a.setXYZ(38,r.r,r.g,r.b),a.setXYZ(39,r.r,r.g,r.b),a.setXYZ(40,s.r,s.g,s.b),a.setXYZ(41,s.r,s.g,s.b),a.setXYZ(42,s.r,s.g,s.b),a.setXYZ(43,s.r,s.g,s.b),a.setXYZ(44,s.r,s.g,s.b),a.setXYZ(45,s.r,s.g,s.b),a.setXYZ(46,s.r,s.g,s.b),a.setXYZ(47,s.r,s.g,s.b),a.setXYZ(48,s.r,s.g,s.b),a.setXYZ(49,s.r,s.g,s.b),a.needsUpdate=!0}update(){const e=this.geometry,t=this.pointMap,i=1,r=1;yn.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),En("c",t,e,yn,0,0,-1),En("t",t,e,yn,0,0,1),En("n1",t,e,yn,-i,-r,-1),En("n2",t,e,yn,i,-r,-1),En("n3",t,e,yn,-i,r,-1),En("n4",t,e,yn,i,r,-1),En("f1",t,e,yn,-i,-r,1),En("f2",t,e,yn,i,-r,1),En("f3",t,e,yn,-i,r,1),En("f4",t,e,yn,i,r,1),En("u1",t,e,yn,i*.7,r*1.1,-1),En("u2",t,e,yn,-i*.7,r*1.1,-1),En("u3",t,e,yn,0,r*2,-1),En("cf1",t,e,yn,-i,0,1),En("cf2",t,e,yn,i,0,1),En("cf3",t,e,yn,0,-r,1),En("cf4",t,e,yn,0,r,1),En("cn1",t,e,yn,-i,0,-1),En("cn2",t,e,yn,i,0,-1),En("cn3",t,e,yn,0,-r,-1),En("cn4",t,e,yn,0,r,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function En(n,e,t,i,r,s,o){Eh.set(r,s,o).unproject(i);const a=e[n];if(a!==void 0){const c=t.getAttribute("position");for(let f=0,d=a.length;f<d;f++)c.setXYZ(a[f],Eh.x,Eh.y,Eh.z)}}const Th=new Ti;class dF extends ss{constructor(e,t=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(8*3),s=new Dt;s.setIndex(new Kt(i,1)),s.setAttribute("position",new Kt(r,3)),super(s,new Ci({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&Th.setFromObject(this.object),Th.isEmpty())return;const t=Th.min,i=Th.max,r=this.geometry.attributes.position,s=r.array;s[0]=i.x,s[1]=i.y,s[2]=i.z,s[3]=t.x,s[4]=i.y,s[5]=i.z,s[6]=t.x,s[7]=t.y,s[8]=i.z,s[9]=i.x,s[10]=t.y,s[11]=i.z,s[12]=i.x,s[13]=i.y,s[14]=t.z,s[15]=t.x,s[16]=i.y,s[17]=t.z,s[18]=t.x,s[19]=t.y,s[20]=t.z,s[21]=i.x,s[22]=t.y,s[23]=t.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class hF extends ss{constructor(e,t=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new Dt;s.setIndex(new Kt(i,1)),s.setAttribute("position",new ft(r,3)),super(s,new Ci({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class pF extends Eo{constructor(e,t=1,i=16776960){const r=i,s=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],o=new Dt;o.setAttribute("position",new ft(s,3)),o.computeBoundingSphere(),super(o,new Ci({color:r,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const a=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],c=new Dt;c.setAttribute("position",new ft(a,3)),c.computeBoundingSphere(),this.add(new kn(c,new Ro({color:r,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const zw=new k;let Ah,I0;class mF extends Wt{constructor(e=new k(0,0,1),t=new k(0,0,0),i=1,r=16776960,s=i*.2,o=s*.2){super(),this.type="ArrowHelper",Ah===void 0&&(Ah=new Dt,Ah.setAttribute("position",new ft([0,0,0,0,1,0],3)),I0=new du(0,.5,1,5,1),I0.translate(0,-.5,0)),this.position.copy(t),this.line=new Eo(Ah,new Ci({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new kn(I0,new Ro({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(i,s,o)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{zw.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(zw,t)}}setLength(e,t=e*.2,i=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(i,t,i),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class gF extends ss{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],i=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new Dt;r.setAttribute("position",new ft(t,3)),r.setAttribute("color",new ft(i,3));const s=new Ci({vertexColors:!0,toneMapped:!1});super(r,s),this.type="AxesHelper"}setColors(e,t,i){const r=new nt,s=this.geometry.attributes.color.array;return r.set(e),r.toArray(s,0),r.toArray(s,3),r.set(t),r.toArray(s,6),r.toArray(s,9),r.set(i),r.toArray(s,12),r.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class vF{constructor(){this.type="ShapePath",this.color=new nt,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new Kc,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,i,r){return this.currentPath.quadraticCurveTo(e,t,i,r),this}bezierCurveTo(e,t,i,r,s,o){return this.currentPath.bezierCurveTo(e,t,i,r,s,o),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(g){const S=[];for(let M=0,T=g.length;M<T;M++){const P=g[M],b=new ya;b.curves=P.curves,S.push(b)}return S}function i(g,S){const M=S.length;let T=!1;for(let P=M-1,b=0;b<M;P=b++){let L=S[P],O=S[b],C=O.x-L.x,R=O.y-L.y;if(Math.abs(R)>Number.EPSILON){if(R<0&&(L=S[b],C=-C,O=S[P],R=-R),g.y<L.y||g.y>O.y)continue;if(g.y===L.y){if(g.x===L.x)return!0}else{const B=R*(g.x-L.x)-C*(g.y-L.y);if(B===0)return!0;if(B<0)continue;T=!T}}else{if(g.y!==L.y)continue;if(O.x<=g.x&&g.x<=L.x||L.x<=g.x&&g.x<=O.x)return!0}}return T}const r=is.isClockWise,s=this.subPaths;if(s.length===0)return[];let o,a,c;const f=[];if(s.length===1)return a=s[0],c=new ya,c.curves=a.curves,f.push(c),f;let d=!r(s[0].getPoints());d=e?!d:d;const h=[],m=[];let v=[],y=0,w;m[y]=void 0,v[y]=[];for(let g=0,S=s.length;g<S;g++)a=s[g],w=a.getPoints(),o=r(w),o=e?!o:o,o?(!d&&m[y]&&y++,m[y]={s:new ya,p:w},m[y].s.curves=a.curves,d&&y++,v[y]=[]):v[y].push({h:a,p:w[0]});if(!m[0])return t(s);if(m.length>1){let g=!1,S=0;for(let M=0,T=m.length;M<T;M++)h[M]=[];for(let M=0,T=m.length;M<T;M++){const P=v[M];for(let b=0;b<P.length;b++){const L=P[b];let O=!0;for(let C=0;C<m.length;C++)i(L.p,m[C].p)&&(M!==C&&S++,O?(O=!1,h[C].push(L)):g=!0);O&&h[M].push(L)}}S>0&&g===!1&&(v=h)}let x;for(let g=0,S=m.length;g<S;g++){c=m[g].s,f.push(c),x=v[g];for(let M=0,T=x.length;M<T;M++)c.holes.push(x[M].h)}return f}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Xp}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Xp);const yF=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:M_,AddEquation:so,AddOperation:ZA,AdditiveAnimationBlendMode:L_,AdditiveBlending:Uv,AgXToneMapping:eb,AlphaFormat:rb,AlwaysCompare:Mb,AlwaysDepth:VA,AlwaysStencilFunc:dy,AmbientLight:MC,AnimationAction:PC,AnimationClip:nf,AnimationLoader:xk,AnimationMixer:Zk,AnimationObjectGroup:Yk,AnimationUtils:gk,ArcCurve:Yb,ArrayCamera:kb,ArrowHelper:mF,AttachedBindMode:Bv,Audio:CC,AudioAnalyser:kk,AudioContext:ax,AudioListener:Dk,AudioLoader:Lk,AxesHelper:gF,BackSide:Ei,BasicDepthPacking:hb,BasicShadowMap:EA,BatchedMesh:Wb,Bone:Y_,BooleanKeyframeTrack:Ia,Box2:tF,Box3:Ti,Box3Helper:hF,BoxGeometry:La,BoxHelper:dF,BufferAttribute:Kt,BufferGeometry:Dt,BufferGeometryLoader:bC,ByteType:nb,Cache:As,Camera:pf,CameraHelper:fF,CanvasTexture:BO,CapsuleGeometry:om,CatmullRomCurve3:qb,CineonToneMapping:QA,CircleGeometry:am,ClampToEdgeWrapping:fi,Clock:lx,Color:nt,ColorKeyframeTrack:rx,ColorManagement:Yt,CompressedArrayTexture:FO,CompressedCubeTexture:zO,CompressedTexture:rm,CompressedTextureLoader:Sk,ConeGeometry:lm,ConstantAlphaFactor:zA,ConstantColorFactor:kA,CubeCamera:Cb,CubeReflectionMapping:Ds,CubeRefractionMapping:Mo,CubeTexture:mf,CubeTextureLoader:Mk,CubeUVReflectionMapping:cu,CubicBezierCurve:K_,CubicBezierCurve3:Zb,CubicInterpolant:pC,CullFaceBack:Dv,CullFaceFront:wA,CullFaceFrontBack:C3,CullFaceNone:MA,Curve:Fr,CurvePath:Jb,CustomBlending:TA,CustomToneMapping:$A,CylinderGeometry:du,Cylindrical:eF,Data3DTexture:k_,DataArrayTexture:Jp,DataTexture:va,DataTextureLoader:wk,DataUtils:kL,DecrementStencilOp:B3,DecrementWrapStencilOp:V3,DefaultLoadingManager:vC,DepthFormat:yo,DepthStencilFormat:Ta,DepthTexture:Qp,DetachedBindMode:tb,DirectionalLight:SC,DirectionalLightHelper:cF,DiscreteInterpolant:mC,DisplayP3ColorSpace:Kp,DodecahedronGeometry:um,DoubleSide:Ki,DstAlphaFactor:IA,DstColorFactor:DA,DynamicCopyUsage:iL,DynamicDrawUsage:J3,DynamicReadUsage:eL,EdgesGeometry:Qb,EllipseCurve:sm,EqualCompare:yb,EqualDepth:WA,EqualStencilFunc:j3,EquirectangularReflectionMapping:Fc,EquirectangularRefractionMapping:zc,Euler:hf,EventDispatcher:ks,ExtrudeGeometry:fm,FileLoader:Us,Float16BufferAttribute:GL,Float32BufferAttribute:ft,Float64BufferAttribute:WL,FloatType:vr,Fog:tm,FogExp2:em,FramebufferTexture:kO,FrontSide:Ns,Frustum:gf,GLBufferAttribute:$k,GLSL1:sL,GLSL3:hy,GreaterCompare:_b,GreaterDepth:jA,GreaterEqualCompare:Sb,GreaterEqualDepth:XA,GreaterEqualStencilFunc:K3,GreaterStencilFunc:q3,GridHelper:lF,Group:zl,HalfFloatType:Ea,HemisphereLight:yC,HemisphereLightHelper:aF,IcosahedronGeometry:dm,ImageBitmapLoader:Pk,ImageLoader:rf,ImageUtils:O_,IncrementStencilOp:z3,IncrementWrapStencilOp:H3,InstancedBufferAttribute:su,InstancedBufferGeometry:AC,InstancedInterleavedBuffer:Qk,InstancedMesh:Gb,Int16BufferAttribute:HL,Int32BufferAttribute:VL,Int8BufferAttribute:FL,IntType:E_,InterleavedBuffer:nm,InterleavedBufferAttribute:Aa,Interpolant:Sf,InterpolateDiscrete:Vc,InterpolateLinear:Gc,InterpolateSmooth:Zh,InvertStencilOp:G3,KeepStencilOp:ta,KeyframeTrack:zr,LOD:Hb,LatheGeometry:yf,Layers:ga,LessCompare:vb,LessDepth:GA,LessEqualCompare:N_,LessEqualDepth:kc,LessEqualStencilFunc:Y3,LessStencilFunc:X3,Light:Lo,LightProbe:TC,Line:Eo,Line3:nF,LineBasicMaterial:Ci,LineCurve:J_,LineCurve3:Kb,LineDashedMaterial:fC,LineLoop:Xb,LineSegments:ss,LinearDisplayP3ColorSpace:df,LinearEncoding:I_,LinearFilter:fn,LinearInterpolant:ix,LinearMipMapLinearFilter:N3,LinearMipMapNearestFilter:I3,LinearMipmapLinearFilter:wo,LinearMipmapNearestFilter:w_,LinearSRGBColorSpace:rs,LinearToneMapping:KA,LinearTransfer:Xc,Loader:Bi,LoaderUtils:Sy,LoadingManager:sx,LoopOnce:cb,LoopPingPong:db,LoopRepeat:fb,LuminanceAlphaFormat:ob,LuminanceFormat:sb,MOUSE:$o,Material:mi,MaterialLoader:_m,MathUtils:U_,Matrix3:Nt,Matrix4:Mt,MaxEquation:zv,Mesh:kn,MeshBasicMaterial:Ro,MeshDepthMaterial:V_,MeshDistanceMaterial:G_,MeshLambertMaterial:uC,MeshMatcapMaterial:cC,MeshNormalMaterial:lC,MeshPhongMaterial:oC,MeshPhysicalMaterial:sC,MeshStandardMaterial:tx,MeshToonMaterial:aC,MinEquation:Fv,MirroredRepeatWrapping:Hc,MixOperation:qA,MultiplyBlending:kv,MultiplyOperation:ff,NearestFilter:Tn,NearestMipMapLinearFilter:L3,NearestMipMapNearestFilter:P3,NearestMipmapLinearFilter:mc,NearestMipmapNearestFilter:Ep,NeverCompare:gb,NeverDepth:HA,NeverStencilFunc:W3,NoBlending:Cs,NoColorSpace:Ji,NoToneMapping:es,NormalAnimationBlendMode:Zp,NormalBlending:pa,NotEqualCompare:xb,NotEqualDepth:YA,NotEqualStencilFunc:Z3,NumberKeyframeTrack:ef,Object3D:Wt,ObjectLoader:Ck,ObjectSpaceNormalMap:mb,OctahedronGeometry:_f,OneFactor:RA,OneMinusConstantAlphaFactor:BA,OneMinusConstantColorFactor:FA,OneMinusDstAlphaFactor:NA,OneMinusDstColorFactor:UA,OneMinusSrcAlphaFactor:wp,OneMinusSrcColorFactor:LA,OrthographicCamera:ns,P3Primaries:Yc,PCFShadowMap:jp,PCFSoftShadowMap:pc,PMREMGenerator:my,Path:Kc,PerspectiveCamera:dn,Plane:Ss,PlaneGeometry:vf,PlaneHelper:pF,PointLight:xC,PointLightHelper:sF,Points:jb,PointsMaterial:q_,PolarGridHelper:uF,PolyhedronGeometry:Po,PositionalAudio:Ok,PropertyBinding:zt,PropertyMixer:RC,QuadraticBezierCurve:Q_,QuadraticBezierCurve3:$_,Quaternion:di,QuaternionKeyframeTrack:hu,QuaternionLinearInterpolant:gC,RED_GREEN_RGTC2_Format:cy,RED_RGTC1_Format:ub,REVISION:Xp,RGBADepthPacking:pb,RGBAFormat:Mi,RGBAIntegerFormat:R_,RGBA_ASTC_10x10_Format:ry,RGBA_ASTC_10x5_Format:ty,RGBA_ASTC_10x6_Format:ny,RGBA_ASTC_10x8_Format:iy,RGBA_ASTC_12x10_Format:sy,RGBA_ASTC_12x12_Format:oy,RGBA_ASTC_4x4_Format:Yv,RGBA_ASTC_5x4_Format:qv,RGBA_ASTC_5x5_Format:Zv,RGBA_ASTC_6x5_Format:Kv,RGBA_ASTC_6x6_Format:Jv,RGBA_ASTC_8x5_Format:Qv,RGBA_ASTC_8x6_Format:$v,RGBA_ASTC_8x8_Format:ey,RGBA_BPTC_Format:qh,RGBA_ETC2_EAC_Format:jv,RGBA_PVRTC_2BPPV1_Format:Wv,RGBA_PVRTC_4BPPV1_Format:Gv,RGBA_S3TC_DXT1_Format:Xh,RGBA_S3TC_DXT3_Format:jh,RGBA_S3TC_DXT5_Format:Yh,RGB_BPTC_SIGNED_Format:ay,RGB_BPTC_UNSIGNED_Format:ly,RGB_ETC1_Format:P_,RGB_ETC2_Format:Xv,RGB_PVRTC_2BPPV1_Format:Vv,RGB_PVRTC_4BPPV1_Format:Hv,RGB_S3TC_DXT1_Format:Wh,RGFormat:lb,RGIntegerFormat:C_,RawShaderMaterial:rC,Ray:Pa,Raycaster:LC,Rec709Primaries:jc,RectAreaLight:wC,RedFormat:ab,RedIntegerFormat:b_,ReinhardToneMapping:JA,RenderTarget:Tb,RepeatWrapping:Bc,ReplaceStencilOp:F3,ReverseSubtractEquation:bA,RingGeometry:hm,SIGNED_RED_GREEN_RGTC2_Format:fy,SIGNED_RED_RGTC1_Format:uy,SRGBColorSpace:Un,SRGBTransfer:tn,Scene:X_,ShaderChunk:Pt,ShaderLib:Ir,ShaderMaterial:kr,ShadowMaterial:iC,Shape:ya,ShapeGeometry:pm,ShapePath:vF,ShapeUtils:is,ShortType:ib,Skeleton:im,SkeletonHelper:rF,SkinnedMesh:Vb,Source:ca,Sphere:hi,SphereGeometry:xf,Spherical:wy,SphericalHarmonics3:EC,SplineCurve:ex,SpotLight:_C,SpotLightHelper:iF,Sprite:Bb,SpriteMaterial:j_,SrcAlphaFactor:Mp,SrcAlphaSaturateFactor:OA,SrcColorFactor:PA,StaticCopyUsage:nL,StaticDrawUsage:qc,StaticReadUsage:$3,StereoCamera:Ik,StreamCopyUsage:rL,StreamDrawUsage:Q3,StreamReadUsage:tL,StringKeyframeTrack:Na,SubtractEquation:AA,SubtractiveBlending:Ov,TOUCH:ea,TangentSpaceNormalMap:Co,TetrahedronGeometry:mm,Texture:bn,TextureLoader:Ek,TorusGeometry:gm,TorusKnotGeometry:vm,Triangle:Di,TriangleFanDrawMode:O3,TriangleStripDrawMode:U3,TrianglesDrawMode:D3,TubeGeometry:ym,TwoPassDoubleSide:R3,UVMapping:Yp,Uint16BufferAttribute:F_,Uint32BufferAttribute:z_,Uint8BufferAttribute:zL,Uint8ClampedBufferAttribute:BL,Uniform:fx,UniformsGroup:Jk,UniformsLib:qe,UniformsUtils:B_,UnsignedByteType:ts,UnsignedInt248Type:vo,UnsignedIntType:Ts,UnsignedShort4444Type:T_,UnsignedShort5551Type:A_,UnsignedShortType:qp,VSMShadowMap:Rr,Vector2:be,Vector3:k,Vector4:qt,VectorKeyframeTrack:tf,VideoTexture:OO,WebGL1Renderer:Fb,WebGL3DRenderTarget:TL,WebGLArrayRenderTarget:EL,WebGLCoordinateSystem:Nr,WebGLCubeRenderTarget:Rb,WebGLMultipleRenderTargets:AL,WebGLRenderTarget:Sr,WebGLRenderer:W_,WebGLUtils:Ob,WebGPUCoordinateSystem:nu,WireframeGeometry:nC,WrapAroundEnding:Wc,ZeroCurvatureEnding:la,ZeroFactor:CA,ZeroSlopeEnding:ua,ZeroStencilOp:k3,_SRGBAFormat:Tp,createCanvasElement:Eb,sRGBEncoding:_o},Symbol.toStringTag,{value:"Module"}));var NC={exports:{}},Da={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */Da.ConcurrentRoot=1;Da.ContinuousEventPriority=4;Da.DefaultEventPriority=16;Da.DiscreteEventPriority=1;Da.IdleEventPriority=536870912;Da.LegacyRoot=0;NC.exports=Da;var Hl=NC.exports;function _F(n){let e;const t=new Set,i=(f,d)=>{const h=typeof f=="function"?f(e):f;if(h!==e){const m=e;e=d?h:Object.assign({},e,h),t.forEach(v=>v(e,m))}},r=()=>e,s=(f,d=r,h=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let m=d(e);function v(){const y=d(e);if(!h(m,y)){const w=m;f(m=y,w)}}return t.add(v),()=>t.delete(v)},c={setState:i,getState:r,subscribe:(f,d,h)=>d||h?s(f,d,h):(t.add(f),()=>t.delete(f)),destroy:()=>t.clear()};return e=n(i,r,c),c}const xF=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),Bw=xF?X.useEffect:X.useLayoutEffect;function SF(n){const e=typeof n=="function"?_F(n):n,t=(i=e.getState,r=Object.is)=>{const[,s]=X.useReducer(x=>x+1,0),o=e.getState(),a=X.useRef(o),c=X.useRef(i),f=X.useRef(r),d=X.useRef(!1),h=X.useRef();h.current===void 0&&(h.current=i(o));let m,v=!1;(a.current!==o||c.current!==i||f.current!==r||d.current)&&(m=i(o),v=!r(h.current,m)),Bw(()=>{v&&(h.current=m),a.current=o,c.current=i,f.current=r,d.current=!1});const y=X.useRef(o);Bw(()=>{const x=()=>{try{const S=e.getState(),M=c.current(S);f.current(h.current,M)||(a.current=S,h.current=M,s())}catch{d.current=!0,s()}},g=e.subscribe(x);return e.getState()!==y.current&&x(),g},[]);const w=v?m:h.current;return X.useDebugValue(w),w};return Object.assign(t,e),t[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const i=[t,e];return{next(){const r=i.length<=0;return{value:i.shift(),done:r}}}},t}var DC={exports:{}},UC={exports:{}},OC={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(F,W){var V=F.length;F.push(W);e:for(;0<V;){var Q=V-1>>>1,se=F[Q];if(0<r(se,W))F[Q]=W,F[V]=se,V=Q;else break e}}function t(F){return F.length===0?null:F[0]}function i(F){if(F.length===0)return null;var W=F[0],V=F.pop();if(V!==W){F[0]=V;e:for(var Q=0,se=F.length,J=se>>>1;Q<J;){var ge=2*(Q+1)-1,Ie=F[ge],Be=ge+1,Fe=F[Be];if(0>r(Ie,V))Be<se&&0>r(Fe,Ie)?(F[Q]=Fe,F[Be]=V,Q=Be):(F[Q]=Ie,F[ge]=V,Q=ge);else if(Be<se&&0>r(Fe,V))F[Q]=Fe,F[Be]=V,Q=Be;else break e}}return W}function r(F,W){var V=F.sortIndex-W.sortIndex;return V!==0?V:F.id-W.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var c=[],f=[],d=1,h=null,m=3,v=!1,y=!1,w=!1,x=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function M(F){for(var W=t(f);W!==null;){if(W.callback===null)i(f);else if(W.startTime<=F)i(f),W.sortIndex=W.expirationTime,e(c,W);else break;W=t(f)}}function T(F){if(w=!1,M(F),!y)if(t(c)!==null)y=!0,ne(P);else{var W=t(f);W!==null&&he(T,W.startTime-F)}}function P(F,W){y=!1,w&&(w=!1,g(O),O=-1),v=!0;var V=m;try{for(M(W),h=t(c);h!==null&&(!(h.expirationTime>W)||F&&!B());){var Q=h.callback;if(typeof Q=="function"){h.callback=null,m=h.priorityLevel;var se=Q(h.expirationTime<=W);W=n.unstable_now(),typeof se=="function"?h.callback=se:h===t(c)&&i(c),M(W)}else i(c);h=t(c)}if(h!==null)var J=!0;else{var ge=t(f);ge!==null&&he(T,ge.startTime-W),J=!1}return J}finally{h=null,m=V,v=!1}}var b=!1,L=null,O=-1,C=5,R=-1;function B(){return!(n.unstable_now()-R<C)}function $(){if(L!==null){var F=n.unstable_now();R=F;var W=!0;try{W=L(!0,F)}finally{W?me():(b=!1,L=null)}}else b=!1}var me;if(typeof S=="function")me=function(){S($)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,Z=G.port2;G.port1.onmessage=$,me=function(){Z.postMessage(null)}}else me=function(){x($,0)};function ne(F){L=F,b||(b=!0,me())}function he(F,W){O=x(function(){F(n.unstable_now())},W)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(F){F.callback=null},n.unstable_continueExecution=function(){y||v||(y=!0,ne(P))},n.unstable_forceFrameRate=function(F){0>F||125<F?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<F?Math.floor(1e3/F):5},n.unstable_getCurrentPriorityLevel=function(){return m},n.unstable_getFirstCallbackNode=function(){return t(c)},n.unstable_next=function(F){switch(m){case 1:case 2:case 3:var W=3;break;default:W=m}var V=m;m=W;try{return F()}finally{m=V}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(F,W){switch(F){case 1:case 2:case 3:case 4:case 5:break;default:F=3}var V=m;m=F;try{return W()}finally{m=V}},n.unstable_scheduleCallback=function(F,W,V){var Q=n.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?Q+V:Q):V=Q,F){case 1:var se=-1;break;case 2:se=250;break;case 5:se=1073741823;break;case 4:se=1e4;break;default:se=5e3}return se=V+se,F={id:d++,callback:W,priorityLevel:F,startTime:V,expirationTime:se,sortIndex:-1},V>Q?(F.sortIndex=V,e(f,F),t(c)===null&&F===t(f)&&(w?(g(O),O=-1):w=!0,he(T,V-Q))):(F.sortIndex=se,e(c,F),y||v||(y=!0,ne(P))),F},n.unstable_shouldYield=B,n.unstable_wrapCallback=function(F){var W=m;return function(){var V=m;m=W;try{return F.apply(this,arguments)}finally{m=V}}}})(OC);UC.exports=OC;var Ey=UC.exports;/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var MF=function(e){var t={},i=X,r=Ey,s=Object.assign;function o(l){for(var u="https://reactjs.org/docs/error-decoder.html?invariant="+l,p=1;p<arguments.length;p++)u+="&args[]="+encodeURIComponent(arguments[p]);return"Minified React error #"+l+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,c=Symbol.for("react.element"),f=Symbol.for("react.portal"),d=Symbol.for("react.fragment"),h=Symbol.for("react.strict_mode"),m=Symbol.for("react.profiler"),v=Symbol.for("react.provider"),y=Symbol.for("react.context"),w=Symbol.for("react.forward_ref"),x=Symbol.for("react.suspense"),g=Symbol.for("react.suspense_list"),S=Symbol.for("react.memo"),M=Symbol.for("react.lazy"),T=Symbol.for("react.offscreen"),P=Symbol.iterator;function b(l){return l===null||typeof l!="object"?null:(l=P&&l[P]||l["@@iterator"],typeof l=="function"?l:null)}function L(l){if(l==null)return null;if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case d:return"Fragment";case f:return"Portal";case m:return"Profiler";case h:return"StrictMode";case x:return"Suspense";case g:return"SuspenseList"}if(typeof l=="object")switch(l.$$typeof){case y:return(l.displayName||"Context")+".Consumer";case v:return(l._context.displayName||"Context")+".Provider";case w:var u=l.render;return l=l.displayName,l||(l=u.displayName||u.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case S:return u=l.displayName||null,u!==null?u:L(l.type)||"Memo";case M:u=l._payload,l=l._init;try{return L(l(u))}catch{}}return null}function O(l){var u=l.type;switch(l.tag){case 24:return"Cache";case 9:return(u.displayName||"Context")+".Consumer";case 10:return(u._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return l=u.render,l=l.displayName||l.name||"",u.displayName||(l!==""?"ForwardRef("+l+")":"ForwardRef");case 7:return"Fragment";case 5:return u;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return L(u);case 8:return u===h?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof u=="function")return u.displayName||u.name||null;if(typeof u=="string")return u}return null}function C(l){var u=l,p=l;if(l.alternate)for(;u.return;)u=u.return;else{l=u;do u=l,u.flags&4098&&(p=u.return),l=u.return;while(l)}return u.tag===3?p:null}function R(l){if(C(l)!==l)throw Error(o(188))}function B(l){var u=l.alternate;if(!u){if(u=C(l),u===null)throw Error(o(188));return u!==l?null:l}for(var p=l,_=u;;){var E=p.return;if(E===null)break;var A=E.alternate;if(A===null){if(_=E.return,_!==null){p=_;continue}break}if(E.child===A.child){for(A=E.child;A;){if(A===p)return R(E),l;if(A===_)return R(E),u;A=A.sibling}throw Error(o(188))}if(p.return!==_.return)p=E,_=A;else{for(var z=!1,K=E.child;K;){if(K===p){z=!0,p=E,_=A;break}if(K===_){z=!0,_=E,p=A;break}K=K.sibling}if(!z){for(K=A.child;K;){if(K===p){z=!0,p=A,_=E;break}if(K===_){z=!0,_=A,p=E;break}K=K.sibling}if(!z)throw Error(o(189))}}if(p.alternate!==_)throw Error(o(190))}if(p.tag!==3)throw Error(o(188));return p.stateNode.current===p?l:u}function $(l){return l=B(l),l!==null?me(l):null}function me(l){if(l.tag===5||l.tag===6)return l;for(l=l.child;l!==null;){var u=me(l);if(u!==null)return u;l=l.sibling}return null}function G(l){if(l.tag===5||l.tag===6)return l;for(l=l.child;l!==null;){if(l.tag!==4){var u=G(l);if(u!==null)return u}l=l.sibling}return null}var Z=Array.isArray,ne=e.getPublicInstance,he=e.getRootHostContext,F=e.getChildHostContext,W=e.prepareForCommit,V=e.resetAfterCommit,Q=e.createInstance,se=e.appendInitialChild,J=e.finalizeInitialChildren,ge=e.prepareUpdate,Ie=e.shouldSetTextContent,Be=e.createTextInstance,Fe=e.scheduleTimeout,Ne=e.cancelTimeout,je=e.noTimeout,ke=e.isPrimaryRenderer,Le=e.supportsMutation,H=e.supportsPersistence,xe=e.supportsHydration,oe=e.getInstanceFromNode,Ue=e.preparePortalMount,ve=e.getCurrentEventPriority,Ze=e.detachDeletedInstance,Ve=e.supportsMicrotasks,N=e.scheduleMicrotask,I=e.supportsTestSelectors,te=e.findFiberRoot,Ce=e.getBoundingRect,we=e.getTextContent,Ee=e.isHiddenSubtree,Ke=e.matchAccessibilityRole,Oe=e.setFocusIfFocusable,Ge=e.setupIntersectionObserver,lt=e.appendChild,yt=e.appendChildToContainer,Te=e.commitTextUpdate,Ct=e.commitMount,ot=e.commitUpdate,ut=e.insertBefore,ct=e.insertInContainerBefore,$e=e.removeChild,j=e.removeChildFromContainer,Ae=e.resetTextContent,Ye=e.hideInstance,Je=e.hideTextInstance,De=e.unhideInstance,Y=e.unhideTextInstance,pe=e.clearContainer,D=e.cloneInstance,re=e.createContainerChildSet,ue=e.appendChildToContainerChildSet,Me=e.finalizeContainerChildren,ye=e.replaceContainerChildren,Re=e.cloneHiddenInstance,Pe=e.cloneHiddenTextInstance,fe=e.canHydrateInstance,Qe=e.canHydrateTextInstance,Et=e.canHydrateSuspenseInstance,Tt=e.isSuspenseInstancePending,Xt=e.isSuspenseInstanceFallback,Ut=e.registerSuspenseInstanceRetry,Xe=e.getNextHydratableSibling,Ft=e.getFirstHydratableChild,jt=e.getFirstHydratableChildWithinContainer,$t=e.getFirstHydratableChildWithinSuspenseInstance,Yn=e.hydrateInstance,gi=e.hydrateTextInstance,Hi=e.hydrateSuspenseInstance,U=e.getNextHydratableInstanceAfterSuspenseInstance,q=e.commitHydratedContainer,ae=e.commitHydratedSuspenseInstance,ce=e.clearSuspenseBoundary,ie=e.clearSuspenseBoundaryFromContainer,We=e.shouldDeleteUnhydratedTailInstances,at=e.didNotMatchHydratedContainerTextInstance,pt=e.didNotMatchHydratedTextInstance,mt;function St(l){if(mt===void 0)try{throw Error()}catch(p){var u=p.stack.trim().match(/\n( *(at )?)/);mt=u&&u[1]||""}return`
`+mt+l}var xt=!1;function wt(l,u){if(!l||xt)return"";xt=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(u)if(u=function(){throw Error()},Object.defineProperty(u.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(u,[])}catch(He){var _=He}Reflect.construct(l,[],u)}else{try{u.call()}catch(He){_=He}l.call(u.prototype)}else{try{throw Error()}catch(He){_=He}l()}}catch(He){if(He&&_&&typeof He.stack=="string"){for(var E=He.stack.split(`
`),A=_.stack.split(`
`),z=E.length-1,K=A.length-1;1<=z&&0<=K&&E[z]!==A[K];)K--;for(;1<=z&&0<=K;z--,K--)if(E[z]!==A[K]){if(z!==1||K!==1)do if(z--,K--,0>K||E[z]!==A[K]){var Se=`
`+E[z].replace(" at new "," at ");return l.displayName&&Se.includes("<anonymous>")&&(Se=Se.replace("<anonymous>",l.displayName)),Se}while(1<=z&&0<=K);break}}}finally{xt=!1,Error.prepareStackTrace=p}return(l=l?l.displayName||l.name:"")?St(l):""}var en=Object.prototype.hasOwnProperty,In=[],Jt=-1;function Sn(l){return{current:l}}function _t(l){0>Jt||(l.current=In[Jt],In[Jt]=null,Jt--)}function it(l,u){Jt++,In[Jt]=l.current,l.current=u}var $n={},Rt=Sn($n),gn=Sn(!1),Br=$n;function rr(l,u){var p=l.type.contextTypes;if(!p)return $n;var _=l.stateNode;if(_&&_.__reactInternalMemoizedUnmaskedChildContext===u)return _.__reactInternalMemoizedMaskedChildContext;var E={},A;for(A in p)E[A]=u[A];return _&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=u,l.__reactInternalMemoizedMaskedChildContext=E),E}function Bn(l){return l=l.childContextTypes,l!=null}function Mn(){_t(gn),_t(Rt)}function Hr(l,u,p){if(Rt.current!==$n)throw Error(o(168));it(Rt,u),it(gn,p)}function Ua(l,u,p){var _=l.stateNode;if(u=u.childContextTypes,typeof _.getChildContext!="function")return p;_=_.getChildContext();for(var E in _)if(!(E in u))throw Error(o(108,O(l)||"Unknown",E));return s({},p,_)}function qn(l){return l=(l=l.stateNode)&&l.__reactInternalMemoizedMergedChildContext||$n,Br=Rt.current,it(Rt,l),it(gn,gn.current),!0}function Oa(l,u,p){var _=l.stateNode;if(!_)throw Error(o(169));p?(l=Ua(l,u,Br),_.__reactInternalMemoizedMergedChildContext=l,_t(gn),_t(Rt),it(Rt,l)):_t(gn),it(gn,p)}var Vi=Math.clz32?Math.clz32:i2,Tf=Math.log,n2=Math.LN2;function i2(l){return l>>>=0,l===0?32:31-(Tf(l)/n2|0)|0}var Af=64,bf=4194304;function pu(l){switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return l&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return l}}function Cf(l,u){var p=l.pendingLanes;if(p===0)return 0;var _=0,E=l.suspendedLanes,A=l.pingedLanes,z=p&268435455;if(z!==0){var K=z&~E;K!==0?_=pu(K):(A&=z,A!==0&&(_=pu(A)))}else z=p&~E,z!==0?_=pu(z):A!==0&&(_=pu(A));if(_===0)return 0;if(u!==0&&u!==_&&!(u&E)&&(E=_&-_,A=u&-u,E>=A||E===16&&(A&4194240)!==0))return u;if(_&4&&(_|=p&16),u=l.entangledLanes,u!==0)for(l=l.entanglements,u&=_;0<u;)p=31-Vi(u),E=1<<p,_|=l[p],u&=~E;return _}function r2(l,u){switch(l){case 1:case 2:case 4:return u+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function s2(l,u){for(var p=l.suspendedLanes,_=l.pingedLanes,E=l.expirationTimes,A=l.pendingLanes;0<A;){var z=31-Vi(A),K=1<<z,Se=E[z];Se===-1?(!(K&p)||K&_)&&(E[z]=r2(K,u)):Se<=u&&(l.expiredLanes|=K),A&=~K}}function xm(l){return l=l.pendingLanes&-1073741825,l!==0?l:l&1073741824?1073741824:0}function Sm(l){for(var u=[],p=0;31>p;p++)u.push(l);return u}function mu(l,u,p){l.pendingLanes|=u,u!==536870912&&(l.suspendedLanes=0,l.pingedLanes=0),l=l.eventTimes,u=31-Vi(u),l[u]=p}function o2(l,u){var p=l.pendingLanes&~u;l.pendingLanes=u,l.suspendedLanes=0,l.pingedLanes=0,l.expiredLanes&=u,l.mutableReadLanes&=u,l.entangledLanes&=u,u=l.entanglements;var _=l.eventTimes;for(l=l.expirationTimes;0<p;){var E=31-Vi(p),A=1<<E;u[E]=0,_[E]=-1,l[E]=-1,p&=~A}}function Mm(l,u){var p=l.entangledLanes|=u;for(l=l.entanglements;p;){var _=31-Vi(p),E=1<<_;E&u|l[_]&u&&(l[_]|=u),p&=~E}}var Ht=0;function mx(l){return l&=-l,1<l?4<l?l&268435455?16:536870912:4:1}var wm=r.unstable_scheduleCallback,gx=r.unstable_cancelCallback,a2=r.unstable_shouldYield,l2=r.unstable_requestPaint,Hn=r.unstable_now,Em=r.unstable_ImmediatePriority,u2=r.unstable_UserBlockingPriority,Tm=r.unstable_NormalPriority,c2=r.unstable_IdlePriority,Rf=null,Vr=null;function f2(l){if(Vr&&typeof Vr.onCommitFiberRoot=="function")try{Vr.onCommitFiberRoot(Rf,l,void 0,(l.current.flags&128)===128)}catch{}}function d2(l,u){return l===u&&(l!==0||1/l===1/u)||l!==l&&u!==u}var Gr=typeof Object.is=="function"?Object.is:d2,os=null,Pf=!1,Am=!1;function vx(l){os===null?os=[l]:os.push(l)}function h2(l){Pf=!0,vx(l)}function Wr(){if(!Am&&os!==null){Am=!0;var l=0,u=Ht;try{var p=os;for(Ht=1;l<p.length;l++){var _=p[l];do _=_(!0);while(_!==null)}os=null,Pf=!1}catch(E){throw os!==null&&(os=os.slice(l+1)),wm(Em,Wr),E}finally{Ht=u,Am=!1}}return null}var p2=a.ReactCurrentBatchConfig;function Lf(l,u){if(Gr(l,u))return!0;if(typeof l!="object"||l===null||typeof u!="object"||u===null)return!1;var p=Object.keys(l),_=Object.keys(u);if(p.length!==_.length)return!1;for(_=0;_<p.length;_++){var E=p[_];if(!en.call(u,E)||!Gr(l[E],u[E]))return!1}return!0}function m2(l){switch(l.tag){case 5:return St(l.type);case 16:return St("Lazy");case 13:return St("Suspense");case 19:return St("SuspenseList");case 0:case 2:case 15:return l=wt(l.type,!1),l;case 11:return l=wt(l.type.render,!1),l;case 1:return l=wt(l.type,!0),l;default:return""}}function Mr(l,u){if(l&&l.defaultProps){u=s({},u),l=l.defaultProps;for(var p in l)u[p]===void 0&&(u[p]=l[p]);return u}return u}var If=Sn(null),Nf=null,ka=null,bm=null;function Cm(){bm=ka=Nf=null}function yx(l,u,p){ke?(it(If,u._currentValue),u._currentValue=p):(it(If,u._currentValue2),u._currentValue2=p)}function Rm(l){var u=If.current;_t(If),ke?l._currentValue=u:l._currentValue2=u}function Pm(l,u,p){for(;l!==null;){var _=l.alternate;if((l.childLanes&u)!==u?(l.childLanes|=u,_!==null&&(_.childLanes|=u)):_!==null&&(_.childLanes&u)!==u&&(_.childLanes|=u),l===p)break;l=l.return}}function Fa(l,u){Nf=l,bm=ka=null,l=l.dependencies,l!==null&&l.firstContext!==null&&(l.lanes&u&&(Xi=!0),l.firstContext=null)}function sr(l){var u=ke?l._currentValue:l._currentValue2;if(bm!==l)if(l={context:l,memoizedValue:u,next:null},ka===null){if(Nf===null)throw Error(o(308));ka=l,Nf.dependencies={lanes:0,firstContext:l}}else ka=ka.next=l;return u}var Xr=null,Fs=!1;function Lm(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function _x(l,u){l=l.updateQueue,u.updateQueue===l&&(u.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,effects:l.effects})}function as(l,u){return{eventTime:l,lane:u,tag:0,payload:null,callback:null,next:null}}function zs(l,u){var p=l.updateQueue;p!==null&&(p=p.shared,Cn!==null&&l.mode&1&&!(Ot&2)?(l=p.interleaved,l===null?(u.next=u,Xr===null?Xr=[p]:Xr.push(p)):(u.next=l.next,l.next=u),p.interleaved=u):(l=p.pending,l===null?u.next=u:(u.next=l.next,l.next=u),p.pending=u))}function Df(l,u,p){if(u=u.updateQueue,u!==null&&(u=u.shared,(p&4194240)!==0)){var _=u.lanes;_&=l.pendingLanes,p|=_,u.lanes=p,Mm(l,p)}}function xx(l,u){var p=l.updateQueue,_=l.alternate;if(_!==null&&(_=_.updateQueue,p===_)){var E=null,A=null;if(p=p.firstBaseUpdate,p!==null){do{var z={eventTime:p.eventTime,lane:p.lane,tag:p.tag,payload:p.payload,callback:p.callback,next:null};A===null?E=A=z:A=A.next=z,p=p.next}while(p!==null);A===null?E=A=u:A=A.next=u}else E=A=u;p={baseState:_.baseState,firstBaseUpdate:E,lastBaseUpdate:A,shared:_.shared,effects:_.effects},l.updateQueue=p;return}l=p.lastBaseUpdate,l===null?p.firstBaseUpdate=u:l.next=u,p.lastBaseUpdate=u}function Uf(l,u,p,_){var E=l.updateQueue;Fs=!1;var A=E.firstBaseUpdate,z=E.lastBaseUpdate,K=E.shared.pending;if(K!==null){E.shared.pending=null;var Se=K,He=Se.next;Se.next=null,z===null?A=He:z.next=He,z=Se;var st=l.alternate;st!==null&&(st=st.updateQueue,K=st.lastBaseUpdate,K!==z&&(K===null?st.firstBaseUpdate=He:K.next=He,st.lastBaseUpdate=Se))}if(A!==null){var At=E.baseState;z=0,st=He=Se=null,K=A;do{var gt=K.lane,Qt=K.eventTime;if((_&gt)===gt){st!==null&&(st=st.next={eventTime:Qt,lane:0,tag:K.tag,payload:K.payload,callback:K.callback,next:null});e:{var ht=l,ii=K;switch(gt=u,Qt=p,ii.tag){case 1:if(ht=ii.payload,typeof ht=="function"){At=ht.call(Qt,At,gt);break e}At=ht;break e;case 3:ht.flags=ht.flags&-65537|128;case 0:if(ht=ii.payload,gt=typeof ht=="function"?ht.call(Qt,At,gt):ht,gt==null)break e;At=s({},At,gt);break e;case 2:Fs=!0}}K.callback!==null&&K.lane!==0&&(l.flags|=64,gt=E.effects,gt===null?E.effects=[K]:gt.push(K))}else Qt={eventTime:Qt,lane:gt,tag:K.tag,payload:K.payload,callback:K.callback,next:null},st===null?(He=st=Qt,Se=At):st=st.next=Qt,z|=gt;if(K=K.next,K===null){if(K=E.shared.pending,K===null)break;gt=K,K=gt.next,gt.next=null,E.lastBaseUpdate=gt,E.shared.pending=null}}while(!0);if(st===null&&(Se=At),E.baseState=Se,E.firstBaseUpdate=He,E.lastBaseUpdate=st,u=E.shared.interleaved,u!==null){E=u;do z|=E.lane,E=E.next;while(E!==u)}else A===null&&(E.shared.lanes=0);Ya|=z,l.lanes=z,l.memoizedState=At}}function Sx(l,u,p){if(l=u.effects,u.effects=null,l!==null)for(u=0;u<l.length;u++){var _=l[u],E=_.callback;if(E!==null){if(_.callback=null,_=p,typeof E!="function")throw Error(o(191,E));E.call(_)}}}var Mx=new i.Component().refs;function Im(l,u,p,_){u=l.memoizedState,p=p(_,u),p=p==null?u:s({},u,p),l.memoizedState=p,l.lanes===0&&(l.updateQueue.baseState=p)}var Of={isMounted:function(l){return(l=l._reactInternals)?C(l)===l:!1},enqueueSetState:function(l,u,p){l=l._reactInternals;var _=yi(),E=Vs(l),A=as(_,E);A.payload=u,p!=null&&(A.callback=p),zs(l,A),u=cr(l,E,_),u!==null&&Df(u,l,E)},enqueueReplaceState:function(l,u,p){l=l._reactInternals;var _=yi(),E=Vs(l),A=as(_,E);A.tag=1,A.payload=u,p!=null&&(A.callback=p),zs(l,A),u=cr(l,E,_),u!==null&&Df(u,l,E)},enqueueForceUpdate:function(l,u){l=l._reactInternals;var p=yi(),_=Vs(l),E=as(p,_);E.tag=2,u!=null&&(E.callback=u),zs(l,E),u=cr(l,_,p),u!==null&&Df(u,l,_)}};function wx(l,u,p,_,E,A,z){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(_,A,z):u.prototype&&u.prototype.isPureReactComponent?!Lf(p,_)||!Lf(E,A):!0}function Ex(l,u,p){var _=!1,E=$n,A=u.contextType;return typeof A=="object"&&A!==null?A=sr(A):(E=Bn(u)?Br:Rt.current,_=u.contextTypes,A=(_=_!=null)?rr(l,E):$n),u=new u(p,A),l.memoizedState=u.state!==null&&u.state!==void 0?u.state:null,u.updater=Of,l.stateNode=u,u._reactInternals=l,_&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=E,l.__reactInternalMemoizedMaskedChildContext=A),u}function Tx(l,u,p,_){l=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(p,_),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(p,_),u.state!==l&&Of.enqueueReplaceState(u,u.state,null)}function Nm(l,u,p,_){var E=l.stateNode;E.props=p,E.state=l.memoizedState,E.refs=Mx,Lm(l);var A=u.contextType;typeof A=="object"&&A!==null?E.context=sr(A):(A=Bn(u)?Br:Rt.current,E.context=rr(l,A)),E.state=l.memoizedState,A=u.getDerivedStateFromProps,typeof A=="function"&&(Im(l,u,A,p),E.state=l.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof E.getSnapshotBeforeUpdate=="function"||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(u=E.state,typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount(),u!==E.state&&Of.enqueueReplaceState(E,E.state,null),Uf(l,p,E,_),E.state=l.memoizedState),typeof E.componentDidMount=="function"&&(l.flags|=4194308)}var za=[],Ba=0,kf=null,Ff=0,or=[],ar=0,Io=null,ls=1,us="";function No(l,u){za[Ba++]=Ff,za[Ba++]=kf,kf=l,Ff=u}function Ax(l,u,p){or[ar++]=ls,or[ar++]=us,or[ar++]=Io,Io=l;var _=ls;l=us;var E=32-Vi(_)-1;_&=~(1<<E),p+=1;var A=32-Vi(u)+E;if(30<A){var z=E-E%5;A=(_&(1<<z)-1).toString(32),_>>=z,E-=z,ls=1<<32-Vi(u)+E|p<<E|_,us=A+l}else ls=1<<A|p<<E|_,us=l}function Dm(l){l.return!==null&&(No(l,1),Ax(l,1,0))}function Um(l){for(;l===kf;)kf=za[--Ba],za[Ba]=null,Ff=za[--Ba],za[Ba]=null;for(;l===Io;)Io=or[--ar],or[ar]=null,us=or[--ar],or[ar]=null,ls=or[--ar],or[ar]=null}var Gi=null,Wi=null,an=!1,gu=!1,wr=null;function bx(l,u){var p=fr(5,null,null,0);p.elementType="DELETED",p.stateNode=u,p.return=l,u=l.deletions,u===null?(l.deletions=[p],l.flags|=16):u.push(p)}function Cx(l,u){switch(l.tag){case 5:return u=fe(u,l.type,l.pendingProps),u!==null?(l.stateNode=u,Gi=l,Wi=Ft(u),!0):!1;case 6:return u=Qe(u,l.pendingProps),u!==null?(l.stateNode=u,Gi=l,Wi=null,!0):!1;case 13:if(u=Et(u),u!==null){var p=Io!==null?{id:ls,overflow:us}:null;return l.memoizedState={dehydrated:u,treeContext:p,retryLane:1073741824},p=fr(18,null,null,0),p.stateNode=u,p.return=l,l.child=p,Gi=l,Wi=null,!0}return!1;default:return!1}}function Om(l){return(l.mode&1)!==0&&(l.flags&128)===0}function km(l){if(an){var u=Wi;if(u){var p=u;if(!Cx(l,u)){if(Om(l))throw Error(o(418));u=Xe(p);var _=Gi;u&&Cx(l,u)?bx(_,p):(l.flags=l.flags&-4097|2,an=!1,Gi=l)}}else{if(Om(l))throw Error(o(418));l.flags=l.flags&-4097|2,an=!1,Gi=l}}}function Rx(l){for(l=l.return;l!==null&&l.tag!==5&&l.tag!==3&&l.tag!==13;)l=l.return;Gi=l}function vu(l){if(!xe||l!==Gi)return!1;if(!an)return Rx(l),an=!0,!1;if(l.tag!==3&&(l.tag!==5||We(l.type)&&!Ie(l.type,l.memoizedProps))){var u=Wi;if(u){if(Om(l)){for(l=Wi;l;)l=Xe(l);throw Error(o(418))}for(;u;)bx(l,u),u=Xe(u)}}if(Rx(l),l.tag===13){if(!xe)throw Error(o(316));if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(o(317));Wi=U(l)}else Wi=Gi?Xe(l.stateNode):null;return!0}function Ha(){xe&&(Wi=Gi=null,gu=an=!1)}function Fm(l){wr===null?wr=[l]:wr.push(l)}function yu(l,u,p){if(l=p.ref,l!==null&&typeof l!="function"&&typeof l!="object"){if(p._owner){if(p=p._owner,p){if(p.tag!==1)throw Error(o(309));var _=p.stateNode}if(!_)throw Error(o(147,l));var E=_,A=""+l;return u!==null&&u.ref!==null&&typeof u.ref=="function"&&u.ref._stringRef===A?u.ref:(u=function(z){var K=E.refs;K===Mx&&(K=E.refs={}),z===null?delete K[A]:K[A]=z},u._stringRef=A,u)}if(typeof l!="string")throw Error(o(284));if(!p._owner)throw Error(o(290,l))}return l}function zf(l,u){throw l=Object.prototype.toString.call(u),Error(o(31,l==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":l))}function Px(l){var u=l._init;return u(l._payload)}function Lx(l){function u(le,ee){if(l){var _e=le.deletions;_e===null?(le.deletions=[ee],le.flags|=16):_e.push(ee)}}function p(le,ee){if(!l)return null;for(;ee!==null;)u(le,ee),ee=ee.sibling;return null}function _(le,ee){for(le=new Map;ee!==null;)ee.key!==null?le.set(ee.key,ee):le.set(ee.index,ee),ee=ee.sibling;return le}function E(le,ee){return le=Ws(le,ee),le.index=0,le.sibling=null,le}function A(le,ee,_e){return le.index=_e,l?(_e=le.alternate,_e!==null?(_e=_e.index,_e<ee?(le.flags|=2,ee):_e):(le.flags|=2,ee)):(le.flags|=1048576,ee)}function z(le){return l&&le.alternate===null&&(le.flags|=2),le}function K(le,ee,_e,tt){return ee===null||ee.tag!==6?(ee=Sg(_e,le.mode,tt),ee.return=le,ee):(ee=E(ee,_e),ee.return=le,ee)}function Se(le,ee,_e,tt){var dt=_e.type;return dt===d?st(le,ee,_e.props.children,tt,_e.key):ee!==null&&(ee.elementType===dt||typeof dt=="object"&&dt!==null&&dt.$$typeof===M&&Px(dt)===ee.type)?(tt=E(ee,_e.props),tt.ref=yu(le,ee,_e),tt.return=le,tt):(tt=gd(_e.type,_e.key,_e.props,null,le.mode,tt),tt.ref=yu(le,ee,_e),tt.return=le,tt)}function He(le,ee,_e,tt){return ee===null||ee.tag!==4||ee.stateNode.containerInfo!==_e.containerInfo||ee.stateNode.implementation!==_e.implementation?(ee=Mg(_e,le.mode,tt),ee.return=le,ee):(ee=E(ee,_e.children||[]),ee.return=le,ee)}function st(le,ee,_e,tt,dt){return ee===null||ee.tag!==7?(ee=Bo(_e,le.mode,tt,dt),ee.return=le,ee):(ee=E(ee,_e),ee.return=le,ee)}function At(le,ee,_e){if(typeof ee=="string"&&ee!==""||typeof ee=="number")return ee=Sg(""+ee,le.mode,_e),ee.return=le,ee;if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case c:return _e=gd(ee.type,ee.key,ee.props,null,le.mode,_e),_e.ref=yu(le,null,ee),_e.return=le,_e;case f:return ee=Mg(ee,le.mode,_e),ee.return=le,ee;case M:var tt=ee._init;return At(le,tt(ee._payload),_e)}if(Z(ee)||b(ee))return ee=Bo(ee,le.mode,_e,null),ee.return=le,ee;zf(le,ee)}return null}function gt(le,ee,_e,tt){var dt=ee!==null?ee.key:null;if(typeof _e=="string"&&_e!==""||typeof _e=="number")return dt!==null?null:K(le,ee,""+_e,tt);if(typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case c:return _e.key===dt?Se(le,ee,_e,tt):null;case f:return _e.key===dt?He(le,ee,_e,tt):null;case M:return dt=_e._init,gt(le,ee,dt(_e._payload),tt)}if(Z(_e)||b(_e))return dt!==null?null:st(le,ee,_e,tt,null);zf(le,_e)}return null}function Qt(le,ee,_e,tt,dt){if(typeof tt=="string"&&tt!==""||typeof tt=="number")return le=le.get(_e)||null,K(ee,le,""+tt,dt);if(typeof tt=="object"&&tt!==null){switch(tt.$$typeof){case c:return le=le.get(tt.key===null?_e:tt.key)||null,Se(ee,le,tt,dt);case f:return le=le.get(tt.key===null?_e:tt.key)||null,He(ee,le,tt,dt);case M:var It=tt._init;return Qt(le,ee,_e,It(tt._payload),dt)}if(Z(tt)||b(tt))return le=le.get(_e)||null,st(ee,le,tt,dt,null);zf(ee,tt)}return null}function ht(le,ee,_e,tt){for(var dt=null,It=null,bt=ee,Vt=ee=0,Gn=null;bt!==null&&Vt<_e.length;Vt++){bt.index>Vt?(Gn=bt,bt=null):Gn=bt.sibling;var Gt=gt(le,bt,_e[Vt],tt);if(Gt===null){bt===null&&(bt=Gn);break}l&&bt&&Gt.alternate===null&&u(le,bt),ee=A(Gt,ee,Vt),It===null?dt=Gt:It.sibling=Gt,It=Gt,bt=Gn}if(Vt===_e.length)return p(le,bt),an&&No(le,Vt),dt;if(bt===null){for(;Vt<_e.length;Vt++)bt=At(le,_e[Vt],tt),bt!==null&&(ee=A(bt,ee,Vt),It===null?dt=bt:It.sibling=bt,It=bt);return an&&No(le,Vt),dt}for(bt=_(le,bt);Vt<_e.length;Vt++)Gn=Qt(bt,le,Vt,_e[Vt],tt),Gn!==null&&(l&&Gn.alternate!==null&&bt.delete(Gn.key===null?Vt:Gn.key),ee=A(Gn,ee,Vt),It===null?dt=Gn:It.sibling=Gn,It=Gn);return l&&bt.forEach(function(Xs){return u(le,Xs)}),an&&No(le,Vt),dt}function ii(le,ee,_e,tt){var dt=b(_e);if(typeof dt!="function")throw Error(o(150));if(_e=dt.call(_e),_e==null)throw Error(o(151));for(var It=dt=null,bt=ee,Vt=ee=0,Gn=null,Gt=_e.next();bt!==null&&!Gt.done;Vt++,Gt=_e.next()){bt.index>Vt?(Gn=bt,bt=null):Gn=bt.sibling;var Xs=gt(le,bt,Gt.value,tt);if(Xs===null){bt===null&&(bt=Gn);break}l&&bt&&Xs.alternate===null&&u(le,bt),ee=A(Xs,ee,Vt),It===null?dt=Xs:It.sibling=Xs,It=Xs,bt=Gn}if(Gt.done)return p(le,bt),an&&No(le,Vt),dt;if(bt===null){for(;!Gt.done;Vt++,Gt=_e.next())Gt=At(le,Gt.value,tt),Gt!==null&&(ee=A(Gt,ee,Vt),It===null?dt=Gt:It.sibling=Gt,It=Gt);return an&&No(le,Vt),dt}for(bt=_(le,bt);!Gt.done;Vt++,Gt=_e.next())Gt=Qt(bt,le,Vt,Gt.value,tt),Gt!==null&&(l&&Gt.alternate!==null&&bt.delete(Gt.key===null?Vt:Gt.key),ee=A(Gt,ee,Vt),It===null?dt=Gt:It.sibling=Gt,It=Gt);return l&&bt.forEach(function(X2){return u(le,X2)}),an&&No(le,Vt),dt}function dr(le,ee,_e,tt){if(typeof _e=="object"&&_e!==null&&_e.type===d&&_e.key===null&&(_e=_e.props.children),typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case c:e:{for(var dt=_e.key,It=ee;It!==null;){if(It.key===dt){if(dt=_e.type,dt===d){if(It.tag===7){p(le,It.sibling),ee=E(It,_e.props.children),ee.return=le,le=ee;break e}}else if(It.elementType===dt||typeof dt=="object"&&dt!==null&&dt.$$typeof===M&&Px(dt)===It.type){p(le,It.sibling),ee=E(It,_e.props),ee.ref=yu(le,It,_e),ee.return=le,le=ee;break e}p(le,It);break}else u(le,It);It=It.sibling}_e.type===d?(ee=Bo(_e.props.children,le.mode,tt,_e.key),ee.return=le,le=ee):(tt=gd(_e.type,_e.key,_e.props,null,le.mode,tt),tt.ref=yu(le,ee,_e),tt.return=le,le=tt)}return z(le);case f:e:{for(It=_e.key;ee!==null;){if(ee.key===It)if(ee.tag===4&&ee.stateNode.containerInfo===_e.containerInfo&&ee.stateNode.implementation===_e.implementation){p(le,ee.sibling),ee=E(ee,_e.children||[]),ee.return=le,le=ee;break e}else{p(le,ee);break}else u(le,ee);ee=ee.sibling}ee=Mg(_e,le.mode,tt),ee.return=le,le=ee}return z(le);case M:return It=_e._init,dr(le,ee,It(_e._payload),tt)}if(Z(_e))return ht(le,ee,_e,tt);if(b(_e))return ii(le,ee,_e,tt);zf(le,_e)}return typeof _e=="string"&&_e!==""||typeof _e=="number"?(_e=""+_e,ee!==null&&ee.tag===6?(p(le,ee.sibling),ee=E(ee,_e),ee.return=le,le=ee):(p(le,ee),ee=Sg(_e,le.mode,tt),ee.return=le,le=ee),z(le)):p(le,ee)}return dr}var Va=Lx(!0),Ix=Lx(!1),_u={},lr=Sn(_u),xu=Sn(_u),Ga=Sn(_u);function jr(l){if(l===_u)throw Error(o(174));return l}function zm(l,u){it(Ga,u),it(xu,l),it(lr,_u),l=he(u),_t(lr),it(lr,l)}function Wa(){_t(lr),_t(xu),_t(Ga)}function Nx(l){var u=jr(Ga.current),p=jr(lr.current);u=F(p,l.type,u),p!==u&&(it(xu,l),it(lr,u))}function Bm(l){xu.current===l&&(_t(lr),_t(xu))}var un=Sn(0);function Bf(l){for(var u=l;u!==null;){if(u.tag===13){var p=u.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||Tt(p)||Xt(p)))return u}else if(u.tag===19&&u.memoizedProps.revealOrder!==void 0){if(u.flags&128)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}var Hm=[];function Vm(){for(var l=0;l<Hm.length;l++){var u=Hm[l];ke?u._workInProgressVersionPrimary=null:u._workInProgressVersionSecondary=null}Hm.length=0}var Hf=a.ReactCurrentDispatcher,ur=a.ReactCurrentBatchConfig,Xa=0,vn=null,ei=null,Vn=null,Vf=!1,Su=!1,Mu=0,g2=0;function ti(){throw Error(o(321))}function Gm(l,u){if(u===null)return!1;for(var p=0;p<u.length&&p<l.length;p++)if(!Gr(l[p],u[p]))return!1;return!0}function Wm(l,u,p,_,E,A){if(Xa=A,vn=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,Hf.current=l===null||l.memoizedState===null?x2:S2,l=p(_,E),Su){A=0;do{if(Su=!1,Mu=0,25<=A)throw Error(o(301));A+=1,Vn=ei=null,u.updateQueue=null,Hf.current=M2,l=p(_,E)}while(Su)}if(Hf.current=Yf,u=ei!==null&&ei.next!==null,Xa=0,Vn=ei=vn=null,Vf=!1,u)throw Error(o(300));return l}function Xm(){var l=Mu!==0;return Mu=0,l}function cs(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Vn===null?vn.memoizedState=Vn=l:Vn=Vn.next=l,Vn}function Yr(){if(ei===null){var l=vn.alternate;l=l!==null?l.memoizedState:null}else l=ei.next;var u=Vn===null?vn.memoizedState:Vn.next;if(u!==null)Vn=u,ei=l;else{if(l===null)throw Error(o(310));ei=l,l={memoizedState:ei.memoizedState,baseState:ei.baseState,baseQueue:ei.baseQueue,queue:ei.queue,next:null},Vn===null?vn.memoizedState=Vn=l:Vn=Vn.next=l}return Vn}function Do(l,u){return typeof u=="function"?u(l):u}function Gf(l){var u=Yr(),p=u.queue;if(p===null)throw Error(o(311));p.lastRenderedReducer=l;var _=ei,E=_.baseQueue,A=p.pending;if(A!==null){if(E!==null){var z=E.next;E.next=A.next,A.next=z}_.baseQueue=E=A,p.pending=null}if(E!==null){A=E.next,_=_.baseState;var K=z=null,Se=null,He=A;do{var st=He.lane;if((Xa&st)===st)Se!==null&&(Se=Se.next={lane:0,action:He.action,hasEagerState:He.hasEagerState,eagerState:He.eagerState,next:null}),_=He.hasEagerState?He.eagerState:l(_,He.action);else{var At={lane:st,action:He.action,hasEagerState:He.hasEagerState,eagerState:He.eagerState,next:null};Se===null?(K=Se=At,z=_):Se=Se.next=At,vn.lanes|=st,Ya|=st}He=He.next}while(He!==null&&He!==A);Se===null?z=_:Se.next=K,Gr(_,u.memoizedState)||(Xi=!0),u.memoizedState=_,u.baseState=z,u.baseQueue=Se,p.lastRenderedState=_}if(l=p.interleaved,l!==null){E=l;do A=E.lane,vn.lanes|=A,Ya|=A,E=E.next;while(E!==l)}else E===null&&(p.lanes=0);return[u.memoizedState,p.dispatch]}function Wf(l){var u=Yr(),p=u.queue;if(p===null)throw Error(o(311));p.lastRenderedReducer=l;var _=p.dispatch,E=p.pending,A=u.memoizedState;if(E!==null){p.pending=null;var z=E=E.next;do A=l(A,z.action),z=z.next;while(z!==E);Gr(A,u.memoizedState)||(Xi=!0),u.memoizedState=A,u.baseQueue===null&&(u.baseState=A),p.lastRenderedState=A}return[A,_]}function Dx(){}function Ux(l,u){var p=vn,_=Yr(),E=u(),A=!Gr(_.memoizedState,E);if(A&&(_.memoizedState=E,Xi=!0),_=_.queue,Eu(Fx.bind(null,p,_,l),[l]),_.getSnapshot!==u||A||Vn!==null&&Vn.memoizedState.tag&1){if(p.flags|=2048,wu(9,kx.bind(null,p,_,E,u),void 0,null),Cn===null)throw Error(o(349));Xa&30||Ox(p,u,E)}return E}function Ox(l,u,p){l.flags|=16384,l={getSnapshot:u,value:p},u=vn.updateQueue,u===null?(u={lastEffect:null,stores:null},vn.updateQueue=u,u.stores=[l]):(p=u.stores,p===null?u.stores=[l]:p.push(l))}function kx(l,u,p,_){u.value=p,u.getSnapshot=_,zx(u)&&cr(l,1,-1)}function Fx(l,u,p){return p(function(){zx(u)&&cr(l,1,-1)})}function zx(l){var u=l.getSnapshot;l=l.value;try{var p=u();return!Gr(l,p)}catch{return!0}}function jm(l){var u=cs();return typeof l=="function"&&(l=l()),u.memoizedState=u.baseState=l,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Do,lastRenderedState:l},u.queue=l,l=l.dispatch=_2.bind(null,vn,l),[u.memoizedState,l]}function wu(l,u,p,_){return l={tag:l,create:u,destroy:p,deps:_,next:null},u=vn.updateQueue,u===null?(u={lastEffect:null,stores:null},vn.updateQueue=u,u.lastEffect=l.next=l):(p=u.lastEffect,p===null?u.lastEffect=l.next=l:(_=p.next,p.next=l,l.next=_,u.lastEffect=l)),l}function Bx(){return Yr().memoizedState}function Xf(l,u,p,_){var E=cs();vn.flags|=l,E.memoizedState=wu(1|u,p,void 0,_===void 0?null:_)}function jf(l,u,p,_){var E=Yr();_=_===void 0?null:_;var A=void 0;if(ei!==null){var z=ei.memoizedState;if(A=z.destroy,_!==null&&Gm(_,z.deps)){E.memoizedState=wu(u,p,A,_);return}}vn.flags|=l,E.memoizedState=wu(1|u,p,A,_)}function Ym(l,u){return Xf(8390656,8,l,u)}function Eu(l,u){return jf(2048,8,l,u)}function Hx(l,u){return jf(4,2,l,u)}function Vx(l,u){return jf(4,4,l,u)}function Gx(l,u){if(typeof u=="function")return l=l(),u(l),function(){u(null)};if(u!=null)return l=l(),u.current=l,function(){u.current=null}}function Wx(l,u,p){return p=p!=null?p.concat([l]):null,jf(4,4,Gx.bind(null,u,l),p)}function qm(){}function Xx(l,u){var p=Yr();u=u===void 0?null:u;var _=p.memoizedState;return _!==null&&u!==null&&Gm(u,_[1])?_[0]:(p.memoizedState=[l,u],l)}function jx(l,u){var p=Yr();u=u===void 0?null:u;var _=p.memoizedState;return _!==null&&u!==null&&Gm(u,_[1])?_[0]:(l=l(),p.memoizedState=[l,u],l)}function v2(l,u){var p=Ht;Ht=p!==0&&4>p?p:4,l(!0);var _=ur.transition;ur.transition={};try{l(!1),u()}finally{Ht=p,ur.transition=_}}function Yx(){return Yr().memoizedState}function y2(l,u,p){var _=Vs(l);p={lane:_,action:p,hasEagerState:!1,eagerState:null,next:null},qx(l)?Zx(u,p):(Kx(l,u,p),p=yi(),l=cr(l,_,p),l!==null&&Jx(l,u,_))}function _2(l,u,p){var _=Vs(l),E={lane:_,action:p,hasEagerState:!1,eagerState:null,next:null};if(qx(l))Zx(u,E);else{Kx(l,u,E);var A=l.alternate;if(l.lanes===0&&(A===null||A.lanes===0)&&(A=u.lastRenderedReducer,A!==null))try{var z=u.lastRenderedState,K=A(z,p);if(E.hasEagerState=!0,E.eagerState=K,Gr(K,z))return}catch{}finally{}p=yi(),l=cr(l,_,p),l!==null&&Jx(l,u,_)}}function qx(l){var u=l.alternate;return l===vn||u!==null&&u===vn}function Zx(l,u){Su=Vf=!0;var p=l.pending;p===null?u.next=u:(u.next=p.next,p.next=u),l.pending=u}function Kx(l,u,p){Cn!==null&&l.mode&1&&!(Ot&2)?(l=u.interleaved,l===null?(p.next=p,Xr===null?Xr=[u]:Xr.push(u)):(p.next=l.next,l.next=p),u.interleaved=p):(l=u.pending,l===null?p.next=p:(p.next=l.next,l.next=p),u.pending=p)}function Jx(l,u,p){if(p&4194240){var _=u.lanes;_&=l.pendingLanes,p|=_,u.lanes=p,Mm(l,p)}}var Yf={readContext:sr,useCallback:ti,useContext:ti,useEffect:ti,useImperativeHandle:ti,useInsertionEffect:ti,useLayoutEffect:ti,useMemo:ti,useReducer:ti,useRef:ti,useState:ti,useDebugValue:ti,useDeferredValue:ti,useTransition:ti,useMutableSource:ti,useSyncExternalStore:ti,useId:ti,unstable_isNewReconciler:!1},x2={readContext:sr,useCallback:function(l,u){return cs().memoizedState=[l,u===void 0?null:u],l},useContext:sr,useEffect:Ym,useImperativeHandle:function(l,u,p){return p=p!=null?p.concat([l]):null,Xf(4194308,4,Gx.bind(null,u,l),p)},useLayoutEffect:function(l,u){return Xf(4194308,4,l,u)},useInsertionEffect:function(l,u){return Xf(4,2,l,u)},useMemo:function(l,u){var p=cs();return u=u===void 0?null:u,l=l(),p.memoizedState=[l,u],l},useReducer:function(l,u,p){var _=cs();return u=p!==void 0?p(u):u,_.memoizedState=_.baseState=u,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:u},_.queue=l,l=l.dispatch=y2.bind(null,vn,l),[_.memoizedState,l]},useRef:function(l){var u=cs();return l={current:l},u.memoizedState=l},useState:jm,useDebugValue:qm,useDeferredValue:function(l){var u=jm(l),p=u[0],_=u[1];return Ym(function(){var E=ur.transition;ur.transition={};try{_(l)}finally{ur.transition=E}},[l]),p},useTransition:function(){var l=jm(!1),u=l[0];return l=v2.bind(null,l[1]),cs().memoizedState=l,[u,l]},useMutableSource:function(){},useSyncExternalStore:function(l,u,p){var _=vn,E=cs();if(an){if(p===void 0)throw Error(o(407));p=p()}else{if(p=u(),Cn===null)throw Error(o(349));Xa&30||Ox(_,u,p)}E.memoizedState=p;var A={value:p,getSnapshot:u};return E.queue=A,Ym(Fx.bind(null,_,A,l),[l]),_.flags|=2048,wu(9,kx.bind(null,_,A,p,u),void 0,null),p},useId:function(){var l=cs(),u=Cn.identifierPrefix;if(an){var p=us,_=ls;p=(_&~(1<<32-Vi(_)-1)).toString(32)+p,u=":"+u+"R"+p,p=Mu++,0<p&&(u+="H"+p.toString(32)),u+=":"}else p=g2++,u=":"+u+"r"+p.toString(32)+":";return l.memoizedState=u},unstable_isNewReconciler:!1},S2={readContext:sr,useCallback:Xx,useContext:sr,useEffect:Eu,useImperativeHandle:Wx,useInsertionEffect:Hx,useLayoutEffect:Vx,useMemo:jx,useReducer:Gf,useRef:Bx,useState:function(){return Gf(Do)},useDebugValue:qm,useDeferredValue:function(l){var u=Gf(Do),p=u[0],_=u[1];return Eu(function(){var E=ur.transition;ur.transition={};try{_(l)}finally{ur.transition=E}},[l]),p},useTransition:function(){var l=Gf(Do)[0],u=Yr().memoizedState;return[l,u]},useMutableSource:Dx,useSyncExternalStore:Ux,useId:Yx,unstable_isNewReconciler:!1},M2={readContext:sr,useCallback:Xx,useContext:sr,useEffect:Eu,useImperativeHandle:Wx,useInsertionEffect:Hx,useLayoutEffect:Vx,useMemo:jx,useReducer:Wf,useRef:Bx,useState:function(){return Wf(Do)},useDebugValue:qm,useDeferredValue:function(l){var u=Wf(Do),p=u[0],_=u[1];return Eu(function(){var E=ur.transition;ur.transition={};try{_(l)}finally{ur.transition=E}},[l]),p},useTransition:function(){var l=Wf(Do)[0],u=Yr().memoizedState;return[l,u]},useMutableSource:Dx,useSyncExternalStore:Ux,useId:Yx,unstable_isNewReconciler:!1};function Zm(l,u){try{var p="",_=u;do p+=m2(_),_=_.return;while(_);var E=p}catch(A){E=`
Error generating stack: `+A.message+`
`+A.stack}return{value:l,source:u,stack:E}}function Km(l,u){try{console.error(u.value)}catch(p){setTimeout(function(){throw p})}}var w2=typeof WeakMap=="function"?WeakMap:Map;function Qx(l,u,p){p=as(-1,p),p.tag=3,p.payload={element:null};var _=u.value;return p.callback=function(){ud||(ud=!0,pg=_),Km(l,u)},p}function $x(l,u,p){p=as(-1,p),p.tag=3;var _=l.type.getDerivedStateFromError;if(typeof _=="function"){var E=u.value;p.payload=function(){return _(E)},p.callback=function(){Km(l,u)}}var A=l.stateNode;return A!==null&&typeof A.componentDidCatch=="function"&&(p.callback=function(){Km(l,u),typeof _!="function"&&(Bs===null?Bs=new Set([this]):Bs.add(this));var z=u.stack;this.componentDidCatch(u.value,{componentStack:z!==null?z:""})}),p}function eS(l,u,p){var _=l.pingCache;if(_===null){_=l.pingCache=new w2;var E=new Set;_.set(u,E)}else E=_.get(u),E===void 0&&(E=new Set,_.set(u,E));E.has(p)||(E.add(p),l=k2.bind(null,l,u,p),u.then(l,l))}function tS(l){do{var u;if((u=l.tag===13)&&(u=l.memoizedState,u=u!==null?u.dehydrated!==null:!0),u)return l;l=l.return}while(l!==null);return null}function nS(l,u,p,_,E){return l.mode&1?(l.flags|=65536,l.lanes=E,l):(l===u?l.flags|=65536:(l.flags|=128,p.flags|=131072,p.flags&=-52805,p.tag===1&&(p.alternate===null?p.tag=17:(u=as(-1,1),u.tag=2,zs(p,u))),p.lanes|=1),l)}function qr(l){l.flags|=4}function iS(l,u){if(l!==null&&l.child===u.child)return!0;if(u.flags&16)return!1;for(l=u.child;l!==null;){if(l.flags&12854||l.subtreeFlags&12854)return!1;l=l.sibling}return!0}var Tu,Au,qf,Zf;if(Le)Tu=function(l,u){for(var p=u.child;p!==null;){if(p.tag===5||p.tag===6)se(l,p.stateNode);else if(p.tag!==4&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===u)break;for(;p.sibling===null;){if(p.return===null||p.return===u)return;p=p.return}p.sibling.return=p.return,p=p.sibling}},Au=function(){},qf=function(l,u,p,_,E){if(l=l.memoizedProps,l!==_){var A=u.stateNode,z=jr(lr.current);p=ge(A,p,l,_,E,z),(u.updateQueue=p)&&qr(u)}},Zf=function(l,u,p,_){p!==_&&qr(u)};else if(H){Tu=function(l,u,p,_){for(var E=u.child;E!==null;){if(E.tag===5){var A=E.stateNode;p&&_&&(A=Re(A,E.type,E.memoizedProps,E)),se(l,A)}else if(E.tag===6)A=E.stateNode,p&&_&&(A=Pe(A,E.memoizedProps,E)),se(l,A);else if(E.tag!==4){if(E.tag===22&&E.memoizedState!==null)A=E.child,A!==null&&(A.return=E),Tu(l,E,!0,!0);else if(E.child!==null){E.child.return=E,E=E.child;continue}}if(E===u)break;for(;E.sibling===null;){if(E.return===null||E.return===u)return;E=E.return}E.sibling.return=E.return,E=E.sibling}};var rS=function(l,u,p,_){for(var E=u.child;E!==null;){if(E.tag===5){var A=E.stateNode;p&&_&&(A=Re(A,E.type,E.memoizedProps,E)),ue(l,A)}else if(E.tag===6)A=E.stateNode,p&&_&&(A=Pe(A,E.memoizedProps,E)),ue(l,A);else if(E.tag!==4){if(E.tag===22&&E.memoizedState!==null)A=E.child,A!==null&&(A.return=E),rS(l,E,!0,!0);else if(E.child!==null){E.child.return=E,E=E.child;continue}}if(E===u)break;for(;E.sibling===null;){if(E.return===null||E.return===u)return;E=E.return}E.sibling.return=E.return,E=E.sibling}};Au=function(l,u){var p=u.stateNode;if(!iS(l,u)){l=p.containerInfo;var _=re(l);rS(_,u,!1,!1),p.pendingChildren=_,qr(u),Me(l,_)}},qf=function(l,u,p,_,E){var A=l.stateNode,z=l.memoizedProps;if((l=iS(l,u))&&z===_)u.stateNode=A;else{var K=u.stateNode,Se=jr(lr.current),He=null;z!==_&&(He=ge(K,p,z,_,E,Se)),l&&He===null?u.stateNode=A:(A=D(A,He,p,z,_,u,l,K),J(A,p,_,E,Se)&&qr(u),u.stateNode=A,l?qr(u):Tu(A,u,!1,!1))}},Zf=function(l,u,p,_){p!==_?(l=jr(Ga.current),p=jr(lr.current),u.stateNode=Be(_,l,p,u),qr(u)):u.stateNode=l.stateNode}}else Au=function(){},qf=function(){},Zf=function(){};function bu(l,u){if(!an)switch(l.tailMode){case"hidden":u=l.tail;for(var p=null;u!==null;)u.alternate!==null&&(p=u),u=u.sibling;p===null?l.tail=null:p.sibling=null;break;case"collapsed":p=l.tail;for(var _=null;p!==null;)p.alternate!==null&&(_=p),p=p.sibling;_===null?u||l.tail===null?l.tail=null:l.tail.sibling=null:_.sibling=null}}function ni(l){var u=l.alternate!==null&&l.alternate.child===l.child,p=0,_=0;if(u)for(var E=l.child;E!==null;)p|=E.lanes|E.childLanes,_|=E.subtreeFlags&14680064,_|=E.flags&14680064,E.return=l,E=E.sibling;else for(E=l.child;E!==null;)p|=E.lanes|E.childLanes,_|=E.subtreeFlags,_|=E.flags,E.return=l,E=E.sibling;return l.subtreeFlags|=_,l.childLanes=p,u}function E2(l,u,p){var _=u.pendingProps;switch(Um(u),u.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ni(u),null;case 1:return Bn(u.type)&&Mn(),ni(u),null;case 3:return _=u.stateNode,Wa(),_t(gn),_t(Rt),Vm(),_.pendingContext&&(_.context=_.pendingContext,_.pendingContext=null),(l===null||l.child===null)&&(vu(u)?qr(u):l===null||l.memoizedState.isDehydrated&&!(u.flags&256)||(u.flags|=1024,wr!==null&&(vg(wr),wr=null))),Au(l,u),ni(u),null;case 5:Bm(u),p=jr(Ga.current);var E=u.type;if(l!==null&&u.stateNode!=null)qf(l,u,E,_,p),l.ref!==u.ref&&(u.flags|=512,u.flags|=2097152);else{if(!_){if(u.stateNode===null)throw Error(o(166));return ni(u),null}if(l=jr(lr.current),vu(u)){if(!xe)throw Error(o(175));l=Yn(u.stateNode,u.type,u.memoizedProps,p,l,u,!gu),u.updateQueue=l,l!==null&&qr(u)}else{var A=Q(E,_,p,l,u);Tu(A,u,!1,!1),u.stateNode=A,J(A,E,_,p,l)&&qr(u)}u.ref!==null&&(u.flags|=512,u.flags|=2097152)}return ni(u),null;case 6:if(l&&u.stateNode!=null)Zf(l,u,l.memoizedProps,_);else{if(typeof _!="string"&&u.stateNode===null)throw Error(o(166));if(l=jr(Ga.current),p=jr(lr.current),vu(u)){if(!xe)throw Error(o(176));if(l=u.stateNode,_=u.memoizedProps,(p=gi(l,_,u,!gu))&&(E=Gi,E!==null))switch(A=(E.mode&1)!==0,E.tag){case 3:at(E.stateNode.containerInfo,l,_,A);break;case 5:pt(E.type,E.memoizedProps,E.stateNode,l,_,A)}p&&qr(u)}else u.stateNode=Be(_,l,p,u)}return ni(u),null;case 13:if(_t(un),_=u.memoizedState,an&&Wi!==null&&u.mode&1&&!(u.flags&128)){for(l=Wi;l;)l=Xe(l);return Ha(),u.flags|=98560,u}if(_!==null&&_.dehydrated!==null){if(_=vu(u),l===null){if(!_)throw Error(o(318));if(!xe)throw Error(o(344));if(l=u.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(o(317));Hi(l,u)}else Ha(),!(u.flags&128)&&(u.memoizedState=null),u.flags|=4;return ni(u),null}return wr!==null&&(vg(wr),wr=null),u.flags&128?(u.lanes=p,u):(_=_!==null,p=!1,l===null?vu(u):p=l.memoizedState!==null,_&&!p&&(u.child.flags|=8192,u.mode&1&&(l===null||un.current&1?Nn===0&&(Nn=3):_g())),u.updateQueue!==null&&(u.flags|=4),ni(u),null);case 4:return Wa(),Au(l,u),l===null&&Ue(u.stateNode.containerInfo),ni(u),null;case 10:return Rm(u.type._context),ni(u),null;case 17:return Bn(u.type)&&Mn(),ni(u),null;case 19:if(_t(un),E=u.memoizedState,E===null)return ni(u),null;if(_=(u.flags&128)!==0,A=E.rendering,A===null)if(_)bu(E,!1);else{if(Nn!==0||l!==null&&l.flags&128)for(l=u.child;l!==null;){if(A=Bf(l),A!==null){for(u.flags|=128,bu(E,!1),l=A.updateQueue,l!==null&&(u.updateQueue=l,u.flags|=4),u.subtreeFlags=0,l=p,_=u.child;_!==null;)p=_,E=l,p.flags&=14680066,A=p.alternate,A===null?(p.childLanes=0,p.lanes=E,p.child=null,p.subtreeFlags=0,p.memoizedProps=null,p.memoizedState=null,p.updateQueue=null,p.dependencies=null,p.stateNode=null):(p.childLanes=A.childLanes,p.lanes=A.lanes,p.child=A.child,p.subtreeFlags=0,p.deletions=null,p.memoizedProps=A.memoizedProps,p.memoizedState=A.memoizedState,p.updateQueue=A.updateQueue,p.type=A.type,E=A.dependencies,p.dependencies=E===null?null:{lanes:E.lanes,firstContext:E.firstContext}),_=_.sibling;return it(un,un.current&1|2),u.child}l=l.sibling}E.tail!==null&&Hn()>hg&&(u.flags|=128,_=!0,bu(E,!1),u.lanes=4194304)}else{if(!_)if(l=Bf(A),l!==null){if(u.flags|=128,_=!0,l=l.updateQueue,l!==null&&(u.updateQueue=l,u.flags|=4),bu(E,!0),E.tail===null&&E.tailMode==="hidden"&&!A.alternate&&!an)return ni(u),null}else 2*Hn()-E.renderingStartTime>hg&&p!==1073741824&&(u.flags|=128,_=!0,bu(E,!1),u.lanes=4194304);E.isBackwards?(A.sibling=u.child,u.child=A):(l=E.last,l!==null?l.sibling=A:u.child=A,E.last=A)}return E.tail!==null?(u=E.tail,E.rendering=u,E.tail=u.sibling,E.renderingStartTime=Hn(),u.sibling=null,l=un.current,it(un,_?l&1|2:l&1),u):(ni(u),null);case 22:case 23:return yg(),_=u.memoizedState!==null,l!==null&&l.memoizedState!==null!==_&&(u.flags|=8192),_&&u.mode&1?ji&1073741824&&(ni(u),Le&&u.subtreeFlags&6&&(u.flags|=8192)):ni(u),null;case 24:return null;case 25:return null}throw Error(o(156,u.tag))}var T2=a.ReactCurrentOwner,Xi=!1;function vi(l,u,p,_){u.child=l===null?Ix(u,null,p,_):Va(u,l.child,p,_)}function sS(l,u,p,_,E){p=p.render;var A=u.ref;return Fa(u,E),_=Wm(l,u,p,_,A,E),p=Xm(),l!==null&&!Xi?(u.updateQueue=l.updateQueue,u.flags&=-2053,l.lanes&=~E,fs(l,u,E)):(an&&p&&Dm(u),u.flags|=1,vi(l,u,_,E),u.child)}function oS(l,u,p,_,E){if(l===null){var A=p.type;return typeof A=="function"&&!xg(A)&&A.defaultProps===void 0&&p.compare===null&&p.defaultProps===void 0?(u.tag=15,u.type=A,aS(l,u,A,_,E)):(l=gd(p.type,null,_,u,u.mode,E),l.ref=u.ref,l.return=u,u.child=l)}if(A=l.child,!(l.lanes&E)){var z=A.memoizedProps;if(p=p.compare,p=p!==null?p:Lf,p(z,_)&&l.ref===u.ref)return fs(l,u,E)}return u.flags|=1,l=Ws(A,_),l.ref=u.ref,l.return=u,u.child=l}function aS(l,u,p,_,E){if(l!==null&&Lf(l.memoizedProps,_)&&l.ref===u.ref)if(Xi=!1,(l.lanes&E)!==0)l.flags&131072&&(Xi=!0);else return u.lanes=l.lanes,fs(l,u,E);return Jm(l,u,p,_,E)}function lS(l,u,p){var _=u.pendingProps,E=_.children,A=l!==null?l.memoizedState:null;if(_.mode==="hidden")if(!(u.mode&1))u.memoizedState={baseLanes:0,cachePool:null},it(ja,ji),ji|=p;else if(p&1073741824)u.memoizedState={baseLanes:0,cachePool:null},_=A!==null?A.baseLanes:p,it(ja,ji),ji|=_;else return l=A!==null?A.baseLanes|p:p,u.lanes=u.childLanes=1073741824,u.memoizedState={baseLanes:l,cachePool:null},u.updateQueue=null,it(ja,ji),ji|=l,null;else A!==null?(_=A.baseLanes|p,u.memoizedState=null):_=p,it(ja,ji),ji|=_;return vi(l,u,E,p),u.child}function uS(l,u){var p=u.ref;(l===null&&p!==null||l!==null&&l.ref!==p)&&(u.flags|=512,u.flags|=2097152)}function Jm(l,u,p,_,E){var A=Bn(p)?Br:Rt.current;return A=rr(u,A),Fa(u,E),p=Wm(l,u,p,_,A,E),_=Xm(),l!==null&&!Xi?(u.updateQueue=l.updateQueue,u.flags&=-2053,l.lanes&=~E,fs(l,u,E)):(an&&_&&Dm(u),u.flags|=1,vi(l,u,p,E),u.child)}function cS(l,u,p,_,E){if(Bn(p)){var A=!0;qn(u)}else A=!1;if(Fa(u,E),u.stateNode===null)l!==null&&(l.alternate=null,u.alternate=null,u.flags|=2),Ex(u,p,_),Nm(u,p,_,E),_=!0;else if(l===null){var z=u.stateNode,K=u.memoizedProps;z.props=K;var Se=z.context,He=p.contextType;typeof He=="object"&&He!==null?He=sr(He):(He=Bn(p)?Br:Rt.current,He=rr(u,He));var st=p.getDerivedStateFromProps,At=typeof st=="function"||typeof z.getSnapshotBeforeUpdate=="function";At||typeof z.UNSAFE_componentWillReceiveProps!="function"&&typeof z.componentWillReceiveProps!="function"||(K!==_||Se!==He)&&Tx(u,z,_,He),Fs=!1;var gt=u.memoizedState;z.state=gt,Uf(u,_,z,E),Se=u.memoizedState,K!==_||gt!==Se||gn.current||Fs?(typeof st=="function"&&(Im(u,p,st,_),Se=u.memoizedState),(K=Fs||wx(u,p,K,_,gt,Se,He))?(At||typeof z.UNSAFE_componentWillMount!="function"&&typeof z.componentWillMount!="function"||(typeof z.componentWillMount=="function"&&z.componentWillMount(),typeof z.UNSAFE_componentWillMount=="function"&&z.UNSAFE_componentWillMount()),typeof z.componentDidMount=="function"&&(u.flags|=4194308)):(typeof z.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=_,u.memoizedState=Se),z.props=_,z.state=Se,z.context=He,_=K):(typeof z.componentDidMount=="function"&&(u.flags|=4194308),_=!1)}else{z=u.stateNode,_x(l,u),K=u.memoizedProps,He=u.type===u.elementType?K:Mr(u.type,K),z.props=He,At=u.pendingProps,gt=z.context,Se=p.contextType,typeof Se=="object"&&Se!==null?Se=sr(Se):(Se=Bn(p)?Br:Rt.current,Se=rr(u,Se));var Qt=p.getDerivedStateFromProps;(st=typeof Qt=="function"||typeof z.getSnapshotBeforeUpdate=="function")||typeof z.UNSAFE_componentWillReceiveProps!="function"&&typeof z.componentWillReceiveProps!="function"||(K!==At||gt!==Se)&&Tx(u,z,_,Se),Fs=!1,gt=u.memoizedState,z.state=gt,Uf(u,_,z,E);var ht=u.memoizedState;K!==At||gt!==ht||gn.current||Fs?(typeof Qt=="function"&&(Im(u,p,Qt,_),ht=u.memoizedState),(He=Fs||wx(u,p,He,_,gt,ht,Se)||!1)?(st||typeof z.UNSAFE_componentWillUpdate!="function"&&typeof z.componentWillUpdate!="function"||(typeof z.componentWillUpdate=="function"&&z.componentWillUpdate(_,ht,Se),typeof z.UNSAFE_componentWillUpdate=="function"&&z.UNSAFE_componentWillUpdate(_,ht,Se)),typeof z.componentDidUpdate=="function"&&(u.flags|=4),typeof z.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof z.componentDidUpdate!="function"||K===l.memoizedProps&&gt===l.memoizedState||(u.flags|=4),typeof z.getSnapshotBeforeUpdate!="function"||K===l.memoizedProps&&gt===l.memoizedState||(u.flags|=1024),u.memoizedProps=_,u.memoizedState=ht),z.props=_,z.state=ht,z.context=Se,_=He):(typeof z.componentDidUpdate!="function"||K===l.memoizedProps&&gt===l.memoizedState||(u.flags|=4),typeof z.getSnapshotBeforeUpdate!="function"||K===l.memoizedProps&&gt===l.memoizedState||(u.flags|=1024),_=!1)}return Qm(l,u,p,_,A,E)}function Qm(l,u,p,_,E,A){uS(l,u);var z=(u.flags&128)!==0;if(!_&&!z)return E&&Oa(u,p,!1),fs(l,u,A);_=u.stateNode,T2.current=u;var K=z&&typeof p.getDerivedStateFromError!="function"?null:_.render();return u.flags|=1,l!==null&&z?(u.child=Va(u,l.child,null,A),u.child=Va(u,null,K,A)):vi(l,u,K,A),u.memoizedState=_.state,E&&Oa(u,p,!0),u.child}function fS(l){var u=l.stateNode;u.pendingContext?Hr(l,u.pendingContext,u.pendingContext!==u.context):u.context&&Hr(l,u.context,!1),zm(l,u.containerInfo)}function dS(l,u,p,_,E){return Ha(),Fm(E),u.flags|=256,vi(l,u,p,_),u.child}var Kf={dehydrated:null,treeContext:null,retryLane:0};function Jf(l){return{baseLanes:l,cachePool:null}}function hS(l,u,p){var _=u.pendingProps,E=un.current,A=!1,z=(u.flags&128)!==0,K;if((K=z)||(K=l!==null&&l.memoizedState===null?!1:(E&2)!==0),K?(A=!0,u.flags&=-129):(l===null||l.memoizedState!==null)&&(E|=1),it(un,E&1),l===null)return km(u),l=u.memoizedState,l!==null&&(l=l.dehydrated,l!==null)?(u.mode&1?Xt(l)?u.lanes=8:u.lanes=1073741824:u.lanes=1,null):(E=_.children,l=_.fallback,A?(_=u.mode,A=u.child,E={mode:"hidden",children:E},!(_&1)&&A!==null?(A.childLanes=0,A.pendingProps=E):A=vd(E,_,0,null),l=Bo(l,_,p,null),A.return=u,l.return=u,A.sibling=l,u.child=A,u.child.memoizedState=Jf(p),u.memoizedState=Kf,l):$m(u,E));if(E=l.memoizedState,E!==null){if(K=E.dehydrated,K!==null){if(z)return u.flags&256?(u.flags&=-257,Qf(l,u,p,Error(o(422)))):u.memoizedState!==null?(u.child=l.child,u.flags|=128,null):(A=_.fallback,E=u.mode,_=vd({mode:"visible",children:_.children},E,0,null),A=Bo(A,E,p,null),A.flags|=2,_.return=u,A.return=u,_.sibling=A,u.child=_,u.mode&1&&Va(u,l.child,null,p),u.child.memoizedState=Jf(p),u.memoizedState=Kf,A);if(!(u.mode&1))u=Qf(l,u,p,null);else if(Xt(K))u=Qf(l,u,p,Error(o(419)));else if(_=(p&l.childLanes)!==0,Xi||_){if(_=Cn,_!==null){switch(p&-p){case 4:A=2;break;case 16:A=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:A=32;break;case 536870912:A=268435456;break;default:A=0}_=A&(_.suspendedLanes|p)?0:A,_!==0&&_!==E.retryLane&&(E.retryLane=_,cr(l,_,-1))}_g(),u=Qf(l,u,p,Error(o(421)))}else Tt(K)?(u.flags|=128,u.child=l.child,u=F2.bind(null,l),Ut(K,u),u=null):(p=E.treeContext,xe&&(Wi=$t(K),Gi=u,an=!0,wr=null,gu=!1,p!==null&&(or[ar++]=ls,or[ar++]=us,or[ar++]=Io,ls=p.id,us=p.overflow,Io=u)),u=$m(u,u.pendingProps.children),u.flags|=4096);return u}return A?(_=mS(l,u,_.children,_.fallback,p),A=u.child,E=l.child.memoizedState,A.memoizedState=E===null?Jf(p):{baseLanes:E.baseLanes|p,cachePool:null},A.childLanes=l.childLanes&~p,u.memoizedState=Kf,_):(p=pS(l,u,_.children,p),u.memoizedState=null,p)}return A?(_=mS(l,u,_.children,_.fallback,p),A=u.child,E=l.child.memoizedState,A.memoizedState=E===null?Jf(p):{baseLanes:E.baseLanes|p,cachePool:null},A.childLanes=l.childLanes&~p,u.memoizedState=Kf,_):(p=pS(l,u,_.children,p),u.memoizedState=null,p)}function $m(l,u){return u=vd({mode:"visible",children:u},l.mode,0,null),u.return=l,l.child=u}function pS(l,u,p,_){var E=l.child;return l=E.sibling,p=Ws(E,{mode:"visible",children:p}),!(u.mode&1)&&(p.lanes=_),p.return=u,p.sibling=null,l!==null&&(_=u.deletions,_===null?(u.deletions=[l],u.flags|=16):_.push(l)),u.child=p}function mS(l,u,p,_,E){var A=u.mode;l=l.child;var z=l.sibling,K={mode:"hidden",children:p};return!(A&1)&&u.child!==l?(p=u.child,p.childLanes=0,p.pendingProps=K,u.deletions=null):(p=Ws(l,K),p.subtreeFlags=l.subtreeFlags&14680064),z!==null?_=Ws(z,_):(_=Bo(_,A,E,null),_.flags|=2),_.return=u,p.return=u,p.sibling=_,u.child=p,_}function Qf(l,u,p,_){return _!==null&&Fm(_),Va(u,l.child,null,p),l=$m(u,u.pendingProps.children),l.flags|=2,u.memoizedState=null,l}function gS(l,u,p){l.lanes|=u;var _=l.alternate;_!==null&&(_.lanes|=u),Pm(l.return,u,p)}function eg(l,u,p,_,E){var A=l.memoizedState;A===null?l.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:_,tail:p,tailMode:E}:(A.isBackwards=u,A.rendering=null,A.renderingStartTime=0,A.last=_,A.tail=p,A.tailMode=E)}function vS(l,u,p){var _=u.pendingProps,E=_.revealOrder,A=_.tail;if(vi(l,u,_.children,p),_=un.current,_&2)_=_&1|2,u.flags|=128;else{if(l!==null&&l.flags&128)e:for(l=u.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&gS(l,p,u);else if(l.tag===19)gS(l,p,u);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===u)break e;for(;l.sibling===null;){if(l.return===null||l.return===u)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}_&=1}if(it(un,_),!(u.mode&1))u.memoizedState=null;else switch(E){case"forwards":for(p=u.child,E=null;p!==null;)l=p.alternate,l!==null&&Bf(l)===null&&(E=p),p=p.sibling;p=E,p===null?(E=u.child,u.child=null):(E=p.sibling,p.sibling=null),eg(u,!1,E,p,A);break;case"backwards":for(p=null,E=u.child,u.child=null;E!==null;){if(l=E.alternate,l!==null&&Bf(l)===null){u.child=E;break}l=E.sibling,E.sibling=p,p=E,E=l}eg(u,!0,p,null,A);break;case"together":eg(u,!1,null,null,void 0);break;default:u.memoizedState=null}return u.child}function fs(l,u,p){if(l!==null&&(u.dependencies=l.dependencies),Ya|=u.lanes,!(p&u.childLanes))return null;if(l!==null&&u.child!==l.child)throw Error(o(153));if(u.child!==null){for(l=u.child,p=Ws(l,l.pendingProps),u.child=p,p.return=u;l.sibling!==null;)l=l.sibling,p=p.sibling=Ws(l,l.pendingProps),p.return=u;p.sibling=null}return u.child}function A2(l,u,p){switch(u.tag){case 3:fS(u),Ha();break;case 5:Nx(u);break;case 1:Bn(u.type)&&qn(u);break;case 4:zm(u,u.stateNode.containerInfo);break;case 10:yx(u,u.type._context,u.memoizedProps.value);break;case 13:var _=u.memoizedState;if(_!==null)return _.dehydrated!==null?(it(un,un.current&1),u.flags|=128,null):p&u.child.childLanes?hS(l,u,p):(it(un,un.current&1),l=fs(l,u,p),l!==null?l.sibling:null);it(un,un.current&1);break;case 19:if(_=(p&u.childLanes)!==0,l.flags&128){if(_)return vS(l,u,p);u.flags|=128}var E=u.memoizedState;if(E!==null&&(E.rendering=null,E.tail=null,E.lastEffect=null),it(un,un.current),_)break;return null;case 22:case 23:return u.lanes=0,lS(l,u,p)}return fs(l,u,p)}function b2(l,u){switch(Um(u),u.tag){case 1:return Bn(u.type)&&Mn(),l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 3:return Wa(),_t(gn),_t(Rt),Vm(),l=u.flags,l&65536&&!(l&128)?(u.flags=l&-65537|128,u):null;case 5:return Bm(u),null;case 13:if(_t(un),l=u.memoizedState,l!==null&&l.dehydrated!==null){if(u.alternate===null)throw Error(o(340));Ha()}return l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 19:return _t(un),null;case 4:return Wa(),null;case 10:return Rm(u.type._context),null;case 22:case 23:return yg(),null;case 24:return null;default:return null}}var $f=!1,Uo=!1,C2=typeof WeakSet=="function"?WeakSet:Set,et=null;function ed(l,u){var p=l.ref;if(p!==null)if(typeof p=="function")try{p(null)}catch(_){Li(l,u,_)}else p.current=null}function tg(l,u,p){try{p()}catch(_){Li(l,u,_)}}var yS=!1;function R2(l,u){for(W(l.containerInfo),et=u;et!==null;)if(l=et,u=l.child,(l.subtreeFlags&1028)!==0&&u!==null)u.return=l,et=u;else for(;et!==null;){l=et;try{var p=l.alternate;if(l.flags&1024)switch(l.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var _=p.memoizedProps,E=p.memoizedState,A=l.stateNode,z=A.getSnapshotBeforeUpdate(l.elementType===l.type?_:Mr(l.type,_),E);A.__reactInternalSnapshotBeforeUpdate=z}break;case 3:Le&&pe(l.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(o(163))}}catch(K){Li(l,l.return,K)}if(u=l.sibling,u!==null){u.return=l.return,et=u;break}et=l.return}return p=yS,yS=!1,p}function Oo(l,u,p){var _=u.updateQueue;if(_=_!==null?_.lastEffect:null,_!==null){var E=_=_.next;do{if((E.tag&l)===l){var A=E.destroy;E.destroy=void 0,A!==void 0&&tg(u,p,A)}E=E.next}while(E!==_)}}function Cu(l,u){if(u=u.updateQueue,u=u!==null?u.lastEffect:null,u!==null){var p=u=u.next;do{if((p.tag&l)===l){var _=p.create;p.destroy=_()}p=p.next}while(p!==u)}}function ng(l){var u=l.ref;if(u!==null){var p=l.stateNode;switch(l.tag){case 5:l=ne(p);break;default:l=p}typeof u=="function"?u(l):u.current=l}}function _S(l,u,p){if(Vr&&typeof Vr.onCommitFiberUnmount=="function")try{Vr.onCommitFiberUnmount(Rf,u)}catch{}switch(u.tag){case 0:case 11:case 14:case 15:if(l=u.updateQueue,l!==null&&(l=l.lastEffect,l!==null)){var _=l=l.next;do{var E=_,A=E.destroy;E=E.tag,A!==void 0&&(E&2||E&4)&&tg(u,p,A),_=_.next}while(_!==l)}break;case 1:if(ed(u,p),l=u.stateNode,typeof l.componentWillUnmount=="function")try{l.props=u.memoizedProps,l.state=u.memoizedState,l.componentWillUnmount()}catch(z){Li(u,p,z)}break;case 5:ed(u,p);break;case 4:Le?TS(l,u,p):H&&H&&(u=u.stateNode.containerInfo,p=re(u),ye(u,p))}}function xS(l,u,p){for(var _=u;;)if(_S(l,_,p),_.child===null||Le&&_.tag===4){if(_===u)break;for(;_.sibling===null;){if(_.return===null||_.return===u)return;_=_.return}_.sibling.return=_.return,_=_.sibling}else _.child.return=_,_=_.child}function SS(l){var u=l.alternate;u!==null&&(l.alternate=null,SS(u)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(u=l.stateNode,u!==null&&Ze(u)),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}function MS(l){return l.tag===5||l.tag===3||l.tag===4}function wS(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||MS(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function ES(l){if(Le){e:{for(var u=l.return;u!==null;){if(MS(u))break e;u=u.return}throw Error(o(160))}var p=u;switch(p.tag){case 5:u=p.stateNode,p.flags&32&&(Ae(u),p.flags&=-33),p=wS(l),rg(l,p,u);break;case 3:case 4:u=p.stateNode.containerInfo,p=wS(l),ig(l,p,u);break;default:throw Error(o(161))}}}function ig(l,u,p){var _=l.tag;if(_===5||_===6)l=l.stateNode,u?ct(p,l,u):yt(p,l);else if(_!==4&&(l=l.child,l!==null))for(ig(l,u,p),l=l.sibling;l!==null;)ig(l,u,p),l=l.sibling}function rg(l,u,p){var _=l.tag;if(_===5||_===6)l=l.stateNode,u?ut(p,l,u):lt(p,l);else if(_!==4&&(l=l.child,l!==null))for(rg(l,u,p),l=l.sibling;l!==null;)rg(l,u,p),l=l.sibling}function TS(l,u,p){for(var _=u,E=!1,A,z;;){if(!E){E=_.return;e:for(;;){if(E===null)throw Error(o(160));switch(A=E.stateNode,E.tag){case 5:z=!1;break e;case 3:A=A.containerInfo,z=!0;break e;case 4:A=A.containerInfo,z=!0;break e}E=E.return}E=!0}if(_.tag===5||_.tag===6)xS(l,_,p),z?j(A,_.stateNode):$e(A,_.stateNode);else if(_.tag===18)z?ie(A,_.stateNode):ce(A,_.stateNode);else if(_.tag===4){if(_.child!==null){A=_.stateNode.containerInfo,z=!0,_.child.return=_,_=_.child;continue}}else if(_S(l,_,p),_.child!==null){_.child.return=_,_=_.child;continue}if(_===u)break;for(;_.sibling===null;){if(_.return===null||_.return===u)return;_=_.return,_.tag===4&&(E=!1)}_.sibling.return=_.return,_=_.sibling}}function sg(l,u){if(Le){switch(u.tag){case 0:case 11:case 14:case 15:Oo(3,u,u.return),Cu(3,u),Oo(5,u,u.return);return;case 1:return;case 5:var p=u.stateNode;if(p!=null){var _=u.memoizedProps;l=l!==null?l.memoizedProps:_;var E=u.type,A=u.updateQueue;u.updateQueue=null,A!==null&&ot(p,A,E,l,_,u)}return;case 6:if(u.stateNode===null)throw Error(o(162));p=u.memoizedProps,Te(u.stateNode,l!==null?l.memoizedProps:p,p);return;case 3:xe&&l!==null&&l.memoizedState.isDehydrated&&q(u.stateNode.containerInfo);return;case 12:return;case 13:td(u);return;case 19:td(u);return;case 17:return}throw Error(o(163))}switch(u.tag){case 0:case 11:case 14:case 15:Oo(3,u,u.return),Cu(3,u),Oo(5,u,u.return);return;case 12:return;case 13:td(u);return;case 19:td(u);return;case 3:xe&&l!==null&&l.memoizedState.isDehydrated&&q(u.stateNode.containerInfo);break;case 22:case 23:return}e:if(H){switch(u.tag){case 1:case 5:case 6:break e;case 3:case 4:u=u.stateNode,ye(u.containerInfo,u.pendingChildren);break e}throw Error(o(163))}}function td(l){var u=l.updateQueue;if(u!==null){l.updateQueue=null;var p=l.stateNode;p===null&&(p=l.stateNode=new C2),u.forEach(function(_){var E=z2.bind(null,l,_);p.has(_)||(p.add(_),_.then(E,E))})}}function P2(l,u){for(et=u;et!==null;){u=et;var p=u.deletions;if(p!==null)for(var _=0;_<p.length;_++){var E=p[_];try{var A=l;Le?TS(A,E,u):xS(A,E,u);var z=E.alternate;z!==null&&(z.return=null),E.return=null}catch(dt){Li(E,u,dt)}}if(p=u.child,u.subtreeFlags&12854&&p!==null)p.return=u,et=p;else for(;et!==null;){u=et;try{var K=u.flags;if(K&32&&Le&&Ae(u.stateNode),K&512){var Se=u.alternate;if(Se!==null){var He=Se.ref;He!==null&&(typeof He=="function"?He(null):He.current=null)}}if(K&8192)switch(u.tag){case 13:if(u.memoizedState!==null){var st=u.alternate;(st===null||st.memoizedState===null)&&(dg=Hn())}break;case 22:var At=u.memoizedState!==null,gt=u.alternate,Qt=gt!==null&&gt.memoizedState!==null;if(p=u,Le){e:if(_=p,E=At,A=null,Le)for(var ht=_;;){if(ht.tag===5){if(A===null){A=ht;var ii=ht.stateNode;E?Ye(ii):De(ht.stateNode,ht.memoizedProps)}}else if(ht.tag===6){if(A===null){var dr=ht.stateNode;E?Je(dr):Y(dr,ht.memoizedProps)}}else if((ht.tag!==22&&ht.tag!==23||ht.memoizedState===null||ht===_)&&ht.child!==null){ht.child.return=ht,ht=ht.child;continue}if(ht===_)break;for(;ht.sibling===null;){if(ht.return===null||ht.return===_)break e;A===ht&&(A=null),ht=ht.return}A===ht&&(A=null),ht.sibling.return=ht.return,ht=ht.sibling}}if(At&&!Qt&&p.mode&1){et=p;for(var le=p.child;le!==null;){for(p=et=le;et!==null;){_=et;var ee=_.child;switch(_.tag){case 0:case 11:case 14:case 15:Oo(4,_,_.return);break;case 1:ed(_,_.return);var _e=_.stateNode;if(typeof _e.componentWillUnmount=="function"){var tt=_.return;try{_e.props=_.memoizedProps,_e.state=_.memoizedState,_e.componentWillUnmount()}catch(dt){Li(_,tt,dt)}}break;case 5:ed(_,_.return);break;case 22:if(_.memoizedState!==null){CS(p);continue}}ee!==null?(ee.return=_,et=ee):CS(p)}le=le.sibling}}}switch(K&4102){case 2:ES(u),u.flags&=-3;break;case 6:ES(u),u.flags&=-3,sg(u.alternate,u);break;case 4096:u.flags&=-4097;break;case 4100:u.flags&=-4097,sg(u.alternate,u);break;case 4:sg(u.alternate,u)}}catch(dt){Li(u,u.return,dt)}if(p=u.sibling,p!==null){p.return=u.return,et=p;break}et=u.return}}}function L2(l,u,p){et=l,AS(l)}function AS(l,u,p){for(var _=(l.mode&1)!==0;et!==null;){var E=et,A=E.child;if(E.tag===22&&_){var z=E.memoizedState!==null||$f;if(!z){var K=E.alternate,Se=K!==null&&K.memoizedState!==null||Uo;K=$f;var He=Uo;if($f=z,(Uo=Se)&&!He)for(et=E;et!==null;)z=et,Se=z.child,z.tag===22&&z.memoizedState!==null?RS(E):Se!==null?(Se.return=z,et=Se):RS(E);for(;A!==null;)et=A,AS(A),A=A.sibling;et=E,$f=K,Uo=He}bS(l)}else E.subtreeFlags&8772&&A!==null?(A.return=E,et=A):bS(l)}}function bS(l){for(;et!==null;){var u=et;if(u.flags&8772){var p=u.alternate;try{if(u.flags&8772)switch(u.tag){case 0:case 11:case 15:Uo||Cu(5,u);break;case 1:var _=u.stateNode;if(u.flags&4&&!Uo)if(p===null)_.componentDidMount();else{var E=u.elementType===u.type?p.memoizedProps:Mr(u.type,p.memoizedProps);_.componentDidUpdate(E,p.memoizedState,_.__reactInternalSnapshotBeforeUpdate)}var A=u.updateQueue;A!==null&&Sx(u,A,_);break;case 3:var z=u.updateQueue;if(z!==null){if(p=null,u.child!==null)switch(u.child.tag){case 5:p=ne(u.child.stateNode);break;case 1:p=u.child.stateNode}Sx(u,z,p)}break;case 5:var K=u.stateNode;p===null&&u.flags&4&&Ct(K,u.type,u.memoizedProps,u);break;case 6:break;case 4:break;case 12:break;case 13:if(xe&&u.memoizedState===null){var Se=u.alternate;if(Se!==null){var He=Se.memoizedState;if(He!==null){var st=He.dehydrated;st!==null&&ae(st)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(o(163))}Uo||u.flags&512&&ng(u)}catch(At){Li(u,u.return,At)}}if(u===l){et=null;break}if(p=u.sibling,p!==null){p.return=u.return,et=p;break}et=u.return}}function CS(l){for(;et!==null;){var u=et;if(u===l){et=null;break}var p=u.sibling;if(p!==null){p.return=u.return,et=p;break}et=u.return}}function RS(l){for(;et!==null;){var u=et;try{switch(u.tag){case 0:case 11:case 15:var p=u.return;try{Cu(4,u)}catch(Se){Li(u,p,Se)}break;case 1:var _=u.stateNode;if(typeof _.componentDidMount=="function"){var E=u.return;try{_.componentDidMount()}catch(Se){Li(u,E,Se)}}var A=u.return;try{ng(u)}catch(Se){Li(u,A,Se)}break;case 5:var z=u.return;try{ng(u)}catch(Se){Li(u,z,Se)}}}catch(Se){Li(u,u.return,Se)}if(u===l){et=null;break}var K=u.sibling;if(K!==null){K.return=u.return,et=K;break}et=u.return}}var nd=0,id=1,rd=2,sd=3,od=4;if(typeof Symbol=="function"&&Symbol.for){var Ru=Symbol.for;nd=Ru("selector.component"),id=Ru("selector.has_pseudo_class"),rd=Ru("selector.role"),sd=Ru("selector.test_id"),od=Ru("selector.text")}function og(l){var u=oe(l);if(u!=null){if(typeof u.memoizedProps["data-testname"]!="string")throw Error(o(364));return u}if(l=te(l),l===null)throw Error(o(362));return l.stateNode.current}function ag(l,u){switch(u.$$typeof){case nd:if(l.type===u.value)return!0;break;case id:e:{u=u.value,l=[l,0];for(var p=0;p<l.length;){var _=l[p++],E=l[p++],A=u[E];if(_.tag!==5||!Ee(_)){for(;A!=null&&ag(_,A);)E++,A=u[E];if(E===u.length){u=!0;break e}else for(_=_.child;_!==null;)l.push(_,E),_=_.sibling}}u=!1}return u;case rd:if(l.tag===5&&Ke(l.stateNode,u.value))return!0;break;case od:if((l.tag===5||l.tag===6)&&(l=we(l),l!==null&&0<=l.indexOf(u.value)))return!0;break;case sd:if(l.tag===5&&(l=l.memoizedProps["data-testname"],typeof l=="string"&&l.toLowerCase()===u.value.toLowerCase()))return!0;break;default:throw Error(o(365))}return!1}function lg(l){switch(l.$$typeof){case nd:return"<"+(L(l.value)||"Unknown")+">";case id:return":has("+(lg(l)||"")+")";case rd:return'[role="'+l.value+'"]';case od:return'"'+l.value+'"';case sd:return'[data-testname="'+l.value+'"]';default:throw Error(o(365))}}function PS(l,u){var p=[];l=[l,0];for(var _=0;_<l.length;){var E=l[_++],A=l[_++],z=u[A];if(E.tag!==5||!Ee(E)){for(;z!=null&&ag(E,z);)A++,z=u[A];if(A===u.length)p.push(E);else for(E=E.child;E!==null;)l.push(E,A),E=E.sibling}}return p}function ug(l,u){if(!I)throw Error(o(363));l=og(l),l=PS(l,u),u=[],l=Array.from(l);for(var p=0;p<l.length;){var _=l[p++];if(_.tag===5)Ee(_)||u.push(_.stateNode);else for(_=_.child;_!==null;)l.push(_),_=_.sibling}return u}var I2=Math.ceil,ad=a.ReactCurrentDispatcher,cg=a.ReactCurrentOwner,wn=a.ReactCurrentBatchConfig,Ot=0,Cn=null,Rn=null,Zn=0,ji=0,ja=Sn(0),Nn=0,Pu=null,Ya=0,ld=0,fg=0,Lu=null,Ri=null,dg=0,hg=1/0;function qa(){hg=Hn()+500}var ud=!1,pg=null,Bs=null,cd=!1,Hs=null,fd=0,Iu=0,mg=null,dd=-1,hd=0;function yi(){return Ot&6?Hn():dd!==-1?dd:dd=Hn()}function Vs(l){return l.mode&1?Ot&2&&Zn!==0?Zn&-Zn:p2.transition!==null?(hd===0&&(l=Af,Af<<=1,!(Af&4194240)&&(Af=64),hd=l),hd):(l=Ht,l!==0?l:ve()):1}function cr(l,u,p){if(50<Iu)throw Iu=0,mg=null,Error(o(185));var _=pd(l,u);return _===null?null:(mu(_,u,p),(!(Ot&2)||_!==Cn)&&(_===Cn&&(!(Ot&2)&&(ld|=u),Nn===4&&Gs(_,Zn)),Pi(_,p),u===1&&Ot===0&&!(l.mode&1)&&(qa(),Pf&&Wr())),_)}function pd(l,u){l.lanes|=u;var p=l.alternate;for(p!==null&&(p.lanes|=u),p=l,l=l.return;l!==null;)l.childLanes|=u,p=l.alternate,p!==null&&(p.childLanes|=u),p=l,l=l.return;return p.tag===3?p.stateNode:null}function Pi(l,u){var p=l.callbackNode;s2(l,u);var _=Cf(l,l===Cn?Zn:0);if(_===0)p!==null&&gx(p),l.callbackNode=null,l.callbackPriority=0;else if(u=_&-_,l.callbackPriority!==u){if(p!=null&&gx(p),u===1)l.tag===0?h2(IS.bind(null,l)):vx(IS.bind(null,l)),Ve?N(function(){Ot===0&&Wr()}):wm(Em,Wr),p=null;else{switch(mx(_)){case 1:p=Em;break;case 4:p=u2;break;case 16:p=Tm;break;case 536870912:p=c2;break;default:p=Tm}p=HS(p,LS.bind(null,l))}l.callbackPriority=u,l.callbackNode=p}}function LS(l,u){if(dd=-1,hd=0,Ot&6)throw Error(o(327));var p=l.callbackNode;if(zo()&&l.callbackNode!==p)return null;var _=Cf(l,l===Cn?Zn:0);if(_===0)return null;if(_&30||_&l.expiredLanes||u)u=md(l,_);else{u=_;var E=Ot;Ot|=2;var A=US();(Cn!==l||Zn!==u)&&(qa(),ko(l,u));do try{U2();break}catch(K){DS(l,K)}while(!0);Cm(),ad.current=A,Ot=E,Rn!==null?u=0:(Cn=null,Zn=0,u=Nn)}if(u!==0){if(u===2&&(E=xm(l),E!==0&&(_=E,u=gg(l,E))),u===1)throw p=Pu,ko(l,0),Gs(l,_),Pi(l,Hn()),p;if(u===6)Gs(l,_);else{if(E=l.current.alternate,!(_&30)&&!N2(E)&&(u=md(l,_),u===2&&(A=xm(l),A!==0&&(_=A,u=gg(l,A))),u===1))throw p=Pu,ko(l,0),Gs(l,_),Pi(l,Hn()),p;switch(l.finishedWork=E,l.finishedLanes=_,u){case 0:case 1:throw Error(o(345));case 2:Fo(l,Ri);break;case 3:if(Gs(l,_),(_&130023424)===_&&(u=dg+500-Hn(),10<u)){if(Cf(l,0)!==0)break;if(E=l.suspendedLanes,(E&_)!==_){yi(),l.pingedLanes|=l.suspendedLanes&E;break}l.timeoutHandle=Fe(Fo.bind(null,l,Ri),u);break}Fo(l,Ri);break;case 4:if(Gs(l,_),(_&4194240)===_)break;for(u=l.eventTimes,E=-1;0<_;){var z=31-Vi(_);A=1<<z,z=u[z],z>E&&(E=z),_&=~A}if(_=E,_=Hn()-_,_=(120>_?120:480>_?480:1080>_?1080:1920>_?1920:3e3>_?3e3:4320>_?4320:1960*I2(_/1960))-_,10<_){l.timeoutHandle=Fe(Fo.bind(null,l,Ri),_);break}Fo(l,Ri);break;case 5:Fo(l,Ri);break;default:throw Error(o(329))}}}return Pi(l,Hn()),l.callbackNode===p?LS.bind(null,l):null}function gg(l,u){var p=Lu;return l.current.memoizedState.isDehydrated&&(ko(l,u).flags|=256),l=md(l,u),l!==2&&(u=Ri,Ri=p,u!==null&&vg(u)),l}function vg(l){Ri===null?Ri=l:Ri.push.apply(Ri,l)}function N2(l){for(var u=l;;){if(u.flags&16384){var p=u.updateQueue;if(p!==null&&(p=p.stores,p!==null))for(var _=0;_<p.length;_++){var E=p[_],A=E.getSnapshot;E=E.value;try{if(!Gr(A(),E))return!1}catch{return!1}}}if(p=u.child,u.subtreeFlags&16384&&p!==null)p.return=u,u=p;else{if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function Gs(l,u){for(u&=~fg,u&=~ld,l.suspendedLanes|=u,l.pingedLanes&=~u,l=l.expirationTimes;0<u;){var p=31-Vi(u),_=1<<p;l[p]=-1,u&=~_}}function IS(l){if(Ot&6)throw Error(o(327));zo();var u=Cf(l,0);if(!(u&1))return Pi(l,Hn()),null;var p=md(l,u);if(l.tag!==0&&p===2){var _=xm(l);_!==0&&(u=_,p=gg(l,_))}if(p===1)throw p=Pu,ko(l,0),Gs(l,u),Pi(l,Hn()),p;if(p===6)throw Error(o(345));return l.finishedWork=l.current.alternate,l.finishedLanes=u,Fo(l,Ri),Pi(l,Hn()),null}function NS(l){Hs!==null&&Hs.tag===0&&!(Ot&6)&&zo();var u=Ot;Ot|=1;var p=wn.transition,_=Ht;try{if(wn.transition=null,Ht=1,l)return l()}finally{Ht=_,wn.transition=p,Ot=u,!(Ot&6)&&Wr()}}function yg(){ji=ja.current,_t(ja)}function ko(l,u){l.finishedWork=null,l.finishedLanes=0;var p=l.timeoutHandle;if(p!==je&&(l.timeoutHandle=je,Ne(p)),Rn!==null)for(p=Rn.return;p!==null;){var _=p;switch(Um(_),_.tag){case 1:_=_.type.childContextTypes,_!=null&&Mn();break;case 3:Wa(),_t(gn),_t(Rt),Vm();break;case 5:Bm(_);break;case 4:Wa();break;case 13:_t(un);break;case 19:_t(un);break;case 10:Rm(_.type._context);break;case 22:case 23:yg()}p=p.return}if(Cn=l,Rn=l=Ws(l.current,null),Zn=ji=u,Nn=0,Pu=null,fg=ld=Ya=0,Ri=Lu=null,Xr!==null){for(u=0;u<Xr.length;u++)if(p=Xr[u],_=p.interleaved,_!==null){p.interleaved=null;var E=_.next,A=p.pending;if(A!==null){var z=A.next;A.next=E,_.next=z}p.pending=_}Xr=null}return l}function DS(l,u){do{var p=Rn;try{if(Cm(),Hf.current=Yf,Vf){for(var _=vn.memoizedState;_!==null;){var E=_.queue;E!==null&&(E.pending=null),_=_.next}Vf=!1}if(Xa=0,Vn=ei=vn=null,Su=!1,Mu=0,cg.current=null,p===null||p.return===null){Nn=1,Pu=u,Rn=null;break}e:{var A=l,z=p.return,K=p,Se=u;if(u=Zn,K.flags|=32768,Se!==null&&typeof Se=="object"&&typeof Se.then=="function"){var He=Se,st=K,At=st.tag;if(!(st.mode&1)&&(At===0||At===11||At===15)){var gt=st.alternate;gt?(st.updateQueue=gt.updateQueue,st.memoizedState=gt.memoizedState,st.lanes=gt.lanes):(st.updateQueue=null,st.memoizedState=null)}var Qt=tS(z);if(Qt!==null){Qt.flags&=-257,nS(Qt,z,K,A,u),Qt.mode&1&&eS(A,He,u),u=Qt,Se=He;var ht=u.updateQueue;if(ht===null){var ii=new Set;ii.add(Se),u.updateQueue=ii}else ht.add(Se);break e}else{if(!(u&1)){eS(A,He,u),_g();break e}Se=Error(o(426))}}else if(an&&K.mode&1){var dr=tS(z);if(dr!==null){!(dr.flags&65536)&&(dr.flags|=256),nS(dr,z,K,A,u),Fm(Se);break e}}A=Se,Nn!==4&&(Nn=2),Lu===null?Lu=[A]:Lu.push(A),Se=Zm(Se,K),K=z;do{switch(K.tag){case 3:K.flags|=65536,u&=-u,K.lanes|=u;var le=Qx(K,Se,u);xx(K,le);break e;case 1:A=Se;var ee=K.type,_e=K.stateNode;if(!(K.flags&128)&&(typeof ee.getDerivedStateFromError=="function"||_e!==null&&typeof _e.componentDidCatch=="function"&&(Bs===null||!Bs.has(_e)))){K.flags|=65536,u&=-u,K.lanes|=u;var tt=$x(K,A,u);xx(K,tt);break e}}K=K.return}while(K!==null)}kS(p)}catch(dt){u=dt,Rn===p&&p!==null&&(Rn=p=p.return);continue}break}while(!0)}function US(){var l=ad.current;return ad.current=Yf,l===null?Yf:l}function _g(){(Nn===0||Nn===3||Nn===2)&&(Nn=4),Cn===null||!(Ya&268435455)&&!(ld&268435455)||Gs(Cn,Zn)}function md(l,u){var p=Ot;Ot|=2;var _=US();Cn===l&&Zn===u||ko(l,u);do try{D2();break}catch(E){DS(l,E)}while(!0);if(Cm(),Ot=p,ad.current=_,Rn!==null)throw Error(o(261));return Cn=null,Zn=0,Nn}function D2(){for(;Rn!==null;)OS(Rn)}function U2(){for(;Rn!==null&&!a2();)OS(Rn)}function OS(l){var u=BS(l.alternate,l,ji);l.memoizedProps=l.pendingProps,u===null?kS(l):Rn=u,cg.current=null}function kS(l){var u=l;do{var p=u.alternate;if(l=u.return,u.flags&32768){if(p=b2(p,u),p!==null){p.flags&=32767,Rn=p;return}if(l!==null)l.flags|=32768,l.subtreeFlags=0,l.deletions=null;else{Nn=6,Rn=null;return}}else if(p=E2(p,u,ji),p!==null){Rn=p;return}if(u=u.sibling,u!==null){Rn=u;return}Rn=u=l}while(u!==null);Nn===0&&(Nn=5)}function Fo(l,u){var p=Ht,_=wn.transition;try{wn.transition=null,Ht=1,O2(l,u,p)}finally{wn.transition=_,Ht=p}return null}function O2(l,u,p){do zo();while(Hs!==null);if(Ot&6)throw Error(o(327));var _=l.finishedWork,E=l.finishedLanes;if(_===null)return null;if(l.finishedWork=null,l.finishedLanes=0,_===l.current)throw Error(o(177));l.callbackNode=null,l.callbackPriority=0;var A=_.lanes|_.childLanes;if(o2(l,A),l===Cn&&(Rn=Cn=null,Zn=0),!(_.subtreeFlags&2064)&&!(_.flags&2064)||cd||(cd=!0,HS(Tm,function(){return zo(),null})),A=(_.flags&15990)!==0,_.subtreeFlags&15990||A){A=wn.transition,wn.transition=null;var z=Ht;Ht=1;var K=Ot;Ot|=4,cg.current=null,R2(l,_),P2(l,_),V(l.containerInfo),l.current=_,L2(_),l2(),Ot=K,Ht=z,wn.transition=A}else l.current=_;if(cd&&(cd=!1,Hs=l,fd=E),A=l.pendingLanes,A===0&&(Bs=null),f2(_.stateNode),Pi(l,Hn()),u!==null)for(p=l.onRecoverableError,_=0;_<u.length;_++)p(u[_]);if(ud)throw ud=!1,l=pg,pg=null,l;return fd&1&&l.tag!==0&&zo(),A=l.pendingLanes,A&1?l===mg?Iu++:(Iu=0,mg=l):Iu=0,Wr(),null}function zo(){if(Hs!==null){var l=mx(fd),u=wn.transition,p=Ht;try{if(wn.transition=null,Ht=16>l?16:l,Hs===null)var _=!1;else{if(l=Hs,Hs=null,fd=0,Ot&6)throw Error(o(331));var E=Ot;for(Ot|=4,et=l.current;et!==null;){var A=et,z=A.child;if(et.flags&16){var K=A.deletions;if(K!==null){for(var Se=0;Se<K.length;Se++){var He=K[Se];for(et=He;et!==null;){var st=et;switch(st.tag){case 0:case 11:case 15:Oo(8,st,A)}var At=st.child;if(At!==null)At.return=st,et=At;else for(;et!==null;){st=et;var gt=st.sibling,Qt=st.return;if(SS(st),st===He){et=null;break}if(gt!==null){gt.return=Qt,et=gt;break}et=Qt}}}var ht=A.alternate;if(ht!==null){var ii=ht.child;if(ii!==null){ht.child=null;do{var dr=ii.sibling;ii.sibling=null,ii=dr}while(ii!==null)}}et=A}}if(A.subtreeFlags&2064&&z!==null)z.return=A,et=z;else e:for(;et!==null;){if(A=et,A.flags&2048)switch(A.tag){case 0:case 11:case 15:Oo(9,A,A.return)}var le=A.sibling;if(le!==null){le.return=A.return,et=le;break e}et=A.return}}var ee=l.current;for(et=ee;et!==null;){z=et;var _e=z.child;if(z.subtreeFlags&2064&&_e!==null)_e.return=z,et=_e;else e:for(z=ee;et!==null;){if(K=et,K.flags&2048)try{switch(K.tag){case 0:case 11:case 15:Cu(9,K)}}catch(dt){Li(K,K.return,dt)}if(K===z){et=null;break e}var tt=K.sibling;if(tt!==null){tt.return=K.return,et=tt;break e}et=K.return}}if(Ot=E,Wr(),Vr&&typeof Vr.onPostCommitFiberRoot=="function")try{Vr.onPostCommitFiberRoot(Rf,l)}catch{}_=!0}return _}finally{Ht=p,wn.transition=u}}return!1}function FS(l,u,p){u=Zm(p,u),u=Qx(l,u,1),zs(l,u),u=yi(),l=pd(l,1),l!==null&&(mu(l,1,u),Pi(l,u))}function Li(l,u,p){if(l.tag===3)FS(l,l,p);else for(;u!==null;){if(u.tag===3){FS(u,l,p);break}else if(u.tag===1){var _=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof _.componentDidCatch=="function"&&(Bs===null||!Bs.has(_))){l=Zm(p,l),l=$x(u,l,1),zs(u,l),l=yi(),u=pd(u,1),u!==null&&(mu(u,1,l),Pi(u,l));break}}u=u.return}}function k2(l,u,p){var _=l.pingCache;_!==null&&_.delete(u),u=yi(),l.pingedLanes|=l.suspendedLanes&p,Cn===l&&(Zn&p)===p&&(Nn===4||Nn===3&&(Zn&130023424)===Zn&&500>Hn()-dg?ko(l,0):fg|=p),Pi(l,u)}function zS(l,u){u===0&&(l.mode&1?(u=bf,bf<<=1,!(bf&130023424)&&(bf=4194304)):u=1);var p=yi();l=pd(l,u),l!==null&&(mu(l,u,p),Pi(l,p))}function F2(l){var u=l.memoizedState,p=0;u!==null&&(p=u.retryLane),zS(l,p)}function z2(l,u){var p=0;switch(l.tag){case 13:var _=l.stateNode,E=l.memoizedState;E!==null&&(p=E.retryLane);break;case 19:_=l.stateNode;break;default:throw Error(o(314))}_!==null&&_.delete(u),zS(l,p)}var BS;BS=function(l,u,p){if(l!==null)if(l.memoizedProps!==u.pendingProps||gn.current)Xi=!0;else{if(!(l.lanes&p)&&!(u.flags&128))return Xi=!1,A2(l,u,p);Xi=!!(l.flags&131072)}else Xi=!1,an&&u.flags&1048576&&Ax(u,Ff,u.index);switch(u.lanes=0,u.tag){case 2:var _=u.type;l!==null&&(l.alternate=null,u.alternate=null,u.flags|=2),l=u.pendingProps;var E=rr(u,Rt.current);Fa(u,p),E=Wm(null,u,_,l,E,p);var A=Xm();return u.flags|=1,typeof E=="object"&&E!==null&&typeof E.render=="function"&&E.$$typeof===void 0?(u.tag=1,u.memoizedState=null,u.updateQueue=null,Bn(_)?(A=!0,qn(u)):A=!1,u.memoizedState=E.state!==null&&E.state!==void 0?E.state:null,Lm(u),E.updater=Of,u.stateNode=E,E._reactInternals=u,Nm(u,_,l,p),u=Qm(null,u,_,!0,A,p)):(u.tag=0,an&&A&&Dm(u),vi(null,u,E,p),u=u.child),u;case 16:_=u.elementType;e:{switch(l!==null&&(l.alternate=null,u.alternate=null,u.flags|=2),l=u.pendingProps,E=_._init,_=E(_._payload),u.type=_,E=u.tag=H2(_),l=Mr(_,l),E){case 0:u=Jm(null,u,_,l,p);break e;case 1:u=cS(null,u,_,l,p);break e;case 11:u=sS(null,u,_,l,p);break e;case 14:u=oS(null,u,_,Mr(_.type,l),p);break e}throw Error(o(306,_,""))}return u;case 0:return _=u.type,E=u.pendingProps,E=u.elementType===_?E:Mr(_,E),Jm(l,u,_,E,p);case 1:return _=u.type,E=u.pendingProps,E=u.elementType===_?E:Mr(_,E),cS(l,u,_,E,p);case 3:e:{if(fS(u),l===null)throw Error(o(387));_=u.pendingProps,A=u.memoizedState,E=A.element,_x(l,u),Uf(u,_,null,p);var z=u.memoizedState;if(_=z.element,xe&&A.isDehydrated)if(A={element:_,isDehydrated:!1,cache:z.cache,transitions:z.transitions},u.updateQueue.baseState=A,u.memoizedState=A,u.flags&256){E=Error(o(423)),u=dS(l,u,_,p,E);break e}else if(_!==E){E=Error(o(424)),u=dS(l,u,_,p,E);break e}else for(xe&&(Wi=jt(u.stateNode.containerInfo),Gi=u,an=!0,wr=null,gu=!1),p=Ix(u,null,_,p),u.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(Ha(),_===E){u=fs(l,u,p);break e}vi(l,u,_,p)}u=u.child}return u;case 5:return Nx(u),l===null&&km(u),_=u.type,E=u.pendingProps,A=l!==null?l.memoizedProps:null,z=E.children,Ie(_,E)?z=null:A!==null&&Ie(_,A)&&(u.flags|=32),uS(l,u),vi(l,u,z,p),u.child;case 6:return l===null&&km(u),null;case 13:return hS(l,u,p);case 4:return zm(u,u.stateNode.containerInfo),_=u.pendingProps,l===null?u.child=Va(u,null,_,p):vi(l,u,_,p),u.child;case 11:return _=u.type,E=u.pendingProps,E=u.elementType===_?E:Mr(_,E),sS(l,u,_,E,p);case 7:return vi(l,u,u.pendingProps,p),u.child;case 8:return vi(l,u,u.pendingProps.children,p),u.child;case 12:return vi(l,u,u.pendingProps.children,p),u.child;case 10:e:{if(_=u.type._context,E=u.pendingProps,A=u.memoizedProps,z=E.value,yx(u,_,z),A!==null)if(Gr(A.value,z)){if(A.children===E.children&&!gn.current){u=fs(l,u,p);break e}}else for(A=u.child,A!==null&&(A.return=u);A!==null;){var K=A.dependencies;if(K!==null){z=A.child;for(var Se=K.firstContext;Se!==null;){if(Se.context===_){if(A.tag===1){Se=as(-1,p&-p),Se.tag=2;var He=A.updateQueue;if(He!==null){He=He.shared;var st=He.pending;st===null?Se.next=Se:(Se.next=st.next,st.next=Se),He.pending=Se}}A.lanes|=p,Se=A.alternate,Se!==null&&(Se.lanes|=p),Pm(A.return,p,u),K.lanes|=p;break}Se=Se.next}}else if(A.tag===10)z=A.type===u.type?null:A.child;else if(A.tag===18){if(z=A.return,z===null)throw Error(o(341));z.lanes|=p,K=z.alternate,K!==null&&(K.lanes|=p),Pm(z,p,u),z=A.sibling}else z=A.child;if(z!==null)z.return=A;else for(z=A;z!==null;){if(z===u){z=null;break}if(A=z.sibling,A!==null){A.return=z.return,z=A;break}z=z.return}A=z}vi(l,u,E.children,p),u=u.child}return u;case 9:return E=u.type,_=u.pendingProps.children,Fa(u,p),E=sr(E),_=_(E),u.flags|=1,vi(l,u,_,p),u.child;case 14:return _=u.type,E=Mr(_,u.pendingProps),E=Mr(_.type,E),oS(l,u,_,E,p);case 15:return aS(l,u,u.type,u.pendingProps,p);case 17:return _=u.type,E=u.pendingProps,E=u.elementType===_?E:Mr(_,E),l!==null&&(l.alternate=null,u.alternate=null,u.flags|=2),u.tag=1,Bn(_)?(l=!0,qn(u)):l=!1,Fa(u,p),Ex(u,_,E),Nm(u,_,E,p),Qm(null,u,_,!0,l,p);case 19:return vS(l,u,p);case 22:return lS(l,u,p)}throw Error(o(156,u.tag))};function HS(l,u){return wm(l,u)}function B2(l,u,p,_){this.tag=l,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=_,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function fr(l,u,p,_){return new B2(l,u,p,_)}function xg(l){return l=l.prototype,!(!l||!l.isReactComponent)}function H2(l){if(typeof l=="function")return xg(l)?1:0;if(l!=null){if(l=l.$$typeof,l===w)return 11;if(l===S)return 14}return 2}function Ws(l,u){var p=l.alternate;return p===null?(p=fr(l.tag,u,l.key,l.mode),p.elementType=l.elementType,p.type=l.type,p.stateNode=l.stateNode,p.alternate=l,l.alternate=p):(p.pendingProps=u,p.type=l.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=l.flags&14680064,p.childLanes=l.childLanes,p.lanes=l.lanes,p.child=l.child,p.memoizedProps=l.memoizedProps,p.memoizedState=l.memoizedState,p.updateQueue=l.updateQueue,u=l.dependencies,p.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},p.sibling=l.sibling,p.index=l.index,p.ref=l.ref,p}function gd(l,u,p,_,E,A){var z=2;if(_=l,typeof l=="function")xg(l)&&(z=1);else if(typeof l=="string")z=5;else e:switch(l){case d:return Bo(p.children,E,A,u);case h:z=8,E|=8;break;case m:return l=fr(12,p,u,E|2),l.elementType=m,l.lanes=A,l;case x:return l=fr(13,p,u,E),l.elementType=x,l.lanes=A,l;case g:return l=fr(19,p,u,E),l.elementType=g,l.lanes=A,l;case T:return vd(p,E,A,u);default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case v:z=10;break e;case y:z=9;break e;case w:z=11;break e;case S:z=14;break e;case M:z=16,_=null;break e}throw Error(o(130,l==null?l:typeof l,""))}return u=fr(z,p,u,E),u.elementType=l,u.type=_,u.lanes=A,u}function Bo(l,u,p,_){return l=fr(7,l,_,u),l.lanes=p,l}function vd(l,u,p,_){return l=fr(22,l,_,u),l.elementType=T,l.lanes=p,l.stateNode={},l}function Sg(l,u,p){return l=fr(6,l,null,u),l.lanes=p,l}function Mg(l,u,p){return u=fr(4,l.children!==null?l.children:[],l.key,u),u.lanes=p,u.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},u}function V2(l,u,p,_,E){this.tag=u,this.containerInfo=l,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=je,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Sm(0),this.expirationTimes=Sm(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Sm(0),this.identifierPrefix=_,this.onRecoverableError=E,xe&&(this.mutableSourceEagerHydrationData=null)}function VS(l,u,p,_,E,A,z,K,Se){return l=new V2(l,u,p,K,Se),u===1?(u=1,A===!0&&(u|=8)):u=0,A=fr(3,null,null,u),l.current=A,A.stateNode=l,A.memoizedState={element:_,isDehydrated:p,cache:null,transitions:null},Lm(A),l}function GS(l){if(!l)return $n;l=l._reactInternals;e:{if(C(l)!==l||l.tag!==1)throw Error(o(170));var u=l;do{switch(u.tag){case 3:u=u.stateNode.context;break e;case 1:if(Bn(u.type)){u=u.stateNode.__reactInternalMemoizedMergedChildContext;break e}}u=u.return}while(u!==null);throw Error(o(171))}if(l.tag===1){var p=l.type;if(Bn(p))return Ua(l,p,u)}return u}function WS(l){var u=l._reactInternals;if(u===void 0)throw typeof l.render=="function"?Error(o(188)):(l=Object.keys(l).join(","),Error(o(268,l)));return l=$(u),l===null?null:l.stateNode}function XS(l,u){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var p=l.retryLane;l.retryLane=p!==0&&p<u?p:u}}function wg(l,u){XS(l,u),(l=l.alternate)&&XS(l,u)}function G2(l){return l=$(l),l===null?null:l.stateNode}function W2(){return null}return t.attemptContinuousHydration=function(l){if(l.tag===13){var u=yi();cr(l,134217728,u),wg(l,134217728)}},t.attemptHydrationAtCurrentPriority=function(l){if(l.tag===13){var u=yi(),p=Vs(l);cr(l,p,u),wg(l,p)}},t.attemptSynchronousHydration=function(l){switch(l.tag){case 3:var u=l.stateNode;if(u.current.memoizedState.isDehydrated){var p=pu(u.pendingLanes);p!==0&&(Mm(u,p|1),Pi(u,Hn()),!(Ot&6)&&(qa(),Wr()))}break;case 13:var _=yi();NS(function(){return cr(l,1,_)}),wg(l,1)}},t.batchedUpdates=function(l,u){var p=Ot;Ot|=1;try{return l(u)}finally{Ot=p,Ot===0&&(qa(),Pf&&Wr())}},t.createComponentSelector=function(l){return{$$typeof:nd,value:l}},t.createContainer=function(l,u,p,_,E,A,z){return VS(l,u,!1,null,p,_,E,A,z)},t.createHasPseudoClassSelector=function(l){return{$$typeof:id,value:l}},t.createHydrationContainer=function(l,u,p,_,E,A,z,K,Se){return l=VS(p,_,!0,l,E,A,z,K,Se),l.context=GS(null),p=l.current,_=yi(),E=Vs(p),A=as(_,E),A.callback=u??null,zs(p,A),l.current.lanes=E,mu(l,E,_),Pi(l,_),l},t.createPortal=function(l,u,p){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:f,key:_==null?null:""+_,children:l,containerInfo:u,implementation:p}},t.createRoleSelector=function(l){return{$$typeof:rd,value:l}},t.createTestNameSelector=function(l){return{$$typeof:sd,value:l}},t.createTextSelector=function(l){return{$$typeof:od,value:l}},t.deferredUpdates=function(l){var u=Ht,p=wn.transition;try{return wn.transition=null,Ht=16,l()}finally{Ht=u,wn.transition=p}},t.discreteUpdates=function(l,u,p,_,E){var A=Ht,z=wn.transition;try{return wn.transition=null,Ht=1,l(u,p,_,E)}finally{Ht=A,wn.transition=z,Ot===0&&qa()}},t.findAllNodes=ug,t.findBoundingRects=function(l,u){if(!I)throw Error(o(363));u=ug(l,u),l=[];for(var p=0;p<u.length;p++)l.push(Ce(u[p]));for(u=l.length-1;0<u;u--){p=l[u];for(var _=p.x,E=_+p.width,A=p.y,z=A+p.height,K=u-1;0<=K;K--)if(u!==K){var Se=l[K],He=Se.x,st=He+Se.width,At=Se.y,gt=At+Se.height;if(_>=He&&A>=At&&E<=st&&z<=gt){l.splice(u,1);break}else if(_!==He||p.width!==Se.width||gt<A||At>z){if(!(A!==At||p.height!==Se.height||st<_||He>E)){He>_&&(Se.width+=He-_,Se.x=_),st<E&&(Se.width=E-He),l.splice(u,1);break}}else{At>A&&(Se.height+=At-A,Se.y=A),gt<z&&(Se.height=z-At),l.splice(u,1);break}}}return l},t.findHostInstance=WS,t.findHostInstanceWithNoPortals=function(l){return l=B(l),l=l!==null?G(l):null,l===null?null:l.stateNode},t.findHostInstanceWithWarning=function(l){return WS(l)},t.flushControlled=function(l){var u=Ot;Ot|=1;var p=wn.transition,_=Ht;try{wn.transition=null,Ht=1,l()}finally{Ht=_,wn.transition=p,Ot=u,Ot===0&&(qa(),Wr())}},t.flushPassiveEffects=zo,t.flushSync=NS,t.focusWithin=function(l,u){if(!I)throw Error(o(363));for(l=og(l),u=PS(l,u),u=Array.from(u),l=0;l<u.length;){var p=u[l++];if(!Ee(p)){if(p.tag===5&&Oe(p.stateNode))return!0;for(p=p.child;p!==null;)u.push(p),p=p.sibling}}return!1},t.getCurrentUpdatePriority=function(){return Ht},t.getFindAllNodesFailureDescription=function(l,u){if(!I)throw Error(o(363));var p=0,_=[];l=[og(l),0];for(var E=0;E<l.length;){var A=l[E++],z=l[E++],K=u[z];if((A.tag!==5||!Ee(A))&&(ag(A,K)&&(_.push(lg(K)),z++,z>p&&(p=z)),z<u.length))for(A=A.child;A!==null;)l.push(A,z),A=A.sibling}if(p<u.length){for(l=[];p<u.length;p++)l.push(lg(u[p]));return`findAllNodes was able to match part of the selector:
  `+(_.join(" > ")+`

No matching component was found for:
  `)+l.join(" > ")}return null},t.getPublicRootInstance=function(l){if(l=l.current,!l.child)return null;switch(l.child.tag){case 5:return ne(l.child.stateNode);default:return l.child.stateNode}},t.injectIntoDevTools=function(l){if(l={bundleType:l.bundleType,version:l.version,rendererPackageName:l.rendererPackageName,rendererConfig:l.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:a.ReactCurrentDispatcher,findHostInstanceByFiber:G2,findFiberByHostInstance:l.findFiberByHostInstance||W2,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")l=!1;else{var u=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(u.isDisabled||!u.supportsFiber)l=!0;else{try{Rf=u.inject(l),Vr=u}catch{}l=!!u.checkDCE}}return l},t.isAlreadyRendering=function(){return!1},t.observeVisibleRects=function(l,u,p,_){if(!I)throw Error(o(363));l=ug(l,u);var E=Ge(l,p,_).disconnect;return{disconnect:function(){E()}}},t.registerMutableSourceForHydration=function(l,u){var p=u._getVersion;p=p(u._source),l.mutableSourceEagerHydrationData==null?l.mutableSourceEagerHydrationData=[u,p]:l.mutableSourceEagerHydrationData.push(u,p)},t.runWithPriority=function(l,u){var p=Ht;try{return Ht=l,u()}finally{Ht=p}},t.shouldError=function(){return null},t.shouldSuspend=function(){return!1},t.updateContainer=function(l,u,p,_){var E=u.current,A=yi(),z=Vs(E);return p=GS(p),u.context===null?u.context=p:u.pendingContext=p,u=as(A,z),u.payload={element:l},_=_===void 0?null:_,_!==null&&(u.callback=_),zs(E,u),l=cr(E,z,A),l!==null&&Df(l,E,z),z},t};DC.exports=MF;var wF=DC.exports;const EF=aE(wF),dx={},kC=n=>void Object.assign(dx,n);function TF(n,e){function t(d,{args:h=[],attach:m,...v},y){let w=`${d[0].toUpperCase()}${d.slice(1)}`,x;if(d==="primitive"){if(v.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const g=v.object;x=Ml(g,{type:d,root:y,attach:m,primitive:!0})}else{const g=dx[w];if(!g)throw new Error(`R3F: ${w} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(h))throw new Error("R3F: The args prop must be an array!");x=Ml(new g(...h),{type:d,root:y,attach:m,memoizedProps:{args:h}})}return x.__r3f.attach===void 0&&(x.isBufferGeometry?x.__r3f.attach="geometry":x.isMaterial&&(x.__r3f.attach="material")),w!=="inject"&&U0(x,v),x}function i(d,h){let m=!1;if(h){var v,y;(v=h.__r3f)!=null&&v.attach?D0(d,h,h.__r3f.attach):h.isObject3D&&d.isObject3D&&(d.add(h),m=!0),m||(y=d.__r3f)==null||y.objects.push(h),h.__r3f||Ml(h,{}),h.__r3f.parent=d,Ay(h),wl(h)}}function r(d,h,m){let v=!1;if(h){var y,w;if((y=h.__r3f)!=null&&y.attach)D0(d,h,h.__r3f.attach);else if(h.isObject3D&&d.isObject3D){h.parent=d,h.dispatchEvent({type:"added"}),d.dispatchEvent({type:"childadded",child:h});const x=d.children.filter(S=>S!==h),g=x.indexOf(m);d.children=[...x.slice(0,g),h,...x.slice(g)],v=!0}v||(w=d.__r3f)==null||w.objects.push(h),h.__r3f||Ml(h,{}),h.__r3f.parent=d,Ay(h),wl(h)}}function s(d,h,m=!1){d&&[...d].forEach(v=>o(h,v,m))}function o(d,h,m){if(h){var v,y,w;if(h.__r3f&&(h.__r3f.parent=null),(v=d.__r3f)!=null&&v.objects&&(d.__r3f.objects=d.__r3f.objects.filter(T=>T!==h)),(y=h.__r3f)!=null&&y.attach)Xw(d,h,h.__r3f.attach);else if(h.isObject3D&&d.isObject3D){var x;d.remove(h),(x=h.__r3f)!=null&&x.root&&IF(Jh(h),h)}const S=(w=h.__r3f)==null?void 0:w.primitive,M=!S&&(m===void 0?h.dispose!==null:m);if(!S){var g;s((g=h.__r3f)==null?void 0:g.objects,h,M),s(h.children,h,M)}if(delete h.__r3f,M&&h.dispose&&h.type!=="Scene"){const T=()=>{try{h.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT>"u"?Ey.unstable_scheduleCallback(Ey.unstable_IdlePriority,T):T()}wl(d)}}function a(d,h,m,v){var y;const w=(y=d.__r3f)==null?void 0:y.parent;if(!w)return;const x=t(h,m,d.__r3f.root);if(d.children){for(const g of d.children)g.__r3f&&i(x,g);d.children=d.children.filter(g=>!g.__r3f)}d.__r3f.objects.forEach(g=>i(x,g)),d.__r3f.objects=[],d.__r3f.autoRemovedBeforeAppend||o(w,d),x.parent&&(x.__r3f.autoRemovedBeforeAppend=!0),i(w,x),x.raycast&&x.__r3f.eventCount&&Jh(x).getState().internal.interaction.push(x),[v,v.alternate].forEach(g=>{g!==null&&(g.stateNode=x,g.ref&&(typeof g.ref=="function"?g.ref(x):g.ref.current=x))})}const c=()=>{};return{reconciler:EF({createInstance:t,removeChild:o,appendChild:i,appendInitialChild:i,insertBefore:r,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(d,h)=>{if(!h)return;const m=d.getState().scene;m.__r3f&&(m.__r3f.root=d,i(m,h))},removeChildFromContainer:(d,h)=>{h&&o(d.getState().scene,h)},insertInContainerBefore:(d,h,m)=>{if(!h||!m)return;const v=d.getState().scene;v.__r3f&&r(v,h,m)},getRootHostContext:()=>null,getChildHostContext:d=>d,finalizeInitialChildren(d){var h;return!!((h=d==null?void 0:d.__r3f)!=null?h:{}).handlers},prepareUpdate(d,h,m,v){var y;if(((y=d==null?void 0:d.__r3f)!=null?y:{}).primitive&&v.object&&v.object!==d)return[!0];{const{args:x=[],children:g,...S}=v,{args:M=[],children:T,...P}=m;if(!Array.isArray(x))throw new Error("R3F: the args prop must be an array!");if(x.some((L,O)=>L!==M[O]))return[!0];const b=WC(d,S,P,!0);return b.changes.length?[!1,b]:null}},commitUpdate(d,[h,m],v,y,w,x){h?a(d,v,w,x):U0(d,m)},commitMount(d,h,m,v){var y;const w=(y=d.__r3f)!=null?y:{};d.raycast&&w.handlers&&w.eventCount&&Jh(d).getState().internal.interaction.push(d)},getPublicInstance:d=>d,prepareForCommit:()=>null,preparePortalMount:d=>Ml(d.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(d){var h;const{attach:m,parent:v}=(h=d.__r3f)!=null?h:{};m&&v&&Xw(v,d,m),d.isObject3D&&(d.visible=!1),wl(d)},unhideInstance(d,h){var m;const{attach:v,parent:y}=(m=d.__r3f)!=null?m:{};v&&y&&D0(y,d,v),(d.isObject3D&&h.visible==null||h.visible)&&(d.visible=!0),wl(d)},createTextInstance:c,hideTextInstance:c,unhideTextInstance:c,getCurrentEventPriority:()=>e?e():Hl.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&sn.fun(performance.now)?performance.now:sn.fun(Date.now)?Date.now:()=>0,scheduleTimeout:sn.fun(setTimeout)?setTimeout:void 0,cancelTimeout:sn.fun(clearTimeout)?clearTimeout:void 0}),applyProps:U0}}var Hw,Vw;const N0=n=>"colorSpace"in n||"outputColorSpace"in n,FC=()=>{var n;return(n=dx.ColorManagement)!=null?n:null},zC=n=>n&&n.isOrthographicCamera,AF=n=>n&&n.hasOwnProperty("current"),Mf=typeof window<"u"&&((Hw=window.document)!=null&&Hw.createElement||((Vw=window.navigator)==null?void 0:Vw.product)==="ReactNative")?X.useLayoutEffect:X.useEffect;function BC(n){const e=X.useRef(n);return Mf(()=>void(e.current=n),[n]),e}function bF({set:n}){return Mf(()=>(n(new Promise(()=>null)),()=>n(!1)),[n]),null}class HC extends X.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}HC.getDerivedStateFromError=()=>({error:!0});const VC="__default",Gw=new Map,CF=n=>n&&!!n.memoized&&!!n.changes;function GC(n){var e;const t=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(n)?Math.min(Math.max(n[0],t),n[1]):n}const Qu=n=>{var e;return(e=n.__r3f)==null?void 0:e.root.getState()};function Jh(n){let e=n.__r3f.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const sn={obj:n=>n===Object(n)&&!sn.arr(n)&&typeof n!="function",fun:n=>typeof n=="function",str:n=>typeof n=="string",num:n=>typeof n=="number",boo:n=>typeof n=="boolean",und:n=>n===void 0,arr:n=>Array.isArray(n),equ(n,e,{arrays:t="shallow",objects:i="reference",strict:r=!0}={}){if(typeof n!=typeof e||!!n!=!!e)return!1;if(sn.str(n)||sn.num(n)||sn.boo(n))return n===e;const s=sn.obj(n);if(s&&i==="reference")return n===e;const o=sn.arr(n);if(o&&t==="reference")return n===e;if((o||s)&&n===e)return!0;let a;for(a in n)if(!(a in e))return!1;if(s&&t==="shallow"&&i==="shallow"){for(a in r?e:n)if(!sn.equ(n[a],e[a],{strict:r,objects:"reference"}))return!1}else for(a in r?e:n)if(n[a]!==e[a])return!1;if(sn.und(a)){if(o&&n.length===0&&e.length===0||s&&Object.keys(n).length===0&&Object.keys(e).length===0)return!0;if(n!==e)return!1}return!0}};function RF(n){n.dispose&&n.type!=="Scene"&&n.dispose();for(const e in n)e.dispose==null||e.dispose(),delete n[e]}function Ml(n,e){const t=n;return t.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...e},n}function Ty(n,e){let t=n;if(e.includes("-")){const i=e.split("-"),r=i.pop();return t=i.reduce((s,o)=>s[o],n),{target:t,key:r}}else return{target:t,key:e}}const Ww=/-\d+$/;function D0(n,e,t){if(sn.str(t)){if(Ww.test(t)){const s=t.replace(Ww,""),{target:o,key:a}=Ty(n,s);Array.isArray(o[a])||(o[a]=[])}const{target:i,key:r}=Ty(n,t);e.__r3f.previousAttach=i[r],i[r]=e}else e.__r3f.previousAttach=t(n,e)}function Xw(n,e,t){var i,r;if(sn.str(t)){const{target:s,key:o}=Ty(n,t),a=e.__r3f.previousAttach;a===void 0?delete s[o]:s[o]=a}else(i=e.__r3f)==null||i.previousAttach==null||i.previousAttach(n,e);(r=e.__r3f)==null||delete r.previousAttach}function WC(n,{children:e,key:t,ref:i,...r},{children:s,key:o,ref:a,...c}={},f=!1){const d=n.__r3f,h=Object.entries(r),m=[];if(f){const y=Object.keys(c);for(let w=0;w<y.length;w++)r.hasOwnProperty(y[w])||h.unshift([y[w],VC+"remove"])}h.forEach(([y,w])=>{var x;if((x=n.__r3f)!=null&&x.primitive&&y==="object"||sn.equ(w,c[y]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(y))return m.push([y,w,!0,[]]);let g=[];y.includes("-")&&(g=y.split("-")),m.push([y,w,!1,g]);for(const S in r){const M=r[S];S.startsWith(`${y}-`)&&m.push([S,M,!1,S.split("-")])}});const v={...r};return d!=null&&d.memoizedProps&&d!=null&&d.memoizedProps.args&&(v.args=d.memoizedProps.args),d!=null&&d.memoizedProps&&d!=null&&d.memoizedProps.attach&&(v.attach=d.memoizedProps.attach),{memoized:v,changes:m}}function U0(n,e){var t;const i=n.__r3f,r=i==null?void 0:i.root,s=r==null||r.getState==null?void 0:r.getState(),{memoized:o,changes:a}=CF(e)?e:WC(n,e),c=i==null?void 0:i.eventCount;n.__r3f&&(n.__r3f.memoizedProps=o);for(let m=0;m<a.length;m++){let[v,y,w,x]=a[m];if(N0(n)){const T="srgb",P="srgb-linear";v==="encoding"?(v="colorSpace",y=y===3001?T:P):v==="outputEncoding"&&(v="outputColorSpace",y=y===3001?T:P)}let g=n,S=g[v];if(x.length&&(S=x.reduce((M,T)=>M[T],n),!(S&&S.set))){const[M,...T]=x.reverse();g=T.reverse().reduce((P,b)=>P[b],n),v=M}if(y===VC+"remove")if(g.constructor){let M=Gw.get(g.constructor);M||(M=new g.constructor,Gw.set(g.constructor,M)),y=M[v]}else y=0;if(w&&i)y?i.handlers[v]=y:delete i.handlers[v],i.eventCount=Object.keys(i.handlers).length;else if(S&&S.set&&(S.copy||S instanceof ga)){if(Array.isArray(y))S.fromArray?S.fromArray(y):S.set(...y);else if(S.copy&&y&&y.constructor&&S.constructor===y.constructor)S.copy(y);else if(y!==void 0){var f;const M=(f=S)==null?void 0:f.isColor;!M&&S.setScalar?S.setScalar(y):S instanceof ga&&y instanceof ga?S.mask=y.mask:S.set(y),!FC()&&s&&!s.linear&&M&&S.convertSRGBToLinear()}}else{var d;if(g[v]=y,(d=g[v])!=null&&d.isTexture&&g[v].format===Mi&&g[v].type===ts&&s){const M=g[v];N0(M)&&N0(s.gl)?M.colorSpace=s.gl.outputColorSpace:M.encoding=s.gl.outputEncoding}}wl(n)}if(i&&i.parent&&n.raycast&&c!==i.eventCount){const m=Jh(n).getState().internal,v=m.interaction.indexOf(n);v>-1&&m.interaction.splice(v,1),i.eventCount&&m.interaction.push(n)}return!(a.length===1&&a[0][0]==="onUpdate")&&a.length&&(t=n.__r3f)!=null&&t.parent&&Ay(n),n}function wl(n){var e,t;const i=(e=n.__r3f)==null||(t=e.root)==null||t.getState==null?void 0:t.getState();i&&i.internal.frames===0&&i.invalidate()}function Ay(n){n.onUpdate==null||n.onUpdate(n)}function PF(n,e){n.manual||(zC(n)?(n.left=e.width/-2,n.right=e.width/2,n.top=e.height/2,n.bottom=e.height/-2):n.aspect=e.width/e.height,n.updateProjectionMatrix(),n.updateMatrixWorld())}function bh(n){return(n.eventObject||n.object).uuid+"/"+n.index+n.instanceId}function LF(){var n;const e=typeof self<"u"&&self||typeof window<"u"&&window;if(!e)return Hl.DefaultEventPriority;switch((n=e.event)==null?void 0:n.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return Hl.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return Hl.ContinuousEventPriority;default:return Hl.DefaultEventPriority}}function XC(n,e,t,i){const r=t.get(e);r&&(t.delete(e),t.size===0&&(n.delete(i),r.target.releasePointerCapture(i)))}function IF(n,e){const{internal:t}=n.getState();t.interaction=t.interaction.filter(i=>i!==e),t.initialHits=t.initialHits.filter(i=>i!==e),t.hovered.forEach((i,r)=>{(i.eventObject===e||i.object===e)&&t.hovered.delete(r)}),t.capturedMap.forEach((i,r)=>{XC(t.capturedMap,e,i,r)})}function NF(n){function e(c){const{internal:f}=n.getState(),d=c.offsetX-f.initialClick[0],h=c.offsetY-f.initialClick[1];return Math.round(Math.sqrt(d*d+h*h))}function t(c){return c.filter(f=>["Move","Over","Enter","Out","Leave"].some(d=>{var h;return(h=f.__r3f)==null?void 0:h.handlers["onPointer"+d]}))}function i(c,f){const d=n.getState(),h=new Set,m=[],v=f?f(d.internal.interaction):d.internal.interaction;for(let g=0;g<v.length;g++){const S=Qu(v[g]);S&&(S.raycaster.camera=void 0)}d.previousRoot||d.events.compute==null||d.events.compute(c,d);function y(g){const S=Qu(g);if(!S||!S.events.enabled||S.raycaster.camera===null)return[];if(S.raycaster.camera===void 0){var M;S.events.compute==null||S.events.compute(c,S,(M=S.previousRoot)==null?void 0:M.getState()),S.raycaster.camera===void 0&&(S.raycaster.camera=null)}return S.raycaster.camera?S.raycaster.intersectObject(g,!0):[]}let w=v.flatMap(y).sort((g,S)=>{const M=Qu(g.object),T=Qu(S.object);return!M||!T?g.distance-S.distance:T.events.priority-M.events.priority||g.distance-S.distance}).filter(g=>{const S=bh(g);return h.has(S)?!1:(h.add(S),!0)});d.events.filter&&(w=d.events.filter(w,d));for(const g of w){let S=g.object;for(;S;){var x;(x=S.__r3f)!=null&&x.eventCount&&m.push({...g,eventObject:S}),S=S.parent}}if("pointerId"in c&&d.internal.capturedMap.has(c.pointerId))for(let g of d.internal.capturedMap.get(c.pointerId).values())h.has(bh(g.intersection))||m.push(g.intersection);return m}function r(c,f,d,h){const m=n.getState();if(c.length){const v={stopped:!1};for(const y of c){const w=Qu(y.object)||m,{raycaster:x,pointer:g,camera:S,internal:M}=w,T=new k(g.x,g.y,0).unproject(S),P=R=>{var B,$;return(B=($=M.capturedMap.get(R))==null?void 0:$.has(y.eventObject))!=null?B:!1},b=R=>{const B={intersection:y,target:f.target};M.capturedMap.has(R)?M.capturedMap.get(R).set(y.eventObject,B):M.capturedMap.set(R,new Map([[y.eventObject,B]])),f.target.setPointerCapture(R)},L=R=>{const B=M.capturedMap.get(R);B&&XC(M.capturedMap,y.eventObject,B,R)};let O={};for(let R in f){let B=f[R];typeof B!="function"&&(O[R]=B)}let C={...y,...O,pointer:g,intersections:c,stopped:v.stopped,delta:d,unprojectedPoint:T,ray:x.ray,camera:S,stopPropagation(){const R="pointerId"in f&&M.capturedMap.get(f.pointerId);if((!R||R.has(y.eventObject))&&(C.stopped=v.stopped=!0,M.hovered.size&&Array.from(M.hovered.values()).find(B=>B.eventObject===y.eventObject))){const B=c.slice(0,c.indexOf(y));s([...B,y])}},target:{hasPointerCapture:P,setPointerCapture:b,releasePointerCapture:L},currentTarget:{hasPointerCapture:P,setPointerCapture:b,releasePointerCapture:L},nativeEvent:f};if(h(C),v.stopped===!0)break}}return c}function s(c){const{internal:f}=n.getState();for(const d of f.hovered.values())if(!c.length||!c.find(h=>h.object===d.object&&h.index===d.index&&h.instanceId===d.instanceId)){const m=d.eventObject.__r3f,v=m==null?void 0:m.handlers;if(f.hovered.delete(bh(d)),m!=null&&m.eventCount){const y={...d,intersections:c};v.onPointerOut==null||v.onPointerOut(y),v.onPointerLeave==null||v.onPointerLeave(y)}}}function o(c,f){for(let d=0;d<f.length;d++){const h=f[d].__r3f;h==null||h.handlers.onPointerMissed==null||h.handlers.onPointerMissed(c)}}function a(c){switch(c){case"onPointerLeave":case"onPointerCancel":return()=>s([]);case"onLostPointerCapture":return f=>{const{internal:d}=n.getState();"pointerId"in f&&d.capturedMap.has(f.pointerId)&&requestAnimationFrame(()=>{d.capturedMap.has(f.pointerId)&&(d.capturedMap.delete(f.pointerId),s([]))})}}return function(d){const{onPointerMissed:h,internal:m}=n.getState();m.lastEvent.current=d;const v=c==="onPointerMove",y=c==="onClick"||c==="onContextMenu"||c==="onDoubleClick",x=i(d,v?t:void 0),g=y?e(d):0;c==="onPointerDown"&&(m.initialClick=[d.offsetX,d.offsetY],m.initialHits=x.map(M=>M.eventObject)),y&&!x.length&&g<=2&&(o(d,m.interaction),h&&h(d)),v&&s(x);function S(M){const T=M.eventObject,P=T.__r3f,b=P==null?void 0:P.handlers;if(P!=null&&P.eventCount)if(v){if(b.onPointerOver||b.onPointerEnter||b.onPointerOut||b.onPointerLeave){const L=bh(M),O=m.hovered.get(L);O?O.stopped&&M.stopPropagation():(m.hovered.set(L,M),b.onPointerOver==null||b.onPointerOver(M),b.onPointerEnter==null||b.onPointerEnter(M))}b.onPointerMove==null||b.onPointerMove(M)}else{const L=b[c];L?(!y||m.initialHits.includes(T))&&(o(d,m.interaction.filter(O=>!m.initialHits.includes(O))),L(M)):y&&m.initialHits.includes(T)&&o(d,m.interaction.filter(O=>!m.initialHits.includes(O)))}}r(x,d,g,S)}}return{handlePointer:a}}const jC=n=>!!(n!=null&&n.render),YC=X.createContext(null),DF=(n,e)=>{const t=SF((a,c)=>{const f=new k,d=new k,h=new k;function m(g=c().camera,S=d,M=c().size){const{width:T,height:P,top:b,left:L}=M,O=T/P;S.isVector3?h.copy(S):h.set(...S);const C=g.getWorldPosition(f).distanceTo(h);if(zC(g))return{width:T/g.zoom,height:P/g.zoom,top:b,left:L,factor:1,distance:C,aspect:O};{const R=g.fov*Math.PI/180,B=2*Math.tan(R/2)*C,$=B*(T/P);return{width:$,height:B,top:b,left:L,factor:T/$,distance:C,aspect:O}}}let v;const y=g=>a(S=>({performance:{...S.performance,current:g}})),w=new be;return{set:a,get:c,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(g=1)=>n(c(),g),advance:(g,S)=>e(g,S,c()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new lx,pointer:w,mouse:w,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const g=c();v&&clearTimeout(v),g.performance.current!==g.performance.min&&y(g.performance.min),v=setTimeout(()=>y(c().performance.max),g.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:m},setEvents:g=>a(S=>({...S,events:{...S.events,...g}})),setSize:(g,S,M,T,P)=>{const b=c().camera,L={width:g,height:S,top:T||0,left:P||0,updateStyle:M};a(O=>({size:L,viewport:{...O.viewport,...m(b,d,L)}}))},setDpr:g=>a(S=>{const M=GC(g);return{viewport:{...S.viewport,dpr:M,initialDpr:S.viewport.initialDpr||M}}}),setFrameloop:(g="always")=>{const S=c().clock;S.stop(),S.elapsedTime=0,g!=="never"&&(S.start(),S.elapsedTime=0),a(()=>({frameloop:g}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:X.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(g,S,M)=>{const T=c().internal;return T.priority=T.priority+(S>0?1:0),T.subscribers.push({ref:g,priority:S,store:M}),T.subscribers=T.subscribers.sort((P,b)=>P.priority-b.priority),()=>{const P=c().internal;P!=null&&P.subscribers&&(P.priority=P.priority-(S>0?1:0),P.subscribers=P.subscribers.filter(b=>b.ref!==g))}}}}}),i=t.getState();let r=i.size,s=i.viewport.dpr,o=i.camera;return t.subscribe(()=>{const{camera:a,size:c,viewport:f,gl:d,set:h}=t.getState();if(c.width!==r.width||c.height!==r.height||f.dpr!==s){var m;r=c,s=f.dpr,PF(a,c),d.setPixelRatio(f.dpr);const v=(m=c.updateStyle)!=null?m:typeof HTMLCanvasElement<"u"&&d.domElement instanceof HTMLCanvasElement;d.setSize(c.width,c.height,v)}a!==o&&(o=a,h(v=>({viewport:{...v.viewport,...v.viewport.getCurrentViewport(a)}})))}),t.subscribe(a=>n(a)),t};let Ch,UF=new Set,OF=new Set,kF=new Set;function O0(n,e){if(n.size)for(const{callback:t}of n.values())t(e)}function $u(n,e){switch(n){case"before":return O0(UF,e);case"after":return O0(OF,e);case"tail":return O0(kF,e)}}let k0,F0;function z0(n,e,t){let i=e.clock.getDelta();for(e.frameloop==="never"&&typeof n=="number"&&(i=n-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=n),k0=e.internal.subscribers,Ch=0;Ch<k0.length;Ch++)F0=k0[Ch],F0.ref.current(F0.store.getState(),i,t);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}function FF(n){let e=!1,t=!1,i,r,s;function o(f){r=requestAnimationFrame(o),e=!0,i=0,$u("before",f),t=!0;for(const h of n.values()){var d;s=h.store.getState(),s.internal.active&&(s.frameloop==="always"||s.internal.frames>0)&&!((d=s.gl.xr)!=null&&d.isPresenting)&&(i+=z0(f,s))}if(t=!1,$u("after",f),i===0)return $u("tail",f),e=!1,cancelAnimationFrame(r)}function a(f,d=1){var h;if(!f)return n.forEach(m=>a(m.store.getState(),d));(h=f.gl.xr)!=null&&h.isPresenting||!f.internal.active||f.frameloop==="never"||(d>1?f.internal.frames=Math.min(60,f.internal.frames+d):t?f.internal.frames=2:f.internal.frames=1,e||(e=!0,requestAnimationFrame(o)))}function c(f,d=!0,h,m){if(d&&$u("before",f),h)z0(f,h,m);else for(const v of n.values())z0(f,v.store.getState());d&&$u("after",f)}return{loop:o,invalidate:a,advance:c}}function qC(){const n=X.useContext(YC);if(!n)throw new Error("R3F: Hooks can only be used within the Canvas component!");return n}function ui(n=t=>t,e){return qC()(n,e)}function wf(n,e=0){const t=qC(),i=t.getState().internal.subscribe,r=BC(n);return Mf(()=>i(r,e,t),[e,i,t]),null}const ou=new Map,{invalidate:jw,advance:Yw}=FF(ou),{reconciler:Cp,applyProps:yl}=TF(ou,LF),_l={objects:"shallow",strict:!1},zF=(n,e)=>{const t=typeof n=="function"?n(e):n;return jC(t)?t:new W_({powerPreference:"high-performance",canvas:e,antialias:!0,alpha:!0,...n})};function BF(n,e){const t=typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement;if(e){const{width:i,height:r,top:s,left:o,updateStyle:a=t}=e;return{width:i,height:r,top:s,left:o,updateStyle:a}}else if(typeof HTMLCanvasElement<"u"&&n instanceof HTMLCanvasElement&&n.parentElement){const{width:i,height:r,top:s,left:o}=n.parentElement.getBoundingClientRect();return{width:i,height:r,top:s,left:o,updateStyle:t}}else if(typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas)return{width:n.width,height:n.height,top:0,left:0,updateStyle:t};return{width:0,height:0,top:0,left:0}}function HF(n){const e=ou.get(n),t=e==null?void 0:e.fiber,i=e==null?void 0:e.store;e&&console.warn("R3F.createRoot should only be called once!");const r=typeof reportError=="function"?reportError:console.error,s=i||DF(jw,Yw),o=t||Cp.createContainer(s,Hl.ConcurrentRoot,null,!1,null,"",r,null);e||ou.set(n,{fiber:o,store:s});let a,c=!1,f;return{configure(d={}){let{gl:h,size:m,scene:v,events:y,onCreated:w,shadows:x=!1,linear:g=!1,flat:S=!1,legacy:M=!1,orthographic:T=!1,frameloop:P="always",dpr:b=[1,2],performance:L,raycaster:O,camera:C,onPointerMissed:R}=d,B=s.getState(),$=B.gl;B.gl||B.set({gl:$=zF(h,n)});let me=B.raycaster;me||B.set({raycaster:me=new LC});const{params:G,...Z}=O||{};if(sn.equ(Z,me,_l)||yl(me,{...Z}),sn.equ(G,me.params,_l)||yl(me,{params:{...me.params,...G}}),!B.camera||B.camera===f&&!sn.equ(f,C,_l)){f=C;const V=C instanceof pf,Q=V?C:T?new ns(0,0,0,0,.1,1e3):new dn(75,0,.1,1e3);V||(Q.position.z=5,C&&(yl(Q,C),("aspect"in C||"left"in C||"right"in C||"bottom"in C||"top"in C)&&(Q.manual=!0,Q.updateProjectionMatrix())),!B.camera&&!(C!=null&&C.rotation)&&Q.lookAt(0,0,0)),B.set({camera:Q}),me.camera=Q}if(!B.scene){let V;v!=null&&v.isScene?V=v:(V=new X_,v&&yl(V,v)),B.set({scene:Ml(V)})}if(!B.xr){var ne;const V=(J,ge)=>{const Ie=s.getState();Ie.frameloop!=="never"&&Yw(J,!0,Ie,ge)},Q=()=>{const J=s.getState();J.gl.xr.enabled=J.gl.xr.isPresenting,J.gl.xr.setAnimationLoop(J.gl.xr.isPresenting?V:null),J.gl.xr.isPresenting||jw(J)},se={connect(){const J=s.getState().gl;J.xr.addEventListener("sessionstart",Q),J.xr.addEventListener("sessionend",Q)},disconnect(){const J=s.getState().gl;J.xr.removeEventListener("sessionstart",Q),J.xr.removeEventListener("sessionend",Q)}};typeof((ne=$.xr)==null?void 0:ne.addEventListener)=="function"&&se.connect(),B.set({xr:se})}if($.shadowMap){const V=$.shadowMap.enabled,Q=$.shadowMap.type;if($.shadowMap.enabled=!!x,sn.boo(x))$.shadowMap.type=pc;else if(sn.str(x)){var he;const se={basic:EA,percentage:jp,soft:pc,variance:Rr};$.shadowMap.type=(he=se[x])!=null?he:pc}else sn.obj(x)&&Object.assign($.shadowMap,x);(V!==$.shadowMap.enabled||Q!==$.shadowMap.type)&&($.shadowMap.needsUpdate=!0)}const F=FC();F&&("enabled"in F?F.enabled=!M:"legacyMode"in F&&(F.legacyMode=M)),c||yl($,{outputEncoding:g?3e3:3001,toneMapping:S?es:M_}),B.legacy!==M&&B.set(()=>({legacy:M})),B.linear!==g&&B.set(()=>({linear:g})),B.flat!==S&&B.set(()=>({flat:S})),h&&!sn.fun(h)&&!jC(h)&&!sn.equ(h,$,_l)&&yl($,h),y&&!B.events.handlers&&B.set({events:y(s)});const W=BF(n,m);return sn.equ(W,B.size,_l)||B.setSize(W.width,W.height,W.updateStyle,W.top,W.left),b&&B.viewport.dpr!==GC(b)&&B.setDpr(b),B.frameloop!==P&&B.setFrameloop(P),B.onPointerMissed||B.set({onPointerMissed:R}),L&&!sn.equ(L,B.performance,_l)&&B.set(V=>({performance:{...V.performance,...L}})),a=w,c=!0,this},render(d){return c||this.configure(),Cp.updateContainer(de.jsx(VF,{store:s,children:d,onCreated:a,rootElement:n}),o,null,()=>{}),s},unmount(){ZC(n)}}}function VF({store:n,children:e,onCreated:t,rootElement:i}){return Mf(()=>{const r=n.getState();r.set(s=>({internal:{...s.internal,active:!0}})),t&&t(r),n.getState().events.connected||r.events.connect==null||r.events.connect(i)},[]),de.jsx(YC.Provider,{value:n,children:e})}function ZC(n,e){const t=ou.get(n),i=t==null?void 0:t.fiber;if(i){const r=t==null?void 0:t.store.getState();r&&(r.internal.active=!1),Cp.updateContainer(null,i,null,()=>{r&&setTimeout(()=>{try{var s,o,a,c;r.events.disconnect==null||r.events.disconnect(),(s=r.gl)==null||(o=s.renderLists)==null||o.dispose==null||o.dispose(),(a=r.gl)==null||a.forceContextLoss==null||a.forceContextLoss(),(c=r.gl)!=null&&c.xr&&r.xr.disconnect(),RF(r),ou.delete(n)}catch{}},500)})}}Cp.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:X.version});const B0={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function GF(n){const{handlePointer:e}=NF(n);return{priority:1,enabled:!0,compute(t,i,r){i.pointer.set(t.offsetX/i.size.width*2-1,-(t.offsetY/i.size.height)*2+1),i.raycaster.setFromCamera(i.pointer,i.camera)},connected:void 0,handlers:Object.keys(B0).reduce((t,i)=>({...t,[i]:e(i)}),{}),update:()=>{var t;const{events:i,internal:r}=n.getState();(t=r.lastEvent)!=null&&t.current&&i.handlers&&i.handlers.onPointerMove(r.lastEvent.current)},connect:t=>{var i;const{set:r,events:s}=n.getState();s.disconnect==null||s.disconnect(),r(o=>({events:{...o.events,connected:t}})),Object.entries((i=s.handlers)!=null?i:[]).forEach(([o,a])=>{const[c,f]=B0[o];t.addEventListener(c,a,{passive:f})})},disconnect:()=>{const{set:t,events:i}=n.getState();if(i.connected){var r;Object.entries((r=i.handlers)!=null?r:[]).forEach(([s,o])=>{if(i&&i.connected instanceof HTMLElement){const[a]=B0[s];i.connected.removeEventListener(a,o)}}),t(s=>({events:{...s.events,connected:void 0}}))}}}}function qw(n,e){let t;return(...i)=>{window.clearTimeout(t),t=window.setTimeout(()=>n(...i),e)}}function WF({debounce:n,scroll:e,polyfill:t,offsetSize:i}={debounce:0,scroll:!1,offsetSize:!1}){const r=t||(typeof window>"u"?class{}:window.ResizeObserver);if(!r)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[s,o]=X.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),a=X.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:s,orientationHandler:null}),c=n?typeof n=="number"?n:n.scroll:null,f=n?typeof n=="number"?n:n.resize:null,d=X.useRef(!1);X.useEffect(()=>(d.current=!0,()=>void(d.current=!1)));const[h,m,v]=X.useMemo(()=>{const g=()=>{if(!a.current.element)return;const{left:S,top:M,width:T,height:P,bottom:b,right:L,x:O,y:C}=a.current.element.getBoundingClientRect(),R={left:S,top:M,width:T,height:P,bottom:b,right:L,x:O,y:C};a.current.element instanceof HTMLElement&&i&&(R.height=a.current.element.offsetHeight,R.width=a.current.element.offsetWidth),Object.freeze(R),d.current&&!qF(a.current.lastBounds,R)&&o(a.current.lastBounds=R)};return[g,f?qw(g,f):g,c?qw(g,c):g]},[o,i,c,f]);function y(){a.current.scrollContainers&&(a.current.scrollContainers.forEach(g=>g.removeEventListener("scroll",v,!0)),a.current.scrollContainers=null),a.current.resizeObserver&&(a.current.resizeObserver.disconnect(),a.current.resizeObserver=null),a.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",a.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",a.current.orientationHandler))}function w(){a.current.element&&(a.current.resizeObserver=new r(v),a.current.resizeObserver.observe(a.current.element),e&&a.current.scrollContainers&&a.current.scrollContainers.forEach(g=>g.addEventListener("scroll",v,{capture:!0,passive:!0})),a.current.orientationHandler=()=>{v()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",a.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",a.current.orientationHandler))}const x=g=>{!g||g===a.current.element||(y(),a.current.element=g,a.current.scrollContainers=KC(g),w())};return jF(v,!!e),XF(m),X.useEffect(()=>{y(),w()},[e,v,m]),X.useEffect(()=>y,[]),[x,s,h]}function XF(n){X.useEffect(()=>{const e=n;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[n])}function jF(n,e){X.useEffect(()=>{if(e){const t=n;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",t,!0)}},[n,e])}function KC(n){const e=[];if(!n||n===document.body)return e;const{overflow:t,overflowX:i,overflowY:r}=window.getComputedStyle(n);return[t,i,r].some(s=>s==="auto"||s==="scroll")&&e.push(n),[...e,...KC(n.parentElement)]}const YF=["x","y","top","bottom","left","right","width","height"],qF=(n,e)=>YF.every(t=>n[t]===e[t]);var ZF=Object.defineProperty,KF=Object.defineProperties,JF=Object.getOwnPropertyDescriptors,Zw=Object.getOwnPropertySymbols,QF=Object.prototype.hasOwnProperty,$F=Object.prototype.propertyIsEnumerable,Kw=(n,e,t)=>e in n?ZF(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,Jw=(n,e)=>{for(var t in e||(e={}))QF.call(e,t)&&Kw(n,t,e[t]);if(Zw)for(var t of Zw(e))$F.call(e,t)&&Kw(n,t,e[t]);return n},ez=(n,e)=>KF(n,JF(e)),Qw,$w;typeof window<"u"&&((Qw=window.document)!=null&&Qw.createElement||(($w=window.navigator)==null?void 0:$w.product)==="ReactNative")?X.useLayoutEffect:X.useEffect;function JC(n,e,t){if(!n)return;if(t(n)===!0)return n;let i=n.child;for(;i;){const r=JC(i,e,t);if(r)return r;i=i.sibling}}function QC(n){try{return Object.defineProperties(n,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return n}}const eE=console.error;console.error=function(){const n=[...arguments].join("");if(n!=null&&n.startsWith("Warning:")&&n.includes("useContext")){console.error=eE;return}return eE.apply(this,arguments)};const hx=QC(X.createContext(null));class $C extends X.Component{render(){return X.createElement(hx.Provider,{value:this._reactInternals},this.props.children)}}function tz(){const n=X.useContext(hx);if(n===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=X.useId();return X.useMemo(()=>{for(const i of[n,n==null?void 0:n.alternate]){if(!i)continue;const r=JC(i,!1,s=>{let o=s.memoizedState;for(;o;){if(o.memoizedState===e)return!0;o=o.next}});if(r)return r}},[n,e])}function nz(){const n=tz(),[e]=X.useState(()=>new Map);e.clear();let t=n;for(;t;){if(t.type&&typeof t.type=="object"){const r=t.type._context===void 0&&t.type.Provider===t.type?t.type:t.type._context;r&&r!==hx&&!e.has(r)&&e.set(r,X.useContext(QC(r)))}t=t.return}return e}function iz(){const n=nz();return X.useMemo(()=>Array.from(n.keys()).reduce((e,t)=>i=>X.createElement(e,null,X.createElement(t.Provider,ez(Jw({},i),{value:n.get(t)}))),e=>X.createElement($C,Jw({},e))),[n])}const rz=X.forwardRef(function({children:e,fallback:t,resize:i,style:r,gl:s,events:o=GF,eventSource:a,eventPrefix:c,shadows:f,linear:d,flat:h,legacy:m,orthographic:v,frameloop:y,dpr:w,performance:x,raycaster:g,camera:S,scene:M,onPointerMissed:T,onCreated:P,...b},L){X.useMemo(()=>kC(yF),[]);const O=iz(),[C,R]=WF({scroll:!0,debounce:{scroll:50,resize:0},...i}),B=X.useRef(null),$=X.useRef(null);X.useImperativeHandle(L,()=>B.current);const me=BC(T),[G,Z]=X.useState(!1),[ne,he]=X.useState(!1);if(G)throw G;if(ne)throw ne;const F=X.useRef(null);Mf(()=>{const V=B.current;R.width>0&&R.height>0&&V&&(F.current||(F.current=HF(V)),F.current.configure({gl:s,events:o,shadows:f,linear:d,flat:h,legacy:m,orthographic:v,frameloop:y,dpr:w,performance:x,raycaster:g,camera:S,scene:M,size:R,onPointerMissed:(...Q)=>me.current==null?void 0:me.current(...Q),onCreated:Q=>{Q.events.connect==null||Q.events.connect(a?AF(a)?a.current:a:$.current),c&&Q.setEvents({compute:(se,J)=>{const ge=se[c+"X"],Ie=se[c+"Y"];J.pointer.set(ge/J.size.width*2-1,-(Ie/J.size.height)*2+1),J.raycaster.setFromCamera(J.pointer,J.camera)}}),P==null||P(Q)}}),F.current.render(de.jsx(O,{children:de.jsx(HC,{set:he,children:de.jsx(X.Suspense,{fallback:de.jsx(bF,{set:Z}),children:e??null})})})))}),X.useEffect(()=>{const V=B.current;if(V)return()=>ZC(V)},[]);const W=a?"none":"auto";return de.jsx("div",{ref:$,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:W,...r},...b,children:de.jsx("div",{ref:C,style:{width:"100%",height:"100%"},children:de.jsx("canvas",{ref:B,style:{display:"block"},children:t})})})}),sz=X.forwardRef(function(e,t){return de.jsx($C,{children:de.jsx(rz,{...e,ref:t})})});function sf(){return sf=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var i in t)({}).hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},sf.apply(null,arguments)}const Ef=new k,px=new k,oz=new k,tE=new be;function az(n,e,t){const i=Ef.setFromMatrixPosition(n.matrixWorld);i.project(e);const r=t.width/2,s=t.height/2;return[i.x*r+r,-(i.y*s)+s]}function lz(n,e){const t=Ef.setFromMatrixPosition(n.matrixWorld),i=px.setFromMatrixPosition(e.matrixWorld),r=t.sub(i),s=e.getWorldDirection(oz);return r.angleTo(s)>Math.PI/2}function uz(n,e,t,i){const r=Ef.setFromMatrixPosition(n.matrixWorld),s=r.clone();s.project(e),tE.set(s.x,s.y),t.setFromCamera(tE,e);const o=t.intersectObjects(i,!0);if(o.length){const a=o[0].distance;return r.distanceTo(t.ray.origin)<a}return!0}function cz(n,e){if(e instanceof ns)return e.zoom;if(e instanceof dn){const t=Ef.setFromMatrixPosition(n.matrixWorld),i=px.setFromMatrixPosition(e.matrixWorld),r=e.fov*Math.PI/180,s=t.distanceTo(i);return 1/(2*Math.tan(r/2)*s)}else return 1}function fz(n,e,t){if(e instanceof dn||e instanceof ns){const i=Ef.setFromMatrixPosition(n.matrixWorld),r=px.setFromMatrixPosition(e.matrixWorld),s=i.distanceTo(r),o=(t[1]-t[0])/(e.far-e.near),a=t[1]-o*e.far;return Math.round(o*s+a)}}const by=n=>Math.abs(n)<1e-10?0:n;function e2(n,e,t=""){let i="matrix3d(";for(let r=0;r!==16;r++)i+=by(e[r]*n.elements[r])+(r!==15?",":")");return t+i}const dz=(n=>e=>e2(e,n))([1,-1,1,1,1,-1,1,1,1,-1,1,1,1,-1,1,1]),hz=(n=>(e,t)=>e2(e,n(t),"translate(-50%,-50%)"))(n=>[1/n,1/n,1/n,1,-1/n,-1/n,-1/n,-1,1/n,1/n,1/n,1,1,1,1,1]);function pz(n){return n&&typeof n=="object"&&"current"in n}const mz=X.forwardRef(({children:n,eps:e=.001,style:t,className:i,prepend:r,center:s,fullscreen:o,portal:a,distanceFactor:c,sprite:f=!1,transform:d=!1,occlude:h,onOcclude:m,castShadow:v,receiveShadow:y,material:w,geometry:x,zIndexRange:g=[16777271,0],calculatePosition:S=az,as:M="div",wrapperClass:T,pointerEvents:P="auto",...b},L)=>{const{gl:O,camera:C,scene:R,size:B,raycaster:$,events:me,viewport:G}=ui(),[Z]=X.useState(()=>document.createElement(M)),ne=X.useRef(),he=X.useRef(null),F=X.useRef(0),W=X.useRef([0,0]),V=X.useRef(null),Q=X.useRef(null),se=(a==null?void 0:a.current)||me.connected||O.domElement.parentNode,J=X.useRef(null),ge=X.useRef(!1),Ie=X.useMemo(()=>h&&h!=="blending"||Array.isArray(h)&&h.length&&pz(h[0]),[h]);X.useLayoutEffect(()=>{const ke=O.domElement;h&&h==="blending"?(ke.style.zIndex=`${Math.floor(g[0]/2)}`,ke.style.position="absolute",ke.style.pointerEvents="none"):(ke.style.zIndex=null,ke.style.position=null,ke.style.pointerEvents=null)},[h]),X.useLayoutEffect(()=>{if(he.current){const ke=ne.current=xA(Z);if(R.updateMatrixWorld(),d)Z.style.cssText="position:absolute;top:0;left:0;pointer-events:none;overflow:hidden;";else{const Le=S(he.current,C,B);Z.style.cssText=`position:absolute;top:0;left:0;transform:translate3d(${Le[0]}px,${Le[1]}px,0);transform-origin:0 0;`}return se&&(r?se.prepend(Z):se.appendChild(Z)),()=>{se&&se.removeChild(Z),ke.unmount()}}},[se,d]),X.useLayoutEffect(()=>{T&&(Z.className=T)},[T]);const Be=X.useMemo(()=>d?{position:"absolute",top:0,left:0,width:B.width,height:B.height,transformStyle:"preserve-3d",pointerEvents:"none"}:{position:"absolute",transform:s?"translate3d(-50%,-50%,0)":"none",...o&&{top:-B.height/2,left:-B.width/2,width:B.width,height:B.height},...t},[t,s,o,B,d]),Fe=X.useMemo(()=>({position:"absolute",pointerEvents:P}),[P]);X.useLayoutEffect(()=>{if(ge.current=!1,d){var ke;(ke=ne.current)==null||ke.render(X.createElement("div",{ref:V,style:Be},X.createElement("div",{ref:Q,style:Fe},X.createElement("div",{ref:L,className:i,style:t,children:n}))))}else{var Le;(Le=ne.current)==null||Le.render(X.createElement("div",{ref:L,style:Be,className:i,children:n}))}});const Ne=X.useRef(!0);wf(ke=>{if(he.current){C.updateMatrixWorld(),he.current.updateWorldMatrix(!0,!1);const Le=d?W.current:S(he.current,C,B);if(d||Math.abs(F.current-C.zoom)>e||Math.abs(W.current[0]-Le[0])>e||Math.abs(W.current[1]-Le[1])>e){const H=lz(he.current,C);let xe=!1;Ie&&(Array.isArray(h)?xe=h.map(Ze=>Ze.current):h!=="blending"&&(xe=[R]));const oe=Ne.current;if(xe){const Ze=uz(he.current,C,$,xe);Ne.current=Ze&&!H}else Ne.current=!H;oe!==Ne.current&&(m?m(!Ne.current):Z.style.display=Ne.current?"block":"none");const Ue=Math.floor(g[0]/2),ve=h?Ie?[g[0],Ue]:[Ue-1,0]:g;if(Z.style.zIndex=`${fz(he.current,C,ve)}`,d){const[Ze,Ve]=[B.width/2,B.height/2],N=C.projectionMatrix.elements[5]*Ve,{isOrthographicCamera:I,top:te,left:Ce,bottom:we,right:Ee}=C,Ke=dz(C.matrixWorldInverse),Oe=I?`scale(${N})translate(${by(-(Ee+Ce)/2)}px,${by((te+we)/2)}px)`:`translateZ(${N}px)`;let Ge=he.current.matrixWorld;f&&(Ge=C.matrixWorldInverse.clone().transpose().copyPosition(Ge).scale(he.current.scale),Ge.elements[3]=Ge.elements[7]=Ge.elements[11]=0,Ge.elements[15]=1),Z.style.width=B.width+"px",Z.style.height=B.height+"px",Z.style.perspective=I?"":`${N}px`,V.current&&Q.current&&(V.current.style.transform=`${Oe}${Ke}translate(${Ze}px,${Ve}px)`,Q.current.style.transform=hz(Ge,1/((c||10)/400)))}else{const Ze=c===void 0?1:cz(he.current,C)*c;Z.style.transform=`translate3d(${Le[0]}px,${Le[1]}px,0) scale(${Ze})`}W.current=Le,F.current=C.zoom}}if(!Ie&&J.current&&!ge.current)if(d){if(V.current){const Le=V.current.children[0];if(Le!=null&&Le.clientWidth&&Le!=null&&Le.clientHeight){const{isOrthographicCamera:H}=C;if(H||x)b.scale&&(Array.isArray(b.scale)?b.scale instanceof k?J.current.scale.copy(b.scale.clone().divideScalar(1)):J.current.scale.set(1/b.scale[0],1/b.scale[1],1/b.scale[2]):J.current.scale.setScalar(1/b.scale));else{const xe=(c||10)/400,oe=Le.clientWidth*xe,Ue=Le.clientHeight*xe;J.current.scale.set(oe,Ue,1)}ge.current=!0}}}else{const Le=Z.children[0];if(Le!=null&&Le.clientWidth&&Le!=null&&Le.clientHeight){const H=1/G.factor,xe=Le.clientWidth*H,oe=Le.clientHeight*H;J.current.scale.set(xe,oe,1),ge.current=!0}J.current.lookAt(ke.camera.position)}});const je=X.useMemo(()=>({vertexShader:d?void 0:`
          /*
            This shader is from the THREE's SpriteMaterial.
            We need to turn the backing plane into a Sprite
            (make it always face the camera) if "transfrom"
            is false.
          */
          #include <common>

          void main() {
            vec2 center = vec2(0., 1.);
            float rotation = 0.0;

            // This is somewhat arbitrary, but it seems to work well
            // Need to figure out how to derive this dynamically if it even matters
            float size = 0.03;

            vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
            vec2 scale;
            scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
            scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );

            bool isPerspective = isPerspectiveMatrix( projectionMatrix );
            if ( isPerspective ) scale *= - mvPosition.z;

            vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale * size;
            vec2 rotatedPosition;
            rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
            rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
            mvPosition.xy += rotatedPosition;

            gl_Position = projectionMatrix * mvPosition;
          }
      `,fragmentShader:`
        void main() {
          gl_FragColor = vec4(0.0, 0.0, 0.0, 0.0);
        }
      `}),[d]);return X.createElement("group",sf({},b,{ref:he}),h&&!Ie&&X.createElement("mesh",{castShadow:v,receiveShadow:y,ref:J},x||X.createElement("planeGeometry",null),w||X.createElement("shaderMaterial",{side:Ki,vertexShader:je.vertexShader,fragmentShader:je.fragmentShader})))});var gz=Object.defineProperty,vz=(n,e,t)=>e in n?gz(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,yz=(n,e,t)=>(vz(n,e+"",t),t);class _z{constructor(){yz(this,"_listeners")}addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[e]===void 0&&(i[e]=[]),i[e].indexOf(t)===-1&&i[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const i=this._listeners;return i[e]!==void 0&&i[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const r=this._listeners[e];if(r!==void 0){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const i=this._listeners[e.type];if(i!==void 0){e.target=this;const r=i.slice(0);for(let s=0,o=r.length;s<o;s++)r[s].call(this,e);e.target=null}}}var xz=Object.defineProperty,Sz=(n,e,t)=>e in n?xz(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,vt=(n,e,t)=>(Sz(n,typeof e!="symbol"?e+"":e,t),t);const Rh=new Pa,nE=new Ss,Mz=Math.cos(70*(Math.PI/180)),iE=(n,e)=>(n%e+e)%e;let wz=class extends _z{constructor(e,t){super(),vt(this,"object"),vt(this,"domElement"),vt(this,"enabled",!0),vt(this,"target",new k),vt(this,"minDistance",0),vt(this,"maxDistance",1/0),vt(this,"minZoom",0),vt(this,"maxZoom",1/0),vt(this,"minPolarAngle",0),vt(this,"maxPolarAngle",Math.PI),vt(this,"minAzimuthAngle",-1/0),vt(this,"maxAzimuthAngle",1/0),vt(this,"enableDamping",!1),vt(this,"dampingFactor",.05),vt(this,"enableZoom",!0),vt(this,"zoomSpeed",1),vt(this,"enableRotate",!0),vt(this,"rotateSpeed",1),vt(this,"enablePan",!0),vt(this,"panSpeed",1),vt(this,"screenSpacePanning",!0),vt(this,"keyPanSpeed",7),vt(this,"zoomToCursor",!1),vt(this,"autoRotate",!1),vt(this,"autoRotateSpeed",2),vt(this,"reverseOrbit",!1),vt(this,"reverseHorizontalOrbit",!1),vt(this,"reverseVerticalOrbit",!1),vt(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),vt(this,"mouseButtons",{LEFT:$o.ROTATE,MIDDLE:$o.DOLLY,RIGHT:$o.PAN}),vt(this,"touches",{ONE:ea.ROTATE,TWO:ea.DOLLY_PAN}),vt(this,"target0"),vt(this,"position0"),vt(this,"zoom0"),vt(this,"_domElementKeyEvents",null),vt(this,"getPolarAngle"),vt(this,"getAzimuthalAngle"),vt(this,"setPolarAngle"),vt(this,"setAzimuthalAngle"),vt(this,"getDistance"),vt(this,"getZoomScale"),vt(this,"listenToKeyEvents"),vt(this,"stopListenToKeyEvents"),vt(this,"saveState"),vt(this,"reset"),vt(this,"update"),vt(this,"connect"),vt(this,"dispose"),vt(this,"dollyIn"),vt(this,"dollyOut"),vt(this,"getScale"),vt(this,"setScale"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>d.phi,this.getAzimuthalAngle=()=>d.theta,this.setPolarAngle=j=>{let Ae=iE(j,2*Math.PI),Ye=d.phi;Ye<0&&(Ye+=2*Math.PI),Ae<0&&(Ae+=2*Math.PI);let Je=Math.abs(Ae-Ye);2*Math.PI-Je<Je&&(Ae<Ye?Ae+=2*Math.PI:Ye+=2*Math.PI),h.phi=Ae-Ye,i.update()},this.setAzimuthalAngle=j=>{let Ae=iE(j,2*Math.PI),Ye=d.theta;Ye<0&&(Ye+=2*Math.PI),Ae<0&&(Ae+=2*Math.PI);let Je=Math.abs(Ae-Ye);2*Math.PI-Je<Je&&(Ae<Ye?Ae+=2*Math.PI:Ye+=2*Math.PI),h.theta=Ae-Ye,i.update()},this.getDistance=()=>i.object.position.distanceTo(i.target),this.listenToKeyEvents=j=>{j.addEventListener("keydown",lt),this._domElementKeyEvents=j},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",lt),this._domElementKeyEvents=null},this.saveState=()=>{i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},this.reset=()=>{i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(r),i.update(),c=a.NONE},this.update=(()=>{const j=new k,Ae=new k(0,1,0),Ye=new di().setFromUnitVectors(e.up,Ae),Je=Ye.clone().invert(),De=new k,Y=new di,pe=2*Math.PI;return function(){const re=i.object.position;Ye.setFromUnitVectors(e.up,Ae),Je.copy(Ye).invert(),j.copy(re).sub(i.target),j.applyQuaternion(Ye),d.setFromVector3(j),i.autoRotate&&c===a.NONE&&G($()),i.enableDamping?(d.theta+=h.theta*i.dampingFactor,d.phi+=h.phi*i.dampingFactor):(d.theta+=h.theta,d.phi+=h.phi);let ue=i.minAzimuthAngle,Me=i.maxAzimuthAngle;isFinite(ue)&&isFinite(Me)&&(ue<-Math.PI?ue+=pe:ue>Math.PI&&(ue-=pe),Me<-Math.PI?Me+=pe:Me>Math.PI&&(Me-=pe),ue<=Me?d.theta=Math.max(ue,Math.min(Me,d.theta)):d.theta=d.theta>(ue+Me)/2?Math.max(ue,d.theta):Math.min(Me,d.theta)),d.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,d.phi)),d.makeSafe(),i.enableDamping===!0?i.target.addScaledVector(v,i.dampingFactor):i.target.add(v),i.zoomToCursor&&C||i.object.isOrthographicCamera?d.radius=J(d.radius):d.radius=J(d.radius*m),j.setFromSpherical(d),j.applyQuaternion(Je),re.copy(i.target).add(j),i.object.matrixAutoUpdate||i.object.updateMatrix(),i.object.lookAt(i.target),i.enableDamping===!0?(h.theta*=1-i.dampingFactor,h.phi*=1-i.dampingFactor,v.multiplyScalar(1-i.dampingFactor)):(h.set(0,0,0),v.set(0,0,0));let ye=!1;if(i.zoomToCursor&&C){let Re=null;if(i.object instanceof dn&&i.object.isPerspectiveCamera){const Pe=j.length();Re=J(Pe*m);const fe=Pe-Re;i.object.position.addScaledVector(L,fe),i.object.updateMatrixWorld()}else if(i.object.isOrthographicCamera){const Pe=new k(O.x,O.y,0);Pe.unproject(i.object),i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/m)),i.object.updateProjectionMatrix(),ye=!0;const fe=new k(O.x,O.y,0);fe.unproject(i.object),i.object.position.sub(fe).add(Pe),i.object.updateMatrixWorld(),Re=j.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),i.zoomToCursor=!1;Re!==null&&(i.screenSpacePanning?i.target.set(0,0,-1).transformDirection(i.object.matrix).multiplyScalar(Re).add(i.object.position):(Rh.origin.copy(i.object.position),Rh.direction.set(0,0,-1).transformDirection(i.object.matrix),Math.abs(i.object.up.dot(Rh.direction))<Mz?e.lookAt(i.target):(nE.setFromNormalAndCoplanarPoint(i.object.up,i.target),Rh.intersectPlane(nE,i.target))))}else i.object instanceof ns&&i.object.isOrthographicCamera&&(ye=m!==1,ye&&(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/m)),i.object.updateProjectionMatrix()));return m=1,C=!1,ye||De.distanceToSquared(i.object.position)>f||8*(1-Y.dot(i.object.quaternion))>f?(i.dispatchEvent(r),De.copy(i.object.position),Y.copy(i.object.quaternion),ye=!1,!0):!1}})(),this.connect=j=>{i.domElement=j,i.domElement.style.touchAction="none",i.domElement.addEventListener("contextmenu",Ct),i.domElement.addEventListener("pointerdown",Ce),i.domElement.addEventListener("pointercancel",Ee),i.domElement.addEventListener("wheel",Ge)},this.dispose=()=>{var j,Ae,Ye,Je,De,Y;i.domElement&&(i.domElement.style.touchAction="auto"),(j=i.domElement)==null||j.removeEventListener("contextmenu",Ct),(Ae=i.domElement)==null||Ae.removeEventListener("pointerdown",Ce),(Ye=i.domElement)==null||Ye.removeEventListener("pointercancel",Ee),(Je=i.domElement)==null||Je.removeEventListener("wheel",Ge),(De=i.domElement)==null||De.ownerDocument.removeEventListener("pointermove",we),(Y=i.domElement)==null||Y.ownerDocument.removeEventListener("pointerup",Ee),i._domElementKeyEvents!==null&&i._domElementKeyEvents.removeEventListener("keydown",lt)};const i=this,r={type:"change"},s={type:"start"},o={type:"end"},a={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let c=a.NONE;const f=1e-6,d=new wy,h=new wy;let m=1;const v=new k,y=new be,w=new be,x=new be,g=new be,S=new be,M=new be,T=new be,P=new be,b=new be,L=new k,O=new be;let C=!1;const R=[],B={};function $(){return 2*Math.PI/60/60*i.autoRotateSpeed}function me(){return Math.pow(.95,i.zoomSpeed)}function G(j){i.reverseOrbit||i.reverseHorizontalOrbit?h.theta+=j:h.theta-=j}function Z(j){i.reverseOrbit||i.reverseVerticalOrbit?h.phi+=j:h.phi-=j}const ne=(()=>{const j=new k;return function(Ye,Je){j.setFromMatrixColumn(Je,0),j.multiplyScalar(-Ye),v.add(j)}})(),he=(()=>{const j=new k;return function(Ye,Je){i.screenSpacePanning===!0?j.setFromMatrixColumn(Je,1):(j.setFromMatrixColumn(Je,0),j.crossVectors(i.object.up,j)),j.multiplyScalar(Ye),v.add(j)}})(),F=(()=>{const j=new k;return function(Ye,Je){const De=i.domElement;if(De&&i.object instanceof dn&&i.object.isPerspectiveCamera){const Y=i.object.position;j.copy(Y).sub(i.target);let pe=j.length();pe*=Math.tan(i.object.fov/2*Math.PI/180),ne(2*Ye*pe/De.clientHeight,i.object.matrix),he(2*Je*pe/De.clientHeight,i.object.matrix)}else De&&i.object instanceof ns&&i.object.isOrthographicCamera?(ne(Ye*(i.object.right-i.object.left)/i.object.zoom/De.clientWidth,i.object.matrix),he(Je*(i.object.top-i.object.bottom)/i.object.zoom/De.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}})();function W(j){i.object instanceof dn&&i.object.isPerspectiveCamera||i.object instanceof ns&&i.object.isOrthographicCamera?m=j:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function V(j){W(m/j)}function Q(j){W(m*j)}function se(j){if(!i.zoomToCursor||!i.domElement)return;C=!0;const Ae=i.domElement.getBoundingClientRect(),Ye=j.clientX-Ae.left,Je=j.clientY-Ae.top,De=Ae.width,Y=Ae.height;O.x=Ye/De*2-1,O.y=-(Je/Y)*2+1,L.set(O.x,O.y,1).unproject(i.object).sub(i.object.position).normalize()}function J(j){return Math.max(i.minDistance,Math.min(i.maxDistance,j))}function ge(j){y.set(j.clientX,j.clientY)}function Ie(j){se(j),T.set(j.clientX,j.clientY)}function Be(j){g.set(j.clientX,j.clientY)}function Fe(j){w.set(j.clientX,j.clientY),x.subVectors(w,y).multiplyScalar(i.rotateSpeed);const Ae=i.domElement;Ae&&(G(2*Math.PI*x.x/Ae.clientHeight),Z(2*Math.PI*x.y/Ae.clientHeight)),y.copy(w),i.update()}function Ne(j){P.set(j.clientX,j.clientY),b.subVectors(P,T),b.y>0?V(me()):b.y<0&&Q(me()),T.copy(P),i.update()}function je(j){S.set(j.clientX,j.clientY),M.subVectors(S,g).multiplyScalar(i.panSpeed),F(M.x,M.y),g.copy(S),i.update()}function ke(j){se(j),j.deltaY<0?Q(me()):j.deltaY>0&&V(me()),i.update()}function Le(j){let Ae=!1;switch(j.code){case i.keys.UP:F(0,i.keyPanSpeed),Ae=!0;break;case i.keys.BOTTOM:F(0,-i.keyPanSpeed),Ae=!0;break;case i.keys.LEFT:F(i.keyPanSpeed,0),Ae=!0;break;case i.keys.RIGHT:F(-i.keyPanSpeed,0),Ae=!0;break}Ae&&(j.preventDefault(),i.update())}function H(){if(R.length==1)y.set(R[0].pageX,R[0].pageY);else{const j=.5*(R[0].pageX+R[1].pageX),Ae=.5*(R[0].pageY+R[1].pageY);y.set(j,Ae)}}function xe(){if(R.length==1)g.set(R[0].pageX,R[0].pageY);else{const j=.5*(R[0].pageX+R[1].pageX),Ae=.5*(R[0].pageY+R[1].pageY);g.set(j,Ae)}}function oe(){const j=R[0].pageX-R[1].pageX,Ae=R[0].pageY-R[1].pageY,Ye=Math.sqrt(j*j+Ae*Ae);T.set(0,Ye)}function Ue(){i.enableZoom&&oe(),i.enablePan&&xe()}function ve(){i.enableZoom&&oe(),i.enableRotate&&H()}function Ze(j){if(R.length==1)w.set(j.pageX,j.pageY);else{const Ye=$e(j),Je=.5*(j.pageX+Ye.x),De=.5*(j.pageY+Ye.y);w.set(Je,De)}x.subVectors(w,y).multiplyScalar(i.rotateSpeed);const Ae=i.domElement;Ae&&(G(2*Math.PI*x.x/Ae.clientHeight),Z(2*Math.PI*x.y/Ae.clientHeight)),y.copy(w)}function Ve(j){if(R.length==1)S.set(j.pageX,j.pageY);else{const Ae=$e(j),Ye=.5*(j.pageX+Ae.x),Je=.5*(j.pageY+Ae.y);S.set(Ye,Je)}M.subVectors(S,g).multiplyScalar(i.panSpeed),F(M.x,M.y),g.copy(S)}function N(j){const Ae=$e(j),Ye=j.pageX-Ae.x,Je=j.pageY-Ae.y,De=Math.sqrt(Ye*Ye+Je*Je);P.set(0,De),b.set(0,Math.pow(P.y/T.y,i.zoomSpeed)),V(b.y),T.copy(P)}function I(j){i.enableZoom&&N(j),i.enablePan&&Ve(j)}function te(j){i.enableZoom&&N(j),i.enableRotate&&Ze(j)}function Ce(j){var Ae,Ye;i.enabled!==!1&&(R.length===0&&((Ae=i.domElement)==null||Ae.ownerDocument.addEventListener("pointermove",we),(Ye=i.domElement)==null||Ye.ownerDocument.addEventListener("pointerup",Ee)),ot(j),j.pointerType==="touch"?yt(j):Ke(j))}function we(j){i.enabled!==!1&&(j.pointerType==="touch"?Te(j):Oe(j))}function Ee(j){var Ae,Ye,Je;ut(j),R.length===0&&((Ae=i.domElement)==null||Ae.releasePointerCapture(j.pointerId),(Ye=i.domElement)==null||Ye.ownerDocument.removeEventListener("pointermove",we),(Je=i.domElement)==null||Je.ownerDocument.removeEventListener("pointerup",Ee)),i.dispatchEvent(o),c=a.NONE}function Ke(j){let Ae;switch(j.button){case 0:Ae=i.mouseButtons.LEFT;break;case 1:Ae=i.mouseButtons.MIDDLE;break;case 2:Ae=i.mouseButtons.RIGHT;break;default:Ae=-1}switch(Ae){case $o.DOLLY:if(i.enableZoom===!1)return;Ie(j),c=a.DOLLY;break;case $o.ROTATE:if(j.ctrlKey||j.metaKey||j.shiftKey){if(i.enablePan===!1)return;Be(j),c=a.PAN}else{if(i.enableRotate===!1)return;ge(j),c=a.ROTATE}break;case $o.PAN:if(j.ctrlKey||j.metaKey||j.shiftKey){if(i.enableRotate===!1)return;ge(j),c=a.ROTATE}else{if(i.enablePan===!1)return;Be(j),c=a.PAN}break;default:c=a.NONE}c!==a.NONE&&i.dispatchEvent(s)}function Oe(j){if(i.enabled!==!1)switch(c){case a.ROTATE:if(i.enableRotate===!1)return;Fe(j);break;case a.DOLLY:if(i.enableZoom===!1)return;Ne(j);break;case a.PAN:if(i.enablePan===!1)return;je(j);break}}function Ge(j){i.enabled===!1||i.enableZoom===!1||c!==a.NONE&&c!==a.ROTATE||(j.preventDefault(),i.dispatchEvent(s),ke(j),i.dispatchEvent(o))}function lt(j){i.enabled===!1||i.enablePan===!1||Le(j)}function yt(j){switch(ct(j),R.length){case 1:switch(i.touches.ONE){case ea.ROTATE:if(i.enableRotate===!1)return;H(),c=a.TOUCH_ROTATE;break;case ea.PAN:if(i.enablePan===!1)return;xe(),c=a.TOUCH_PAN;break;default:c=a.NONE}break;case 2:switch(i.touches.TWO){case ea.DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;Ue(),c=a.TOUCH_DOLLY_PAN;break;case ea.DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;ve(),c=a.TOUCH_DOLLY_ROTATE;break;default:c=a.NONE}break;default:c=a.NONE}c!==a.NONE&&i.dispatchEvent(s)}function Te(j){switch(ct(j),c){case a.TOUCH_ROTATE:if(i.enableRotate===!1)return;Ze(j),i.update();break;case a.TOUCH_PAN:if(i.enablePan===!1)return;Ve(j),i.update();break;case a.TOUCH_DOLLY_PAN:if(i.enableZoom===!1&&i.enablePan===!1)return;I(j),i.update();break;case a.TOUCH_DOLLY_ROTATE:if(i.enableZoom===!1&&i.enableRotate===!1)return;te(j),i.update();break;default:c=a.NONE}}function Ct(j){i.enabled!==!1&&j.preventDefault()}function ot(j){R.push(j)}function ut(j){delete B[j.pointerId];for(let Ae=0;Ae<R.length;Ae++)if(R[Ae].pointerId==j.pointerId){R.splice(Ae,1);return}}function ct(j){let Ae=B[j.pointerId];Ae===void 0&&(Ae=new be,B[j.pointerId]=Ae),Ae.set(j.pageX,j.pageY)}function $e(j){const Ae=j.pointerId===R[0].pointerId?R[1]:R[0];return B[Ae.pointerId]}this.dollyIn=(j=me())=>{Q(j),i.update()},this.dollyOut=(j=me())=>{V(j),i.update()},this.getScale=()=>m,this.setScale=j=>{W(j),i.update()},this.getZoomScale=()=>me(),t!==void 0&&this.connect(t),this.update()}};function Ez(n,e,t,i){const r=class extends kr{constructor(o={}){const a=Object.entries(n);super({uniforms:a.reduce((c,[f,d])=>{const h=B_.clone({[f]:{value:d}});return{...c,...h}},{}),vertexShader:e,fragmentShader:t}),this.key="",a.forEach(([c])=>Object.defineProperty(this,c,{get:()=>this.uniforms[c].value,set:f=>this.uniforms[c].value=f})),Object.assign(this,o)}};return r.key=U_.generateUUID(),r}function Tz(n,e,t){const i=ui(m=>m.size),r=ui(m=>m.viewport),s=typeof n=="number"?n:i.width*r.dpr,o=i.height*r.dpr,a=(typeof n=="number"?t:n)||{},{samples:c=0,depth:f,...d}=a,h=X.useMemo(()=>{const m=new Sr(s,o,{minFilter:fn,magFilter:fn,type:Ea,...d});return f&&(m.depthTexture=new Qp(s,o,vr)),m.samples=c,m},[]);return X.useLayoutEffect(()=>{h.setSize(s,o),c&&(h.samples=c)},[c,h,s,o]),X.useEffect(()=>()=>h.dispose(),[]),h}const Az=n=>typeof n=="function",bz=X.forwardRef(({envMap:n,resolution:e=256,frames:t=1/0,makeDefault:i,children:r,...s},o)=>{const a=ui(({set:x})=>x),c=ui(({camera:x})=>x),f=ui(({size:x})=>x),d=X.useRef(null);X.useImperativeHandle(o,()=>d.current,[]);const h=X.useRef(null),m=Tz(e);X.useLayoutEffect(()=>{s.manual||(d.current.aspect=f.width/f.height)},[f,s]),X.useLayoutEffect(()=>{d.current.updateProjectionMatrix()});let v=0,y=null;const w=Az(r);return wf(x=>{w&&(t===1/0||v<t)&&(h.current.visible=!1,x.gl.setRenderTarget(m),y=x.scene.background,n&&(x.scene.background=n),x.gl.render(x.scene,d.current),x.scene.background=y,x.gl.setRenderTarget(null),h.current.visible=!0,v++)}),X.useLayoutEffect(()=>{if(i){const x=c;return a(()=>({camera:d.current})),()=>a(()=>({camera:x}))}},[d,i,a]),X.createElement(X.Fragment,null,X.createElement("perspectiveCamera",sf({ref:d},s),!w&&r),X.createElement("group",{ref:h},w&&r(m.texture)))}),Cz=X.forwardRef(({makeDefault:n,camera:e,regress:t,domElement:i,enableDamping:r=!0,keyEvents:s=!1,onChange:o,onStart:a,onEnd:c,...f},d)=>{const h=ui(b=>b.invalidate),m=ui(b=>b.camera),v=ui(b=>b.gl),y=ui(b=>b.events),w=ui(b=>b.setEvents),x=ui(b=>b.set),g=ui(b=>b.get),S=ui(b=>b.performance),M=e||m,T=i||y.connected||v.domElement,P=X.useMemo(()=>new wz(M),[M]);return wf(()=>{P.enabled&&P.update()},-1),X.useEffect(()=>(s&&P.connect(s===!0?T:s),P.connect(T),()=>void P.dispose()),[s,T,t,P,h]),X.useEffect(()=>{const b=C=>{h(),t&&S.regress(),o&&o(C)},L=C=>{a&&a(C)},O=C=>{c&&c(C)};return P.addEventListener("change",b),P.addEventListener("start",L),P.addEventListener("end",O),()=>{P.removeEventListener("start",L),P.removeEventListener("end",O),P.removeEventListener("change",b)}},[o,a,c,P,h,w]),X.useEffect(()=>{if(n){const b=g().controls;return x({controls:P}),()=>x({controls:b})}},[n,P]),X.createElement("primitive",sf({ref:d,object:P,enableDamping:r},f))}),Rz=Ez({iTime:0,dimFactor:1,cameraPos:new k,bgColor:new nt(.1,.11,.13),ledColor:new nt(0,.85,.95)},`
    varying vec2 vUv;
    void main() {
      vUv = uv;
      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
    }
  `,`
    uniform float iTime;
    uniform float dimFactor;
    uniform vec3 cameraPos;
    uniform vec3 bgColor;
    uniform vec3 ledColor;

    varying vec2 vUv;

    // --- Configuration ---
    #define MAX_STEPS 128
    #define MAX_DIST 100.0
    #define NUM_STARS 200

    // Hash function for pseudo-random star positions
    float hash(vec3 p) {
        p = fract(p * 0.3183099 + 0.1);
        p *= 17.0;
        return fract(p.x * p.y * p.z * (p.x + p.y + p.z));
    }

    // Generate star field
    vec3 stars(vec3 rd) {
        vec3 col = vec3(0.0);
        
        // Multiple layers of stars at different depths
        for(float layer = 0.0; layer < 3.0; layer += 1.0) {
            vec3 starDir = rd * (20.0 + layer * 30.0);
            vec3 starCell = floor(starDir);
            
            for(float dx = -1.0; dx <= 1.0; dx += 1.0) {
                for(float dy = -1.0; dy <= 1.0; dy += 1.0) {
                    for(float dz = -1.0; dz <= 1.0; dz += 1.0) {
                        vec3 cell = starCell + vec3(dx, dy, dz);
                        float h = hash(cell + vec3(layer * 10.0));
                        
                        // Only some cells have stars
                        if(h > 0.95) {
                            vec3 starPos = cell + vec3(
                                hash(cell + vec3(1.0, layer, 0.0)),
                                hash(cell + vec3(0.0, layer, 1.0)),
                                hash(cell + vec3(1.0, layer, 1.0))
                            );
                            
                            vec3 toStar = normalize(starPos) - rd;
                            float dist = length(toStar);
                            
                            // Star size and intensity
                            float size = 0.002 + hash(cell + vec3(2.0, layer, 0.0)) * 0.003;
                            float intensity = smoothstep(size, 0.0, dist);
                            
                            // Star color variation (mostly white/blue/cyan)
                            float colorVar = hash(cell + vec3(3.0, layer, 0.0));
                            vec3 starColor = mix(
                                vec3(0.9, 0.95, 1.0),  // White-blue
                                ledColor,               // Cyan from uniform
                                colorVar * 0.5
                            );
                            
                            // Twinkling effect
                            float twinkle = sin(iTime * 3.0 + h * 100.0) * 0.5 + 0.5;
                            intensity *= 0.7 + twinkle * 0.3;
                            
                            col += starColor * intensity * (1.0 - layer * 0.3);
                        }
                    }
                }
            }
        }
        
        return col;
    }

    void main() {
        // Standard UV setup for full-screen quad
        vec2 uv = (vUv - 0.5) * 2.0;

        // Ray Direction
        vec3 rd = normalize(vec3(uv.x, uv.y, 1.5));

        // Start with deep space background
        vec3 col = bgColor * 0.5; // Darker background for night sky

        // Add stars
        col += stars(rd);

        // Subtle nebula-like effect in the background
        float nebula = smoothstep(0.5, 1.0, 
            sin(rd.x * 2.0 + iTime * 0.1) * 
            sin(rd.y * 2.0 + iTime * 0.15) * 
            sin(rd.z * 2.0)
        );
        col += ledColor * nebula * 0.03;

        // --- Dark Mode / Dimming ---
        col *= dimFactor;

        gl_FragColor = vec4(col, 1.0);
    }
  `);kC({Shader021_3DMaterial:Rz});const Pz=({playheadX:n,controlsRef:e})=>{const{camera:t}=ui(),i=X.useRef(n);return wf(()=>{if(!e.current)return;const r=e.current,s=n,o=r.target,a=new k().subVectors(t.position,o),c=U_.lerp(o.x,s,.1);r.target.set(c,0,0),t.position.copy(r.target).add(a),r.update(),i.current=n}),null},Ph=({position:n,rotation:e=[0,0,0],width:t=4,height:i=3,children:r,darkMode:s=!1})=>de.jsxs("group",{position:n,rotation:e,children:[de.jsxs("mesh",{children:[de.jsx("planeGeometry",{args:[t,i]}),de.jsx("meshStandardMaterial",{color:s?"#1a1a1a":"#ffffff",transparent:!0,opacity:s?.3:.95,side:Ki})]}),de.jsx(mz,{transform:!0,occlude:!0,position:[0,0,.01],style:{width:`${t*100}px`,height:`${i*100}px`,pointerEvents:"auto"},distanceFactor:1,children:de.jsx("div",{style:{width:"100%",height:"100%",overflow:"hidden",background:s?"rgba(0, 0, 0, 0.5)":"transparent",padding:"10px",borderRadius:"8px",border:s?"1px solid rgba(255, 255, 255, 0.1)":"1px solid rgba(0, 0, 0, 0.1)"},children:r})})]}),Lz=({dimFactor:n,playheadX:e})=>{const t=X.useRef(null),{camera:i}=ui();return wf(r=>{t.current&&(t.current.iTime=r.clock.elapsedTime,t.current.dimFactor=n,t.current.cameraPos=i.position)}),de.jsxs("mesh",{position:[e,0,-20],scale:[200,200,1],children:[de.jsx("planeGeometry",{args:[1,1]}),de.jsx("shader021_3DMaterial",{ref:t,transparent:!0,side:Ki})]})},Iz=({headerContent:n,patternDisplayContent:e,controlsContent:t,mediaOverlayContent:i,darkMode:r=!1,dimFactor:s=1,playheadX:o=0,viewMode:a="device",onDarkModeToggle:c,onExitStudio:f,onViewModeToggle:d})=>{const h=X.useRef(null);return de.jsxs("div",{style:{width:"100%",height:"100vh",position:"relative"},children:[de.jsx("div",{style:{position:"absolute",top:"20px",left:"20px",zIndex:1e3},children:de.jsx("button",{onClick:f,className:"px-4 py-2 bg-blue-600 text-white rounded-lg shadow-lg hover:bg-blue-700 transition-colors border border-blue-500 font-mono text-sm",children:" Exit 3D Studio"})}),de.jsxs("div",{style:{position:"absolute",top:"20px",right:"20px",zIndex:1e3,display:"flex",gap:"10px"},children:[de.jsx("button",{onClick:d,className:"px-4 py-2 bg-purple-600 text-white rounded-lg shadow-lg hover:bg-purple-700 transition-colors border border-purple-500 font-mono text-sm",children:a==="device"?" Device View":" Wall View"}),de.jsx("button",{onClick:c,className:"px-4 py-2 bg-gray-800 text-white rounded-lg shadow-lg hover:bg-gray-700 transition-colors border border-gray-600",children:r?" Light Mode":" Dark Mode"})]}),de.jsxs(sz,{shadows:!0,children:[de.jsx(Pz,{isPlaying:!0,playheadX:o,controlsRef:h}),de.jsx(bz,{makeDefault:!0,position:[0,2,12],fov:60}),de.jsx(Lz,{dimFactor:s,playheadX:o}),de.jsx(Cz,{ref:h,enableDamping:!0,dampingFactor:.05,minDistance:5,maxDistance:30,maxPolarAngle:Math.PI/2}),de.jsx("ambientLight",{intensity:r?.2:.6}),de.jsx("directionalLight",{position:[10,10,5],intensity:r?.3:.8,castShadow:!0,"shadow-mapSize-width":2048,"shadow-mapSize-height":2048}),de.jsx("pointLight",{position:[-10,5,-5],intensity:r?.2:.5}),de.jsx("pointLight",{position:[10,5,5],intensity:r?.2:.5}),de.jsxs("group",{position:[o,0,0],children:[n&&de.jsx(Ph,{position:[0,4,-2],width:8,height:1.5,darkMode:r,children:n}),e&&de.jsx(Ph,{position:a==="wall"?[0,2,-15]:[0,-1,2],rotation:a==="wall"?[0,0,0]:[Math.PI/8,0,0],width:a==="wall"?16:10,height:a==="wall"?12:6,darkMode:r,children:e}),t&&de.jsx(Ph,{position:[0,-2.5,1],rotation:[Math.PI/12,0,0],width:9,height:1.8,darkMode:r,children:t}),i&&de.jsx(Ph,{position:[6,.5,-1],rotation:[0,-Math.PI/6,0],width:4,height:3,darkMode:r,children:i})]})]})]})},eo=44100,Lh=4096,Nz="Loading library...",rE={title:"...",order:0,row:0,bpm:0,numChannels:0},sE="4-mat_madness.mod",xl="./worklets/openmpt-processor.js".replace(/\/\//g,"/"),Dz=(n,e,t)=>n+(e-n)*t,oE=(n,e,t,i)=>Dz(n,e,1-Math.exp(-t*i)),Uz=n=>{if(!(n!=null&&n.text))return{activeEffect:0,intensity:0};const t=n.text.trim().toUpperCase().match(/([0-9A-F])([0-9A-F]{2})/);if(!t)return{activeEffect:0,intensity:0};const i=t[1],r=parseInt(t[2],16)/255;switch(i){case"4":return{activeEffect:1,intensity:r};case"3":return{activeEffect:2,intensity:r};case"7":return{activeEffect:3,intensity:r};case"0":if(t[2]!=="00")return{activeEffect:4,intensity:r};break;case"R":return{activeEffect:5,intensity:r}}return{activeEffect:0,intensity:r}},Oz=n=>{var e,t;return(t=(e=n==null?void 0:n.text)==null?void 0:e.match(/[A-G][#-]?\d/))==null?void 0:t[0]},kz=n=>{if(!n)return 0;const e=n.toUpperCase(),t={C:0,"C#":1,DB:1,D:2,"D#":3,EB:3,E:4,F:5,"F#":6,GB:6,G:7,"G#":8,AB:8,A:9,"A#":10,BB:10,B:11},i=e.match(/^([A-G](?:#|B)?)\-?(\d)$/);if(!i)return 0;const r=t[i[1]]??0,s=(parseInt(i[2],10)+1)*12+r;return 440*Math.pow(2,(s-69)/12)};function Fz(n=1){const[e,t]=X.useState(Nz),[i,r]=X.useState(!1),[s,o]=X.useState(!1),[a,c]=X.useState(!1),[f,d]=X.useState(rE),[h,m]=X.useState("... Waiting for module to play ..."),[v,y]=X.useState(null),[w,x]=X.useState(0),[g,S]=X.useState(0),[M,T]=X.useState(0),[P,b]=X.useState(!1),[L,O]=X.useState("script"),[C,R]=X.useState(!1),[B,$]=X.useState(0),[me,G]=X.useState(0),[Z,ne]=X.useState([]),[he,F]=X.useState(0),[W,V]=X.useState(0),[Q,se]=X.useState(0),[J,ge]=X.useState(0),[Ie,Be]=X.useState(!1),[Fe,Ne]=X.useState(0),je=X.useRef(null),ke=X.useRef(0),Le=X.useRef(null),H=X.useRef(null),xe=X.useRef(null),oe=X.useRef(null),Ue=X.useRef({}),ve=X.useRef({}),Ze=X.useRef(0),Ve=X.useRef(0),N=X.useRef(f),I=X.useRef(s),te=X.useRef(Ie),Ce=X.useRef(null),we=X.useRef(!1),Ee=X.useRef(!1),Ke=X.useRef(null),Oe=X.useRef(0),Ge=X.useRef(0),lt=eo*.5,yt=eo*.2,Te=4096,Ct=4,ot=4;X.useEffect(()=>{N.current=f},[f]),X.useEffect(()=>{I.current=s},[s]),X.useEffect(()=>{te.current=Ie},[Ie]),X.useEffect(()=>{Ce.current&&(Ce.current.gain.value=n)},[n]);const ut=X.useCallback((pe=!1)=>{if(H.current&&(H.current.disconnect(),H.current=null),xe.current&&(xe.current.disconnect(),xe.current=null),oe.current&&(oe.current.disconnect(),oe.current=null),Ke.current&&(clearInterval(Ke.current),Ke.current=null),Oe.current=0,Ge.current=0,o(!1),cancelAnimationFrame(Ze.current),ke.current!==0&&je.current)try{je.current._openmpt_module_set_position_order_row(ke.current,0,0)}catch(D){console.error("Error resetting module position:",D)}m(pe?"... Song Ended ...":"... Stopped ..."),Ve.current=0,pe&&t(`Finished playing "${N.current.title}".`)},[]),ct=X.useCallback((pe,D,re)=>{t("Caching pattern data..."),Ue.current={},ve.current={},setTimeout(()=>{try{const ue=D._openmpt_module_get_num_orders(pe),Me=D._openmpt_module_get_num_channels(pe);d(ye=>({...ye,numChannels:Me}));for(let ye=0;ye<ue;ye++){const Re=D._openmpt_module_get_order_pattern(pe,ye);if(Re>=D._openmpt_module_get_num_patterns(pe))continue;const Pe=D._openmpt_module_get_pattern_num_rows(pe,Re),fe=Array.from({length:Pe},()=>Array.from({length:Me},()=>({type:"empty",text:""})));for(let Qe=0;Qe<Pe;Qe++){let Et="";for(let Tt=0;Tt<Me;Tt++){const Xt=D._openmpt_module_format_pattern_row_channel(pe,Re,Qe,Tt,12,1),Ut=D.UTF8ToString(Xt);D._openmpt_free_string(Xt),Et+=" "+Ut.replace(/ /g,"&nbsp;")+" |";const Xe=(Ut||"").trim();let Ft="empty";!Xe||/^[-\.\s]+$/.test(Xe)?Ft="empty":/[A-Ga-g][#b]?\d/.test(Xe)?Ft="note":/^\d{1,3}$/.test(Xe)||/^i\d+/i.test(Xe)?Ft="instrument":(/^[0-9A-Fa-f]{1,4}$/.test(Xe)||/[A-Za-z]+=/.test(Xe)||/[0-9A-Fa-f]{1,2}/.test(Xe),Ft="effect");let jt=0,$t=0,Yn=0,gi=0,Hi=0,U=0;D._openmpt_module_get_pattern_row_channel_command&&(jt=D._openmpt_module_get_pattern_row_channel_command(pe,Re,Qe,Tt,0),$t=D._openmpt_module_get_pattern_row_channel_command(pe,Re,Qe,Tt,1),Yn=D._openmpt_module_get_pattern_row_channel_command(pe,Re,Qe,Tt,2),gi=D._openmpt_module_get_pattern_row_channel_command(pe,Re,Qe,Tt,3),Hi=D._openmpt_module_get_pattern_row_channel_command(pe,Re,Qe,Tt,4),U=D._openmpt_module_get_pattern_row_channel_command(pe,Re,Qe,Tt,5)),fe[Qe][Tt]={type:Ft,text:Xe,note:jt,inst:$t,volCmd:Yn,effCmd:gi,volVal:Hi,effVal:U}}Ue.current[`${ye}-${Qe}`]=Et}ve.current[ye]={order:ye,patternIndex:Re,numRows:Pe,numChannels:Me,rows:fe}}{let ye=0;const Re=Object.keys(ve.current);for(let Pe=0;Pe<Re.length;Pe++){const fe=Number(Re[Pe]),Qe=ve.current[fe];Qe&&(ye+=Qe.numRows)}T(ye)}t(`Loaded "${re}". Ready to play.`),console.log("Pattern data cached.")}catch(ue){console.error("Failed to cache pattern data:",ue),t("Error: Failed to cache patterns. See console.")}},50)},[]),$e=X.useCallback(async(pe,D)=>{if(je.current){I.current&&ut(!1),ke.current!==0&&(je.current._openmpt_module_destroy(ke.current),ke.current=0),Ue.current={},ve.current={},c(!1),t(`Loading "${D}"...`);try{const re=je.current,ue=re._malloc(pe.length);re.HEAPU8.set(pe,ue);const Me=re._openmpt_module_create_from_memory2(ue,pe.length,0,0,0,0,0,0,0);if(re._free(ue),Me===0)throw new Error(`Failed to load module "${D}".`);ke.current=Me;const ye=re.stringToUTF8("title"),Re=re._openmpt_module_get_metadata(Me,ye),Pe=re.UTF8ToString(Re)||D;re._free(ye),re._openmpt_free_string(Re),d({...rE,title:Pe}),c(!0),ct(Me,re,Pe)}catch(re){console.error("Failed to load module:",re);const ue=re;t(`Error: ${ue.message}. See console.`),ue.name==="TypeError"&&t("Error: libopenmpt.js may be missing required C API functions.")}}},[ut,ct]),j=X.useCallback(async pe=>{const D=new Uint8Array(await pe.arrayBuffer());await $e(D,pe.name)},[$e]),Ae=X.useCallback(()=>{var pe,D,re,ue,Me,ye,Re,Pe;if(!(!je.current||ke.current===0)){try{const fe=je.current,Qe=ke.current,Et=fe._openmpt_module_get_current_order(Qe),Tt=fe._openmpt_module_get_current_row(Qe),Xt=fe._openmpt_module_get_position_seconds(Qe),Ut=fe._openmpt_module_get_current_estimated_bpm(Qe),Xe=((pe=fe._openmpt_module_get_current_tempo2)==null?void 0:pe.call(fe,Qe))??Ut,Ft=((D=fe._openmpt_module_get_current_speed)==null?void 0:D.call(fe,Qe))??6,jt=((re=fe._openmpt_module_get_current_playing_channels)==null?void 0:re.call(fe,Qe))??N.current.numChannels;d(ie=>({...ie,order:Et,row:Tt,bpm:Math.round(Ut)})),$(Xt),ge(jt),V(ie=>(ie+Xe/60*(1/60))%1),se(ie=>oE(ie,Ft%2===0?0:.1,3,1/60));const $t=Ut>0?Ut/60*4:0,Yn=$t>0?Xt*$t:Tt,gi=performance.now()/1e3,Hi=gi-Ve.current,U=Yn+Hi*$t;Ve.current=gi,G(U);const q=ve.current[Et]??null;y(q||null),x(Tt);const ae=(q==null?void 0:q.numChannels)??N.current.numChannels,ce=[];for(let ie=0;ie<ae;ie++){const We=((ue=fe._openmpt_module_get_current_channel_vu_mono)==null?void 0:ue.call(fe,Qe,ie))??0,at=((Me=fe._openmpt_module_get_current_channel_vu_left)==null?void 0:Me.call(fe,Qe,ie))??We,pt=((ye=fe._openmpt_module_get_current_channel_vu_right)==null?void 0:ye.call(fe,Qe,ie))??We,mt=Math.max(-1,Math.min(1,pt-at)),St=Math.min(1,We),xt=((Re=fe._openmpt_module_get_channel_mute_status)==null?void 0:Re.call(fe,Qe,ie))??0,en=((q==null?void 0:q.rows[Tt])??[])[ie],{activeEffect:In,intensity:Jt}=Uz(en),Sn=Oz(en),_t=kz(Sn),it=Sn?1:0,$n=Z[ie],Rt=it?0:(($n==null?void 0:$n.noteAge)??0)+1/60;ce.push({volume:St,pan:mt,freq:_t,trigger:it,noteAge:Rt,activeEffect:In,effectValue:Jt,isMuted:xt})}ne(ce),(Pe=ce[0])!=null&&Pe.trigger?F(1):F(ie=>oE(ie,0,8,1/60))}catch(fe){console.error("Error in UI update:",fe)}Ze.current=requestAnimationFrame(Ae)}},[Z]),Ye=X.useCallback(pe=>{if(!ke.current||!je.current)return;const D=je.current,re=ke.current,ue=D._malloc(pe*4),Me=D._malloc(pe*4),ye=D._openmpt_module_read_float_stereo(re,eo,pe,ue,Me);if(ye===0)if(te.current)try{D._openmpt_module_set_position_order_row(re,0,0)}catch(Et){console.error("Error resetting position for loop:",Et)}else{ut(!0),D._free(ue),D._free(Me);return}const Re=new Float32Array(D.HEAPF32.buffer,ue,ye),Pe=new Float32Array(D.HEAPF32.buffer,Me,ye),fe=new Float32Array(Re),Qe=new Float32Array(Pe);xe.current&&(xe.current.port.postMessage({left:fe,right:Qe},[fe.buffer,Qe.buffer]),Oe.current+=ye),D._free(ue),D._free(Me)},[ut]),Je=X.useCallback(async()=>{if(!(s||ke.current===0||!je.current))try{if(!Le.current){const pe=window.AudioContext||window.webkitAudioContext;if(Le.current=new pe({sampleRate:eo}),L==="worklet"&&!Ee.current)try{try{const D=await fetch(xl,{method:"HEAD",cache:"no-store"});console.log("Worklet HEAD preflight:",D.status,D.statusText,D.headers.get("content-type"))}catch(D){console.warn("Worklet HEAD preflight failed (continuing to module load):",D)}await Le.current.audioWorklet.addModule(xl),Ee.current=!0,console.log("AudioWorklet initialized")}catch(D){console.warn("Failed to initialize AudioWorklet, using ScriptProcessor:",D);try{const re=await fetch(xl,{method:"GET",cache:"no-store"});if(re.status!==200){const ue=await re.text();console.warn("Worklet GET body preview:",ue.slice(0,200))}}catch(re){console.warn("Worklet GET failed:",re)}we.current=!1}}if(Le.current.state==="suspended"&&await Le.current.resume(),Ce.current||(Ce.current=Le.current.createGain(),Ce.current.connect(Le.current.destination)),Ce.current.gain.value=n,oe.current&&oe.current.disconnect(),oe.current=Le.current.createStereoPanner(),oe.current.pan.value=Fe,L==="worklet"&&Ee.current)try{xe.current=new AudioWorkletNode(Le.current,"openmpt-processor",{outputChannelCount:[2]}),xe.current.port.onmessage=re=>{if(re.data.type==="starvation"){console.warn("Audio Buffer Underrun! Available frames:",re.data.available);const ue=yt-re.data.available,Me=Math.max(1,Math.ceil(ue/Te)),ye=Math.min(Me,Ct);for(let Re=0;Re<ye;Re++)Ye(Te)}else re.data.type==="bufferLevel"?Oe.current=re.data.level:re.data.type==="overflow"&&console.warn("Buffer overflow, lost frames:",re.data.lost)},xe.current.connect(oe.current),oe.current.connect(Ce.current),Ce.current.connect(Le.current.destination),console.log("Using AudioWorkletNode with Ring Buffer Pump"),Ke.current&&clearInterval(Ke.current),Oe.current=0,Ge.current=Le.current.currentTime,console.log("Prefilling audio buffer...");let pe=0;const D=Math.ceil(lt/Te);for(let re=0;re<D;re++)Ye(Te),pe+=Te;console.log(`Prefilled ${pe} frames (${(pe/eo*1e3).toFixed(0)}ms)`),Ke.current=window.setInterval(()=>{if(!Le.current||!I.current)return;const re=Le.current.currentTime,Me=(re-Ge.current)*eo;if(Oe.current=Math.max(0,Oe.current-Me),Ge.current=re,Oe.current<yt){const ye=lt-Oe.current,Re=Math.ceil(ye/Te);for(let Pe=0;Pe<Re&&Pe<ot;Pe++)Ye(Te)}},50)}catch(pe){console.warn("Failed to create AudioWorkletNode, falling back:",pe)}if(L==="script"||L==="worklet"&&!xe.current){const pe=je.current,D=ke.current,re=pe._malloc(Lh*4),ue=pe._malloc(Lh*4);H.current=Le.current.createScriptProcessor(Lh,0,2),H.current.onaudioprocess=Me=>{try{const ye=pe._openmpt_module_read_float_stereo(D,eo,Lh,re,ue);if(ye===0)if(te.current){try{pe._openmpt_module_set_position_order_row(D,0,0)}catch(Et){console.error("Error resetting position for loop:",Et),setTimeout(()=>ut(!0),0)}return}else{setTimeout(()=>ut(!0),0);return}const Re=Me.outputBuffer.getChannelData(0),Pe=Me.outputBuffer.getChannelData(1),fe=new Float32Array(pe.HEAPF32.buffer,re,ye),Qe=new Float32Array(pe.HEAPF32.buffer,ue,ye);Re.set(fe),Pe.set(Qe)}catch(ye){console.error("Error in audio process:",ye),setTimeout(()=>ut(!1),0)}},H.current.connect(oe.current),oe.current.connect(Ce.current),Ce.current.connect(Le.current.destination),console.log("Using ScriptProcessorNode for playback")}o(!0),t(`Playing "${N.current.title}"...`),Ve.current=performance.now()/1e3,Ze.current=requestAnimationFrame(Ae)}catch(pe){console.error("Failed to start music:",pe),t("Error: Failed to start playback. See console.")}},[s,ut,Ae,Fe,n,Ye,L]),De=X.useCallback(()=>{if(L==="script"&&!P)return;const pe=L==="worklet"?"script":"worklet";s&&(ut(!1),R(!0)),O(pe),console.log()},[L,s,P,ut]);return X.useEffect(()=>{C&&(R(!1),Je())},[C,Je]),X.useEffect(()=>((async()=>{if(!window.libopenmptReady){t("Error: libopenmpt initialization script not found."),console.error("window.libopenmptReady promise not found. Check index.html.");return}try{const D=new Promise((ue,Me)=>{setTimeout(()=>Me(new Error("Initialization timed out")),15e3)}),re=await Promise.race([window.libopenmptReady,D]);re.UTF8ToString||(console.warn("Polyfilling libopenmpt.UTF8ToString..."),re.UTF8ToString=ue=>{let Me="";if(!ue)return Me;const ye=re.HEAPU8;for(let Re=0;ye[ue+Re]!==0;Re++)Me+=String.fromCharCode(ye[ue+Re]);return Me}),re.stringToUTF8||(console.warn("Polyfilling libopenmpt.stringToUTF8..."),re.stringToUTF8=ue=>{const Me=(ue.length<<2)+1,ye=re._malloc(Me),Re=re.HEAPU8;let Pe=0,fe=0;for(;Pe<ue.length;)Re[ye+fe++]=ue.charCodeAt(Pe++);return Re[ye+fe]=0,ye}),je.current=re,r(!0);try{const ue=window.AudioContext||window.webkitAudioContext;try{const ye=await fetch(xl,{method:"HEAD",cache:"no-store"});if(!ye.ok)console.warn(`Worklet preflight HEAD returned ${ye.status} ${ye.statusText}`);else{const Re=ye.headers.get("content-type")||"";console.log(`Worklet preflight: status=${ye.status}, content-type=${Re}`),/javascript/.test(Re)||console.warn("Worklet preflight returned unexpected Content-Type:",Re)}}catch(ye){console.warn("Worklet preflight HEAD request failed (continuing to module load):",ye)}const Me=new ue({sampleRate:eo});await Me.audioWorklet.addModule(xl),b(!0),O("worklet"),await Me.close(),console.log("AudioWorklet support enabled")}catch(ue){console.warn("AudioWorklet not available, falling back to ScriptProcessorNode:",ue);try{const Me=await fetch(xl,{method:"GET",cache:"no-store"});if(console.warn("Worklet GET status:",Me.status,Me.statusText,"content-type:",Me.headers.get("content-type")),Me.status!==200){const ye=await Me.text();console.warn("Worklet GET body preview (first 200 chars):",ye.slice(0,200))}}catch(Me){console.warn("Worklet GET failed:",Me)}Ee.current=!1,b(!1),O("script")}}catch(D){const re=D;re.message==="Initialization timed out"?(t("Error: libopenmpt initialization timed out."),console.error("libopenmpt initialization timed out (>15s).")):(t(`Error: ${re.message||"Audio library failed to load"}`),console.error("Error awaiting libopenmptReady:",D))}})(),()=>{console.log("Cleaning up libopenmpt resources."),H.current&&H.current.disconnect(),xe.current&&xe.current.disconnect(),oe.current&&oe.current.disconnect(),Le.current&&Le.current.state!=="closed"&&Le.current.close(),ke.current!==0&&je.current&&je.current._openmpt_module_destroy(ke.current),cancelAnimationFrame(Ze.current),Ke.current&&clearInterval(Ke.current)}),[]),X.useEffect(()=>{oe.current&&(oe.current.pan.value=Fe)},[Fe]),X.useEffect(()=>{i&&(async()=>{const D=sE.split("/").pop()||"default.mod";t(`Fetching "${D}"...`);try{const re=await fetch(sE);if(!re.ok)throw new Error(`Failed to fetch module: ${re.statusText}`);const ue=await re.arrayBuffer(),Me=new Uint8Array(ue);await $e(Me,D)}catch(re){console.error("Failed to load default module:",re),t("Error fetching default module. See console.")}})()},[i,$e]),{status:e,isReady:i,isPlaying:s,isModuleLoaded:a,moduleInfo:f,patternData:h,loadFile:j,play:Je,stopMusic:ut,sequencerMatrix:v,sequencerCurrentRow:w,sequencerGlobalRow:g,totalPatternRows:M,playbackSeconds:B,playbackRowFraction:me,channelStates:Z,beatPhase:W,grooveAmount:Q,kickTrigger:he,activeChannels:J,isLooping:Ie,setIsLooping:Be,seekToStep:pe=>{const D=je.current,re=ke.current;if(!D||re===0)return;let ue=0,Me=0,ye=0;const Re=D._openmpt_module_get_num_orders(re);for(let Pe=0;Pe<Re;Pe++){const fe=ve.current[Pe],Qe=fe?fe.numRows:D._openmpt_module_get_pattern_num_rows(re,D._openmpt_module_get_order_pattern(re,Pe));if(pe<ue+Qe){Me=Pe,ye=pe-ue;break}ue+=Qe}try{D._openmpt_module_set_position_order_row(re,Me,ye),d(Pe=>({...Pe,order:Me,row:ye})),x(ye),S(pe)}catch(Pe){console.error("Failed to seek:",Pe)}},panValue:Fe,setPanValue:Ne,activeEngine:L,isWorkletSupported:P,toggleAudioEngine:De}}const Sl={SQUARE:[{id:"patternv0.44.wgsl",label:"v0.44 (Frosted Wall 64)"},{id:"patternv0.43.wgsl",label:"v0.43 (Frosted Wall 32)"},{id:"patternv0.40.wgsl",label:"v0.40 (Frosted Grid)"},{id:"patternv0.39.wgsl",label:"v0.39 (Modern)"},{id:"patternv0.21.wgsl",label:"v0.21 (Wall)"}],CIRCULAR:[{id:"patternv0.45.wgsl",label:"v0.45 (Frosted UI)"},{id:"patternv0.42.wgsl",label:"v0.42 (Frosted Disc)"},{id:"patternv0.38.wgsl",label:"v0.38 (Glass)"},{id:"patternv0.35_bloom.wgsl",label:"v0.35 (Bloom)"},{id:"patternv0.30.wgsl",label:"v0.30 (Disc)"}],VIDEO:[{id:"patternv0.23.wgsl",label:"v0.23 (Clouds)"},{id:"patternv0.24.wgsl",label:"v0.24 (Tunnel)"}]};function zz(){const[n,e]=X.useState("patternv0.40.wgsl"),[t,i]=X.useState(.5),[r,s]=X.useState(0),[o,a]=X.useState(!1),[c,f]=X.useState(!1),[d,h]=X.useState("device"),{isReady:m,isModuleLoaded:v,isPlaying:y,isLooping:w,playbackSeconds:x,playbackRowFraction:g,totalPatternRows:S,sequencerMatrix:M,channelStates:T,beatPhase:P,grooveAmount:b,kickTrigger:L,activeChannels:O,play:C,stopMusic:R,loadFile:B,setIsLooping:$,seekToStep:me,setPanValue:G,activeEngine:Z,isWorkletSupported:ne,toggleAudioEngine:he,status:F}=Fz(t),[W,V]=X.useState(!1),[Q,se]=X.useState(null);X.useEffect(()=>{G(r)},[r,G]);const J=Ne=>{B(Ne)},ge=Ne=>{const je=Ne.type.startsWith("video")?"video":"image",ke=URL.createObjectURL(Ne);se({id:crypto.randomUUID(),kind:je,url:ke,fileName:Ne.name,mimeType:Ne.type,loop:je==="video"}),V(!0)},Ie=Ne=>{se(Ne),V(!0)},Be=c?.3:1,Fe=()=>d==="wall"?"patternv0.21.wgsl":"patternv0.38.wgsl";if(o){const Ne=Fe();return de.jsx(Iz,{darkMode:c,viewMode:d,onDarkModeToggle:()=>f(!c),onViewModeToggle:()=>h(d==="device"?"wall":"device"),onExitStudio:()=>a(!1),dimFactor:Be,headerContent:de.jsx("div",{className:"scale-75 origin-top-left",children:de.jsx(tM,{status:F})}),patternDisplayContent:de.jsx("div",{className:"scale-75 origin-center",children:de.jsx(uM,{matrix:M,playheadRow:g,isPlaying:y,bpm:120,timeSec:x,tickOffset:0,channels:T,beatPhase:P,grooveAmount:b,kickTrigger:L,activeChannels:O,isModuleLoaded:v,shaderFile:Ne,volume:t,pan:r,isLooping:w,totalRows:S,onPlay:C,onStop:()=>R(!1),onFileSelected:J,onLoopToggle:()=>$(!w),onSeek:je=>me(je),onVolumeChange:i,onPanChange:s,externalVideoSource:null,dimFactor:Be})}),controlsContent:de.jsx("div",{className:"scale-75 origin-top-left",children:de.jsx(iM,{isReady:m,isPlaying:y,isModuleLoaded:v,onFileSelected:J,onPlay:C,onStop:()=>R(!1),isLooping:w,onLoopToggle:()=>$(!w),volume:t,setVolume:i,pan:r,setPan:s,onMediaAdd:ge,onRemoteMediaSelect:Ie,remoteMediaList:[{id:"1",kind:"video",url:"clouds.mp4",fileName:"Clouds Demo (MP4)"}]})}),mediaOverlayContent:W&&Q?de.jsx("div",{className:"scale-75 origin-center",children:de.jsx(cM,{item:Q,visible:W,onClose:()=>V(!1),onUpdate:je=>{Q&&se({...Q,...je})}})}):void 0,playheadX:x*10})}return de.jsx("div",{className:`min-h-screen ${c?"bg-gray-900 text-white":"bg-gray-100 text-black"} p-4 flex flex-col items-center transition-colors duration-300`,children:de.jsxs("div",{className:"w-full max-w-[1280px]",children:[de.jsx(tM,{status:F}),de.jsxs("div",{className:"mb-4 flex flex-wrap items-center justify-between gap-4",children:[de.jsxs("div",{className:"flex gap-2",children:[de.jsx("button",{onClick:()=>a(!0),className:"px-4 py-2 bg-blue-600 text-white text-sm font-mono rounded-lg shadow-lg hover:bg-blue-700 transition-colors border border-blue-500",children:" 3D Mode"}),de.jsx("button",{onClick:()=>f(!c),className:`px-4 py-2 text-sm font-mono rounded-lg shadow-lg transition-colors border ${c?"bg-gray-800 text-white border-gray-700 hover:bg-gray-700":"bg-white text-black border-gray-300 hover:bg-gray-50"}`,children:c?" Light":" Dark"}),de.jsx("button",{onClick:he,disabled:!ne,title:ne?"Toggle Audio Engine (Worklet vs ScriptProcessor)":"AudioWorklet not supported",className:`px-4 py-2 text-sm font-mono rounded-lg shadow-lg transition-colors border ${ne?Z==="worklet"?"bg-green-600 text-white border-green-500 hover:bg-green-700":"bg-yellow-500 text-black border-yellow-400 hover:bg-yellow-600":"bg-gray-300 text-gray-500 cursor-not-allowed border-gray-400 opacity-50"}`,children:Z==="worklet"?" Worklet":" Script"})]}),de.jsxs("div",{className:`flex flex-wrap gap-2 p-2 rounded-xl border ${c?"bg-black border-gray-800":"bg-gray-200 border-gray-300"}`,children:[de.jsxs("div",{className:"flex items-center gap-1",children:[de.jsx("span",{className:"text-[10px] font-bold text-gray-500 uppercase px-1",children:"Square"}),de.jsxs("select",{className:`text-xs font-mono p-1 rounded border outline-none ${c?"bg-gray-800 border-gray-600 text-white":"bg-white border-gray-300 text-black"}`,value:Sl.SQUARE.some(Ne=>Ne.id===n)?n:"",onChange:Ne=>Ne.target.value&&e(Ne.target.value),children:[de.jsx("option",{value:"",disabled:!0,children:"Select..."}),Sl.SQUARE.map(Ne=>de.jsx("option",{value:Ne.id,children:Ne.label},Ne.id))]})]}),de.jsx("div",{className:`w-px h-6 ${c?"bg-gray-800":"bg-gray-300"}`}),de.jsxs("div",{className:"flex items-center gap-1",children:[de.jsx("span",{className:"text-[10px] font-bold text-gray-500 uppercase px-1",children:"Circular"}),de.jsxs("select",{className:`text-xs font-mono p-1 rounded border outline-none ${c?"bg-gray-800 border-gray-600 text-white":"bg-white border-gray-300 text-black"}`,value:Sl.CIRCULAR.some(Ne=>Ne.id===n)?n:"",onChange:Ne=>Ne.target.value&&e(Ne.target.value),children:[de.jsx("option",{value:"",disabled:!0,children:"Select..."}),Sl.CIRCULAR.map(Ne=>de.jsx("option",{value:Ne.id,children:Ne.label},Ne.id))]})]}),de.jsx("div",{className:`w-px h-6 ${c?"bg-gray-800":"bg-gray-300"}`}),de.jsxs("div",{className:"flex items-center gap-1",children:[de.jsx("span",{className:"text-[10px] font-bold text-gray-500 uppercase px-1",children:"Video"}),de.jsxs("select",{className:`text-xs font-mono p-1 rounded border outline-none ${c?"bg-gray-800 border-gray-600 text-white":"bg-white border-gray-300 text-black"}`,value:Sl.VIDEO.some(Ne=>Ne.id===n)?n:"",onChange:Ne=>Ne.target.value&&e(Ne.target.value),children:[de.jsx("option",{value:"",disabled:!0,children:"Select..."}),Sl.VIDEO.map(Ne=>de.jsx("option",{value:Ne.id,children:Ne.label},Ne.id))]})]})]})]}),de.jsxs("div",{className:`relative rounded-xl overflow-hidden shadow-2xl mb-6 border ${c?"bg-black border-gray-800":"bg-white border-gray-300"}`,children:[de.jsx(uM,{matrix:M,playheadRow:g,isPlaying:y,bpm:120,timeSec:x,tickOffset:0,channels:T,beatPhase:P,grooveAmount:b,kickTrigger:L,activeChannels:O,isModuleLoaded:v,shaderFile:n,volume:t,pan:r,isLooping:w,totalRows:S,onPlay:C,onStop:()=>R(!1),onFileSelected:J,onLoopToggle:()=>$(!w),onSeek:Ne=>me(Ne),onVolumeChange:i,onPanChange:s,externalVideoSource:null,dimFactor:Be}),de.jsx(cM,{item:Q,visible:W,onClose:()=>V(!1),onUpdate:Ne=>{Q&&se({...Q,...Ne})}})]}),de.jsx(iM,{isReady:m,isPlaying:y,isModuleLoaded:v,onFileSelected:J,onPlay:C,onStop:()=>R(!1),isLooping:w,onLoopToggle:()=>$(!w),volume:t,setVolume:i,pan:r,setPan:s,onMediaAdd:ge,onRemoteMediaSelect:Ie,remoteMediaList:[{id:"1",kind:"video",url:"clouds.mp4",fileName:"Clouds Demo (MP4)"}]}),de.jsxs("div",{className:"mt-8 text-center text-xs opacity-50",children:[de.jsx("p",{children:"Supports .mod, .xm, .s3m, .it files."}),de.jsx("p",{children:"WebGPU required for visualization."})]})]})})}const t2=document.getElementById("root");if(!t2)throw new Error("Failed to find the root element");const Bz=H0.createRoot(t2);Bz.render(de.jsx(aR.StrictMode,{children:de.jsx(zz,{})}));
